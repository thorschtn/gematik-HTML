<html>
 <head>
  <link rel="stylesheet" href="attachments/styleSheetForToc.css">
 </head>
 <body>
  <p id="polarion_1"></p>
  <p id="polarion_41"></p>
  <p id="polarion_2"> <br> </p>
  <p id="polarion_3"> <br> </p>
  <p id="polarion_4"> <br> </p>
  <p id="polarion_5"> <br> </p>
  <p id="polarion_6"> <span style="font-weight: bold;text-decoration: underline;font-size: 12pt;font-family: Arial, Helvetica, sans-serif;line-height: 1.5;">Elektronische Gesundheitskarte und Telematikinfrastruktur</span> </p>
  <p id="polarion_7"> <br> </p>
  <p id="polarion_8"> <br> </p>
  <p id="polarion_9"> <br> </p>
  <p id="polarion_10"> <br> </p>
  <p id="polarion_11" style="text-align: center;"> <span style="font-weight: bold;font-size: 26pt;line-height: 1.2;">Spezifikation</span> </p>
  <p id="polarion_12" style="text-align: center;"> <span style="font-weight: bold;font-size: 26pt;line-height: 1.2;">E-Rezept-Fachdienst</span> </p>
  <p id="polarion_13"> <br> </p>
  <p id="polarion_14"> <br> </p>
  <p id="polarion_15"> <br> </p>
  <div id="polarion_editor_html_block2" class="polarion-dle-wiki-block"> 
   <div id="polarion_editor_html_block_content" contenteditable="false"></div>
   <pre id="polarion_editor_html_block_source" class="polarion-dle-wiki-block-source" contenteditable="false">
    <table>
     <tr>
      <td>Version</td>
      <td>1.5.0</td>
     </tr>
     <tr>
      <td>Revision</td>
      <td>571475</td>
     </tr>
     <tr>
      <td>Stand</td>
      <td>07.12.2022</td>
     </tr>
     <tr>
      <td>Status</td>
      <td>freigegeben</td>
     </tr>
     <tr>
      <td>Klassifizierung</td>
      <td>öffentlich</td>
     </tr>
     <tr>
      <td>Referenzierung</td>
      <td>gemSpec_FD_eRp</td>
     </tr>
    </table></pre> 
  </div>
  <p id="polarion_16"></p>
  <h1 id="polarion_wiki macro name=module-workitem;params=id=ML-103540">Dokumentinformationen</h1>
  <p id="polarion_21"> <span style="font-weight: bold;">Änderungen zur Vorversion</span> </p>
  <p id="polarion_22">Anpassungen des vorliegenden Dokumentes im Vergleich zur Vorversion können Sie der nachfolgenden Tabelle entnehmen.</p>
  <p id="polarion_23"></p>
  <p id="polarion_25" data-keep-next="true"> <span style="font-weight: bold;">Dokumentenhistorie</span> </p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=3" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 60.4px;height: 38px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Version<br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 67.6px;height: 38px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Stand<br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 50px;height: 38px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Kap./ Seite<br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 276.4px;height: 38px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Grund der Änderung, besondere Hinweise<br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 94px;height: 38px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Bearbeitung<br> </th> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 60.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">1.0.0</td> 
     <td style="text-align: left;vertical-align: top;width: 67.6px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">30.06.2020</td> 
     <td style="text-align: left;vertical-align: top;width: 50px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td> 
     <td style="text-align: left;vertical-align: top;width: 276.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">freigegeben</td> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 60.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">1.0.1</td> 
     <td style="text-align: left;vertical-align: top;width: 67.6px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">06.07.2020</td> 
     <td style="text-align: left;vertical-align: top;width: 50px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td> 
     <td style="text-align: left;vertical-align: top;width: 276.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Aktualisierung Hinweis zu Dispensierinformation</td> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 60.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">1.1.0</td> 
     <td style="text-align: left;vertical-align: top;width: 67.6px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">12.11.2020</td> 
     <td style="text-align: left;vertical-align: top;width: 50px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td> 
     <td style="text-align: left;vertical-align: top;width: 276.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Einarbeitung gemäß Änderungsliste P22.2 / Scope-Themen zu R4.0.1</td> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 60.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">1.1.1</td> 
     <td style="text-align: left;vertical-align: top;width: 67.6px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">13.11.2020</td> 
     <td style="text-align: left;vertical-align: top;width: 50px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td> 
     <td style="text-align: left;vertical-align: top;width: 276.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Einarbeitung gemäß Änderungsliste P22.4</td> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 60.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">1.2.0&nbsp;</td> 
     <td style="text-align: left;vertical-align: top;width: 67.6px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">19.02.2021</td> 
     <td style="text-align: left;vertical-align: top;width: 50px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td> 
     <td style="text-align: left;vertical-align: top;width: 276.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Einarbeitung gemäß Änderungsliste P22.5</td> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 60.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">1.3.0</td> 
     <td style="text-align: left;vertical-align: top;width: 67.6px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">07.10.2021</td> 
     <td style="text-align: left;vertical-align: top;width: 50px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td> 
     <td style="text-align: left;vertical-align: top;width: 276.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Einarbeitung gemäß Änderungslisten<br> E-Rezept_Maintenance_21.1 und _21.2</td> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 60.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">1.4.0</td> 
     <td style="text-align: left;vertical-align: top;width: 67.6px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">09.08.2022</td> 
     <td style="text-align: left;vertical-align: top;width: 50px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td> 
     <td style="text-align: left;vertical-align: top;width: 276.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Einarbeitung gemäß Änderungslisten E-Rezept_Maintenance_21.3, _21.4, 22.1 und _22.2;<br> Einarbeitung gemF_eRp_WF_LE, gemF_eRp_MVO und gemF_eRp_PKV</td> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 60.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">1.5.0</td> 
     <td style="text-align: left;vertical-align: top;width: 67.6px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">07.12.2022</td> 
     <td style="text-align: left;vertical-align: top;width: 50px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td> 
     <td style="text-align: left;vertical-align: top;width: 276.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Einarbeitung gemäß Änderungsliste E-Rezept_Maintenance_22.3</td> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_27"></p>
  <h1 id="polarion_wiki macro name=module-workitem;params=id=ML-103541">Inhaltsverzeichnis</h1>
  <div id="polarion_wiki macro name=toc"></div>
  <div id="toc_container">
   <p class="toc_title"><h1></h1></p>
   <li><a href="#polarion_wiki macro name=module-workitem;params=id=ML-103540">Dokumentinformationen</a></li>
   <li><a href="#polarion_wiki macro name=module-workitem;params=id=ML-103541">Inhaltsverzeichnis</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103542">1 Einordnung des Dokumentes</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103543">1.1 Zielsetzung</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103544">1.2 Zielgruppe</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103545">1.3 Geltungsbereich</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103546">1.4 Abgrenzungen</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103547">1.5 Methodik</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103548">1.5.1 Hinweis auf offene Punkte</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103549">2 Systemüberblick</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103550">3 Systemkontext</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103552">3.1 Nachbarsysteme</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103551">3.2 Akteure und Rollen</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103553">4 Zerlegung des Produkttyps</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103554">5 Übergreifende Festlegungen</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104284">5.1 Servicelokalisierung</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103555">5.2 Authentifizierung von Nutzern</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-108431">5.2.1 Registrierung beim Identity Provider</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-108430">5.2.2 Claims der Identitätsbestätigung</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-108432">5.2.3 Verwaltung der Nutzersession</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-120942">5.3 Routing von Requests</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103559">5.4 Fehlercodes</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103855">5.5 Protokollierung</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103560">5.6 Löschfristen</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-126181">5.7 Berechtigungen und Prozessparameter</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103566">5.8 Sicherheit</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-108492">5.8.1 Allgemeine Sicherheitsanforderungen</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-108491">5.8.2 Identifikation des Clientsystems</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-108507">5.8.3 Vertrauensraum der TI</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-107346">5.8.4 Sicherheit der Netzübergänge</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-107354">5.8.5 Vertrauenswürdige Ausführungsumgebung</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-107357">5.8.5.1 Verarbeitungskontext</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-107355">5.8.5.2 Ausschluss von nicht autorisierten Zugriffen aus dem Betriebsumfeld</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-107356">5.8.5.3 Konsistenz des Systemzustands, Logging und Monitoring</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-107358">5.8.5.4 Client-Verbindungen zum Verarbeitungskontext</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103568">6 Funktionsmerkmale</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103569">6.1 Ressource Task</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103571">6.1.1 HTTP-Operation GET</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103577">6.1.2 HTTP-Operation POST</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103578">6.1.2.1 POST /Task/$create</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103586">6.1.2.2 POST /Task/&lt;id&gt;/$activate</a></li>
   <li> : : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-132669">6.1.2.2.1 POST /Task/&lt;id&gt;/$activate - Mehrfachverordnung</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103595">6.1.2.3 POST /Task/&lt;id&gt;/$accept</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103601">6.1.2.4 POST /Task/&lt;id&gt;/$reject</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103605">6.1.2.5 POST /Task/&lt;id&gt;/$close</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103611">6.1.2.6 POST /Task/&lt;id&gt;/$abort</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103619">6.2 Ressource MedicationDispense</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103620">6.2.1 HTTP-Operation GET /MedicationDispense</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-132929">6.3 Ressource ChargeItem</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-132928">6.3.1 HTTP-Operation DELETE</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-132932">6.3.2 HTTP-Operation GET</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-132930">6.3.2.1 GET /ChargeItem</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-132931">6.3.2.2 GET /ChargeItem/&lt;id&gt;</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-132941">6.3.3 HTTP-Operation PATCH</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-132942">6.3.3.1 PATCH /ChargeItem/&lt;id&gt;</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-132938">6.3.4 HTTP-Operation POST</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-132940">6.3.4.1 POST /ChargeItem</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-132934">6.3.5 HTTP-Operation PUT</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-132936">6.3.5.1 PUT /ChargeItem/&lt;id&gt;</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-132939">6.4 Ressource Consent</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-132937">6.4.1 HTTP-Operation DELETE</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-132935">6.4.2 HTTP-Operation GET</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-132933">6.4.3 HTTP-Operation POST</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103622">6.5 Ressource Communication</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103623">6.5.1 HTTP-Operation GET</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103624">6.5.1.1 GET /Communication/</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103626">6.5.2 HTTP-Operation POST</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103627">6.5.2.1 POST /Communication/</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-110223">6.5.3 HTTP-Operation DELETE</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-110222">6.5.3.1 DELETE /Communication/</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103628">6.6 Ressource AuditEvent</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104278">6.6.1 HTTP-Operation GET /AuditEvent</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-112022">6.7 Ressource Device</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-126133">6.8 Ressource Subscription</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-126132">6.8.1 HTTP-Operation POST</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-126134">6.9 Subscription Service</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103629">7 Informationsmodell</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103633">8 Anhang A – Verzeichnisse</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103634">8.1 Abkürzungen</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103635">8.2 Glossar</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103636">8.3 Abbildungsverzeichnis</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103637">8.4 Tabellenverzeichnis</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103638">8.5 Referenzierte Dokumente</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103639">8.5.1 Dokumente der gematik</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-103640">8.5.2 Weitere Dokumente</a></li>
  </div>
  <p id="polarion_38"></p>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-103542">1 Einordnung des Dokumentes</h2>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-103543">1.1 Zielsetzung</h3>
  <p id="polarion_40"> Die vorliegende Spezifikation definiert die Anforderungen zu Herstellung, Test und Betrieb des Produkttyps E-Rezept-Fachdienst.<br> </p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-103544">1.2 Zielgruppe</h3>
  <p id="polarion_17">Das Dokument richtet sich an den Hersteller des E-Rezept-Fachdienstes, sowie an Hersteller und Anbieter von weiteren&nbsp;Produkttypen der Fachanwendung E-Rezept.</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-103545">1.3 Geltungsbereich</h3>
  <p id="polarion_53"> Dieses Dokument enthält normative Festlegungen zur Telematikinfrastruktur des Deutschen Gesundheitswesens. Der Gültigkeitszeitraum der vorliegenden Version und deren Anwendung in Zulassungs- oder Abnahmeverfahren wird durch die gematik GmbH in gesonderten Dokumenten (z.B. Dokumentenlandkarte, Produkttypsteckbrief, Leistungsbeschreibung) fest­gelegt und bekannt gegeben.<br> </p>
  <p id="polarion_54"> <span style="font-weight: bold;font-size: 10pt;font-family: Arial, Helvetica, sans-serif;line-height: 1.5;">Schutzrechts-/Patentrechtshinweis</span> </p>
  <p id="polarion_55"> <span style="font-style: italic;font-size: 10pt;font-family: Arial, Helvetica, sans-serif;line-height: 1.5;">Die nachfolgende Spezifikation ist von der gematik allein unter technischen Gesichtspunkten erstellt worden. Im Einzelfall kann nicht ausgeschlossen werden, dass die Implementierung der Spezifikation in technische Schutzrechte Dritter eingreift. Es ist allein Sache des Anbieters oder Herstellers, durch geeignete Maßnahmen dafür Sorge zu tragen, dass von ihm aufgrund der Spezifikation angebotene Produkte und/oder Leistungen nicht gegen Schutzrechte Dritter verstoßen und sich ggf. die erforderlichen Erlaubnisse/Lizenzen von den betroffenen Schutzrechtsinhabern einzuholen. Die gematik GmbH übernimmt insofern keinerlei Gewährleistungen.</span> </p>
  <p id="polarion_18"></p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-103546">1.4 Abgrenzungen</h3>
  <p id="polarion_58">Spezifiziert werden in dem Dokument die von dem Produkttyp bereitgestellten (angebotenen) Schnittstellen. Benutzte Schnittstellen werden hingegen in der Spezifikation desjenigen Produkttypen beschrieben, der diese Schnittstelle bereitstellt. Auf die entsprechenden Dokumente wird referenziert (siehe auch Anhang A5).</p>
  <p id="polarion_59">Die vollständige Anforderungslage für den Produkttyp ergibt sich aus weiteren Konzept- und Spezifikationsdokumenten, diese sind in dem Produkttypsteckbrief des Produkttyps &lt;Produkttyp&gt; verzeichnet.</p>
  <p id="polarion_60"></p>
  <p id="polarion_61">Nicht Bestandteil des vorliegenden Dokumentes sind die informativen Ergänzungen zur Nutzung der Schnittstellen des E-Rezept-Fachdienstes in der separaten API-Dokumentation, sowie zur Profilierung der verwendeten FHIR-Ressourcen.</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-103547">1.5 Methodik</h3>
  <p id="polarion_65">Anforderungen als Ausdruck normativer Festlegungen werden durch eine eindeutige ID in eckigen Klammern sowie die dem RFC 2119 [RFC2119] entsprechenden, in Großbuchstaben geschriebenen deutschen Schlüsselworte MUSS, DARF NICHT, SOLL, SOLL NICHT, KANN gekennzeichnet.</p>
  <p id="polarion_66"></p>
  <p id="polarion_67"> Sie werden im Dokument wie folgt dargestellt:<span style="font-weight: bold;font-family: Wingdings;"><br> </span> <span style="font-weight: bold;">&lt;AFO-ID&gt; - &lt;Titel der Afo&gt;</span><br> Text / Beschreibung<br> [&lt;=] </p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-103548">1.5.1 Hinweis auf offene Punkte</h4>
  <p id="polarion_44">Themen, die noch intern geklärt werden müssen oder eine Entscheidung, sind wie folgt im Dokument gekennzeichnet:</p>
  <table id="polarion_wiki macro name=table;params=header=no|width=100%|uid=1" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-style: italic;color: #3366FF;">Beispiel für einen offenen Punkt.</span></td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_138"></p>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-103549">2 Systemüberblick</h2>
  <p id="polarion_78">Der E-Rezept-Fachdienst verwaltet E-Rezepte in der Telematikinfrastruktur als ein zentraler Ressourcenserver auf Basis des FHIR-Standards mit einer RESTful API.&nbsp;Die Rezepte werden dabei über eine eindeutige Ressourcen-ID (Rezept-ID) adressiert. Zusätzlich protokolliert der E-Rezept-Fachdienst alle Zugriffe auf ein E-Rezept für den Versicherten und verwaltet die Statusübergänge eines E-Rezepts. Für einen Nachrichtenaustausch zwischen Apotheken und Versicherten über die Verfügbarkeit von Medikamenten, die Belieferung von E-Rezepten und der Vertretung beim Einlösen eines E-Rezepts ist zusätzlich eine Kommunikation über den E-Rezept-Fachdienst möglich.</p>
  <p id="polarion_26">Der E-Rezept-Fachdienst realisiert die Vertraulichkeit und Integrität der verarbeiteten Daten über das Konzept der vertrauenswürdigen Ausführungsumgebung (VAU), die eine durchgängige Verschlüsselung der E-Rezepte und der dazu gehörigen Daten aus einer Kombination kryptografischer Verfahren während des Transports, der vertrauenswürdigen Verarbeitung und in der verschlüsselten Persistierung der Daten sicherstellt.</p>
  <p id="polarion_29" style="text-align: center;" data-keep-next="true"> <img src="attachments/Systemkontext.png" style="width: 712px;height: 662px;" data-lastmodified="2020-04-14T14:21:46.303+02:00"> </p>
  <p id="polarion_30" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">1</span>:&nbsp;Systemüberblick </p>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-103550">3 Systemkontext</h2>
  <p id="polarion_28">Der E-Rezept-Fachdienst stellt Schnittstellen für die Verwaltung von E-Rezepten und für den Nachrichtenaustausch bereit. Diese werden von Leistungserbringerorganisationen und Versicherten genutzt, die über ihre jeweiligen Clientsysteme auf den E-Rezept-Fachdienst zugreifen.</p>
  <p id="polarion_37" style="text-align: center;" class="polarion-rte-caption-paragraph"> <img src="attachments/Systemkontextübersicht.png" style="max-width: 750px;" data-lastmodified="2020-08-10T14:23:50.220+02:00"> </p>
  <p id="polarion_109" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">2</span>: Systemkontext E-Rezept-Fachdienst </p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-103552">3.1 Nachbarsysteme</h3>
  <p id="polarion_84"> <span style="font-style: normal;">Die Schnittstellen des E-Rezept-Fachdienstes werden durch die Praxisverwaltungs- und Krankenhausinformationssysteme der verordnenden Leistungserbringer im Verordnungsprozess genutzt. Die Apothekenverwaltungssysteme nutzen die Schnittstellen des E-Rezept-Fachdienstes im Rahmen der Dispensierung.&nbsp;Außerdem werden sie&nbsp;vom E-Rezept-Frontend des Versicherten (E-Rezept-FdV) aufgerufen.&nbsp;Als Fachdienst der Telematikinfrastruktur bedient sich der E-Rezept-Fachdienst der weiteren Infrastrukturdienste wie TSP für die Gültigkeitsabfrage für Signaturzertifikate, des HBA (für QES-Prüfung) und des IdentityManagements, bei dem ein IDP Identitätsbestätigungen (ID_TOKEN, ACCESS_TOKEN) für Nutzer im Rahmen eines Sessionmanagements für das Single Sign-On ausstellt.&nbsp;</span> </p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-103551">3.2 Akteure und Rollen</h3>
  <p id="polarion_73">Leistungserbringerinstitutionen und Versicherte weisen sich gegenüber dem E-Rezept-Fachdienst mit einer Identitätsbestätigung (ACCESS_TOKEN) aus, die sie von einem Identitätsprovider, z.B. SmartCard-IDP, beziehen. In diesen ACCESS_TOKEN ist ihre Rollen-OID sowie ihr Identitätskennzeichen Versicherten-ID (10-stelliger unveränderlicher Anteil der KVNR) bzw. Telematik-ID enthalten. Anhand der jeweiligen Rolle wird die Zulässigkeit einer aufgerufenen Operation geprüft. Das Identitätskennzeichen wird für die Protokollierung von Zugriffen sowie die Zuordnung von Datensätzen, insbesondere bei E-Rezepten zu Versicherten, genutzt.&nbsp;</p>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-103553">4 Zerlegung des Produkttyps</h2>
  <p id="polarion_20">Der E-Rezept-Fachdienst verwaltet E-Rezepte über einen medizinischen Workflow. Dabei muss er die Vertraulichkeit und Integrität der verarbeiteten Daten sicherstellen. Daraus ergeben sich Sicherheitsanforderungen an die Betriebsumgebung, an die Fachlogik der Prozessverarbeitung sowie an die Ausführungsumgebung des Programmcodes.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107058">
   <p><b>A_19586</b></p>
   <p>Der Anbieter des E-Rezept-Fachdienstes MUSS das private Schlüsselmaterial für kryptografische Verfahren (Entschlüsselung, Signaturen) in einem HSM speichern,&nbsp;dessen Eignung durch eine erfolgreiche Evaluierung nachgewiesen wurde. Als Evaluierungsschemata kommen dabei Common Criteria, ITSEC oder Federal Information Processing Standard (FIPS) in Frage. &nbsp;&nbsp;&nbsp;&nbsp;<br> Die Prüftiefe MUSS mindestens&nbsp; 
    <ol> 
     <li>FIPS 140-2 Level 3,&nbsp;&nbsp;&nbsp;&nbsp;</li> 
     <li>Common Criteria EAL 4+ mit hohem Angriffspotenzial oder</li> 
     <li>ITSEC E3 der Stärke „hoch“ entsprechen.</li> 
    </ol> <b>&lt;=</b></p>
  </div>
  <p id="polarion_39">Eine über die Schlüsselspeicherung in einem Hardware Security Module (HSM) hinausgehende Anforderung an die Zerlegung des E-Rezept-Fachdienstes gibt es aus funktionaler Sicht nicht.</p>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-103554">5 Übergreifende Festlegungen</h2>
  <p id="polarion_64">Der folgende Abschnitt beschreibt übergreifende Anforderungen an den E-Rezept-Fachdienst zur Unterstützung der Fachlogik.</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104284">5.1 Servicelokalisierung</h3>
  <p id="polarion_74">Die Schnittstellen des E-Rezept-Fachdienstes werden über verschiedene Netzsegmente von Leistungserbringern und Versicherten aufgerufen. Dafür müssen diese Schnittstellen über DNS-Abfragen lokalisierbar sein.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-120451">
   <p><b>A_19412-03</b></p>
   <p>Der Anbieter des E-Rezept-Fachdienstes MUSS die den Primärsystemen angebotenen Schnittstellen des E-Rezept-Fachdienstes unter den folgenden URLs zur Verfügung stellen: &nbsp;<br>
    <ul>
     <li>https://erp.zentral.erp.splitdns.ti-dienste.de/VAU - Schnittstelle E-Rezept</li>
     <li>https://erp.zentral.erp.splitdns.ti-dienste.de/VAUCertificate - Schnittstelle VAU-Verschlüsselungsidentität</li>
     <li>https://erp.zentral.erp.splitdns.ti-dienste.de/VAUCertificateOCSPResponse - Schnittstelle VAU-Verschlüsselungsidentität</li>
     <li>https://erp.zentral.erp.splitdns.ti-dienste.de/ocspf - Schnittstelle OCSP-Forwarder</li>
     <li>https://erp.zentral.erp.splitdns.ti-dienste.de/TSL.xml - Schnittstelle Download TSL-Datei</li>
     <li>https://erp.zentral.erp.splitdns.ti-dienste.de/TSL.sha2 - Schnittstelle Download Hashwert TSL-Datei</li>
     <li>https://erp.zentral.erp.splitdns.ti-dienste.de/.well-known - Schnittstelle well-known locations&nbsp;</li>
     <li>https://erp.zentral.erp.splitdns.ti-dienste.de/CertList&nbsp;</li>
     <li>https://erp.zentral.erp.splitdns.ti-dienste.de/OCSPList</li>
     <li>https://erp.zentral.erp.splitdns.ti-dienste.de/random - Schnittstelle für Zufallsdaten</li>
     <li>https://subscription.zentral.erp.splitdns.ti-dienste.de - Schnittstelle Subscription Service&nbsp;</li>
    </ul> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-120452">
   <p><b>A_21782</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der Anbieter des E-Rezept-Fachdienstes MUSS die im Internet angebotenen Schnittstellen des E-Rezept-Fachdienstes unter den folgenden URLs zur Verfügung stellen:</span><br> 
    <ul>
     <li>https://erp.app.ti-dienste.de/VAU - Schnittstelle E-Rezept</li>
     <li>https://erp.app.ti-dienste.de/VAUCertificate - Schnittstelle VAU-Verschlüsselungsidentität</li>
     <li>https://erp.app.ti-dienste.de/VAUCertificateOCSPResponse - Schnittstelle VAU-Verschlüsselungsidentität</li>
     <li>https://erp.app.ti-dienste.de/ocspf - Schnittstelle OCSP-Forwarder</li>
     <li>https://erp.app.ti-dienste.de/TSL.xml - Schnittstelle Download TSL-Datei</li>
     <li>https://erp.app.ti-dienste.de/TSL.sha2 - Schnittstelle Download Hashwert TSL-Datei</li>
     <li>https://erp.app.ti-dienste.de/.well-known - Schnittstelle well-known locations&nbsp;</li>
     <li>https://erp.app.ti-dienste.de/CertList&nbsp;</li>
     <li>https://erp.app.ti-dienste.de/OCSPList</li>
     <li>https://erp.app.ti-dienste.de/random - Schnittstelle für Zufallsdaten</li>
    </ul> <b>&lt;=</b></p>
  </div>
  <p id="polarion_24">Um Benutzern den Umgang mit E-Rezepten zu erleichtern, wird die Nutzung der Endnutzeranwendung E-Rezept-FdV als App auf ihrem privaten Smartphone empfohlen. Der E-Rezept-Fachdienst unterstützt dabei die App-Nutzung durch Digital Asset Links (für Android) [DAL_ANDROID] und Universal Links (für iOS/macOS) [UL_APPLE].</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107376">
   <p><b>A_19695</b></p>
   <p>Der E-Rezept-Fachdienst MUSS ein Asset Link Statement <span style="font-size: 10pt;color: #202124;line-height: 1.5;">gemäß [DAL_ANDROID] mit der Liste der Hashwerte der aktuell zugelassenen Android-Versionen des E-Rezept-FdV für den Wert "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">sha256_cert_fingerprints</span>"&nbsp;unter der Internetadresse <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">https://&lt;FQDN für DNS Lookup&gt;/.well-known/assetlinks.json</span> veröffentlichen und pflegen, damit Versicherte mit einem Android-Smartphone E-Rezepte standardmäßig mit dem&nbsp;E-Rezept-FdV verwalten können.</span> <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-103555">5.2 Authentifizierung von Nutzern</h3>
  <p id="polarion_112">Die Identifikation von Nutzern erfolgt nach dem Standard OpenID-Connect, hierfür stellt ein Identity Provider der Telematikinfrastruktur ACCESS_TOKEN für Nutzer aus, die er anhand ihrer identifizierenden Merkmale (z.B. eGK, SMC-B) authentifiziert.</p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-108431">5.2.1 Registrierung beim Identity Provider</h4>
  <p id="polarion_33">Der E-Rezept-Fachdienst delegiert die Authentifizierung von Nutzern an einen Identity Provider. Für diesen Zweck muss er sich bei diesem als Relying Party registrieren und die für die Fachlogik notwendigen Attribute in den Identitätsbestätigungen (ACCESS_TOKEN)&nbsp; festlegen. Die Umsetzung des IdentityManagements über Identity Provider startet mit einem einzelnen IDP (Smartcard-IDP), später werden weitere Identity Provider bei den verschiedenen identitätsbestätigenden Stellen realisiert. Verwaltet ein solcher IDP Identitäten von Nutzern der Telematikinfrastruktur und gilt als vertrauenswürdig für die Umsetzung von Use Cases unter Nutzung der Schnittstellen des E-Rezept-Fachdienstes, obliegt es dem E-Rezept-Fachdienst, sich bei diesem IDP als Relying Party zu registrieren.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-114086">
   <p><b>A_19985-01</b></p>
   <p>Der Anbieter des E-Rezept-Fachdienstes MUSS sich über einen organisatorischen Prozess bei einem vertrauenswürdigen Identity Provider (IDP) der Telematikinfrastruktur als Relying Party registrieren und die Bereitstellung der folgenden Claims in für Nutzer ausgestellte ACCESS_TOKEN mit dem IDP vereinbaren:<br> 
    <ul>
     <li><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">professionOID</span></li>
     <li><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">given_name</span></li>
     <li><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">family_name</span><br></li>
     <li><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">organizationName</span><br></li>
     <li><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">idNummer</span><br></li>
     <li><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">acr</span></li>
     <li><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">aud</span></li>
    </ul>damit der E-Rezept-Fachdienst die Fachlogik der Autorisierung und Protokollierung auf diesen Attributen umsetzen kann.&nbsp; <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111923">
   <p><b>A_20706</b></p>
   <p>Der Anbieter des E-Rezept-Fachdienstes MUSS&nbsp;bei der Registrierung als Relying Party im IDP die Bereitstellung der folgenden Claims in für Nutzer ausgestellte ID_TOKEN mit dem IDP vereinbaren:<br> 
    <ul>
     <li><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">professionOID</span><br></li>
     <li><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">given_name</span><br></li>
     <li><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">family_name</span><br></li>
     <li><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">organizationName</span><br></li>
     <li><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">idNummer</span><br></li>
     <li><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">acr</span></li>
    </ul>damit ein E-Rezept-Client diese Informationen bei Bedarf auswerten kann. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-108436">
   <p><b>A_19986</b></p>
   <p>Der Anbieter des E-Rezept-Fachdienstes MUSS bei der Registrierung als Relying Party im IDP die Ausstellung von ACCESS_TOKEN&nbsp;für authentifizierte Nutzer für die maximale Dauer von 12 Stunden erlauben, sodass der IDP spätestens 12 Stunden nach&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">auth_time</span> eine Re-Authentifizierung des Nutzers erzwingt. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111937">
   <p><b>A_20710</b></p>
   <p>Der Anbieter des E-Rezept-Fachdienstes MUSS bei der Registrierung als Relying Party im IDP eine Lebensdauer von ausgestellten ACCESS_TOKEN durch den IDP für die Berechnung des Werts "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">tokenTimeout</span>" von 300 Sekunden festlegen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_68"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-108447">
   <p><b>A_19993</b></p>
   <p>Der E-Rezept-Fachdienst MUSS jedes mit einem eingehenden HTTP-Request übergebene ACCESS_TOKEN gemäß der Festlegungen in [gemSpec_IDP_FD#Kapitel 6 ACCESS_TOKEN] prüfen und Fehler bzw. ungültige Token gemäß dieser Festlegungen und dem&nbsp;HTTP-Status-Code 401 abweisen. <b>&lt;=</b></p>
  </div>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-108430">5.2.2 Claims der Identitätsbestätigung</h4>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103556">
   <p><b>A_19130</b></p>
   <p>Der E-Rezept-Fachdienst MUSS alle eingehenden HTTP-Requests über den Endpunkt für Leistungserbringerinstitutionen mit dem HTTP-Fehlercode 401 und dem HTTP-Response-Header "<span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">WWW-Authenticate: Bearer realm='prescriptionserver.telematik'</span><pre> scope=openid profile prescriptionservice.lei"</pre>abweisen, die kein ACCESS_TOKEN als&nbsp;JSON-Web-Token-Format gemäß [JWT] im HTTP-Request-Header "Authorization" bereitstellen,&nbsp;damit ausschließlich authentifizierte Nutzer Zugriff auf die HTTP-Schnittstelle des E-Rezept-Fachdienstes erhalten. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-104260">
   <p><b>A_19389</b></p>
   <p>Der E-Rezept-Fachdienst MUSS alle eingehenden HTTP-Requests über den Endpunkt für den Zugriff für Versicherte mit dem HTTP-Fehlercode 401 und dem HTTP-Response-Header "<span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">WWW-Authenticate: Bearer realm='prescriptionserver.telematik'</span><pre>scope=openid profile prescriptionservice.vers"</pre>abweisen, die kein ACCESS_TOKEN als&nbsp;JSON-Web-Token-Format gemäß [JWT] im HTTP-Request-Header "Authorization" bereitstellen,&nbsp;damit ausschließlich authentifizierte Nutzer Zugriff auf die HTTP-Schnittstelle des E-Rezept-Fachdienstes erhalten. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103557">
   <p><b>A_19131</b></p>
   <p>Der E-Rezept-Fachdienst MUSS alle eingehenden HTTP-Requests mit dem HTTP-Fehlercode 401 und dem HTTP-Response-Header "<span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">WWW-Authenticate: Bearer realm='prescriptionserver.telematik', error='invalACCESS_TOKEN'"</span><span style="font-size: 10pt;font-family: Arial, Helvetica;line-height: 1.5;"> </span>abweisen, die ein unsigniertes oder ungültiges ACCESS_TOKEN im HTTP-Request-Header "Authorization" bereitstellen,&nbsp;damit ausschließlich authentifizierte Nutzer Zugriff auf die HTTP-Schnittstelle des E-Rezept-Fachdienstes erhalten. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103558">
   <p><b>A_19132</b></p>
   <p>Der E-Rezept-Fachdienst MUSS die Signatur jedes im HTTP-Header "Authorization" eines eingehenden HTTP-Requests übergebenen JSON-Web-Tokens gemäß [JWS] prüfen und bei Ungültigkeit oder bei Signatur durch einen Identity Provider, bei dem der E-Rezept-Fachdienst nicht als Relying Party registriert ist, den HTTP-Request mit dem HTTP-Fehlercode 401 abweisen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_63"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-104259">
   <p><b>A_19390</b></p>
   <p>Der E-Rezept-Fachdienst MUSS die fachliche Rolle eines Nutzers in jedem Operationsaufruf anhand des Attributs "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">professionOID"&nbsp;</span>im übergebenen IDP-Token im HTTP-Header "Authorization" feststellen und für die nachfolgende Rollenprüfung je Operationsaufruf verwenden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-104257">
   <p><b>A_19391</b></p>
   <p>Der E-Rezept-Fachdienst MUSS den Namen eines Nutzers in jedem Operationsaufruf anhand der Attribute&nbsp;"<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">given_name</span>", "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">family_name</span>" und "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">organizationName"</span> im übergebenen IDP-Token im HTTP-Header "Authorization" feststellen und für die Protokollierung des Zugriffs auf personenbezogene medizinische Daten je Operationsaufruf verwenden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-104261">
   <p><b>A_19392</b></p>
   <p>Der E-Rezept-Fachdienst MUSS die Nutzerkennung (10-stelliger Teil der KVNR, Telematik-ID für Leistungserbringerinstitutionen) eines Nutzers in jedem Operationsaufruf anhand des Attributs "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">idNummer"&nbsp;</span>im übergebenen IDP-Token im HTTP-Header "Authorization" feststellen und für die Protokollierung des Zugriffs auf personenbezogene medizinische Daten je Operationsaufruf verwenden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124911">
   <p><b>A_19439-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS die Authentifizierungsstärke des übergebenen IDP-Token anhand des Attributs "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">acr"</span> im übergebenen IDP-Token im HTTP-Header "Authorization" auf dem Authentifizierungsniveau "hoch" feststellen und einen anderen Wert als bzw. ein Authentifizierungsniveau unterhalb von "gematik-ehealth-loa-high" mit dem HTTP-Status-Code 401 ablehnen. <b>&lt;=</b></p>
  </div>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-108432">5.2.3 Verwaltung der Nutzersession</h4>
  <p id="polarion_113">Der Identity Provider übernimmt für den E-Rezept-Fachdienst als Relying Party die Verwaltung von Nutzersessions und stellt dem Client während der Gültigkeit der Nutzersession ACCESS_TOKEN für den Zugriff auf den E-Rezept-Fachdienst aus. Der E-Rezept-Fachdienst prüft diese ACCESS_TOKEN auf Gültigkeit gemäß der Festlegungen in [gemSpec_IDP_FD].</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-108444">
   <p><b>A_19992</b></p>
   <p>Der E-Rezept-Fachdienst MUSS ein während einer konfigurierbaren Dauer vielfach vorgelegtes ACCESS_TOKEN (z.B. mehr als 10 mal innerhalb einer Sekunde) für den Rest der angegebenen Gültigkeitsdauer auf einer Blocklist führen und eingehende HTTP-Requests mit diesem ACCESS_TOKEN mit dem HTTP-Status-Code 429 ablehnen, damit ein Überlastungsangriff (DOS-Attacke) auf den E-Rezept-Fachdienst unterbunden werden kann. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-119769">
   <p><b>A_20158-02</b></p>
   <p>Der E-Rezept-Fachdienst MUSS mindestens einmal täglich das Signatur-Zertifikat des IDP-Dienstes für die Signatur von ACCESS_TOKEN gemäß [gemSpec_PKI#TUC_PKI_018] mit folgenden Parametern auf Gültigkeit prüfen:<br> <br><p style="text-align: left;" class="polarion-rte-caption-paragraph" data-keep-next="true" id="polarion___1">Tabelle <span class="polarion-rte-caption" data-sequence="Tabelle">1</span>: TAB_eRPFD_005 Parameter Prüfung Signaturzertifikat IDP</p>
    <table style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;" class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%">
     <tbody>
      <tr>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Parameter</th>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><br></th>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Zertifikat</td>
       <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Signaturzertifikat des IDP PUK_IDP_SIG (wird im Discovery Document referenziert, siehe [gemSpec_IDP_Dienst#Kapitel 4])&nbsp;</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">PolicyList</td>
       <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">oid_fd_sig</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">intendedKeyUsage</td>
       <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">nonRepudiation</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">intendedExtendedKeyUsage</td>
       <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">(leer)</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">OCSP-Graceperiod</td>
       <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">60 Minuten</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Offline-Modus</td>
       <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">nein</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Prüfmodus</td>
       <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">OCSP</td>
      </tr>
     </tbody>
    </table><br>Das Signaturzertifikat muss anhand der Zertifikatsprüfung für [mathematisch gültig UND zeitlich gültig UND online gültig ] befunden werden und der HTTP-Request andernfalls mit dem HTTP-Status-Code 401 abgelehnt werden, damit sichergestellt wird dass, ausschließlich ACCESS_TOKEN von einem vertrauenswürdigen IDP akzeptiert werden. <b>&lt;=</b></p>
  </div>
  <p id="polarion_145">Das Signaturzertifikat C.FD.SIG des IDP kann über das Discovery Document des IDP unter https://&lt;FQDN des IDP&gt;/auth/realms/idp/.well-known/openid-configuration&nbsp;automatisch&nbsp;bezogen werden. Das Discovery Document ist als [JWT] aufgebaut und stellt im Claim "uri_puk_idp_sig" den Downloadpunkt auf ein JWK bereit. Darin ist das Signaturzertifikat über den key&nbsp;"kid"="puk_idp_sig" zu lokalisieren und liegt im Parameter "x5c" in Base64-DER-Codierung vor.</p>
  <p id="polarion_131"> <span id="polarion-comment:429"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133071">
   <p><b>A_20974-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS mindestens einmal stündlich sein Signaturzertifikat C.FD.OSIG auf Gültigkeit prüfen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_137"> <span id="polarion-comment:430"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133070">
   <p><b>A_20765-02</b></p>
   <p>Der E-Rezept-Fachdienst MUSS sein Signaturzertifikat gemäß [gemSpec_PKI#TUC_PKI_018] mit folgenden Parametern auf Gültigkeit prüfen: <br> <p data-keep-next="true" class="polarion-rte-caption-paragraph" id="polarion___2"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">2</span>: TAB_eRPFD_010 Parameter Prüfung Signaturzertifikat&nbsp; </p> 
    <table id="polarion_wiki macro name=table;params=width=100%" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
     <tbody> 
      <tr> 
       <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Parameter</th> 
       <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></th> 
      </tr> 
      <tr> 
       <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Zertifikat</td> 
       <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Signaturzertifikat des E-Rezept-Fachdienstes C.FD.OSIG</td> 
      </tr> 
      <tr> 
       <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">PolicyList</td> 
       <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">oid_fd_osig</td> 
      </tr> 
      <tr> 
       <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">intendedKeyUsage</td> 
       <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">nonRepudiation</td> 
      </tr> 
      <tr> 
       <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">intendedExtendedKeyUsage</td> 
       <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">(leer)</td> 
      </tr> 
      <tr> 
       <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">OCSP-Graceperiod</td> 
       <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">24 Stunden</td> 
      </tr> 
      <tr> 
       <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Offline-Modus</td> 
       <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">nein</td> 
      </tr> 
      <tr> 
       <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Prüfmodus</td> 
       <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">OCSP</td> 
      </tr> 
     </tbody> 
    </table> Der E-Rezept-Fachdienst MUSS das Signaturzertifikat anhand der Zertifikatsprüfung für [mathematisch gültig UND zeitlich gültig UND online gültig ] befinden und eingehende HTTP-Requests, welche eine Signatur durch den E-Rezept-Fachdienst erfordern, andernfalls mit dem HTTP-Status-Code 503 ablehnen, damit sichergestellt wird, dass Signaturen mit einem gültigen Signaturzertifikat erstellt werden.&nbsp;&nbsp; <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124775">
   <p><b>A_22221</b></p>
   <p>Der Anbieter des E-Rezept-Fachdienstes MUSS das Signaturzertifikat des E-Rezept-Fachdienstes C.FD.OSIG jährlich im Januar erneuern. <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-120942">5.3 Routing von Requests</h3>
  <p id="polarion_147">Die Clients verwenden Http-Header im äußeren Http-Request, um dem E-Rezept-Fachdienst ein internes Routing zu ermöglichen.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118652">
   <p><b>A_21571</b></p>
   <p>Der Eingangspunkt des E-Rezept-Fachdienstes KANN eine Routingentscheidung zu einem Ressourcen-spezifischen Verarbeitungskontext anhand des Headers "X-erp-resource" mit Wertebereich gemäß der Ressourcennamen (bspw. Communication, Task) im äußeren http-Request treffen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118653">
   <p><b>A_21572</b></p>
   <p>Der Eingangspunkt des E-Rezept-Fachdienstes KANN eine Routingentscheidung zu einem nutzergruppenspezifischen Verarbeitungskontext anhand des Headers "X-erp-user" mit Wertebereich [l, v, k, s] im äußeren http-Request treffen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_148">Die Werte sollen von Clients des E-Rezepts wie folgt verwendet werden:</p>
  <ul id="polarion_149"> 
   <li>l (kleines L) - Leistungserbringer&nbsp;</li> 
   <li>v - Versicherte</li> 
   <li>k - Kostenträger (aktuell nicht verwendet, da nicht zugriffsberechtigt)</li> 
   <li>s - Sonstige (aktuell nicht verwendet)</li> 
  </ul>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-103559">5.4 Fehlercodes</h3>
  <p id="polarion_139">Der E-Rezept-Fachdienst stellt eine http-Schnittstelle für den Aufruf durch Clientsysteme bereit. Das Ergebnis der Operation wird in der Verwendung von Http-Status-Codes [HTTP-STATUS-CODES] mitgeteilt. Die folgende Tabelle listet die vom E-Rezept-Fachdienst genutzten Http-Status-Codes auf.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-129970">
   <p><b>A_19514-03</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf einer Operation&nbsp;im Http-Response-Header einen&nbsp;HTTP-Status-Codes gemäß [RFC<span style="font-size: 10pt;line-height: 1.5;">7231]</span> zurückgeben.&nbsp;<p data-keep-next="true" class="polarion-rte-caption-paragraph"></p> <b>&lt;=</b></p>
  </div>
  <p id="polarion_244" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">3</span>:&nbsp;TAB_eRPFD_003 Übersicht HTTP-Statuscodes&nbsp; </p>
  <table id="polarion_wiki macro name=table;params=width=99.87%|uid=245" class="polarion-Document-table" style="width: 99.87%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">HTTP-Status-Code</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 144px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Bedeutung</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 236px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">in welchen Operationen als Statuscode möglich</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 275px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Bedingung</th> 
    </tr> 
    <tr> 
     <td style="width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">200</td> 
     <td style="width: 144px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Operation erfolgreich beendet, in der Rückgabe ist ggfs. das Ergebnis der Operation enthalten</td> 
     <td style="width: 236px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">GET /Task<br> GET /Task/&lt;id&gt;<br> GET /AuditEvent/<br> GET /Communication<br> GET /MedicationDispense<br> POST /Task/&lt;id&gt;/$activate<br> POST /Task/&lt;id&gt;/$accept<br> POST /Task/&lt;id&gt;/$close<br> GET /notifications/opt-in<br> GET /notifications/opt-out<br> GET, etc für alle übrigen Operationen<br> </td> 
     <td style="width: 275px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Die Operation wurde erfolgreich bearbeitet. In der Rückgabe sind die erzeugten bzw. gelesenen Daten enthalten.</td> 
    </tr> 
    <tr> 
     <td style="width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">201</td> 
     <td style="width: 144px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Neues Objekt wurde erfolgreich angelegt, in der Rückgabe ist das Objekt enthalten</td> 
     <td style="width: 236px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">POST /Task/$create<br> POST /Communication</td> 
     <td style="width: 275px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Der E-Rezept-Fachdienst hat die Ressource in der angeforderten Operation erzeugt.</td> 
    </tr> 
    <tr> 
     <td style="width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">204</td> 
     <td style="width: 144px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Die Operation liefert keinen Rückgabewert</td> 
     <td style="width: 236px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">POST /Task/&lt;id&gt;/$abort<br> POST /Task/&lt;id&gt;/$reject<br> DELETE /Communication/&lt;id&gt;</td> 
     <td style="width: 275px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Das Löschen eines E-Rezepts löscht alle personenbezogenen und medizinischen Daten, daher gibt es keine Daten in der Rückgabe der Operation. Das Zurückweisen eines Rezepts bedeutet die Nicht-Bearbeitung durch eine Apotheke, daher sind hier keine Rückgabedaten erforderlich.</td> 
    </tr> 
    <tr> 
     <td style="width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">400</td> 
     <td style="width: 144px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Bad Request, der Operationsaufruf enthält ungültige Daten.</td> 
     <td style="width: 236px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">POST /Task/$create<br> POST /Task/&lt;id&gt;/$activate<br> POST /Task/&lt;id&gt;/$accept<br> POST /Task/&lt;id&gt;/$reject<br> POST /Task/&lt;id&gt;/$close<br> POST /Task/&lt;id&gt;/$abort<br> POST /Communication<br> GET /notifications/opt-in<br> GET, POST, etc für alle übrigen Operationen</td> 
     <td style="width: 275px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">In der aufgerufenen Operation werden vom Client Daten für die Verarbeitung erwartet. Entsprechen sie nicht dem erwarteten FHIR-Profil oder sind sie ungültig (bspw. Signatur), werden sie vom E-Rezept-Fachdienst zurückgewiesen.</td> 
    </tr> 
    <tr> 
     <td style="width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">401</td> 
     <td style="width: 144px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Der Nutzer konnte nicht authentifiziert werden</td> 
     <td style="width: 236px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">GET /Task<br> GET /Task/&lt;id&gt;<br> GET /AuditEvent/<br> GET /Communication<br> GET /MedicationDispense<br> POST /Task/$create<br> POST /Task/&lt;id&gt;/$activate<br> POST /Task/&lt;id&gt;/$accept<br> POST /Task/&lt;id&gt;/$reject<br> POST /Task/&lt;id&gt;/$close<br> POST /Task/&lt;id&gt;/$abort<br> POST /Communication</td> 
     <td style="width: 275px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Der Aufruf enthält keine oder abgelaufene oder ungültige Authentifizierungsinformationen im HTTP-Request-Header "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Authorization</span>"</td> 
    </tr> 
    <tr> 
     <td style="width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">403</td> 
     <td style="width: 144px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Der Nutzer ist nicht berechtigt, die aufgerufene Operation anzufordern</td> 
     <td style="width: 236px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">GET /Task<br> GET /Task/&lt;id&gt;<br> GET /AuditEvent/<br> GET /Communication<br> GET /MedicationDispense<br> POST /Task/$create<br> POST /Task/&lt;id&gt;/$activate<br> POST /Task/&lt;id&gt;/$accept<br> POST /Task/&lt;id&gt;/$reject<br> POST /Task/&lt;id&gt;/$close<br> POST /Task/&lt;id&gt;/$abort<br> POST /Communication</td> 
     <td style="width: 275px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Gemäß Rollenprüfung in jedem Operationsaufruf sind nur bestimmte Operationen je aufrufendem Nutzer zulässig.</td> 
    </tr> 
    <tr> 
     <td style="width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">404</td> 
     <td style="width: 144px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Die adressierte Ressource wurde nicht gefunden.</td> 
     <td style="width: 236px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">GET /Task/&lt;id&gt;<br> POST /Task/&lt;id&gt;/$activate<br> POST /Task/&lt;id&gt;/$accept<br> POST /Task/&lt;id&gt;/$reject<br> POST /Task/&lt;id&gt;/$close<br> POST /Task/&lt;id&gt;/$abort<br> GET /AuditEvent/&lt;id&gt;<br> GET /Communication/&lt;id&gt;<br> GET /MedicationDispense/&lt;id&gt;<br> GET /notifications/opt-out</td> 
     <td style="width: 275px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Die über die &lt;id&gt; adressierte Ressource existiert nicht, d.h. wurde auch nicht zwischenzeitlich gelöscht (siehe Code 410).<br> </td> 
    </tr> 
    <tr> 
     <td style="width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">405</td> 
     <td style="width: 144px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Die Anfrage ist gültig, jedoch in Kombination mit anderen Aufrufparametern nicht gültig</td> 
     <td style="width: 236px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">GET /Task<br> GET /Task/&lt;id&gt;<br> GET /AuditEvent/<br> GET /Communication<br> GET /MedicationDispense<br> POST /Task/$create<br> POST /Task/&lt;id&gt;/$activate<br> POST /Task/&lt;id&gt;/$accept<br> POST /Task/&lt;id&gt;/$reject<br> POST /Task/&lt;id&gt;/$close<br> POST /Task/&lt;id&gt;/$abort<br> POST /Communication</td> 
     <td style="width: 275px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">In der Operation wird eine unzulässige Kombination aus Http-Operation auf eine bestimmte Ressource ggfs. in Verbindung mit einer FHIR-Operation aufgerufen, z.B.<br> POST /AuditEvent<br> POST /Task/$activate<br> POST /Task/&lt;id&gt;/$create<br> PUT /&lt;Ressource&gt;/<br> HEAD /&lt;Ressource&gt;<br> DELETE /&lt;Ressource/&gt;<br> PATCH /&lt;Ressource&gt;</td> 
    </tr> 
    <tr> 
     <td style="width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">408</td> 
     <td style="width: 144px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Request Timeout. Die Anfrage konnte innerhalb der erwarteten Zeit nicht beantwortet werden</td> 
     <td style="width: 236px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">GET /Task<br> GET /Task/&lt;id&gt;<br> GET /AuditEvent/<br> GET /Communication<br> GET /MedicationDispense<br> POST /Task/$create<br> POST /Task/&lt;id&gt;/$activate<br> POST /Task/&lt;id&gt;/$accept<br> POST /Task/&lt;id&gt;/$reject<br> POST /Task/&lt;id&gt;/$close<br> POST /Task/&lt;id&gt;/$abort<br> POST /Communication</td> 
     <td style="width: 275px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Der E-Rezept-Fachdienst ist überlastet und kann die Anfrage innerhalb der Wartezeit des Clients (PVS, AVS, FdV) nicht beantworten</td> 
    </tr> 
    <tr> 
     <td style="width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">409</td> 
     <td style="width: 144px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Konflikt im Aufruf verschiedener Nutzer um das gleiche Objekt</td> 
     <td style="width: 236px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">POST /Task/&lt;id&gt;/$accept<br> POST /Task/&lt;id&gt;/$abort</td> 
     <td style="width: 275px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Der Task des E-Rezepts hat einen Status, für den der gewünschte Zugriff unzulässig ist. Bspw.: Das E-Rezept befindet sich bereits in Belieferung durch einen Apotheker. Daher kann es vom Verordnenden und Versicherten nicht gelöscht werden ($abort) und von keinem anderen Apotheker heruntergeladen werden ($accept).</td> 
    </tr> 
    <tr> 
     <td style="width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">410</td> 
     <td style="width: 144px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Das aufgerufene Objekt wurde zwischenzeitlich gelöscht</td> 
     <td style="width: 236px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">GET /Task/&lt;id&gt;<br> POST /Task/&lt;id&gt;/$accept<br> POST /Task/&lt;id&gt;/$abort</td> 
     <td style="width: 275px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Der Client (PVS, AVS, FdV) versucht ein E-Rezept zu lesen, das zwischenzeitlich gelöscht wurde</td> 
    </tr> 
    <tr> 
     <td style="width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">429</td> 
     <td style="width: 144px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Der Client hat zu viele Aufrufe innerhalb einer festgelegten Zeitspanne getätigt</td> 
     <td style="width: 236px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">GET /Task<br> GET /Task/&lt;id&gt;<br> GET /AuditEvent/<br> GET /Communication<br> GET /MedicationDispense<br> POST /Task/$create<br> POST /Task/&lt;id&gt;/$activate<br> POST /Task/&lt;id&gt;/$accept<br> POST /Task/&lt;id&gt;/$reject<br> POST /Task/&lt;id&gt;/$close<br> POST /Task/&lt;id&gt;/$abort<br> POST /Communication&nbsp;</td> 
     <td style="width: 275px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Der Client (PVS, AVS, FdV) hat innerhalb des konfigurierten Zeitabschnitts zu viele Requests geschickt</td> 
    </tr> 
    <tr> 
     <td style="width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">500</td> 
     <td style="width: 144px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Interner Serverfehler</td> 
     <td style="width: 236px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">GET /Task<br> GET /Task/&lt;id&gt;<br> GET /AuditEvent/<br> GET /Communication<br> GET /MedicationDispense<br> POST /Task/$create<br> POST /Task/&lt;id&gt;/$activate<br> POST /Task/&lt;id&gt;/$accept<br> POST /Task/&lt;id&gt;/$reject<br> POST /Task/&lt;id&gt;/$close<br> POST /Task/&lt;id&gt;/$abort<br> POST /Communication&nbsp;<br> GET, POST, etc für alle übrigen Operationen</td> 
     <td style="width: 275px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">In allen Operationen, die aufgrund eines internen Fehlers nicht bearbeitet werden können. Die Rückgabe liefert keine weiteren Informationen.</td> 
    </tr> 
   </tbody> 
  </table>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124416">
   <p><b>A_22103</b></p>
   <p>Der E-Rezept-Fachdienst MUSS im Fehlerfall (http-Statuscodes &gt;= 400) Hinweise zur Fehlerursache <br> 
    <ul> 
     <li>im der inneren http-Response-Body als&nbsp;FHIR-Ressource OperationOutcome</li> 
     <li>falls keine innere VAU-Response existiert, in einem "äußeren" http-Response-Body in einer JSON-Struktur mit <span style="font-size: 10pt;color: #003366;line-height: 1.5;">"x-request-id", (http-)"status",&nbsp;"error"-Text,&nbsp;"message"-Details</span></li> 
    </ul> an den Client zurückgeben, ohne Implementierungsdetails (z.B. kein Stacktrace) preiszugeben und dabei sicherstellen, dass&nbsp;personenbezogene oder medizinische Daten, falls für die qualifizierte Fehlerbeschreibung notwendig, ausschließlich in der VAU-verschlüsselten inneren http-Response übertragen werden. <b>&lt;=</b></p>
  </div>
  <p id="polarion_184">Die Fehlermeldung beinhaltet bei fachlichen Fehlern einen VAU-verschlüsselten inneren http-Response. In diesem&nbsp;inneren Response werden ggf. ausschliesslich personenbezogene oder medizinische Daten an den aufrufenden Client übermittelt, welche bereits im VAU-verschlüsselten inneren http-Request, welcher zum Fehler führte, enthalten waren. Das kann bspw. bei Fehlern bei der Prüfung der FHIR Konformität von Datensätzen auftreten.</p>
  <p id="polarion_198">Treten Fehler beim VAU-Transport (bspw. innerer http-Request kann nicht entschlüsselt werden) auf, beinhaltet die Fehlermeldung keinen inneren http-Response.</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-103855">5.5 Protokollierung</h3>
  <p id="polarion_105">Der E-Rezept-Fachdienst soll Protokolldateien schreiben, die eine Analyse technischer Vorgänge erlauben. Diese Protokolldateien sind dafür vorgesehen, aufgetretene Fehler zu identifizieren und die Performance zu analysieren. Für diese Zwecke führt der E-Rezept-Fachdienst ein Systemprotokoll, mit dem der Anbieter des Dienstes jederzeit den Betriebszustand des Systems kontrollieren kann.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103853">
   <p><b>A_19282</b></p>
   <p>Der E-Rezept-Fachdienst MUSS ein Systemprotokoll über durchgeführte Operationen und deren Erfolg/Misserfolg führen, um dem Anbieter des Dienstes jederzeit eine Übersicht über den aktuellen Betriebszustand zu ermöglichen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103854">
   <p><b>A_19283</b></p>
   <p>Der E-Rezept-Fachdienst MUSS in jedem zu tätigenden Systemprotokolleintrag alle personenbezogenen, personenbeziehbaren und medizinischen Informationen vor der Speicherung entfernen, damit vom administrativen Personal keine personenbezogenen Daten der Versicherten oder Leistungserbringer eingesehen werden können. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107347">
   <p><b>A_19678</b></p>
   <p>Der Betreiber des E-Rezept-Fachdienstes MUSS im Rahmen von Testmaßnahmen dem Testbetriebsverantwortlichen auf Anforderung die Log-Dateien des Systemprotokolls übermitteln. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-108467">
   <p><b>A_20001</b></p>
   <p>Der E-Rezept-Fachdienst MUSS ein Systemprotokoll über durchgeführte Operationen und deren Erfolg/Misserfolg führen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_75">Der E-Rezept-Fachdienst führt außerdem Zugriffsprotokolle für Versicherte, in denen alle Zugriffe auf die personenbezogenen und medizinischen Daten eines Versicherten für den Versicherten einsehbar sind. Diese Zugriffsprotokolle sind unabhängig vom Systemprotokoll und stehen ausschließlich dem Versicherten zur Wahrnehmung seiner Betroffenenrechte zur Einsicht zur Verfügung.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-132594">
   <p><b>A_19284-03</b></p>
   <p>Der E-Rezept-Fachdienst MUSS jeden Aufruf der folgenden Operationen protokollieren: <br> <p data-keep-next="true" class="polarion-rte-caption-paragraph" style="text-align: left;" id="polarion___3"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">4</span>: TAB_eRPFD_004 Versichertenprotokoll </p> 
    <table id="polarion_wiki macro name=table;params=width=100%" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
     <tbody> 
      <tr> 
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 92px;height: 42px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Operation</th> 
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 206px;height: 42px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Rolle des<br> zugreifenden Nutzers</th> 
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 422px;height: 42px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Beschreibung (ggfs. als Vorschlag für einen lesbaren Protokolleintrag in einfacher Sprache)</th> 
      </tr> 
      <tr> 
       <th colspan="3" rowspan="1" style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 742px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">http GET /Task/&lt;id&gt;</th> 
      </tr> 
      <tr> 
       <td colspan="1" rowspan="2" style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">-</td> 
       <td style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Versicherter,<br> Vertreter</td> 
       <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Patient/Versicherter/Vertreter hat das E-Rezept heruntergeladen</td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Apotheker</td> 
       <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Apotheke hat die E-Rezept-Quittung heruntergeladen</td> 
      </tr> 
      <tr> 
       <td colspan="3" rowspan="1" style="text-align: left;vertical-align: top;width: 742px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">http POST /Task</span></td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">$activate</td> 
       <td style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Arzt-/Zahnarztpraxis/Krankenhaus</td> 
       <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Arzt-/Zahnarztpraxis/Krankenhaus hat das E-Rezept bereitgestellt</td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">$accept</td> 
       <td style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Apotheke</td> 
       <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Apotheke hat das E-Rezept heruntergeladen</td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">$reject</td> 
       <td style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Apotheke</td> 
       <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Apotheke hat das E-Rezept zurückgegeben</td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">$close</td> 
       <td style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Apotheke</td> 
       <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Apotheke hat das E-Rezept beliefert</td> 
      </tr> 
      <tr> 
       <td colspan="1" rowspan="3" style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">$abort</td> 
       <td style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Versicherter,<br> Vertreter</td> 
       <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Patient/Versicherter/Vertreter hat das E-Rezept gelöscht</td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Arzt-/Zahnarztpraxis/Krankenhaus</td> 
       <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Arzt-/Zahnarztpraxis/Krankenhaus&nbsp;hat das E-Rezept gelöscht</td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Apotheke</td> 
       <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Apotheke&nbsp;hat das E-Rezept gelöscht</td> 
      </tr> 
      <tr> 
       <td colspan="3" rowspan="1" style="text-align: left;vertical-align: top;width: 742px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">http GET /MedicationDispense/&lt;id&gt;&nbsp;bzw. Zugriff via Suchparameter GET /MedicationDispense?&lt;parameter&gt;=...</span></td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td> 
       <td style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Versicherter,<br> Vertreter</td> 
       <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Patient/Versicherter hat Medikament-Informationen heruntergeladen</td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">http DELETE /ChargeItem/&lt;id&gt;</span></td> 
       <td style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Versicherter</td> 
       <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Versicherter hat Abrechnungsinformation gelöscht</td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">http GET /ChargeItem/&lt;id&gt;</span></td> 
       <td style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Versicherter</td> 
       <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Versicherter hat Abrechnungsinformation gelesen</td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td> 
       <td style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Apotheke</td> 
       <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Apotheke&nbsp;hat Abrechnungsinformation gelesen</td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">http POST /ChargeItem</span></td> 
       <td style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Apotheke</td> 
       <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Apotheke&nbsp;hat Abrechnungsinformation bereitgestellt</td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">http PATCH /ChargeItem/&lt;id&gt;</span></td> 
       <td style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Versicherter</td> 
       <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Versicherter hat Markierung zu Abrechnungsinformation gespeichert</td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">http PUT /ChargeItem/&lt;id&gt;</span></td> 
       <td style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Apotheke</td> 
       <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Apotheke&nbsp;hat PKV-Abgabedatensatz gespeichert</td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">http POST /Consent</span></td> 
       <td style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Versicherter</td> 
       <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Versicherter hat Einwilligung erteilt</td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">http DELETE /Consent</span></td> 
       <td style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Versicherter</td> 
       <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Versicherter hat Einwilligung widerrufen</td> 
      </tr> 
      <tr> 
       <td colspan="3" rowspan="1" style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Automatisches Löschen durch den Fachdienst</span></td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Ressource Task</td> 
       <td colspan="1" rowspan="4" style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">E-Rezept-Fachdienst</td> 
       <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Veraltete E-Rezepte vom Fachdienst automatisch gelöscht</td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Ressource MedicationDispense</td> 
       <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Veraltete Medikament-Informationen vom Fachdienst automatisch gelöscht</td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Ressource Communication</td> 
       <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Veraltete Nachrichten vom Fachdienst automatisch gelöscht</td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Ressource ChargeItem</td> 
       <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">Veraltete Abrechnungsinformation vom E-Rezept-Fachdienst automatisch gelöscht</span></td> 
      </tr> 
     </tbody> 
    </table> <br> und die gelesene bzw. geschriebene Ressource im Protokolleintrag <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AuditEvent.entity.what</span> als Referenz hinzufügen sowie die KVNR des betroffenen Versicherten in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AuditEvent.entity.name</span> speichern.<br> Mit diesen Informationen kann der Versicherte die Zugriffe auf seine Daten nachvollziehen und bei einem unberechtigten Zugriff ggfs. intervenieren. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103879">
   <p><b>A_19302</b></p>
   <p>Der E-Rezept-Fachdienst MUSS in jedem zu tätigenden Eintrag des Protokolls für Versicherte einen lesbaren Text in einfacher Sprache (deutsch und englisch) erzeugen, der mindestens den Namen des Zugreifenden, die auslösende Operation und das Ergebnis der Operation umfasst, damit Versicherte ohne technisches Vorwissen den Inhalt des Zugriffsprotokolls verstehen können. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124704">
   <p><b>A_22217</b></p>
   <p>Der E-Rezept-Fachdienst MUSS, wenn im ACCESS_TOKEN die Angabe zur "organizationName" mit NULL gefüllt ist, in der Protokollierung als agentname "unbekannt" verwenden. <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-103560">5.6 Löschfristen</h3>
  <p id="polarion_48">Der E-Rezept-Fachdienst soll eine Datensparsamkeit realisieren. Dafür werden nicht mehr benötigte Ressourcen, abgelaufene E-Rezepte und veraltete Kommunikationsnachrichten automatisch nach einer festen Frist gelöscht.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103561">
   <p><b>A_19252</b></p>
   <p>Der E-Rezept-Fachdienst MUSS einen Task nach Ablauf der Löschfrist gemäß der folgenden Festlegung in TAB_eRPFD_007 automatisch löschen und das Löschen in einem AuditEvent für den Versicherten nachvollziehbar protokollieren, damit nicht mehr benötigte Informationen gelöscht sind.<br> <p data-keep-next="true" class="polarion-rte-caption-paragraph" style="text-align: left;" id="polarion___4"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">5</span>: TAB_eRPFD_007 Löschfristen </p> 
    <table id="polarion_wiki macro name=table;params=width=100%|uid=client1" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
     <tbody> 
      <tr> 
       <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 220px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Task.status nach Statuswechsel</th> 
       <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 511px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Löschfrist</th> 
      </tr> 
      <tr> 
       <td style="width: 220px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">draft</td> 
       <td style="width: 511px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">1 Tage nach Statuswechsel</td> 
      </tr> 
      <tr> 
       <td style="width: 220px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ready</td> 
       <td style="width: 511px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">10 Tage nach&nbsp;Datum in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.expiryDate</span></td> 
      </tr> 
      <tr> 
       <td style="width: 220px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">in-progress</td> 
       <td style="width: 511px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">100 Tage nach Statuswechsel</td> 
      </tr> 
      <tr> 
       <td style="width: 220px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">completed</td> 
       <td style="width: 511px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">100 Tage nach Statuswechsel</td> 
      </tr> 
      <tr> 
       <td style="width: 220px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">cancelled</td> 
       <td style="width: 511px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">10 Tage nach Statuswechsel</td> 
      </tr> 
     </tbody> 
    </table> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103562">
   <p><b>A_19254</b></p>
   <p>Der E-Rezept-Fachdienst MUSS bei jedem Löschen eines Tasks alle referenzierten Bundles (QES-Datensatz, Quittungs-Bundle) ebenfalls löschen, damit die Informationen rund um ein gelöschtes E-Rezept ebenfalls entfernt werden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103563">
   <p><b>A_19255</b></p>
   <p>Der E-Rezept-Fachdienst MUSS&nbsp;eine gespeicherte Ressource MedicationDispense nach 100 Tagen ab ihrem Erzeugungsdatum&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">MedicationDispense.whenHandedOver</span> automatisch löschen, damit Informationen zu veralteten und gelöschten Rezepten ebenfalls entfernt werden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124486">
   <p><b>A_22109</b></p>
   <p>Der E-Rezept-Fachdienst MUSS ein ChargeItem innerhalb eines Monats nach Ablauf von 10 Jahren nach dem Erstellen der Ressource&nbsp; automatisch löschen und das Löschen in einem AuditEvent für den Versicherten nachvollziehbar protokollieren, damit nicht mehr benötigte Informationen gelöscht sind.<br>Der E-Rezept-Fachdienst MUSS bei jedem Löschen eines ChargeItems alle referenzierten Bundles (E-Rezept-Bundle, Quittungs-Bundle, PKV-Abgabedatensatz) ebenfalls löschen, damit die Informationen rund um ein gelöschtes ChargeItem ebenfalls entfernt werden. <b>&lt;=</b></p>
  </div>
  <p id="polarion_76"> <span id="polarion-comment:425"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-132661">
   <p><b>A_19253-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS eine gespeicherte Ressource Communication <br> 
    <ul>
     <li>ohne eine Referenz auf einen Task in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Communication.basedOn</span> nach 100 Tagen ab ihrem Sendedatum <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Communication.sent</span> ,</li>
     <li>mit einer Referenz auf einen Task in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Communication.basedOn</span> gemäß der Löschfrist in TAB_eRPFD_007 beim Löschen des Tasks ,</li>
     <li>mit einer Referenz auf einen ChargeItem in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Communication.basedOn</span>&nbsp;nach 100 Tagen ab ihrem Sendedatum <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Communication.sent</span></li>
    </ul>automatisch löschen, damit nicht mehr relevante Nachrichten&nbsp;ebenfalls gelöscht werden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116823">
   <p><b>A_19256-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS eine gespeicherte Ressource AuditEvent nach 3 Jahren ab dem Erzeugungsdatum <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AuditEvent.recorded</span>&nbsp;innerhalb von einem Monat löschen, damit veraltete Einträge nach Ende der regulären Aufbewahrungsfrist entfernt werden. <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-126181">5.7 Berechtigungen und Prozessparameter</h3>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116185">
   <p><b>A_21267</b></p>
   <p>Der E-Rezept-Fachdienst MUSS die folgenden Zugriffserlaubnisse in Abhängigkeit der Rolle bzw. KVNR/TelematikID des zugreifenden Nutzers, des Task.status, Task.flowType und Kenntnis um AccessCode bzw. Secret gewähren und andernfalls jeden Zugriff mit dem http-Status 403 als unautorisiert abweisen. <p style="text-align: left;" class="polarion-rte-caption-paragraph" data-keep-next="true" id="polarion___5">Tabelle <span class="polarion-rte-caption" data-sequence="Tabelle">6</span>: Zugriffserlaubnisse&nbsp;</p>
    <table style="width: 101.86%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;" class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=101.86%|uid=client1">
     <tbody>
      <tr>
       <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 69px;height: 61px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="2" colspan="1"><span style="font-weight: bold;">Operation</span></th>
       <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 202px;height: 61px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="2" colspan="1"><span style="font-weight: bold;">Rolle des<br> zugreifenden Nutzers</span></th>
       <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 463px;height: 27px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Bedingung (Task.status, Task.flowType, AccesCode bzw. Secret)</span></th>
      </tr>
      <tr>
       <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 463px;height: 23px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">ggfs. Beschränkung der ausgegebenen Daten</span></th>
      </tr>
      <tr>
       <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 756px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="1" colspan="3"><span style="font-weight: bold;">http GET /Task bzw.&nbsp;http GET /Task/&lt;id&gt;</span></th>
      </tr>
      <tr>
       <td style="width: 69px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="6" colspan="1"></td>
       <td style="width: 202px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="2" colspan="1">oid_versicherter<br> (Task.for = KVNR in AccessToken)<br></td>
       <td style="width: 463px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">keine sonstigen Bedingungen&nbsp;</td>
      </tr>
      <tr>
       <td style="width: 463px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Flowtype 160: alle Daten werden zurückgegeben&nbsp;<br> Flowtype 169: AccessCode wird in Task.identifier <span style="text-decoration: underline;">nicht</span> herausgegeben</td>
      </tr>
      <tr>
       <td style="width: 202px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="2" colspan="1">oid_versicherter<br> (Task.for != KVNR in AccessToken)</td>
       <td style="width: 463px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Flowtype 160: AccessCode in URL-Parameter "ac" oder http-Header "X-AccessCode" muss mit Task.identifier für AccessCode übereinstimmen<br> Flowtype 169: Versicherte kennen den AccessCode nicht</td>
      </tr>
      <tr>
       <td style="width: 463px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Flowtype 160: alle Daten werden zurückgegeben&nbsp;<br> Flowtype 169: Task.for != KVNR in AccessToken werden keine Daten zurückgegeben, da AccessCode nicht prüfbar</td>
      </tr>
      <tr>
       <td style="width: 202px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="2" colspan="1">oid_oeffentliche_apotheke,<br> oid_krankenhausapotheke</td>
       <td style="width: 463px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Secret in URL-Parameter "secret" muss mit Task.identifier für Secret übereinstimmen, Task.status = completed</td>
      </tr>
      <tr>
       <td style="width: 463px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">alle Daten des direkt adressierten Tasks werden zurückgegeben</td>
      </tr>
      <tr>
       <td style="width: 756px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="1" colspan="3"><span style="font-weight: bold;">http POST /Task</span></td>
      </tr>
      <tr>
       <td style="width: 69px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="2" colspan="1">$create</td>
       <td style="width: 202px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="2" colspan="1">oid_praxis_arzt<br> oid_zahnarztpraxis<br> oid_praxis_psychotherapeut<br> oid_krankenhaus</td>
       <td style="width: 463px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">keine sonstigen Bedingungen</td>
      </tr>
      <tr>
       <td style="width: 463px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Flowtype 160: Rezept-ID wird generiert mit 160-beginnend<br> Flowtype 169:&nbsp;Rezept-ID wird generiert mit 169-beginnend</td>
      </tr>
      <tr>
       <td style="width: 69px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">$activate</td>
       <td style="width: 202px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">oid_praxis_arzt<br> oid_zahnarztpraxis<br> oid_praxis_psychotherapeut<br> oid_krankenhaus<br></td>
       <td style="width: 463px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Präfix 16x der PrescriptionID im Identifier des Verordnungsdatensatzes muss mit Flowtype des Task übereinstimmen<br> QES des Verordnungsdatensatzes muss von Leistungserbringer mit einer der Rollen erstellt sein:&nbsp;oid_arzt,&nbsp; oid_zahnarzt</td>
      </tr>
      <tr>
       <td style="width: 69px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="2" colspan="1">$accept</td>
       <td style="width: 202px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="2" colspan="1">oid_oeffentliche_apotheke,<br> oid_krankenhausapotheke&nbsp;</td>
       <td style="width: 463px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">AccessCode in URL-Parameter "ac" oder http-Header "X-AccessCode" muss mit Task.identifier für AccessCode übereinstimmen</td>
      </tr>
      <tr>
       <td style="width: 463px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Secret als zusätzlichen Task.identifier generieren&nbsp;</td>
      </tr>
      <tr>
       <td style="width: 69px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="2" colspan="1">$reject</td>
       <td style="width: 202px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="2" colspan="1">oid_oeffentliche_apotheke,<br> oid_krankenhausapotheke&nbsp;</td>
       <td style="width: 463px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Secret in URL-Parameter "secret" muss mit Task.identifier für Secret übereinstimmen</td>
      </tr>
      <tr>
       <td style="width: 463px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Secret als zusätzlicher Task.identifier muss gelöscht werden</td>
      </tr>
      <tr>
       <td style="width: 69px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">$close</td>
       <td style="width: 202px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">oid_oeffentliche_apotheke,<br> oid_krankenhausapotheke&nbsp;</td>
       <td style="width: 463px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Secret in URL-Parameter "secret" muss mit Task.identifier für Secret übereinstimmen</td>
      </tr>
      <tr>
       <td style="width: 69px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="4" colspan="1">$abort</td>
       <td style="width: 202px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">oid_versicherter<br> (Task.for = KVNR in AccessToken)&nbsp;</td>
       <td style="width: 463px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Flowtype 160: Task.status ungleich "in-progress"<br> Flowtype 169: nicht zulässig, wenn&nbsp;Task.status ungleich "completed"</td>
      </tr>
      <tr>
       <td style="width: 202px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">oid_versicherter<br> (Task.for != KVNR in AccessToken)</td>
       <td style="width: 463px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Flowtype 160: AccessCode in URL-Parameter "ac" oder http-Header "X- AccessCode" muss mit Task.identifier für AccessCode übereinstimmen<br> Flowtype 169: nicht zulässig, Versicherte dürfen diese Operation nicht aufrufen</td>
      </tr>
      <tr>
       <td style="width: 202px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">oid_praxis_arzt<br> oid_zahnarztpraxis<br> oid_praxis_psychotherapeut<br> oid_krankenhaus<br></td>
       <td style="width: 463px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">AccessCode in URL-Parameter "ac" oder http-Header "X-AccessCode" muss mit Task.identifier für AccessCode übereinstimmen<br> Task.status ungleich "in-progress"</td>
      </tr>
      <tr>
       <td style="width: 202px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">oid_oeffentliche_apotheke,<br> oid_krankenhausapotheke&nbsp;&nbsp;</td>
       <td style="width: 463px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Secret in URL-Parameter "secret" muss mit Task.identifier für Secret übereinstimmen</td>
      </tr>
      <tr>
       <td style="width: 756px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="1" colspan="3"><span style="font-weight: bold;">http GET /MedicationDispense&nbsp;</span></td>
      </tr>
      <tr>
       <td style="width: 69px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="2" colspan="1"></td>
       <td style="width: 202px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="2" colspan="1">oid_versicherter&nbsp;</td>
       <td style="width: 463px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">(MedicationDispense.identifier = KVNR in AccessToken)&nbsp;</td>
      </tr>
      <tr>
       <td style="width: 463px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">alle Daten werden zurückgegeben</td>
      </tr>
      <tr>
       <td style="width: 756px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="1" colspan="3"><span style="font-weight: bold;">http GET /Bundle/&lt;id&gt;&nbsp;</span></td>
      </tr>
      <tr>
       <td style="width: 69px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td>
       <td style="width: 202px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td>
       <td style="width: 463px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td>
      </tr>
      <tr>
       <td style="width: 69px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td>
       <td style="width: 202px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td>
       <td style="width: 463px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td>
      </tr>
      <tr>
       <td style="width: 756px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="1" colspan="3"><span style="font-weight: bold;">/Communication</span></td>
      </tr>
      <tr>
       <td style="width: 69px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="2" colspan="1">http GET</td>
       <td style="width: 202px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="2" colspan="1">oid_versicherter&nbsp;<br> oid_oeffentliche_apotheke,<br> oid_krankenhausapotheke</td>
       <td style="width: 463px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">&nbsp;keine besonderen Zugriffsbedingungen</td>
      </tr>
      <tr>
       <td style="width: 463px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Filterung auf Communication.recipient =&nbsp;KVNR/TelematikID aus AccessToken</td>
      </tr>
      <tr>
       <td style="width: 756px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="1" colspan="3"><span style="font-weight: bold;">/Communication</span></td>
      </tr>
      <tr>
       <td style="width: 69px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="2" colspan="1">http POST</td>
       <td style="width: 202px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="2" colspan="1">oid_versicherter&nbsp;<br> oid_oeffentliche_apotheke,<br> oid_krankenhausapotheke</td>
       <td style="width: 463px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">keine besonderen Zugriffsbedingungen</td>
      </tr>
      <tr>
       <td style="width: 463px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">KVNR/TelematikID aus AccessToken wird in Communication.sender übernommen</td>
      </tr>
      <tr>
       <td style="width: 756px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="1" colspan="3"><span style="font-weight: bold;">/AuditEvent</span></td>
      </tr>
      <tr>
       <td style="width: 69px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="2" colspan="1">http GET</td>
       <td style="width: 202px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="2" colspan="1">oid_versicherter&nbsp;</td>
       <td style="width: 463px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">keine besonderen Zugriffsbedingungen</td>
      </tr>
      <tr>
       <td style="width: 463px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Filterung auf AuditEvent.entity.name =&nbsp;KVNR aus AccessToken</td>
      </tr>
     </tbody>
    </table> <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-103566">5.8 Sicherheit</h3>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-108492">5.8.1 Allgemeine Sicherheitsanforderungen</h4>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103700">
   <p><b>A_19260</b></p>
   <p>Der E-Rezept-Fachdienst MUSS <span style="font-size: 10pt;line-height: 1.5;">an der Schnittstelle zum Internet die Produktidentifikation (Produktbezeichnung, Produktversion) des Clients</span> erkennen und <span style="font-size: 10pt;line-height: 1.5;">nicht zugelassene Produkte oder bestimmte Produktversionen von der Kommunikation mit dem E-Rezept-Fachdienst ausschließen zu können.</span> Der E-Rezept-Fachdienst MUSS in diesen Fällen eine entsprechende Fehlermeldung mit dem http-StatusCode 403&nbsp;<span style="font-size: 10pt;line-height: 1.5;">an den aufrufenden Client</span> geben. <b>&lt;=</b></p>
  </div>
  <p id="polarion_179"> <span style="font-size: 10pt;line-height: 1.5;"> </span> </p>
  <p id="polarion_107" class="MsoNormal"> <span style="font-size: 10pt;line-height: 1.5;">Hinweis: Der Ausschluss soll über ein Whitelisting gültiger Produktidentifikationen erfolgen.</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-126157">
   <p><b>A_19261-01</b></p>
   <p>Der Anbieter des E-Rezept-Fachdienstes MUSS ausschließlich auf Anweisung der gematik Clients&nbsp;<span style="font-size: 10pt;line-height: 1.5;">mit einer bestimmten Produktidentifikation</span> für die Kommunikation mit dem E-Rezept-Fachdienst zulassen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103706">
   <p><b>A_19266</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS Maßnahmen zum Schutz vor den OWASP-Top-10-Risiken in der aktuellen Version umsetzen.</span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_51">Der E-Rezept-Fachdienst soll sich vor Anfragen, die nicht auf ein übliches Verhalten von Leistungserbringerinstitutionen und Versicherten während des Verordnungsprozesses schließen lassen, schützen. Diesen Anomalien wird mit einer Drosselung der Bearbeitungsgeschwindigkeit begegnet, um bspw. Brute-Force-Attacken auf das Erraten von AccessCodes für den Zugriff auf E-Rezept-Daten unattraktiv zu machen.&nbsp;</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111918">
   <p><b>A_20703</b></p>
   <p>Der E-Rezept-Fachdienst MUSS jede Antwort auf einen Funktionsaufruf, der einen AccessCode oder Secret enthält<br>um den konfigurierbaren http-Response-Header "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Warning</span>" (default "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">999 Throttling active</span>") ergänzt&nbsp;und um ein konfigurierbares Zeitintervall (default: 500 Millisekunden) verzögert zurückschicken, sofern der erwartete AccessCode bzw Secret nicht mit dem übergebenen AccessCode bzw. Secret übereinstimmt, um BruteForce-Angriffe durch einen hohen Zeitaufwand unattraktiv zu machen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111919">
   <p><b>A_20704</b></p>
   <p>Der E-Rezept-Fachdienst MUSS jede Antwort auf den Funktionsaufruf zum Aktivieren eines Tasks mittels Übergabe des QES-signierten Datensatzes&nbsp;um den konfigurierbaren http-Response-Header "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Warning</span>" (default "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">999 Throttling active</span>") ergänzt&nbsp;und um ein konfigurierbares Zeitintervall (default: 500 Millisekunden) verzögert zurückschicken, sofern die QES in der Prüfung während der Operation POST /Task/&lt;id&gt;/$activate als ungültig erkannt wird, um Angriffe durch Rezeptfälschungen durch einen hohen Zeitaufwand unattraktiv zu machen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111920">
   <p><b>A_20705</b></p>
   <p>Der Anbieter des E-Rezept-Fachdienstes MUSS die Funktion der Drosselung sowie die Konfiguration auf Weisung der gematik aktivieren oder deaktivieren bzw. die Konfigurationsparameter anpassen, um die Wirksamkeit des Mechanismus im Feld bei Bedarf zu verbessern. <b>&lt;=</b></p>
  </div>
  <p id="polarion_124">Die gematik stellt mit der Prüfkarte eGK eine elektronische Identität zur Überprüfung verschiedener Anwendungsfälle in der TI und wird vorrangig von Dienstleistern vor Ort (DVOs) genutzt. Die Prüfkarte eGK ist nicht für die Nutzung im regulären Versorgungsalltag von Leistungserbringern oder Versicherten vorgesehen. Die folgenden Anforderungen verhindern eine Vermischung von Prüfaktivitäten mittels der Prüfkarte eGK und den Anwendungsfällen von Versicherten einer Krankenkasse.&nbsp;</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-112185">
   <p><b>A_20751</b></p>
   <p>Der E-Rezept-Fachdienst MUSS eine eGK-Prüfkartenidentität anhand der Bildungsregel in&nbsp;Card-G2-A_3820 (X0000<span style="font-style: italic;">nnnn</span>P, mit <span style="font-style: italic;">nnnn</span> aus der Menge {0001 .. 5000} und P = Prüfziffer) für die KVNR der Prüfkarte eGK erkennen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-112187">
   <p><b>A_20752</b></p>
   <p>Der E-Rezept-Fachdienst MUSS das Einstellen einer Communication-Ressource mit dem http-Status-Code 400 ablehnen wenn diese in den Absender-und Empfänger-Informationen eine Kombination von KVNR der Prüfkarte eGK und KVNR von Versicherten enthält. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-112186">
   <p><b>A_20753</b></p>
   <p>Der E-Rezept-Fachdienst MUSS jeden Zugriff auf E-Rezepte mittels AccessCode (Vertreterzugriff) mit dem http-Status-Code 400 ablehnen, wenn sich aus dem Zugriff eine Kombination aus&nbsp;KVNR der Prüfkarte eGK und KVNR von Versicherten ergibt, d.h. Versicherte dürfen nicht auf Prüfrezepte und mit Prüfkarte eGK darf nicht auf Rezepte von Versicherten zugegriffen werden. <b>&lt;=</b></p>
  </div>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-108491">5.8.2 Identifikation des Clientsystems</h4>
  <p id="polarion_34">Der E-Rezept-Fachdienst verwaltet und steuert den Einlöseprozess für elektronische Verordnungen. Damit kommt ihm eine Relevanz in der Medikamentenversorgung zu, die sich zum einen in einer hohen Verfügbarkeit und zum anderen in einem hohen Angriffspotential widerspiegelt. Zur Unterstützung der betrieblichen Überwachung des E-Rezept-Fachdienstes wird die Nutzung der im Feld befindlichen Clientsysteme protokolliert. Dabei ist der Zugriff auf die Schnittstellen des E-Rezept-Fachdienstes nur durch Primärsysteme der Leistungserbringer und zugelassene E-Rezept-FdVs zulässig. Der E-Rezept-Fachdienst erkennt die Clientsysteme anhand des User-Agent-Header eingehender HTTP-Requests und protokolliert diesen Wert.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-115853">
   <p><b>A_20013-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS das vom aufrufenden Nutzer verwendete Clientsystem anhand des im HTTP-Request enthaltenen Header-Feld "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">User-Agent</span>" gemäß [RFC7231] erkennen und in den Einträgen zur Performance-Rohdatenerfassung gemäß [gemSpec_Perf] protokollieren. Der E-Rezept-Fachdienst MUSS bei fehlendem <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">User-Agent</span>-Header den Request mit dem HTTP-Status-Code 403 beantworten, damit in der Betriebsüberwachung des E-Rezept-Fachdienstes die Nutzung unzulässiger Frontends erkannt werden kann. <b>&lt;=</b></p>
  </div>
  <p id="polarion_110"></p>
  <p id="polarion_128">Beim Verbindungsaufbau zwischen Client und E-Rezept-Fachdienst an Schnittstellen zum Internet wird ein API-KEY übermittelt, welcher durch den E-Rezept-Fachdienst an der Web-Schnittstelle auf Zulässigkeit geprüft wird.</p>
  <p id="polarion_114"> API-KEYs werden durch die gematik in ihrer Rolle als Gesamtverantwortlicher der TI<span style="font-size: 10pt;line-height: 1.5;">&nbsp;</span>erzeugt. Sie sind Zufallswerte mit hoher Entropie und produkt-spezifisch. Die Zulässigkeit von API-KEYs wird von der gematik über organisatorische Prozesse dem Betreiber des E-Rezept-Fachdienstes und den Herstellern von Clientsystemen mitgeteilt. Die Übermittlung muss&nbsp; vertraulichkeits- und integritätsgeschützt erfolgen. Die gematik muss bei der Übergabe des&nbsp;API-KEY sicherstellen, dass nur ein berechtigter&nbsp;Client-Hersteller einen für ihn erzeugten&nbsp;API-KEY erhält. </p>
  <p id="polarion_118"> <span style="font-size: 10pt;line-height: 1.5;">Die Veranlassung zur Sperrung eines API-KEYs erfolgt durch die gematik</span>,&nbsp;bspw. wenn der Verdacht besteht, dass der API-KEY kompromittiert wurde (bspw. missbräuchliche Nutzung des API-KEYs durch Dritte). Hinweis: Betriebliche Sperrprozesse werden über user-agent gesteuert, da ggf der API-KEY Mechanismus gegen einen alternativen Mechanismus getauscht wird, welcher zusätzlich die Authentizität des Clients absichert. </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118594">
   <p><b>A_21551</b></p>
   <p>Der Anbieter des E-Rezept-Fachdienstes MUSS organisatorische Prozesse mit der gematik zur Verwaltung von API-KEYs für die Schnittstellen des E-Rezept-Fachdienstes zum Internet&nbsp;unterstützen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_125">Mittels dieser Prozesse werden zulässige API-KEYs übermittelt und API-KEYs als ungültig erklärt.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118592">
   <p><b>A_21552</b></p>
   <p>Der E-Rezept-Fachdienst MUSS jeden Zugriff über eine Schnittstelle im Internet&nbsp; mittels dem HTTP-Header "<span style="font-size: 10pt;line-height: 1.5;">X-api-key" gegen die Liste zulässiger API-KEYs prüfen</span>. Anfragen ohne HTTP-Header "<span style="font-size: 10pt;line-height: 1.5;">X-api-key" oder einem nicht gültigen&nbsp;API-KEY MÜSSEN als nicht authentisiert (HTTP-Statuscode</span> 401) abgelehnt werden. <b>&lt;=</b></p>
  </div>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-108507">5.8.3 Vertrauensraum der TI</h4>
  <p id="polarion_121"></p>
  <p id="polarion_35">Der E-Rezept-Fachdienst muss das E-Rezept-Frontend des Versicherten (E-Rezept-FdV)&nbsp;bei den Aufgaben unterstützen, regelmäßig die TSL-Aktualisierung vorzunehmen [gemSpec_eRp_FdV#A_20028] und Sperrinformationen für Zertifikate zu ermitteln [gemSpec_eRp_FdV#A_20032]. Die OCSP-Responder und der TSL-Dienst haben deutlich höhere SLAs in Bezug auf die Verfügbarkeit innerhalb der TI. Manche OCSP-Responder besitzen keine direkte Anbindung an das Internet (Komponenten-PKI, Kontext: Prüfung Identität vertrauenswürdige Ausführungsumgebung). Es wird damit auch möglich, bessere Aussagen über die Verfügbarkeit von E-Rezept-Anwendungsfällen zu treffen, weil weniger nicht-SLA-belegte Datenverbindungen für die&nbsp;Anwendungsfälle notwendig sind. (Wenn eine funktionierende Datenverbindung zwischen E-Rezept-FdV&nbsp;und E-Rezept-Fachdienst besteht, dann kann eine in [gemSpec_Perf] definierte Verfügbarkeit garantiert werden.) Aufgrund der Verwendung der Schnittstellen-Funktionalität über die schon etablierte TLS-Verbindung sind OCSP-Requests des E-Rezept-FdV nicht im Klartext im Internet sichtbar.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-108508">
   <p><b>A_20023</b></p>
   <p>Der E-Rezept-Fachdienst MUSS folgende Vorgaben umsetzen:<br> 
    <ol>
     <li>Er MUSS mindestens einmal täglich aus der TI (TI-interne Verbindung) die&nbsp;"TSL(ECC-RSA)" und deren zugehörigen Hashwert aus der TI herunterladen.</li>
     <li>Er MUSS unter dem Pfadnamen "/TSL.xml" über das vom E-Rezept-FdV&nbsp;genutzte HTTPS-Interface die "TSL(ECC-RSA)" der TI zur Verfügung stellen (HTTP-GET, HTTP Content-Type: text/xml).</li>
     <li>Er MUSS unter dem Pfadnamen "/TSL.sha2" über das vom E-Rezept-FdV genutzte HTTPS-Interface den vom TSL-Dienst heruntergeladenen SHA-256 Hashwert der Datei TSL.xml aus Spiegelstrich 2 zur&nbsp;Verfügung stellen (HTTP Content-Type:&nbsp;text/plain, Hashwert als hexdump kodiert (64 Byte + Newline))</li>
    </ol> <b>&lt;=</b></p>
  </div>
  <p id="polarion_111">Hinweise:</p>
  <ol id="polarion_122"> 
   <li>"TI-interne Verbindung" hat den Hintergrund, dass dort über SLAs eine ausreichende Verfügbarkeit gewährleistet ist.</li> 
   <li>Hashwert der TSL.xml bedeutet der Hashwert der Datei TSL.xml, so wie sie vom TSL-Dienst der TI bereitgestellt wird und als wenn man die Datei als Binärdatei interpretiert (vgl. [gemSpec_TSL]).</li> 
  </ol>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-114445">
   <p><b>A_20024-01</b></p>
   <p>Der&nbsp;E-Rezept-Fachdienst MUSS folgende Vorgaben umsetzen:<br> 
    <ol>
     <li>Er MUSS unter der Adresse &lt;FQDN&gt;/ocspf eine Möglichkeit zur Statusabfrage über das vom E-Rezept-FdV&nbsp;genutzte HTTPS-Interface zur Verfügung stellen (HTTP-POST, vgl. auch [RFC-6960, Appendix [gemSpec_PKI]).&nbsp;</li>
     <li>Er MUSS über die Schnittstelle aus Spiegelstrich 1 OCSP-Requests [RFC-6960] entgegen nehmen.</li>
     <li>Aus einem solchen OCSP-Request MUSS er aus dem issuerKeyHash&nbsp;[RFC-6960] die URL des entsprechenden OCSP-Responders in der TI ermitteln (Datengrundlage ist die TSL der TI) und den OCSP-Request an diese ermittelte URL weiterleiten.</li>
     <li>Er MUSS die erhaltenen OCSP-Response an das die OCSP-Anfrage stellende&nbsp;E-Rezept-FdV unverändert weiterreichen.</li>
    </ol> <b>&lt;=</b></p>
  </div>
  <p id="polarion_123">Auf Anfrage stellt die gematik eine Beispielimplementierung für A_20024 Spiegelstrich 3 bereit.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-108509">
   <p><b>A_20025</b></p>
   <p>Der&nbsp;E-Rezept-Fachdienst KANN OCSP-Antworten aus A_20024 bis zu 4 Stunden cachen und bei einer entsprechend passenden OCSP-Anfrage, anstatt neu den OCSP-Responder anzufragen, die im Cache befindliche OCSP-Antwort ausliefern. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-108510">
   <p><b>A_20026</b></p>
   <p>Der&nbsp;E-Rezept-Fachdienst MUSS an der HTTPS-Schnittstelle zum Internet OCSP-Stapling [RFC-6066] unterstützen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_62">&nbsp;Als Alternative zur TSL-Verarbeitung stellt der E-Rezept-Fachdienst eine kurze Zertifikatskette in einer JSON-Struktur bereit, die sich in Plattformen mobiler Betriebssysteme leichter verarbeiten lässt. Diese Zertifikatskette muss regelmäßig aktualisiert und über einen Downloadpunkt für Primärsysteme und das E-Rezept-FdV zur Verfügung gestellt werden. Die normativen Festlegungen finden sich in der Spezifikation [gemSpec_Krypt] in Abschnitt 7.2.2 "Client-seitige Prüfung der E-Rezept-VAU-Identität".</p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-107346">5.8.4 Sicherheit der Netzübergänge</h4>
  <p id="polarion_31">Der E-Rezept-Fachdienst wird für Versicherte über das Internet erreichbar gemacht und für Leistungserbringer über das Netz der TI. Die folgenden Anforderungen beschreiben die für diese Netzübergänge erforderlichen Sicherheitsmechanismen. Für den Netzübergang aus dem Internet als Transportnetz zum E-Rezept-Fachdienst ist ein Paketfilter erforderlich.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107525">
   <p><b>A_19813</b></p>
   <p>Der E-Rezept-Fachdienst MUSS zum Transportnetz Internet durch einen Paketfilter (ACL) gesichert werden, welcher ausschließlich die erforderlichen Protokolle weiterleitet. Der Paketfilter des E-Rezept-Fachdienstes MUSS frei konfigurierbar sein auf der Grundlage von Informationen aus OSI-Layer 3 und 4, das heißt Quell- und Zieladresse, IP-Protokoll sowie Quell- und Zielport. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107526">
   <p><b>A_19814</b></p>
   <p>Der Paketfilter des E-Rezept-Fachdienstes, zum Schutz in Richtung Transportnetz Internet, DARF NICHT physisch auf Systemen der VAU des E-Rezept-Fachdienstes oder dem vorgeschalteten TLS-terminierenden Load Balancer implementiert werden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107527">
   <p><b>A_19815</b></p>
   <p>Der Paketfilter des E-Rezept-Fachdienstes MUSS die Weiterleitung von IP-Paketen an der Schnittstelle zum Internet auf die nachfolgenden Protokolle beschränken:<br> 
    <ol>
     <li>HTTPS, und</li>
     <li>OCSP-Zugriffe für das OCSP-Stapling nach A_20026 (vgl. Hinweis nach A_19815),&nbsp;ggf. notwendige DNS Anfragen (und Antworten)<br></li>
    </ol>Ein Verbindungsaufbau aus dem E-Rezept-Fachdienst in Richtung Internet MUSS unterbunden werden, mit Ausnahme der Verbindungen aus Punkt 2 . <b>&lt;=</b></p>
  </div>
  <p id="polarion_71"> <span style="font-size: 10pt;line-height: 1.5;">Hinweis zu A_19815: </span> </p>
  <p id="polarion_115"> <span style="font-size: 10pt;line-height: 1.5;">Der Anbieter des E-Rezept-Fachdienstes muss für seine HTTPS-Schnittstelle ein TLS-Zertifikat von einem durch das CAB-Forum zulässigen TSP erwerben (dessen CA-Zertifikat also über einen aktuellen Webbrowser prüfbar ist, vgl. A_19823). Für dieses TLS-Zertifikat fragt der E-Rezept-Fachdienst regelmäßig für das&nbsp;OCSP-Stapling nach A_20026 den&nbsp;OCSP-Responder des TSP nach dem Sperrstatus des TLS-Zertifikats.&nbsp;Als Antwort erhält der E-Rezept-Fachdienst eine OCSP-Response. Diese wird nach A_20022 geprüft und anschließend von der HTTPS-Schnittstelle verwendet (vgl.&nbsp;<a href="https://tools.ietf.org/html/rfc6066#section-8" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc6066#section-8</a>&nbsp;und bspw.&nbsp;<a href="http://nginx.org/en/docs/http/ngx_http_ssl_module.html#ssl_stapling" target="_top" class="descriptionLink">http://nginx.org/en/docs/http/ngx_http_ssl_module.html#ssl_stapling</a>&nbsp;).</span> </p>
  <p id="polarion_116"> <span style="font-size: 10pt;line-height: 1.5;"> Um dies zu ermöglichen muss der Paketfilter entsprechende stateful-Firewall-Regeln gemäß A_19815 und A_20022 definieren.</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-108506">
   <p><b>A_20022</b></p>
   <p>Der Paketfilter des E-Rezept-Fachdienstes MUSS bezüglich des OCSP-Stapling gemäß A_20026 folgende Vorgaben umsetzen:<br> 
    <ol>
     <li>Für das vom&nbsp;Anbieter des E-Rezept-Fachdienstes erworbene TLS-Zertifikat (vgl. Hinweis zu A_19815) MUSS der E-Rezept-Fachdienst initial die IP-Adresse (ggf. die IP-Adressen) des entsprechenden OCSP-Responsers ermitteln.</li>
     <li>Diese IP-Adresse(n) MÜSSEN gemäß A_19815 per stateful-Firewalling Verbindungen von der HTTPS-Schnittstelle an den OCSP-Responder erlaubt werden (Whitelisting).</li>
     <li>Gemäß OCSP-Stapling (<a class="descriptionLink" target="_top" href="https://tools.ietf.org/html/rfc6066#section-8">https://tools.ietf.org/html/rfc6066#section-8</a>&nbsp;) MUSS der E-Rezept-Fachdienst regelmäßig eine OCSP-Response vom entsprechenden OCSP-Responder beziehen (Die Regelmäßigkeit wird vom zertifikatsausgebenden TSP und der Gültigkeitsdauer dessen OCSP-Responses bestimmt).&nbsp;</li>
     <li>Die OCSP-Responses MÜSSEN vom E-Rezept-Fachdienst geprüft werden (Signaturprüfung, CertID in der OCSP-Response passt zum angefragten Zertifikat). Falls eine der Prüfungen&nbsp; ein nicht-positives Ergebnis liefert so MUSS die erhaltene OCSP-Response verworfen werden.</li>
     <li>Sollte die letzte im E-Rezept-Fachdienst vorhandene OCSP-Response zeitlich nicht mehr gültig sein (bspw. der OCSP-Responder im Internet war länger nicht erreichbar), so MUSS diese OCSP-Response verworfen werden und ein von einem Klienten (E-Rezept-FdV) <span style="font-size: 10pt;line-height: 1.5;">initiierter</span> TLS-Verbindungsaufbau der HTTPS-Schnittstelle ohne OCSP-Stapling durchgeführt werden.</li>
    </ol> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107537">
   <p><b>A_19824</b></p>
   <p>Der Paketfilter des E-Rezept-Fachdienstes MUSS so konfiguriert sein, dass bei Vollauslastung der Systemressourcen im E-Rezept-Fachdienst keine weiteren Verbindungen angenommen werden. <b>&lt;=</b></p>
  </div>
  <p id="polarion_32">Durch die Zurückweisung von Verbindungen wird sichergestellt, dass Clients einen Verbindungsaufbau mit einer anderen Instanz des Fachdienstes versuchen, bei dem die erforderlichen&nbsp;Ressourcen zur Verfügung stehen.</p>
  <p id="polarion_46">Da der E-Rezept-Fachdienst die Verarbeitung der fachlichen Operationen in einer VAU ausführt, ist der Zugang zum Schutz dieser VAU zweistufig. Der E-Rezept-Fachdienst verfügt über einen Eingangspunkt (einen Load Balancer), an dem die TLS-Verbindung terminiert wird. Der Eingangspunkt wertet dann den HTTP-Header aus, um aus der Ziel-URL des Requests den für die Verarbeitung zu adressierenden Verarbeitungskontext zu ermitteln. An diesen Verarbeitungskontext wird der Request durch den Eingangspunkt weitergeleitet. In umgekehrter Richtung sendet der Eingangspunkt die Response des Verarbeitungskontextes über die TLS-Verbindung an den Client.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107404">
   <p><b>A_19720</b></p>
   <p>Der Eingangspunkt des E-Rezept-Fachdienstes MUSS Verbindungen von Clients (Internet oder TI) ausschließlich über TLS akzeptieren. Er MUSS die TLS-Verbindung terminieren und HTTP Requests und Responses zwischen dem Client und dem für die jeweilige Sitzung zugeordneten Verarbeitungskontext der VAU vermitteln. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107536">
   <p><b>A_19823</b></p>
   <p>Der Eingangspunkt des E-Rezept-Fachdienstes MUSS sich beim TLS-Verbindungsaufbau über das Transportnetz gegenüber dem Client mit einem Extended Validation TLS-Zertifikat eines Herausgebers gemäß [CAB Forum]&nbsp;authentisieren. Das Zertifikat MUSS an die jeweilige Schnittstelle des Eingangspunkts für Primärsysteme und Frontends der Versicherten des E-Rezept-Fachdienstes gebunden werden, damit Clientsysteme beim TLS-Verbindungsaufbau eine vereinfachte Zertifikatsprüfung mit TLS-Standardbibliotheken durchführen können. <b>&lt;=</b></p>
  </div>
  <p id="polarion_104"></p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-107354">5.8.5 Vertrauenswürdige Ausführungsumgebung</h4>
  <p id="polarion_80">In diesem Abschnitt werden die Anforderungen&nbsp;an den E-Rezept-Fachdienst zur Umsetzung einer Vertrauenswürdigen Ausführungsumgebung (VAU) dargestellt. Die VAU dient der datenschutzrechtlich zulässigen und sicheren Verarbeitung von schützenswerten Klartextdaten innerhalb des E-Rezept-Fachdienstes sowie dem technischen Ausschluss der Profilbildung durch den Anbieter bzw. Betreiber. Die VAU stellt dazu Verarbeitungskontexte (d. h. Instanzen der VAU) bereit, in denen die Verarbeitung sensibler Daten im Klartext erfolgen kann. Diese Verarbeitungskontexte sind entsprechend zu schützen.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107363">
   <p><b>A_19683</b></p>
   <p>Der E-Rezept-Fachdienst MUSS die Verarbeitung aller fachlichen Operationen des Fachdienstes in einer Vertrauenswürdigen Ausführungsumgebung umsetzen. <b>&lt;=</b></p>
  </div>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-107357">5.8.5.1 Verarbeitungskontext</h5>
  <p id="polarion_83">Die Gesamtheit aus&nbsp;der für eine Klartextverarbeitung erforderlichen Software,&nbsp;dem für eine Klartextverarbeitung genutzten physikalischen System sowie&nbsp;den für die Integrität einer Klartextverarbeitung erforderlichen organisatorischen und physischen Rahmenbedingungen&nbsp;bildet den Verarbeitungskontext der Vertrauenswürdigen Ausführungsumgebung.</p>
  <p id="polarion_85">Zur Vertrauenswürdigen Ausführungsumgebung gehören neben den Verarbeitungskontexten alle für ihre Erreichbarkeit und betriebliche Steuerung erforderlichen Komponenten.</p>
  <p id="polarion_86">Der Verarbeitungskontext grenzt sich von allen weiteren, im betrieblichen Kontext beim Anbieter des E-Rezept-Fachdienstes vorhandenen Systemen und Prozessen dadurch ab, dass die sensiblen Klartextdaten von Komponenten innerhalb des Verarbeitungskontextes aus erreichbar sind oder sein können, während sie dies von außerhalb des Verarbeitungskontextes nicht sind. Sensible Daten verlassen den Verarbeitungskontext ausschließlich gemäß wohldefinierten (Zugriffs-)Regeln und in verschlüsselter Form.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107364">
   <p><b>A_19684</b></p>
   <p>Der Verarbeitungskontext des E-Rezept-Fachdienstes MUSS sämtliche physikalischen Systemkomponenten sowie sämtliche Softwarekomponenten umfassen, deren Sicherheitseigenschaften sich auf den Schutz der personenbezogenen medizinischen Daten vor Zugriff durch Unbefugte bei ihrer Verarbeitung&nbsp;im Klartext auswirken können. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107368">
   <p><b>A_19688</b></p>
   <p>Der Verarbeitungskontext des E-Rezept-Fachdienstes MUSS sicherstellen, dass sämtliche schützenswerten Daten vor einer Speicherung außerhalb der VAU verschlüsselt werden. Der Verarbeitungskontext MUSS dazu Schlüssel für nur jeweils ein individuelles E-Rezept (inkl. aller mit diesem E-Rezept verbundenen Daten) verwenden oder mindestens einmal pro Sekunde den verwendeten Schlüssel wechseln, so dass nur die innerhalb einer Sekunde neu angelegten E-Rezepte mit einem Schlüssel verschlüsselt werden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107381">
   <p><b>A_19699</b></p>
   <p>Der Verarbeitungskontext des E-Rezept-Fachdienstes MUSS die zur Verschlüsselung der persistierten E-Rezept-Daten verwendeten Schlüssel von einem HSM innerhalb der VAU abrufen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107382">
   <p><b>A_19700</b></p>
   <p>Das HSM der VAU des E-Rezept-Fachdienstes MUSS eine Schnittstelle zur Ableitung von symmetrischen Schlüsseln für die Persistierung von E-Rezept-Daten bereitstellen. Das HSM der VAU des E-Rezept-Fachdienstes MUSS zur Ableitung des jeweiligen Schlüssels ein nach der ersten Erstellung unveränderliches Merkmal des E-Rezept-Datensatzes als Ableitungsparameter verwenden (z. B. den Zeitstempel der Registrierung von Rezept-ID und Access Code oder den Access Code selbst). <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107375">
   <p><b>A_19694</b></p>
   <p>Der Verarbeitungskontext des E-Rezept-Fachdienstes MUSS sicherstellen, dass sämtliche schützenswerten Daten ausschließlich über sichere Verbindungen an autorisierte Nutzer weitergegeben werden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103702">
   <p><b>A_19262</b></p>
   <p>Der Verarbeitungskontext des E-Rezept-Fachdienstes MUSS sicherstellen, dass er nur transportverschlüsselt&nbsp;mit dem PVS kommuniziert. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103703">
   <p><b>A_19263</b></p>
   <p>Der Verarbeitungskontext des E-Rezept-Fachdienstes MUSS sicherstellen, dass er nur transportverschlüsselt&nbsp;mit dem AVS kommuniziert. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103704">
   <p><b>A_19264</b></p>
   <p>Der Verarbeitungskontext des E-Rezept-Fachdienstes MUSS sicherstellen, dass er nur transportverschlüsselt&nbsp;mit dem FdV kommuniziert. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103705">
   <p><b>A_19265</b></p>
   <p>Der Verarbeitungskontext des E-Rezept-Fachdienstes MUSS sicherstellen, dass er nur transportverschlüsselt&nbsp;mit Komponenten außerhalb des&nbsp; Verarbeitungskontextes kommuniziert. <b>&lt;=</b></p>
  </div>
  <p id="polarion_102" class="MsoListParagraph"> <span style="font-size: 10pt;line-height: 1.5;">Hinweis: für die Qualität der Transportverschlüsselung gelten die Anforderungen aus [gemSpec_Krypt].</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103707">
   <p><b>A_19267</b></p>
   <p>Der Verarbeitungskontext des E-Rezept-Fachdienstes MUSS sich gegenüber Clients, die mit ihm kommunizieren, mittels der Fachdienstidentität oid_erp-vau mit Zertifikatsprofil C.FD.ENC (oid_fd_enc) ausweisen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107384">
   <p><b>A_19702</b></p>
   <p>Die VAU des E-Rezept-Fachdienstes MUSS die in ihr ablaufenden Verarbeitungen für die Daten eines Verarbeitungskontextes von den Verarbeitungen für die Daten anderer Verarbeitungskontexte in solcher Weise trennen, dass mit technischen Mitteln ausgeschlossen wird, dass die Verarbeitungen eines Verarbeitungskontextes schadhaft auf die Verarbeitungen eines anderen Verarbeitungskontextes einwirken können. <b>&lt;=</b></p>
  </div>
  <p id="polarion_69"> <span style="font-style: italic;">Hinweis: Da der Verarbeitungskontext der VAU des E-Rezept-Fachdienstes für jede fachliche Operation neu aufgebaut werden muss, ist ein Low-Level-Mechanismus zur Kontextseparation aus Gründen der Performance bzw. Skalierung nicht zwingend vorgeschrieben. Der hier geforderte Separationsmechanismus kann daher auch als Server-Thread, Worker, o. Ä. ausgeführt sein, solange für den dadurch gebildeten Verarbeitungskontext die geforderte Separation nachgewiesen werden kann. Dies setzt voraus, dass die Umsetzung der Verarbeitungskontexte und der in ihnen ablaufenden Verarbeitungsvorgänge technisch möglichst einfach und nachvollziehbar gestaltet ist.</span> </p>
  <p id="polarion_79"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118585">
   <p><b>A_19726-01</b></p>
   <p><span style="font-style: normal;">Die VAU des E-Rezept-Fachdienstes MUSS für die Anwendergruppen Leistungserbringer (E-Rezepte ausstellen, E-Rezepte einlösen) und Versicherte&nbsp; (E-Rezepte einsehen, zuweisen und löschen) sicherstellen, dass eine Überlastung aufgrund außergewöhnlich&nbsp;hoher Aktivität einer Anwendergruppe (primär der Versicherten) keine&nbsp; Beeinträchtigung der Arbeitsfähigkeit der anderen Anwendergruppen (primär der&nbsp;Ärzte und Apotheker) zur Folge hat.</span><br> <b>&lt;=</b></p>
  </div>
  <p id="polarion_150">Dies kann durch Betrieb der Funktionalitäten auf jeweils getrennten physischen Servern oder durch Mechanismen des vorgelagerten Load Balancing realisiert werden.</p>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-107355">5.8.5.2 Ausschluss von nicht autorisierten Zugriffen aus dem Betriebsumfeld</h5>
  <p id="polarion_89">Der Schutzbedarf der in der VAU verarbeiteten Klartextdaten erfordert den technischen Ausschluss von Zugriffen des Anbieters. Dies umfasst&nbsp;insbesondere Zugriffe durch Personen aus dem betrieblichen Umfeld des Anbieters.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107386">
   <p><b>A_19704</b></p>
   <p>Die VAU des E-Rezept-Fachdienstes MUSS die in ihren Verarbeitungskontexten ablaufenden Datenverarbeitungsprozesse von allen sonstigen Datenverarbeitungsprozessen des Anbieters trennen und damit gewährleisten, dass der Anbieter des E-Rezept-Fachdienstes vom Zugriff auf die in der VAU verarbeiteten schützenswerten Daten ausgeschlossen ist.&nbsp; <b>&lt;=</b></p>
  </div>
  <p id="polarion_77"> <span style="font-style: italic;">Hinweis: Für die Separation zwischen Verarbeitungskontexten und Verarbeitungsprozessen des Anbieters, die der betrieblichen Steuerung des Systems dienen, ist eine Low-Level Separation anzustreben, da - im Unterschied zur Separation zwischen Verarbeitungskontexten - hier technisch sehr verschiedene Aspekte getrennt werden müssen.</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107389">
   <p><b>A_19706</b></p>
   <p><span style="font-style: normal;">Die VAU des E-Rezept-Fachdienstes MUSS eine Manipulation der eingesetzten Software erkennen und eine Ausführung der manipulierten Software verhindern.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107388">
   <p><b>A_19707</b></p>
   <p><span style="font-style: italic;"></span><span style="font-style: normal;">Die VAU des E-Rezept-Fachdienstes MUSS die Integrität der eingesetzten Hardware schützen und damit insbesondere Manipulationen an der Hardware durch den Anbieter des E-Rezept-Fachdienstes ausschließen.</span><span style="font-style: italic;"></span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107390">
   <p><b>A_19708</b></p>
   <p><span style="font-style: normal;">Die VAU des E-Rezept-Fachdienstes MUSS den Ausschluss von Manipulationen an der Hardware und der Software durch den Anbieter des E-Rezept-Fachdienstes mit Mitteln umsetzen, deren dauerhafte und kontinuierliche Wirksamkeit gewährleistet werden kann.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107391">
   <p><b>A_19709</b></p>
   <p>Die VAU des E-Rezept-Fachdienstes MUSS mit technischen Mitteln sicherstellen, dass niemand, auch nicht der Anbieter des E-Rezept-Fachdienstes, während der Verarbeitung personenbezogener medizinischer Daten Zugriff auf physische Schnittstellen der Systeme erlangen kann, auf denen eine VAU ausgeführt wird. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107392">
   <p><b>A_19710</b></p>
   <p>Die VAU des E-Rezept-Fachdienstes MUSS mit technischen Mitteln sicherstellen, dass physischer Zugang zu Hardware-Komponenten der Verarbeitungskontexte nur erfolgen kann, nachdem gewährleistet ist, dass aus ihnen keine Nutzdaten extrahiert werden können. <b>&lt;=</b></p>
  </div>
  <p id="polarion_82"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-119771">
   <p><b>A_19711-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS die folgenden privaten Schlüssel in einem Hardware Security Module (HSM) erzeugen und anwenden: <br> 
    <ul> 
     <li>Privater Schlüssel (PrK.FD.ENC) des Schlüsselpaars zur Authentisierung des Verarbeitungskontextes gegenüber dem E-Rezept-Frontend des Versicherten&nbsp;und Primärsystemen (sicherer Kanal auf Anwendungsebene).<br> </li> 
    </ul> Die Prüftiefe des HSM MUSS dabei den in [A_19712] angegebenen Standards entsprechen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_146"> <span style="font-style: italic;">Hinweis: Die TLS-TI-Fachdienst-Identität kann z. B. auf einem außerhalb der VAU betriebenen Load Balancer mit TLS-Terminierung verwendet werden. Hierfür muss dann ein HSM außerhalb der VAU verwendet werden.</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107394">
   <p><b>A_19712</b></p>
   <p>Der Anbieter des E-Rezept-Fachdienstes MUSS beim Einsatz eines HSM sicherstellen, dass dessen Eignung durch eine erfolgreiche Evaluierung nachgewiesen wurde. Als Evaluierungsschemata kommen dabei Common Criteria, ITSEC oder Federal Information Processing Standard (FIPS) in Frage. &nbsp;&nbsp;&nbsp;&nbsp;<br> Die Prüftiefe MUSS mindestens&nbsp; 
    <ol> 
     <li>FIPS 140-2 Level 3,&nbsp;&nbsp;&nbsp;&nbsp;</li> 
     <li>Common Criteria EAL 4+ mit hohem Angriffspotenzial oder</li> 
     <li>ITSEC E3 der Stärke „hoch“ entsprechen.</li> 
    </ol> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107395">
   <p><b>A_19713</b></p>
   <p>Die VAU des E-Rezept-Fachdienstes MUSS mit technischen Mitteln, die auch Manipulationen durch den Anbieter des E-Rezept-Fachdienstes ausschließen, gewährleisten, dass nur Instanzen der VAU Zugriff auf die Kryptographieschnittstelle des HSM zur Nutzung des privaten Schlüsselmaterials für ihre Dienstzertifikate erhalten können. <b>&lt;=</b></p>
  </div>
  <p id="polarion_101"> <span style="font-style: italic;">Hinweis: Falls die Verarbeitungskontexte als Threads, Workers, o. Ä. umgesetzt sind und daher gemeinsam in einem übergreifenden Anwendungsprozess ausgeführt werden, kann dieser Anwendungsprozess eine authentisierte Verbindung zur Kryptograhieschnittstelle des HSM herstellen und aufrecht erhalten, um darüber die Kryptographieschnittstelle des HSM den Verarbeitungskontexten (und nur diesen) lokal zur Verfügung zu stellen.</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107396">
   <p><b>A_19714</b></p>
   <p><span style="font-style: normal;">Die VAU des E-Rezept-Fachdienstes MUSS den Aufbau eines vertraulichen und integritätsgeschützten Kommunikationskanals gemäß [gemSpec_Krypt#3.16] und [gemSpec_Krypt#7]&nbsp;zwischen einem Client und einem Verarbeitungskontext erzwingen, bevor der Verarbeitungskontext seine fachlichen Schnittstellen für den Client nutzbar macht.</span> <b>&lt;=</b></p>
  </div>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-107356">5.8.5.3 Konsistenz des Systemzustands, Logging und Monitoring</h5>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107398">
   <p><b>A_19715</b></p>
   <p>Die VAU des E-Rezept-Fachdienstes MUSS sicherstellen, dass ein konsistenter Zustand des Verarbeitungskontextes auch bei Bedienfehlern oder technischen Problemen immer erhalten bleibt bzw. wiederhergestellt werden kann. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107397">
   <p><b>A_19716</b></p>
   <p>Die VAU des E-Rezept-Fachdienstes MUSS die für den Betrieb eines Fachdienstes erforderlichen Logging- und Monitoring-Informationen in solcher Art und Weise erheben und verarbeiten, dass mit technischen Mitteln ausgeschlossen ist, dass dem Anbieter des E-Rezept-Fachdienstes oder Dritten vertrauliche oder zur Profilbildung geeignete Daten zur Kenntnis gelangen. <b>&lt;=</b></p>
  </div>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-107358">5.8.5.4 Client-Verbindungen zum Verarbeitungskontext</h5>
  <p id="polarion_120">Um Verbindungen vom E-Rezept-Frontend des Versicherten nach [gemSpec_eRp_FdV] zum Verarbeitungskontext zu ermöglichen, ist ein der VAU vorgelagertes Routing ausgehend von einem netztechnischen Eingangspunkt&nbsp;(z. B. in Form eines TLS-terminierenden Load Balancers)&nbsp;erforderlich. Der Eingangspunkt ist im Netzwerk der TI für das Primärsystem unter mindestens einer IP-Adresse/Port-Kombination erreichbar, die im Namensdienst der TI registriert sein muss. Der Eingangspunkt&nbsp;vermittelt die Verbindungen zwischen dem Client und dem jeweils benötigten Verarbeitungskontext.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107405">
   <p><b>A_19719</b></p>
   <p>Die VAU des E-Rezept-Fachdienstes MUSS ihre Verarbeitungskontexte über gemeinsame IP-Adressen und Ports des Eingangspunkts des Fachdienstes erreichbar machen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107411">
   <p><b>A_19724</b></p>
   <p>Der Verarbeitungskontext des E-Rezept-Fachdienstes MUSS sich gegenüber Clients mittels der Fachdienstidentität <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">oid_erp-vau</span> mit Zertifikatsprofil <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">C.FD.ENC</span>&nbsp;ausweisen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107409">
   <p><b>A_19721</b></p>
   <p>Der Eingangspunkt des E-Rezept-Fachdienstes MUSS Clients den Aufbau eines sicheren Kanals auf Inhaltsebene, d. h. einen Verbindungsaufbau gemäß [gemSpec_Krypt#3.16] und [gemSpec_Krypt#7], zum Verarbeitungskontext ermöglichen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107410">
   <p><b>A_19722</b></p>
   <p>Der Verarbeitungskontext des E-Rezept-Fachdienstes MUSS den sicheren Kanal zu einem Client nach Abschluss einer fachlichen Operation&nbsp;(die aus mehreren Requests bestehen kann) abbauen, sodass anschließend keine Zugriffe dieses Clients auf den Verarbeitungskontext mehr möglich sind, ohne dass eine neue Verbindung aufgebaut wird. <b>&lt;=</b></p>
  </div>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-103568">6 Funktionsmerkmale</h2>
  <p id="polarion_99">In diesem Abschnitt werden die vom E-Rezept-Fachdienst verwalteten Ressourcen mit ihren zulässigen Operationen und der Workflow des E-Rezepts spezifiziert. Dabei werden sowohl die relevanten HTTP-Operationen als auch die möglichen FHIR-Operationen auf Ressourcen-Endpunkte bzw. konkrete über eine &lt;id&gt; referenzierte Instanz vorgestellt. Die HTTP-Operationen dienen dabei der Zugriffssteuerung gemäß HTTP-Protokoll, um mit GET Daten von einem Server abzurufen und mittels POST Daten an einen Server zu schicken. Die FHIR-Operationen setzen in Kombination mit den HTTP-Operationen die Workflow-Steuerung um, wobei die entsprechenden FHIR-Operationen jeweils Zustandsänderungen triggern und bei den HTTP-Operationen POST vom Client Übergabeparameter erwarten und bei HTTP-GET ohne Übergabeparameter funktionieren.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-105616">
   <p><b>A_19536</b></p>
   <p>Der E-Rezept-Fachdienst MUSS seine Schnittstellen für alle Zugriffe auf alle Datenobjekte und alle Ressourcen in einer RESTful API gemäß der FHIR-Spezifikation in&nbsp;<a class="descriptionLink" target="_top" href="http://hl7.org/fhir/http.html">http://hl7.org/fhir/http.html</a>&nbsp; der <span style="font-size: 10pt;line-height: 1.5;">Version v4.0.1 R4 umsetzen.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-105621">
   <p><b>A_19537</b></p>
   <p>Der E-Rezept-Fachdienst MUSS in seinen Schnittstellen für die Zugriffe durch Leistungserbringer und Leistungserbringerinstitutionen standardmäßig den MimeType <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">application/fhir+xml</span> akzeptieren und in Responses verwenden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-105619">
   <p><b>A_19538</b></p>
   <p>Der E-Rezept-Fachdienst MUSS in seinen Schnittstellen für die Zugriffe durch Versicherte standardmäßig den MimeType <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;"><span style="font-size: 10pt;line-height: 1.5;">application/fhir+json</span>&nbsp;</span>akzeptieren und in Responses verwenden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-105620">
   <p><b>A_19539</b></p>
   <p>Der E-Rezept-Fachdienst MUSS in seinen Schnittstellen einen von der Standardfestlegung abweichenden MimeType umsetzen, wenn der jeweilige Client eine entsprechende Anforderung in der Aufrufschnittstelle über den URL-Parameter <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">_format=fhir+xml</span> bzw. <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">_format=fhir+json</span>&nbsp;gemäß <a class="descriptionLink" target="_top" href="http://hl7.org/fhir/http.html#general">http://hl7.org/fhir/http.html#general</a> oder mittels des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Accept</span>-Attributs im HTTP-Request-Header als&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">application/fhir+xml</span>&nbsp;bzw.&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">application/fhir+json</span>&nbsp;anfordert, damit Clientsysteme ein für sie leichter verarbeitbares Format in der Antwort erhalten können. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-109311">
   <p><b>A_20171</b></p>
   <p>Der E-Rezept-Fachdienst MUSS an seinen Schnittstellen eine http-GET-Operation auf den Endpunkt /metadata erlauben, in welcher er ein CapabilityStatement gemäß&nbsp;<a class="descriptionLink" target="_top" href="https://www.hl7.org/fhir/capabilitystatement.html">https://www.hl7.org/fhir/capabilitystatement.html</a>&nbsp; veröffentlicht, welches die vom E-Rezept-Fachdienst verarbeiteten Ressourcen mit den zugehörigen http-Operationen der angebotenen REST-Schnittstelle auflistet:<br> 
    <ul>
     <li>Task – GET-, POST-Operation, FHIR-Operations für die Workflow-Steuerung und Einsicht durch den Versicherten</li>
     <li>MedicationDispense – GET-Operation für das Einsehen der Medikamentinformationen durch den Versicherten</li>
     <li>Communication –&nbsp;GET-, POST, DELETE-Operation für das Senden, Empfangen und Löschen von Nachrichten</li>
     <li>AuditEvent – GET-Operation für die Einsicht in Protokolleinträge durch den Versicherten</li>
     <li>Device – GET-Operation mit statischen Informationen zur serverseitigen Signatur</li>
    </ul>damit der Client eine Information über die FHIR-Kompatibilität zum Fachdienst erhält. <b>&lt;=</b></p>
  </div>
  <p id="polarion_100"></p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-103569">6.1 Ressource Task</h3>
  <p id="polarion_90"> Die FHIR-Resource Task [FHIR-TASK] bildet den Workflow für ein E-Rezept ab. Diese wird vom verordnenden Leistungserbringer mittels FHIR-Operationen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">$create</span> und <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">$activate</span>&nbsp;im E-Rezept-Fachdienst erstellt. Der Versicherte kann die Ressource einsehen bzw. herunterladen und auf Wunsch mittels einer FHIR-Operation <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">$abort</span> löschen, die den Workflow abbricht. Die abgebende Apotheke greift ebenso wie der Verordnende ausschließlich über FHIR-Operationen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">$accept</span> und <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">$close</span> zur Workflow-Steuerung auf einen Task zu. </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103570">
   <p><b>A_19030</b></p>
   <p>Der E-Rezept-Fachdienst MUSS alle Zugriffe auf die Ressource Task mittels der HTTP-Operationen PUT, PATCH, HEAD und DELETE sowie POST ohne die Angabe einer gültigen FHIR-Operation unterbinden, damit keine unzulässigen Operationen auf den Rezeptdaten ausgeführt werden können. <b>&lt;=</b></p>
  </div>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-103571">6.1.1 HTTP-Operation GET</h4>
  <p id="polarion_91">Der Zugriff mittels der HTTP-Operation GET steht ausschließlich für die Einsichtnahme in E-Rezepte durch den Versicherten bzw. einen Vertreter mit Wissen um den AccessCode bzw. einen Apotheker mit Wissen um das Secret zur Verfügung. Die GET-Operation ohne Referenz einer FHIR-Operation führt zu keiner Statusänderung.</p>
  <p id="polarion_127"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118630">
   <p><b>A_21558</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf&nbsp;der HTTP-GET-Operation auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Task</span>&nbsp;&nbsp;sicherstellen, dass ausschließlich Versicherte in der Rolle&nbsp;<br> 
    <ul>
     <li>oid_versicherter</li>
    </ul>die Operation am Fachdienst aufrufen dürfen und die Rolle "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">professionOID</span>" des Aufrufers im&nbsp;ACCESS_TOKEN im HTTP-RequestHeader "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Authorization</span>" feststellen, damit E-Rezepte nicht durch Unberechtigte ausgelesen werden können. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-119661">
   <p><b>A_19113-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf&nbsp;der HTTP-GET-Operation&nbsp;auf einen konkreten über &lt;id&gt; adressierten <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Task/&lt;id&gt;</span>&nbsp;(ohne die Referenz einer FHIR-Operation) sicherstellen, dass ausschließlich Versicherte oder Apotheken in einer der Rollen&nbsp;<br> 
    <ul>
     <li>oid_versicherter</li>
     <li>oid_oeffentliche_apotheke</li>
     <li>oid_krankenhausapotheke</li>
    </ul>die Operation am Fachdienst aufrufen dürfen und die Rolle "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">professionOID</span>" des Aufrufers im&nbsp;ACCESS_TOKEN im HTTP-RequestHeader "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Authorization</span>" feststellen, damit E-Rezepte nicht durch Unberechtigte ausgelesen werden können. <b>&lt;=</b></p>
  </div>
  <p id="polarion_167"> <span id="polarion-comment:438"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133165">
   <p><b>A_19115-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf&nbsp;der HTTP-GET-Operation auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Task</span> die dem Versicherten zugeordneten Task-Ressourcen anhand der KVNR des Versicherten aus dem ACCESS_TOKEN im "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Authorization</span>"-Header des HTTP-Requests identifizieren, die in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.for</span> die entsprechende KVNR des begünstigten Patienten referenziert haben, damit ausschließlich Versicherte ihre eigenen E-Rezepte einsehen können. <b>&lt;=</b></p>
  </div>
  <p id="polarion_42"> <span id="polarion-comment:437"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133166">
   <p><b>A_19116-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf&nbsp;der HTTP-GET-Operation auf einen einzelnen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Task/&lt;id&gt;</span> und Ungleichheit der KVNR des Aufrufenden (KVNR des&nbsp;ACCESS_TOKEN im "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Authorization</span>"-Header des HTTP-Requests UNGLEICH KVNR in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.for</span> ) prüfen, ob der im HTTP-Request-Header&nbsp;"<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">X-AccessCode</span>" oder URL-Parameter "?ac=..." übergebene AccessCode gleich dem AccessCode in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.identifier</span> ist,&nbsp;damit auch Vertreter in Kenntnis des AccessCodes ein einzelnes E-Rezept einsehen können. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116848">
   <p><b>A_19129-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf&nbsp;der HTTP-GET-Operation auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Task</span>&nbsp;die gültige Ergebnisliste der Task-Ressourcen ohne die referenzierten, signierten E-Rezept-Bundle an den Aufrufer zurückgeben, damit der Versicherte eine Übersicht aller Tasks erhält. <b>&lt;=</b></p>
  </div>
  <p id="polarion_132"> <span id="polarion-comment:468"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133077">
   <p><b>A_21375-02</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf&nbsp;der HTTP-GET-Operation auf einen einzelnen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Task/&lt;id&gt;</span> durch einen Versicherten die einzelne Task-Ressource um das referenzierte, serverseitig signierte E-Rezept-Bundle aus <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.input</span> <span style="font-family: Arial, Helvetica;">mit Codingsystem&nbsp;<a href="https://gematik.de/fhir/erp/CodeSystem/GEM_ERP_CS_DocumentType" target="_top" class="descriptionLink">https://gematik.de/fhir/erp/CodeSystem/GEM_ERP_CS_DocumentType</a>&nbsp;</span><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">= 2&nbsp;</span>als <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">search.include</span> im Ergebnis-Bundle an den Aufrufer zurückgeben, damit der Versicherte eine vollständige Einsicht in den Task und den signierten Verordnungsdatensatz für eigene Dokumentationszwecke erhält. <b>&lt;=</b></p>
  </div>
  <p id="polarion_207"> <span id="polarion-comment:467"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133078">
   <p><b>A_21532-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf der Operation GET /Task und GET /Task/&lt;id&gt; durch einen Versicherten&nbsp;oid_versicherter ein optional vorhandenes <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.identifier:Secret</span> als&nbsp;<a href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Secret" target="_top" class="descriptionLink">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Secret</a> aus dem zurückgegebenen Task entfernen, sodass Versicherte nicht in Kenntnis des Secrets gelangen, welches die Prozesshoheit des Apothekers darstellt. <b>&lt;=</b></p>
  </div>
  <p id="polarion_204"> <span id="polarion-comment:466"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133079">
   <p><b>A_20702-02</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS beim Aufruf&nbsp;der HTTP-GET-Operation auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Task/&lt;id&gt;</span></span> ausschließlich <span style="font-size: 10pt;line-height: 1.5;">solchen Clients&nbsp;die AccessCode Information (<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.identifier</span> mit <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">system="<a href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_AccessCode" target="_top" class="descriptionLink">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_AccessCode</a>"</span>&nbsp;) in den Task-Ressourcen zurückgeben, welche&nbsp;anhand der mitgeteilten, gültigen Produktidentifikation als hierfür zulässige Clients erkannt werden.</span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_202"> In E-Rezept-Stufe 1 ist <span style="font-size: 10pt;line-height: 1.5;">ausschließlich</span>&nbsp;das E-Rezept-FdV ein Client, welcher den AccessCode über die Operation GET /Task/&lt;id&gt; übermittelt bekommt.&nbsp; </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116763">
   <p><b>A_21360</b></p>
   <p>Der E-Rezept-Fachdienst DARF den AccessCode beim Zugriff durch den Versicherten NICHT an das E-Rezept-Frontend des Versicherten herausgeben, wenn der Flowtype des Tasks den Wert für die Workflowsteuerung durch Leistungserbringer enthält (169). <b>&lt;=</b></p>
  </div>
  <p id="polarion_200"> <span id="polarion-comment:465"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133080">
   <p><b>A_19226-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf&nbsp;der HTTP-GET-Operation auf einen&nbsp;einzelnen Task mittels "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Task/&lt;id&gt;?secret=...</span>" durch einen Apotheker den Task, sofern er den&nbsp;Status "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">completed</span>" hat, um das referenzierte, serverseitig signierte Quittungs-Bundle aus <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.output&nbsp;<span style="font-family: Arial, Helvetica;">mit Codingsystem&nbsp;<a href="https://gematik.de/fhir/erp/CodeSystem/GEM_ERP_CS_DocumentType" target="_top" class="descriptionLink">https://gematik.de/fhir/erp/CodeSystem/GEM_ERP_CS_DocumentType</a>&nbsp;</span>= 3&nbsp;</span>als <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">search.include</span> im Ergebnis-Bundle ergänzen und die Ergebnismenge Task + Quittungs-Bundle an den Apotheker zurückgeben, damit ein Apotheker, der ein konkretes E-Rezept beliefert hat, bei Bedarf genau dieses belieferte E-Rezept inkl. der Quittung erneut abrufen kann. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118828">
   <p><b>A_19569-02</b></p>
   <p>Der E-Rezept-Fachdienst MUSS das Eingrenzen einer Suchanfrage auf <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Task&nbsp;</span>gemäß&nbsp;<a class="descriptionLink" target="_top" href="https://www.hl7.org/fhir/medicationdispense.html#search">https://www.hl7.org/fhir/medicationdispense.html#search</a>&nbsp;mindestens für die Attribute<br>
    <ul>
     <li>Task.status,</li>
     <li>Task.authoredOn und</li>
     <li>Task.lastModified</li>
    </ul>unterstützen,&nbsp;sowie ein <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">_revinclude</span> der Ressource <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AuditEvent:entity.what</span>&nbsp;gemäß&nbsp;<a class="descriptionLink" target="_top" href="https://www.hl7.org/fhir/search.html#revinclude">https://www.hl7.org/fhir/search.html#revinclude</a>&nbsp; zulassen, sodass der Versicherte zu einem gesuchten Task alle zugehörigen Protokolleinträge abrufen kann. <b>&lt;=</b></p>
  </div>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-103577">6.1.2 HTTP-Operation POST</h4>
  <p id="polarion_92">Der Zugriff auf einen Task mittels der HTTP-Operation POST erfolgt immer in Verbindung mit dem Aufruf einer FHIR-Operation, die den Workflow des Tasks steuert. Je nach Anwendungsfall erfolgt der POST-Aufruf auf den Ressourcen-Endpunkt /Task oder eine konkrete über die ID referenzierte Task-Ressource /Task/&lt;id&gt;.</p>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-103578">6.1.2.1 POST /Task/$create</h5>
  <p id="polarion_93">Die FHIR-Operation $create erzeugt einen neuen FHIR-Task für ein E-Rezept. Diese Operation steht ausschließlich verordnenden Leistungserbringern zur Verfügung.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103579">
   <p><b>A_19018</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Erzeugen eines Tasks mittels HTTP-POST/$create-Operation die Rolle "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">professionOID</span>" des Aufrufenden im&nbsp;ACCESS_TOKEN im HTTP-RequestHeader "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Authorization</span>" feststellen und sicherstellen, dass ausschließlich verordnende Leistungserbringer in der Rolle <br> 
    <ul>
     <li>oid_arzt</li>
     <li>oid_zahnarzt</li>
     <li>oid_praxis_arzt</li>
     <li>oid_zahnarztpraxis</li>
     <li>oid_praxis_psychotherapeut</li>
     <li>oid_krankenhaus</li>
    </ul>die Operation im Fachdienst aufrufen dürfen, damit E-Rezepte nicht durch zur Verordnung Unberechtigte eingestellt werden können. <b>&lt;=</b></p>
  </div>
  <p id="polarion_199"> <span id="polarion-comment:464"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133082">
   <p><b>A_19257-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS die im Body der HTTP-POST-Operation auf die Ressource Task übertragenen Parameter gegen das Schema <a href="http://gematik.de/fhir/erp/OperationDefinition/CreateOperationDefinition" target="_top" class="descriptionLink">http://gematik.de/fhir/erp/OperationDefinition/CreateOperationDefinition</a> prüfen und bei Nicht-Konformität das Anlegen der Ressource im Fachdienst mit dem http-Status-Code 400 beantworten, damit kein Schadcode und keine "fachfremden" Daten in den E-Rezept-Fachdienst hochgeladen werden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103581">
   <p><b>A_19112</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Erzeugen eines Tasks mittels HTTP-POST/$create-Operation den Parameter workflowType (Rezepttyp) aus dem HTTP-Body des POST-Requests entnehmen, als Attribut&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.extension:flowType</span>&nbsp;des zu erstellenden Tasks verwenden und bei Fehlen bzw. Nicht-Konformität des Parameters den Request als unzulässig abweisen, damit auf Basis dieser Parameter ausschließlich gültige Workflows gestartet werden können und dem Versicherten bei Einsicht des Tasks der Weg in entweder eine Apotheke oder ein Sanitätshaus oder eine andere zuständige Einrichtung gewiesen werden kann. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103582">
   <p><b>A_19214</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Erzeugen eines Tasks das Feld <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.performerType</span> aus dem übergebenen, gültigen Parameter&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.extension:flowType </span>gemäß der Prozessparameter [gemSpec_DM_eRp#19445] übernehmen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_108"> <span id="polarion-comment:463"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133083">
   <p><b>A_19019-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Anlegen eines neuen Tasks eine Rezept-ID gemäß der Bildungsregel [gemSpec_DM_eRp#19217] generieren und als Identifier mit Namingsystem&nbsp;<a href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_PrescriptionId" target="_top" class="descriptionLink">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_PrescriptionId</a> dem Task hinzufügen und sicherstellen, dass diese Rezept-ID innerhalb von 11 Jahren nach ihrer Erzeugung nicht erneut vergeben wird, damit es innerhalb der Aufbewahrungsfrist der Abrechnungsdaten bei den Krankenkassen zu keinen Dubletten kommt. <b>&lt;=</b></p>
  </div>
  <p id="polarion_197"> <span id="polarion-comment:462"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133085">
   <p><b>A_19021-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Erzeugen eines Tasks mittels&nbsp;HTTP-POST/$create-Operation&nbsp;eine 256 Bit&nbsp;Zufallszahl mit einer Mindestentropie von 120 Bit erzeug<span style="font-size: 10pt;line-height: 1.5;">en,&nbsp;hexadezimal kodieren ([0-9a-f]{64})</span> und diese im zu speichernden Task als externe ID in Task.identifier:AccessCode als&nbsp;<a href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_AccessCode" target="_top" class="descriptionLink">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_AccessCode</a> hinzufügen, damit nachfolgende Zugriffe auf diesen Datensatz nur durch Berechtigte in Kenntnis des AccessCodes erfolgen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103585">
   <p><b>A_19114</b></p>
   <p>Der E-Rezept-Fachdienst MUSS die zulässige Anlage eines Tasks mittels&nbsp;HTTP-POST/$create-Operation im Status <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.status = draft</span> vollziehen und beim erfolgreichen Abschluss der Operation die angelegte Ressource Task im HTTP-Body der HTTP-Response zurückgeben, damit der verordnende Leistungserbringer die generierte Rezept-ID für die QES verwenden kann. <b>&lt;=</b></p>
  </div>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-103586">6.1.2.2 POST /Task/&lt;id&gt;/$activate</h5>
  <p id="polarion_94">Die FHIR-Operation $activate startet einen E-Rezept-Workflow eines zuvor unter einer &lt;id&gt; angelegten neuen Tasks. Diese Operation steht ausschließlich verordnenden Leistungserbringern zur Verfügung.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103587">
   <p><b>A_19022</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aktivieren eines Tasks für ein E-Rezept mittels HTTP-POST/$activate-Operation auf den in der URL referenzierten&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Task/&lt;id&gt;</span> sicherstellen, dass ausschließlich verordnende Leistungserbringer in der Rolle <br> 
    <ul> 
     <li>oid_arzt</li> 
     <li>oid_zahnarzt</li> 
     <li>oid_praxis_arzt</li> 
     <li>oid_zahnarztpraxis</li> 
     <li>oid_praxis_psychotherapeut</li> 
     <li>oid_krankenhaus</li> 
    </ul> die Operation am Fachdienst aufrufen dürfen und die Rolle "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">professionOID</span>" des Aufrufers im&nbsp;ACCESS_TOKEN im HTTP-RequestHeader "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Authorization</span>" feststellen, damit E-Rezepte nicht durch Unberechtigte eingestellt werden können. <b>&lt;=</b></p>
  </div>
  <p id="polarion_195"> <span id="polarion-comment:461"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133086">
   <p><b>A_19024-02</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Zugriff auf einen Task mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$activate den im HTTP-RequestHeader "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">X-AccessCode</span>"&nbsp;oder URL-Parameter "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">?ac=...</span>" übertragenen AccessCode gegen den im referenzierten Task gespeicherten AccessCode&nbsp;Task.identifier:AccessCode als&nbsp;<a href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_AccessCode" target="_top" class="descriptionLink">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_AccessCode</a> und den Status des Tasks auf <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.status = draft</span>&nbsp;prüfen und bei Ungleichheit oder Fehlen des HTTP-Headers die Operation&nbsp;mit dem HTTP-Fehlercode 403 abbrechen, damit Zugriffe auf diesen Datensatz nur durch Berechtigte in Kenntnis des AccessCodes erfolgen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103589">
   <p><b>A_19020</b></p>
   <p>Der E-Rezept-Fachdienst MUSS den im Aufrufparameter der HTTP-POST-Operation&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Task/&lt;id&gt;/$activate</span> übergebenen FHIR-Operationsparameter des QES-Datensatzes als PKCS#7-Datei einer Enveloping CAdES-Signatur entgegennehmen und verarbeiten&nbsp;und bei Fehlen oder ungültiger ASN.1 Datenstruktur die Weiterverarbeitung im Fachdienst mit dem http-Status-Code 400 beantworten, damit kein Schadcode und keine "fachfremden" Daten in den E-Rezept-Fachdienst hochgeladen werden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-128742">
   <p><b>A_20159-02</b></p>
   <p>Der E-Rezept-Fachdienst MUSS das QES-Signaturzertifikat C.HP.QES in der Signatur des übergebenen QES-Datensatzes gemäß [gemSpec_PKI#TUC_PKI_030] mit folgenden Parametern auf Gültigkeit prüfen: <br> <p data-keep-next="true" class="polarion-rte-caption-paragraph" id="polarion___6"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">7</span> : TAB_eRPFD_006 Parameter Prüfung Signaturzertifikat QES des HBA </p> 
    <table id="polarion_wiki macro name=table;params=width=100%" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
     <tbody> 
      <tr> 
       <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 155px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Parameter</th> 
       <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 577px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></th> 
      </tr> 
      <tr> 
       <td style="width: 155px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Zertifikat</td> 
       <td style="width: 577px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Signaturzertifikat des HBA (eingebettet in Signatur-Objekt des QES-Datensatzes):<br> 
        <ul> 
         <li>C.HP.QES (oid_hba_qes = 1.2.276.0.76.4.72 gemäß gemSpec_OID)</li> 
         <li>bzw. für HBA-Vorläuferkarten&nbsp;C.HP.ENC (oid_vk_eaa_enc = 1.3.6.1.4.1.24796.1.10 gemäß gemSpec_OID)<br> Hinweis: die OID dieses Profil wird für Ärzte- und Zahnärzteschaft gleichermaßen genutzt</li> 
        </ul> </td> 
      </tr> 
      <tr> 
       <td style="width: 155px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Referenzzeitpunkt</td> 
       <td style="width: 577px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">&lt;Zeitpunkt der QES.Erstellung gemäß <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">signingTime</span> im QES-Datensatz&gt;</td> 
      </tr> 
      <tr> 
       <td style="width: 155px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Offline-Modus</td> 
       <td style="width: 577px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">nein</td> 
      </tr> 
      <tr> 
       <td style="width: 155px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">OCSP-Response</td> 
       <td style="width: 577px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">eingebettet in QES-Datensatz</td> 
      </tr> 
     </tbody> 
    </table> <br> und darf die OCSP-Response für die Abfrage des Zertifikatsstatus für 12 Stunden zwischenspeichern.<br> Ist keine OCSP-Response eingebettet, MUSS der E-Rezept-Fachdienst die gecachte OCSP-Response verwenden oder eine OCSP-Response beim benannten TSP anfragen und die genutzte OCSP-Response nachträglich in den QES-Datensatz einbetten.<br> Das Signaturzertifikat muss anhand der Zertifikatsprüfung für [mathematisch gültig UND zeitlich gültig UND online gültig ] befunden werden und der HTTP-Request andernfalls mit dem HTTP-Status-Code 400 abgelehnt werden, damit sichergestellt wird, dass ausschließlich E-Rezepte verwaltet werden, die von einer gültigen, nicht gesperrten Heilberufsidentität eines HBA signiert wurden. <b>&lt;=</b></p>
  </div>
  <p id="polarion_210"> <span id="polarion-comment:460"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133087">
   <p><b>A_19025-02</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS beim Zugriff auf einen Task mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$activate<br></span> 
    <ul>
     <li><span style="font-size: 10pt;line-height: 1.5;">die qualifizierte Signatur des QES-Datensatzes gemäß&nbsp;[ETSI_QES]&nbsp;prüfen und bei nicht gültiger qualifizierter Signatur die Operation mit Status 400 abbrechen</span></li>
     <li><span style="font-size: 10pt;line-height: 1.5;">bzw. bei gültiger Signatur das innerhalb des PKCS#7-Datensatz enveloping-enthaltene&nbsp;<span style="color: #172B4D;">FHIR-Bundle einer umfänglichen FHIR-Validierung gegen die eRezept-Schema-Definition der KB<span style="font-weight: normal;">V&nbsp;<span style="color: #333333;">kbv.ita.erp unterziehen und bei Invalidität&nbsp;die Operation mit Status 400 abbrechen</span></span></span></span></li>
     <li><span style="font-size: 10pt;line-height: 1.5;">bzw. bei gültiger Signatur und validem FHIR d<span style="color: #333333;">en Datensatz als PKCS#7-Datei sicher speichern und in Task.input&nbsp;mit Codingsystem&nbsp;<a class="descriptionLink" target="_top" href="https://gematik.de/fhir/erp/CodeSystem/GEM_ERP_CS_DocumentType">https://gematik.de/fhir/erp/CodeSystem/GEM_ERP_CS_DocumentType</a>&nbsp;= 1 über eine interne, eindeutige UUID referenzieren,</span></span></li>
    </ul>damit der nachfolgende Workflow ausschließlich auf Basis medizinisch korrekter und vom Leistungserbringer mittels Signatur freigegebener Daten erfolgt. <b>&lt;=</b></p>
  </div>
  <p id="polarion_227">Hinweis: Das Signaturzertifikat der ZOD-Karten (der Zahnärzteschaft) beinhalten die professionOID oid_zahnarzt.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116780|project=Mainline_OPB1|layout_workitem_type=leafRequirement|layout_content_type=section|serverPath=https://polarion.int.gematik.de">
   <p><b>A_21370</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim berechtigten Aufruf der Operation POST /Task/&lt;id&gt;/$activate prüfen, dass die PrescriptionID des Tasks mit der PrescriptionID im übergebenen QES-Datensatz übereinstimmt und der Präfix der PrescriptionID gleich dem Flowtype des zu aktivierenden Tasks ist und andernfalls die Operation mit dem http-Fehlercode 400 abbrechen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-126636">
   <p><b>A_22487</b></p>
   <p>Der E-Rezept-Fachdienst MUSS den Aufruf der http-POST-Operation /Task/&lt;id&gt;/$activate mit einem Fehlercode 400 und Hinweis im OperationOutcome auf "<span style="font-size: 10pt;line-height: 1.5;">Ausstellungsdatum und Signaturzeitpunkt weichen voneinander ab, müssen aber taggleich sein</span>" als ungültig abweisen, wenn das Datum <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">authoredOn</span> zur Gültigkeitsberechnung des E-Rezepts nicht dem Datum in QES.Erstellung im Signaturobjekt entspricht. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-132105">
   <p><b>A_22925</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aktivieren eines Tasks mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$activate die Operation mit dem Fehlercode 400 und einem Hinweis auf die Längenprüfung der PZN ("Länge PZN unzulässig (muss 8-stellig sein))" im OperationOutcome) abbrechen,&nbsp;wenn die PZN einer übergebenen PZN-Verordnung in&nbsp;KBV_PR_ERP_Medication_PZN.code.coding.code nicht 8-stellig ist. <b>&lt;=</b></p>
  </div>
  <p id="polarion_234">Hinweis:&nbsp;PZNs können eine führende "0" enthalten.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-132127">
   <p><b>A_22927</b></p>
   <p>Der E-Rezept-Fachdienst MUSS&nbsp;beim Aktivieren eines Tasks mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$activate den übergebenen Verordnungsdatensatz auf das Vorhandensein von Extensions prüfen, die nicht in den FHIR-Profilen&nbsp;"kbv.ita.erp 1.0.2" explizit an den zu verwendenden Stellen spezifiziert sind und<br> 
    <ol> 
     <li>für eine Dauer von 6 Wochen (konfigurierbar) mit dem abweichenden Http-Statuscode 202 Accepted ab dem PU-Release dieser Funktion als valide akzeptieren</li> 
     <li>diese Verordnungen (nach 6 Wochen nach Release) als ungültig und Fehlermeldung (Http-Statuscode 400, "unintendierte Verwendung von Extensions an unspezifizierter Stelle im Verordnungsdatensatz") ablehnen</li> 
    </ol> damit undefiniertes Verhalten in Clientsystemen und widersprüchliche Angaben in der Verordnung verhindert werden. <b>&lt;=</b></p>
  </div>
  <p id="polarion_205">Der E-Rezept-Fachdienst setzt damit eine Übergangsregelung "closed slicing light" um – bis zur Umsetzung in den FHIR-Profilen des Verordnungsdatensatzes.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-128461">
   <p><b>A_22347-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Zugriff auf einen Task des Flowtype <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.extension:flowType = 200</span> oder <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">209</span> mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$activate prüfen, ob <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Coverage.type.coding.code</span> mit dem Wert "PKV" belegt ist und im Fehlerfall die Operation mit Http-Fehlercode 400 abbrechen, um sicherzustellen, dass diese Workflows nur für E-Rezepte für PKV-Versicherte genutzt werden<span style="font-size: 10pt;line-height: 1.5;">.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124871">
   <p><b>A_22231</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aktivieren eines Tasks mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$activate die Operation mit dem Fehlercode 400 und einem Hinweis auf den Ausschluss von Betäubungsmittel und T-Rezepten ("BTM und Thalidomid nicht zulässig" im OperationOutcome) abbrechen,&nbsp;wenn der übergebene QES-Datensatz als Betäubungsmittel- oder Thalidomid-Verordnung (Bundle.Medication.extension:KBV_EX_ERP_Medication_Category:code ungleich "00") gekennzeichnet ist. <b>&lt;=</b></p>
  </div>
  <p id="polarion_196">Hinweis: Dieser Ausschluss erfolgt für alle aktuell spezifizierten FlowTypes (160, 169, 200). In einer späteren Ausbaustufe sollen Betäubungsmittel und Verordnungen nach&nbsp;AMVV § 3a Abs. 1 explizit unterstützt werden. Die konkreten Festlegungen dazu werden in einem Folgerelease getroffen.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124776">
   <p><b>A_22222</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aktivieren eines Tasks mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$activate die Operation mit dem Fehlercode 400 und einem Hinweis auf den Ausschluss der Kostenträger <span style="font-size: 10pt;line-height: 1.5;"><span style="color: #172B4D;">("Kostenträger nicht zulässig" im OperationOutcome) abbrechen, wenn der übergebene QES-Datensatz einen unzulässigen Kostenträger (Bundle.Coverage.type:</span><span style="color: #333333;">KBV_VS_FOR_Payor_type</span><span style="color: #172B4D;">&nbsp;ungleich [GKV, PKV,&nbsp;SEL, BG +&nbsp;</span><span style="color: #333333;">KBV_CS_FOR_Payor_Type_KBV:</span><span style="color: #172B4D;">UK]) enthält.</span></span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_189">Dieser Ausschluss erfolgt temporär, in einer späteren Version können weitere Kostenträger explizit unterstützt werden. Die konkreten Festlegungen dazu werden in einem Folgerelease getroffen.</p>
  <p id="polarion_193"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-108465">
   <p><b>A_19999</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aktivieren eines Tasks aus dem Feld <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.performerType</span>&nbsp;die&nbsp;Prozessparameter des Tasks gemäß [gemSpec_DM_eRp#19445] ableiten und befüllen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_166"> <span id="polarion-comment:436"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133167">
   <p><b>A_19127-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS im Zugriff auf einen Task mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$activate und bei gültiger qualifizierter elektronischer Signatur die KVNR des Patienten dem&nbsp;Identifier&nbsp;<a class="descriptionLink" target="_top" href="http://fhir.de/sid/gkv/kvid-10">http://fhir.de/sid/gkv/kvid-10</a>&nbsp;bzw.&nbsp;<a class="descriptionLink" target="_top" href="http://fhir.de/sid/pkv/kvid-10">http://fhir.de/sid/pkv/kvid-10</a> der Patient-Ressource im&nbsp;signierten E-Rezept-Bundle gemäß&nbsp;<a class="descriptionLink" target="_top" href="https://fhir.kbv.de/StructureDefinition/KBV_PR_ERP_Bundle">https://fhir.kbv.de/StructureDefinition/KBV_PR_ERP_Bundle</a>&nbsp;des QES-Datensatzes entnehmen und diese als <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Identifier</span> mit dem System&nbsp;<a class="descriptionLink" target="_top" href="http://fhir.de/sid/gkv/kvid-10">http://fhir.de/sid/gkv/kvid-10</a>&nbsp;bzw.&nbsp;<a class="descriptionLink" target="_top" href="http://fhir.de/sid/pkv/kvid-10">http://fhir.de/sid/pkv/kvid-10</a> dem Task in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.for</span> hinzufügen, damit ausschließlich eine gültige, vom Arzt signierte Patientenreferenz im Workflow verwendet wird. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103593">
   <p><b>A_19128</b></p>
   <p>Der E-Rezept-Fachdienst MUSS die zulässige Aktivierung eines Tasks mittels /Task/&lt;id&gt;/$activate-Operation im Status <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.status = ready&nbsp;</span>vollziehen und bei erfolgreichem Abschluss der Operation die Ressource Task im HTTP-Body der HTTP-Response zurückgeben, damit der verordnende Leistungserbringer über den erfolgreichen Abschluss der Operation in Kenntnis gesetzt wird. <b>&lt;=</b></p>
  </div>
  <p id="polarion_47"> <span id="polarion-comment:459"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133088">
   <p><b>A_19029-05</b></p>
   <p>Der E-Rezept-Fachdienst MUSS das bei der Operation /Task/&lt;id&gt;/$activate im QES-Datensatz enthaltene FHIR-E-Rezept-Bundle vom Profil&nbsp;<a title="https://fhir.kbv.de/StructureDefinition/KBV_PR_ERP_Bundle" class="sc-ugnQR JATWu" target="_top" href="https://fhir.kbv.de/StructureDefinition/KBV_PR_ERP_Bundle">https://fhir.kbv.de/StructureDefinition/KBV_PR_ERP_Bundle</a>&nbsp;in ein Bundle gleichen Typs in JSON-Repräsentation beim Aufruf der HTTP-GET-Operation auf den Endpunkt /Task/&lt;id&gt; zurückliefern.<br>Der E-Rezept-Fachdienst MUSS für diesen <br>
    <ul>
     <li>einen neuen, eindeutigen Identifier für die <a title="http://Bundle.id" class="sc-ugnQR JATWu" target="_top" href="http://bundle.id/">Bundle.id</a> als UUID generieren,</li>
     <li>das Bundle entsprechend der Kanonisierungsregeln&nbsp;<a title="http://hl7.org/fhir/canonicalization/json#static" class="sc-ugnQR JATWu" target="_top" href="http://hl7.org/fhir/canonicalization/json#static">http://hl7.org/fhir/canonicalization/json#static</a>&nbsp;normalisieren&nbsp;<span style="font-size: 10pt;line-height: 1.5;">(Bundle.text und Bundle.meta im "root-Element" entfernen)</span> und</li>
     <li>mit der Signaturidentität des Fachdienstes ID.FD.OSIG gemäß [FHIR-Sig] signieren und</li>
     <li>das signierte Bundle mit Referenz in Task.input mit Codingsystem&nbsp;<a class="descriptionLink" target="_top" href="https://gematik.de/fhir/erp/CodeSystem/GEM_ERP_CS_DocumentType">https://gematik.de/fhir/erp/CodeSystem/GEM_ERP_CS_DocumentType</a>&nbsp;= 2 zurück liefern,</li>
    </ul>damit der Versicherte einen Nachweis über die Integrität der gespeicherten Daten einsehen kann. <b>&lt;=</b></p>
  </div>
  <p id="polarion_192"> Die Festlegungen in [FHIR-Sig] sind in Teilen unspezifisch, konkrete Beispiele finden sich in der gematik-API-Beschreibung für das E-Rezept auf <a href="https://github.com/gematik/api-erp" target="_top" class="descriptionLink">https://github.com/gematik/api-erp</a>&nbsp; </p>
  <p id="polarion_43"> Die Signatur soll als JSON Web Signature [JWS] detached erstellt werden, dementsprechend bleibt das <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">data</span>-Feld der JWS-Struktur leer. Im JWS-Header muss das Zertifikat C.FD.SIG eingebettet werden, mit dessen zugehörigen privaten Signaturschlüssel signiert wurde. Als Wert für targetFormat ist der MimeType&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">application/fhir+json</span>&nbsp;und für sigFormat ist der MimeType&nbsp;<span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #333333;line-height: 1.5;">application/jose</span><span style="font-size: 9pt;color: #333333;line-height: 1.5;">&nbsp;</span>zu verwenden. </p>
  <pre id="polarion_49"></pre>
  <h6 id="polarion_wiki macro name=module-workitem;params=id=ML-132669">6.1.2.2.1 POST /Task/&lt;id&gt;/$activate - Mehrfachverordnung</h6>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-132102">
   <p><b>A_22627-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aktivieren eines Tasks mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$activate die Operation mit dem Fehlercode 400 abbrechen, wenn die Verordnung als Mehrfachverordnung (<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">MedicationRequest.extension:Mehrfachverordnung.extension:Kennzeichen = true</span>) gekennzeichnet und der Flowtype ungleich 160, 169, 200 oder 209 ist, weil Mehrfachverordnungen nur für die Verordnungen von apothekenpflichtigen Arzneimittel (kein BtM, kein T-Rezept) zulässig sind. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-128285">
   <p><b>A_22628</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aktivieren eines Tasks mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$activate die Operation mit dem Fehlercode 400 abbrechen, wenn die Verordnung als Mehrfachverordnung (<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">MedicationRequest.extension:Mehrfachverordnung.extension:Kennzeichen = true</span>) gekennzeichnet und der Numerator oder Denominator größer als 4 ist, weil eine Mehrfachverordnungen aus maximal 4 Teilverordnungen bestehen darf. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-128734">
   <p><b>A_22704</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aktivieren eines Tasks mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$activate die Operation mit dem Fehlercode 400 abbrechen, wenn die Verordnung als Mehrfachverordnung (<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">MedicationRequest.extension:Mehrfachverordnung.extension:Kennzeichen = true</span>) gekennzeichnet und der Numerator kleiner als 1 ist. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-128286">
   <p><b>A_22629</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aktivieren eines Tasks mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$activate die Operation mit dem Fehlercode 400 abbrechen, wenn die Verordnung als Mehrfachverordnung (<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">MedicationRequest.extension:Mehrfachverordnung.extension:Kennzeichen = true</span>) gekennzeichnet und der Denominator kleiner als 2 ist, weil eine Mehrfachverordnungen aus mindestens 2 Teilverordnungen bestehen muss. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-128294">
   <p><b>A_22630</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aktivieren eines Tasks mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$activate die Operation mit dem Fehlercode 400 abbrechen, wenn die Verordnung als Mehrfachverordnung (<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">MedicationRequest.extension:Mehrfachverordnung.extension:Kennzeichen = true</span>) gekennzeichnet und der Numerator größer als der Denominator ist. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-128295">
   <p><b>A_22631</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aktivieren eines Tasks mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$activate die Operation mit dem Fehlercode 400 abbrechen, wenn die Verordnung nicht als Mehrfachverordnung (<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">MedicationRequest.extension:Mehrfachverordnung.extension:Kennzeichen = false</span>) gekennzeichnet ist, aber eine Extension&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Nummerierung</span>&nbsp;oder&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Zeitraum&nbsp;</span>enthält, weil normale Verordnungen keine MVO-Angaben enthalten dürfen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-128291">
   <p><b>A_22632</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aktivieren eines Tasks mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$activate die Operation mit dem Fehlercode 400 abbrechen, wenn die Verordnung als Mehrfachverordnung (<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">MedicationRequest.extension:Mehrfachverordnung.extension:Kennzeichen = true</span>) und als Entlassrezept (&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">code="04"</span>&nbsp;oder <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">"14"</span> in Extension&nbsp; <a class="descriptionLink" target="_top" href="https://fhir.kbv.de/StructureDefinition/KBV_EX_FOR_Legal_basis">https://fhir.kbv.de/StructureDefinition/KBV_EX_FOR_Legal_basis</a>&nbsp;in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Bundle.Composition.extention:rechtsgrundlage</span>) gekennzeichnet ist, weil für Entlassrezepte keine Mehrfachverordnungen zulässig sind. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-128293">
   <p><b>A_22633</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aktivieren eines Tasks mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$activate die Operation mit dem Fehlercode 400 abbrechen, wenn die Verordnung als Mehrfachverordnung (<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">MedicationRequest.extension:Mehrfachverordnung.extension:Kennzeichen = true</span>) und als Ersatzverordnung (&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">code="10"</span> oder <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">"11"</span>&nbsp;oder "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">17</span>" in Extension&nbsp; <a class="descriptionLink" target="_top" href="https://fhir.kbv.de/StructureDefinition/KBV_EX_FOR_Legal_basis">https://fhir.kbv.de/StructureDefinition/KBV_EX_FOR_Legal_basis</a>&nbsp;in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Bundle.Composition.extention:rechtsgrundlage</span>) gekennzeichnet ist, weil für Ersatzverordnungen&nbsp;keine Mehrfachverordnungen zulässig sind. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-128288">
   <p><b>A_22634</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aktivieren eines Tasks mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$activate die Operation mit dem Fehlercode 400 abbrechen, wenn die Verordnung als Mehrfachverordnung (<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">MedicationRequest.extension:Mehrfachverordnung.extension:Kennzeichen = true</span>) gekennzeichnet ist und der Beginn der Einlösefrist (<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">MedicationRequest.extension:Mehrfachverordnung.extension:Zeitraum.value[x]:valuePeriod.start</span>) nicht angegeben ist, weil die Information des Beginns der Einlösefrist notwendig ist, um den Gültigkeitszeitraum zu ermitteln. <b>&lt;=</b></p>
  </div>
  <p id="polarion_206"> Hinweis: Ist das Gültigkeitsende-Datum&nbsp; (<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">MedicationRequest.extension:Mehrfachverordnung.extension:Zeitraum.value[x]:valuePeriod.end</span>) nicht angegeben, kann die Teilverordnung bis zum Tag [Ausstellungsdatum + 365] eingelöst und für E-Rezepte des Workflow-Typen 160 zu Lasten der GKV abgerechnet werden. </p>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-103595">6.1.2.3 POST /Task/&lt;id&gt;/$accept</h5>
  <p id="polarion_151">Die FHIR-Operation $accept weist ein E-Rezept einem abgebenden Leistungserbringer (bzw. der Apotheke als Leistungserbringerinstitution) als "in Abgabe" befindlich über die &lt;id&gt; referenzierten Tasks zu. Diese Operation steht ausschließlich abgebenden Leistungserbringern in Kenntnis des AccessCodes zur Verfügung.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103596">
   <p><b>A_19166</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Abrufen eines Tasks für ein E-Rezept mittels HTTP-POST/$accept-Operation auf den in der URL referenzierten&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Task/&lt;id&gt;</span> sicherstellen, dass ausschließlich abgebende Leistungserbringer in der Rolle<br> 
    <ul> 
     <li>oid_oeffentliche_apotheke</li> 
     <li>oid_krankenhausapotheke</li> 
    </ul> die Operation am Fachdienst aufrufen dürfen und die Rolle "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">professionOID</span>" des Aufrufers im&nbsp;ACCESS_TOKEN im HTTP-RequestHeader "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Authorization</span>" feststellen, damit E-Rezepte nicht durch Unberechtigte abgerufen werden können. <b>&lt;=</b></p>
  </div>
  <p id="polarion_191"> <span id="polarion-comment:458"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133089">
   <p><b>A_19167-03</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Zugriff auf einen Task mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$accept den im HTTP-Header "X-AccessCode" oder URL-Parameter "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">?ac=...</span>" übertragenen AccessCode gegen den im referenzierten Task gespeicherten AccessCode&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.identifier:AccessCode</span> als&nbsp;<a href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_AccessCode" target="_top" class="descriptionLink">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_AccessCode</a> prüfen und bei Ungleichheit oder Fehlen des URL-Parameters die Operation mit dem HTTP-Fehlercode 403 abbrechen, damit Zugriffe auf diesen Datensatz nur durch Berechtigte in Kenntnis des AccessCodes erfolgen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103598">
   <p><b>A_19168</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Zugriff auf einen Task mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$accept die Operation mit dem HTTP-Fehlercode 409 abbrechen, wenn der Status <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.status = completed,&nbsp;Task.status = in-progress</span> oder <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.status = draft</span> ist, damit ein bereits in Abgabe befindliches oder beliefertes E-Rezept nicht durch eine zweite Apotheke bearbeitet werden kann. <b>&lt;=</b></p>
  </div>
  <p id="polarion_169"> <span id="polarion-comment:457"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133100">
   <p><b>A_19169-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Zugriff auf einen Task mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$accept&nbsp;den Status des Tasks auf <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.status = in-progress</span> setzen,&nbsp;eine 256 Bit&nbsp;Zufallszahl mit einer Mindestentropie von 120 Bit erzeug<span style="font-size: 10pt;line-height: 1.5;">en,&nbsp;hexadezimal kodieren ([0-9a-f]{64})</span> und diese im zu speichernden Task als externe ID in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.identifier:Secret</span> als&nbsp;<a href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Secret" target="_top" class="descriptionLink">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Secret</a> hinzufügen&nbsp;und den Task im Bundle mit dem in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.input</span> <span style="font-family: Arial, Helvetica;">mit Codingsystem&nbsp;<a href="https://gematik.de/fhir/erp/CodeSystem/GEM_ERP_CS_DocumentType" target="_top" class="descriptionLink">https://gematik.de/fhir/erp/CodeSystem/GEM_ERP_CS_DocumentType</a>&nbsp;</span><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">= 1</span> referenzierten QES-Datensatz als Binary-Ressource <a href="https://www.hl7.org/fhir/binary.html" target="_top" class="descriptionLink">https://www.hl7.org/fhir/binary.html</a>&nbsp;&nbsp;an den Aufrufer zurückgeben, damit das E-Rezept für die nachfolgende Bearbeitung durch den abrufenden Apotheker reserviert ist. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124484">
   <p><b>A_22110</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Zugriff auf einen Task des Flowtype <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.extension:flowType = 200</span> oder <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">209</span> mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$accept,&nbsp;<span style="font-size: 10pt;line-height: 1.5;">wenn für die KVNR des begünstigten Versicherten (Task.for)&nbsp; eine Consent Ressource mit&nbsp;Consent.patient.identifier = KVNR und&nbsp;Consent.category.coding.code = "CHARGCONS"&nbsp;existiert, das Response Bundle um die Consent Ressource ergänzen,&nbsp;um der abgebenden LEI die Information zu übermitteln, ob der Versicherte eine Einwilligung zum Speichern der Abrechnungsinformationen auf dem E-Rezept-Fachdienst erteilt hat.</span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_190"> <span id="polarion-comment:456"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133101">
   <p><b>A_19149-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Zugriff auf einen Task mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$accept die Operation mit dem HTTP-Fehlercode 410 abbrechen, wenn der referenzierte /Task/&lt;id&gt; existiert, jedoch kein AccessCode im Task.identifier:AccessCode als&nbsp;<a href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_AccessCode" target="_top" class="descriptionLink">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_AccessCode</a> vorhanden ist oder der Status <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.status = cancelled</span> ist, damit ein Apotheker den Versicherten über die zwischenzeitliche Löschung des Datensatzes in Kenntnis setzen kann. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-128289">
   <p><b>A_22635</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Zugriff auf einen Task mittels HTTP-POST-Operation über <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Task/&lt;id&gt;/$accept</span> die Operation mit dem Fehlercode 403&nbsp;abbrechen, wenn die Verordnung als Mehrfachverordnung (<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">MedicationRequest.extension:Mehrfachverordnung.extension:Kennzeichen = true</span>) gekennzeichnet ist und und der Beginn der Einlösefrist (<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">MedicationRequest.extension:Mehrfachverordnung.extension:Zeitraum.value[x]:valuePeriod.start</span>) zu einem späteren Zeitpunkt als das aktuelle Datum liegt, da Teilverordnungen von Mehrfachverordnungen erst ab Beginn der Einlösefrist abgerufen werden dürfen.&nbsp;<span style="font-size: 10pt;line-height: 1.5;">Im Falle dieses Fehlers ist im OperationOutcome des Response der Beginn der Einlösefrist wie folgt anzugeben: „Teilverordnung ab <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&lt;MedicationRequest.extension:Mehrfachverordnung.extension:Zeitraum.value[x]:valuePeriod.start&gt;</span> einlösbar.“&nbsp;</span> <b>&lt;=</b></p>
  </div>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-103601">6.1.2.4 POST /Task/&lt;id&gt;/$reject</h5>
  <p id="polarion_152">Die FHIR-Operation $reject nutzt die abgebende LEI, um ein E-Rezept zurück zu geben. Anschließend kann das E-Rezept von einer anderen Apotheke in Kenntnis des AccessCodes und der ID des Tasks wieder abgerufen werden oder der Versicherte das E-Rezept bei Bedarf löschen.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116829">
   <p><b>A_19170-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Zurückweisen eines Tasks für ein E-Rezept mittels HTTP-POST/$reject-Operation auf den in der URL referenzierten&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Task/&lt;id&gt;</span> sicherstellen, dass ausschließlich abgebende Leistungserbringer in der Rolle<br> 
    <ul>
     <li>oid_oeffentliche_apotheke</li>
     <li>oid_krankenhausapotheke</li>
    </ul>die Operation am Fachdienst aufrufen dürfen und die Rolle "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">professionOID</span>" des Aufrufers im&nbsp;ACCESS_TOKEN im HTTP-RequestHeader "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Authorization</span>" feststellen, damit das E-Rezept nicht durch einen Unberechtigten zurückgewiesen werden kann. <b>&lt;=</b></p>
  </div>
  <p id="polarion_185"> <span id="polarion-comment:455"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133113">
   <p><b>A_19171-02</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Zugriff auf einen Task mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$reject das im URL-Parameter "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">?secret=...</span>" übertragene Secret gegen das im referenzierten Task gespeicherte Secret <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.identifier:Secret</span> als&nbsp;<a href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Secret" target="_top" class="descriptionLink">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Secret</a> und auf <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.status = in-progress</span> prüfen und bei Ungleichheit oder Fehlen des URL-Parameters die Operation mit dem HTTP-Fehlercode 403 abbrechen, damit der Zugriff auf diesen Datensatz nur durch den Berechtigten in Kenntnis des Secrets erfolgt. <b>&lt;=</b></p>
  </div>
  <p id="polarion_188"> <span id="polarion-comment:454"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133114">
   <p><b>A_19172-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Zurückweisen eines Tasks mittels&nbsp;HTTP-POST-Operation über /Task/&lt;id&gt;/$reject die externe ID in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.identifier:Secret</span> als&nbsp;<a href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Secret" target="_top" class="descriptionLink">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Secret</a> löschen und den Status des referenzierten Tasks auf <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.status = ready</span> setzen, damit nachfolgende Zugriffe auf diesen Datensatz durch Berechtigte in Kenntnis des AccessCodes erfolgen können. <b>&lt;=</b></p>
  </div>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-103605">6.1.2.5 POST /Task/&lt;id&gt;/$close</h5>
  <p id="polarion_98">Die FHIR-Operation $close beendet den E-Rezept-Workflow des unter der &lt;id&gt; geführten Tasks, erzeugt eine Quittung als Signatur über das vom abgebenden Leistungserbringer eingestellte MedicationDispense und speichert die vom Apotheker übermittelten Dispensierinformationen für den Versicherten.&nbsp;Diese Operation steht ausschließlich abgebenden Leistungserbringern in Kenntnis eines generierten Secrets zur Verfügung.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103606">
   <p><b>A_19230</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Beenden eines Tasks für ein E-Rezept mittels HTTP-POST/$close-Operation auf den in der URL referenzierten&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Task/&lt;id&gt;</span> sicherstellen, dass ausschließlich abgebende Leistungserbringer in der Rolle<br> 
    <ul> 
     <li>oid_oeffentliche_apotheke</li> 
     <li>oid_krankenhausapotheke</li> 
    </ul> die Operation am Fachdienst aufrufen dürfen und die Rolle "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">professionOID</span>" des Aufrufers im&nbsp;ACCESS_TOKEN im HTTP-RequestHeader "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Authorization</span>" feststellen, damit der E-Rezept-Workflow nicht durch einen Unberechtigten abgeschlossen werden kann. <b>&lt;=</b></p>
  </div>
  <p id="polarion_182"> <span id="polarion-comment:453"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133125">
   <p><b>A_19231-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Beenden eines&nbsp;Tasks mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$close das im URL-Parameter "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">?secret=...</span>" übertragene Secret gegen das im referenzierten Task gespeicherte Secret <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.identifier:Secret</span> als&nbsp;<a href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Secret" target="_top" class="descriptionLink">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Secret</a> und auf <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.status = in-progress&nbsp;</span>prüfen und bei Ungleichheit oder Fehlen des URL-Parameters die Operation mit dem HTTP-Fehlercode 403 abbrechen, damit der Zugriff auf diesen Datensatz nur durch den Berechtigten in Kenntnis des Secrets erfolgt. <b>&lt;=</b></p>
  </div>
  <p id="polarion_183"> <span id="polarion-comment:452"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133126">
   <p><b>A_19248-02</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS beim Beenden eines Tasks mittels /Task/&lt;id&gt;/$close das im http-Body des Requests enthaltene MedicationDispense-Objekt gegen das&nbsp;Profil&nbsp;<a href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_MedicationDispense" target="_top" class="descriptionLink">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_MedicationDispense</a>&nbsp;prüfen, insbesondere</span> <br> 
    <ul> 
     <li><span style="font-size: 10pt;line-height: 1.5;">die Korrektheit der Rezept-ID&nbsp;<a href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_PrescriptionId" target="_top" class="descriptionLink">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_PrescriptionId</a>&nbsp;als</span> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">MedicationDispense.identifier</span><span style="font-size: 10pt;line-height: 1.5;">&nbsp;,</span></li> 
     <li><span style="font-size: 10pt;line-height: 1.5;">die KVNR&nbsp;des Versicherten im referenzierten Task (<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.for</span>) gegen KVNR in&nbsp;</span><span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">MedicationDispense.subject:identifier</span><span style="font-size: 10pt;line-height: 1.5;">&nbsp;und</span></li> 
     <li><span style="font-size: 10pt;line-height: 1.5;">ob die Telematik-ID der Apotheke gemäß ACCESS_TOKEN mit dem Wert in&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">MedicationDispense.performer.actor:identifier</span>&nbsp;übereinstimmt.</span></li> 
    </ul> Der E-Rezept-Fachdienst MUSS die Referenz auf den aufgerufenen Task&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Task/&lt;id&gt;</span>&nbsp;als&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">MedicationDispense.supportingInformation</span>&nbsp;übernehmen und die MedicationDispense für den Abruf durch den Versicherten speichern. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124033">
   <p><b>A_22073</b></p>
   <p><span style="font-size: 10pt;color: #172B4D;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS bei der Validierung der MedicationDispense das Feld whenHandedOver&nbsp;(und sofern vorhanden das Feld whenPrepared) übergangsweise als Datum entweder mit Uhrzeitangabe oder ausschließlich als Datum (10-stellig: "yyyy-mm-dd") gemäß des FHIR-Datentyps dateTime akzeptieren.</span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_178">In einem Folgerelease der FHIR-Profildefinition für MedicationDispense wird ein Contraint für das 10-stellige Datum eingeführt, sodass ab dessen Gültigkeitsbeginn der Fachdienst in den Feldern whenHandedOver und whenPrepared ausschließlich Werte im 10-stelligen Datumsformat akzeptiert.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-123996">
   <p><b>A_22069</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Beenden eines Tasks mittels /Task/&lt;id&gt;/$close auch die Übergabe mehrerer MedicationDispense-Objekte in einem validen Standard-FHIR-Bundle&nbsp;im http-Body des Requests ermöglichen und die zweite, dritte usw. MedicationDispense für den Abruf unter einer einzelnen ID (z.B. MedicationDispense/&lt;prescriptionID&gt; +"suffix") durch den Versicherten speichern. <b>&lt;=</b></p>
  </div>
  <p id="polarion_175">Hinweis: Als Suffix kann ein Zähler "-1", "-2", etc. an die PrescriptionID angehangen werden, um für jede MedicationDispense eine eineindeutige ID zu erzeugen.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103609">
   <p><b>A_19232</b></p>
   <p>Der E-Rezept-Fachdienst MUSS die zulässige Beendigung eines Tasks mittels /Task/&lt;id&gt;/$close-Operation im Status <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.status = completed&nbsp;</span>vollziehen, damit der Workflow für den Versicherten als beendet und das E-Rezept somit als eingelöst dargestellt wird. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110769">
   <p><b>A_20513</b></p>
   <p>Der E-Rezept-Fachdienst MUSS bei erfolgreicher Beendigung eines Tasks mittels /Task/&lt;id&gt;/$close-Operation alle Communication-Ressourcen löschen, die eine Referenz auf diesen Task in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Communication.basedOn</span> enthalten, damit nicht mehr benötigte Informationen über die Kommunikation zur Einlösung des E-Rezepts vom E-Rezept-Fachdienst entfernt werden. <b>&lt;=</b></p>
  </div>
  <p id="polarion_203"> <span id="polarion-comment:451"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133127">
   <p><b>A_19233-05</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Beenden eines Tasks mittels /Task/&lt;id&gt;/$close ein Quittungsbundle gemäß des FHIR-Profils&nbsp;<a class="descriptionLink" target="_top" href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Bundle">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Bundle</a> mit folgenden Informationen erstellen:<br> 
    <ul>
     <li>Telematik-ID der aufrufenden Apotheke als <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Beneficiary</span> in die erxComposition</li>
     <li>Zeitstempel des Statuswechsel des Tasks "in-progress" in event.period.start</li>
     <li>aktueller Zeitstempel in&nbsp;event.period.end</li>
     <li>Identifier PrescriptionID des Task als identifier des Quittungs-Bundle</li>
     <li>Device-Ressource mit Fachdienstinformationen als Autor der Signatur</li>
     <li>Base64Binary-Ressource mit Binary.data = &lt;base64-codierter Hashwert aus der QES-Signatur des dem Task zugrunde liegenden Verordnungsdatensatzes&gt; und contentTpe = "application/octet-stream"</li>
    </ul>und dieses Quittungs-Bundle mit der Signaturidentität des Fachdienstes ID.FD.OSIG gemäß&nbsp;[RFC5652] mit&nbsp;Profil CAdES-BES ([CAdES]) im Enveloping signieren.<br>In die Signatur wird die letzte OCSP-Antwort der regelmäßigen Statusprüfung des Signaturzertifikats C.FD.OSIG eingebettet.<br>Das Signatur-Ergebnis wird als <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">dss:Base64Signature</span>-Objekt in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Bundle.signature</span> eingebettet&nbsp;und dieses Quittungs-Bundle mit Referenz in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.output</span> <span style="font-family: Arial, Helvetica;">mit Codingsystem&nbsp;<a class="descriptionLink" target="_top" href="https://gematik.de/fhir/erp/CodeSystem/GEM_ERP_CS_DocumentType">https://gematik.de/fhir/erp/CodeSystem/GEM_ERP_CS_DocumentType</a>&nbsp;</span><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">= 3&nbsp;</span>gespeichert sowie als Response des http-Requests an den Aufrufer zurückgeben, damit der Apotheker einen Nachweis über den ordnungsgemäßen Abschluss des E-Rezept-Workflows als Quittung erhält. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-129972">
   <p><b>A_22919</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS, falls keine OCSP-Response für das Signaturzertifikat der Quittung vorliegt bzw. die letzte vorliegende OCSP-Response älter als 24 h ist, die Operation mit dem Fehler 503 abbrechen.</span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_180"></p>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-103611">6.1.2.6 POST /Task/&lt;id&gt;/$abort</h5>
  <p id="polarion_153"> Die FHIR-Operation $abort bricht einen&nbsp;unter der &lt;id&gt; angelegten Task als&nbsp;aktiven&nbsp;E-Rezept-Workflow ab und führt zum Löschen aller personenbezogenen und medizinischen Daten. Diese Operation steht <span style="font-size: 10pt;line-height: 1.5;">dem Versicherten, für den das E-Rezept erstellt wurde, sowie&nbsp;</span>allen Nutzern in Kenntnis des AccessCodes (verordnende und abgebende Leistungserbringer, Vertreter)&nbsp; zur Verfügung. </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103612">
   <p><b>A_19026</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Löschen eines E-Rezepts über&nbsp;den mittels der &lt;id&gt; adressierten <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Task/&lt;id&gt;/$abort</span> sicherstellen, dass ausschließlich Nutzer in der Rolle <br> 
    <ul>
     <li>oid_versicherter</li>
     <li>oid_arzt</li>
     <li>oid_zahnarzt</li>
     <li>oid_praxis_arzt</li>
     <li>oid_zahnarztpraxis</li>
     <li>oid_praxis_psychotherapeut</li>
     <li>oid_krankenhaus</li>
     <li>oid_oeffentliche_apotheke</li>
     <li>oid_krankenhausapotheke</li>
    </ul>die Operation am Fachdienst aufrufen dürfen und die Rolle "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">professionOID</span>" des Aufrufers im&nbsp;ACCESS_TOKEN im HTTP-RequestHeader "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Authorization</span>" feststellen, damit E-Rezepte nicht durch Unberechtigte gelöscht werden können. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103613">
   <p><b>A_19145</b></p>
   <p>Der E-Rezept-Fachdienst MUSS das Löschen eines E-Rezepts über&nbsp;den mittels der &lt;id&gt; adressierten <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Task/&lt;id&gt;/$abort</span> verhindern und die Operation mit dem HTTP-Fehlercode 403&nbsp;abweisen, wenn der Status des adressierten Tasks gleich "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">in-progress</span>" ist und die Rolle des aufrufenden Nutzers&nbsp;einer der folgenden Rollen entspricht:<br> 
    <ul>
     <li>oid_versicherter</li>
     <li>oid_arzt</li>
     <li>oid_zahnarzt</li>
     <li>oid_praxis_arzt</li>
     <li>oid_zahnarztpraxis</li>
     <li>oid_praxis_psychotherapeut</li>
     <li>oid_krankenhaus</li>
    </ul>damit Nutzer außerhalb der Apotheke keine Rezepte löschen, die sich aktuell in Belieferung befinden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103614">
   <p><b>A_19146</b></p>
   <p>Der E-Rezept-Fachdienst MUSS das Löschen eines E-Rezepts über&nbsp;den mittels der &lt;id&gt; adressierten <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Task/&lt;id&gt;/$abort</span> verhindern und die Operation mit dem HTTP-Fehlercode 403 abweisen, wenn der Status des adressierten Tasks&nbsp;<span style="text-decoration: underline;">un</span>gleich "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">in-progress</span>" ist und die Rolle des aufrufenden Nutzers einer der folgenden Rollen entspricht:<br> 
    <ul>
     <li>oid_oeffentliche_apotheke</li>
     <li>oid_krankenhausapotheke</li>
    </ul>damit kein Apotheker ein Rezept löscht, das ihm nicht ausdrücklich zugewiesen wurde. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124413">
   <p><b>A_22102</b></p>
   <p>Der E-Rezept-Fachdienst MUSS das Löschen eines E-Rezepts mit dem Flowtype 169&nbsp;über&nbsp;den mittels der &lt;id&gt; adressierten <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Task/&lt;id&gt;/$abort</span> verhindern und die Operation mit dem HTTP-Fehlercode 403 abweisen, wenn der Status des adressierten Tasks&nbsp;<span style="text-decoration: underline;">un</span>gleich "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">completed</span>" ist und die Rolle des aufrufenden Nutzers der folgenden Rollen entspricht:<br> 
    <ul>
     <li>oid_versicherter</li>
    </ul>damit kein Versicherter ein E-Rezept aus dem Workflow 169 löscht, das nicht bereits beliefert wurde. <b>&lt;=</b></p>
  </div>
  <p id="polarion_155"> <span id="polarion-comment:435"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133169">
   <p><b>A_20546-03</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS beim Löschen eines E-Rezepts durch einen Versicherten, wenn der HTTP-Request keinen HTTP-Header "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">X-AccessCode</span>"&nbsp;oder URL-Parameter "?ac=..." enthält, den Versicherten anhand der KVNR aus dem ACCESS_TOKEN im "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Authorization</span>"-Header des HTTP-Requests identifizieren, diese gegen die in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.for</span>&nbsp;hinterlegte KVNR des begünstigten Patienten prüfen&nbsp;und bei Missmatch den Aufruf mit dem HTTP-Fehlercode 403 abweisen, damit ausschließlich der begünstigte Patient als Berechtigter ohne Kenntnis des AccessCodes ein E-Rezept löscht.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-126992">
   <p><b>A_19120-03</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Löschen eines E-Rezepts über&nbsp;den mittels der &lt;id&gt; adressierten <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Task/&lt;id&gt;/$abort</span>&nbsp;durch verordnende Leistungserbringer den im HTTP-Header "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">X-AccessCode</span>" gegen den im referenzierten Task enthaltenen AccessCode prüfen und bei Missmatch oder Fehlen im HTTP-Header oder wenn der Task.Status ungleich "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ready</span>" ist, den Aufruf mit dem HTTP-Fehlercode 403 abweisen, damit ausschließlich die verordnende Leistungserbringerinstitution in Kenntnis des AccessCodes als Berechtigte ein E-Rezept löschen.<br> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103616">
   <p><b>A_19224</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Löschen eines E-Rezepts über&nbsp;den mittels der &lt;id&gt; adressierten <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Task/&lt;id&gt;/$abort</span>&nbsp;durch abgebende Leistungserbringer (Apotheken) das im URL-Parameter "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">?secret=...</span>" übertragene Geheimnis gegen das im referenzierten Task enthaltene Secret in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.identifier</span> prüfen und bei Missmatch oder Fehlen des URL-Parameters den Aufruf mit dem HTTP-Fehlercode 403 abweisen, damit ausschließlich Apotheker in Kenntnis des Secret als Berechtigte ein E-Rezept löschen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-119768">
   <p><b>A_19027-02</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Löschen eines E-Rezepts über&nbsp;den mittels der &lt;id&gt; adressierten <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Task/&lt;id&gt;/$abort</span> alle personenbezogenen medizinischen Daten aus dem referenzierten Task entfernen. Dies gilt insbesondere für: <br> 
    <ul> 
     <li>Task.for (KVNR des Patienten)--&gt; löschen</li> 
     <li>Task.input --&gt; löschen (inkl. aller referenzierten Elemente)</li> 
     <li>Task.output --&gt; löschen (inkl. aller referenzierten Elemente)</li> 
     <li>Task.identifier (AccessCode) --&gt; löschen</li> 
     <li>Task.identifier (Secret, falls vorhanden) --&gt; löschen</li> 
     <li>MedicationDispense --&gt; die in&nbsp;MedicationDispense.supportingInformation auf Task.id verweist</li> 
     <li>Communication --&gt; die in Communication.basedOn auf Task.id verweist</li> 
    </ul> damit dem Betroffenenrecht auf Löschen durch den Versicherten&nbsp;entsprochen wird und beim Löschen durch den Verordnenden dem Versicherten eine aussagekräftige Fehlermeldung durch einen Apotheker vermittelt werden kann. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103618">
   <p><b>A_19121</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Löschen eines E-Rezepts über&nbsp;den mittels der &lt;id&gt; adressierten <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Task/&lt;id&gt;/$abort</span> den Status des Tasks <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.status</span> auf den Wert "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">cancelled</span>" setzen, damit das E-Rezept nicht weiter bearbeitet werden kann. <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-103619">6.2 Ressource MedicationDispense</h3>
  <p id="polarion_50">Dem Versicherten werden über die Ressource MedicationDispense Informationen über ein eingelöstes E-Rezept bereitgestellt. Im MedicationDispense ist dabei die Referenz auf das abgegebene Medikament enthalten. Diese Informationen unterstützen den Versicherten im Versorgungsprozess, indem ihm bspw. mittels dieser Informationen ein digitaler Beipackzettel oder weitere Informationen wie Applikationsanleitungen zur Verfügung gestellt werden können. Der Zugriff auf die Ressource MedicationDispense erfolgt ausschließlich lesend über die http-GET-Operation. Das Löschen erfolgt indirekt über das Löschen des der MedicationDispense zugrunde liegenden Tasks.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-104274">
   <p><b>A_19400</b></p>
   <p>Der E-Rezept-Fachdienst MUSS alle Zugriffe auf die Ressource MedicationDispense mittels der HTTP-Operationen PUT, PATCH, HEAD und DELETE sowie POST unterbinden, damit keine unzulässigen Operationen auf den Rezeptdaten ausgeführt werden können. <b>&lt;=</b></p>
  </div>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-103620">6.2.1 HTTP-Operation GET /MedicationDispense</h4>
  <p id="polarion_135"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-119767">
   <p><b>A_19405-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf&nbsp;der HTTP-GET-Operation auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/MedicationDispense&nbsp;</span>und auf einen konkreten über &lt;id&gt; adressierten <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/MedicationDispense/&lt;id&gt;</span>&nbsp;sicherstellen, dass ausschließlich Versicherte in der Rolle <br> 
    <ul> 
     <li>oid_versicherter</li> 
    </ul> die Operation am Fachdienst aufrufen dürfen und die Rolle "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">professionOID</span>" des Aufrufers im&nbsp;ACCESS_TOKEN im HTTP-RequestHeader "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Authorization</span>" feststellen, damit Dispensierinformationen nicht durch Unberechtigte ausgelesen werden können. <b>&lt;=</b></p>
  </div>
  <p id="polarion_136"> <span id="polarion-comment:434"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133170">
   <p><b>A_19406-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf&nbsp;der HTTP-GET-Operation auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/MedicationDispense&nbsp;</span>die dem Versicherten zugeordneten MedicationDispense-Ressourcen anhand der KVNR des Versicherten im ACCESS_TOKEN im "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Authorization</span>"-Header des HTTP-Requests identifizieren, die in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">MedicationDispense.subject</span>&nbsp;die entsprechende KVNR des begünstigten Patienten referenziert haben, damit ausschließlich Versicherte ihre eigenen Dispensierinformationen einsehen können. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116834">
   <p><b>A_19518-01</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS das Eingrenzen einer Suchanfrage auf <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/MedicationDispense</span> über die URL-Parameter gemäß&nbsp;<a href="https://www.hl7.org/fhir/medicationdispense.html#search" target="_top" class="descriptionLink">https://www.hl7.org/fhir/medicationdispense.html#search</a>&nbsp;mindestens für die Attribute <br> </span> 
    <ul> 
     <li><span style="font-size: 10pt;line-height: 1.5;">MedicationDispense.whenHandedOver,</span></li> 
     <li><span style="font-size: 10pt;line-height: 1.5;">MedicationDispense.whenPrepared und&nbsp;</span></li> 
     <li><span style="font-size: 10pt;line-height: 1.5;">MedicationDispense.performer.actor </span></li> 
    </ul> <span style="font-size: 10pt;line-height: 1.5;">erlauben, damit Versicherte eine Suche und Sortierung nach Ausgabedatum sowie der aufgesuchten Apotheke durchführen können.&nbsp;</span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_177"> <span id="polarion-comment:450"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133128">
   <p><b>A_22070-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS das Suchergebnis mit mehreren MedicationDispense-Objekten anhand der PrescriptionID (<span style="font-size: 10pt;color: #172B4D;line-height: 1.5;">?identifier</span><span style="font-size: 11pt;color: #172B4D;line-height: 1.5;">=</span><code style="color: #172B4D;"><a style="color: #0052CC;" class="external-link" target="_top" href="https://gematik.de/fhir/NamingSystem/PrescriptionID"></a><a class="descriptionLink" target="_top" href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_PrescriptionId">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_PrescriptionId</a>|&lt;PrescriptionID&gt;</code>) und bei Vorhandensein mehrerer MedicationDispense-Objekte zu einem beendeten Task, die MedicationDispense-Objekte in einem Bundle an den Aufrufenden zurückgeben. <b>&lt;=</b></p>
  </div>
  <p id="polarion_176">Der Fachdienst soll eine mögliche Konstellation von Bundles im Ergebnis-Bundle auflösen, sodass das Ergebnisbundle ausschließlich MedicationDispense-Objekte enthält, unabhängig davon, ob ein oder mehrere dieser Objekte zu je einem Task gehören.</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-132929">6.3 Ressource ChargeItem</h3>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124485">
   <p><b>A_22111</b></p>
   <p><span style="font-weight: normal;font-size: 10pt;line-height: 1.5;">Der</span> <span style="font-size: 10pt;line-height: 1.5;">E-Rezept-Fachdienst MUSS alle Zugriffe auf die Ressource ChargeItem mittels der HTTP-Operationen HEAD unterbinden, damit keine unzulässigen Operationen auf die Informationen zu Abrechnungsinformationen ausgeführt werden können.</span> <b>&lt;=</b></p>
  </div>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-132928">6.3.1 HTTP-Operation DELETE</h4>
  <p id="polarion_211">Die FHIR-Operation führt zum Löschen der unter &lt;Prescription-ID&gt; gespeicherten Abrechnungsinformation. Diese Operation steht dem Versicherten, für den das E-Rezept erstellt wurde, zur Verfügung.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124500">
   <p><b>A_22112</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS den Aufruf der Operation <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">DELETE /ChargeItem</span> ohne Angabe einer konkreten über &lt;id&gt; adressierte&nbsp; <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ChargeItem</span> Ressource&nbsp; mit dem HTTP-Fehlercode 405 ablehnen, um das Löschen mehrerer Ressourcen über einen Request zu verhindern.&nbsp;</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124502">
   <p><b>A_22113</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-DELETE-Operation auf eine konkrete über &lt;id&gt; adressierte&nbsp; <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/ChargeItem/&lt;id&gt;</span> Ressource&nbsp; sicherstellen, dass ausschließlich Nutzer in der Rolle&nbsp;<br></span> 
    <ul>
     <li>oid_versicherter</li>
    </ul><span style="font-size: 10pt;line-height: 1.5;">die Operation am E-Rezept-Fachdienst aufrufen dürfen und die Rolle "professionOID" des Aufrufers im ACCESS_TOKEN im HTTP-RequestHeader "Authorization" feststellen, damit eine Abrechnungsinformation nicht durch Unberechtigte gelöscht werden können.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124494">
   <p><b>A_22114</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-DELETE-Operation auf eine konkrete über &lt;id&gt; adressierte<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/ChargeItem/&lt;id&gt;</span> Ressource&nbsp;durch einen Versicherten, den Versicherten anhand der KVNR aus dem ACCESS_TOKEN im "Authorization"-Header des HTTP-Requests identifizieren, diese gegen die in "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ChargeItem.subject.identifier</span>"&nbsp;hinterlegte KVNR des begünstigten Versicherten prüfen und bei Ungleichheit den Aufruf mit dem HTTP-Fehlercode 403 abweisen, damit ausschließlich der begünstigte Versicherte als Berechtigter eine Abrechnungsinformation löscht.</span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_245"> <span id="polarion-comment:423"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-132660">
   <p><b>A_22117-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Löschen einer ChargeItem-Ressource auch<br> 
    <ul>
     <li>die in ChargeItem.supportingInformation referenzierten Ressourcen des Verordnungsdatensatzes, des PKV-Abgabedatensatzes und der Quittung,</li>
     <li>alle Communication mit Communication.basedOn = ChargeItem.id,</li>
    </ul>löschen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_246"></p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-132932">6.3.2 HTTP-Operation GET</h4>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-132930">6.3.2.1 GET /ChargeItem</h5>
  <p id="polarion_213">Mit dieser Operation kann eine Liste von ChargeItem-IDs abgefragt werden, für deren Zugriff der Anfragende berechtigt ist.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124472">
   <p><b>A_22118</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-GET-Operation auf den Endpunkt</span> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">/ChargeItem&nbsp;</span><span style="font-size: 10pt;line-height: 1.5;">sicherstellen, dass ausschließlich Nutzer in der Rolle</span> 
    <ul>
     <li>oid_versicherter</li>
    </ul><span style="font-size: 10pt;line-height: 1.5;">die Operation am E-Rezept-Fachdienst aufrufen dürfen und die Rolle "</span><span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">professionOID</span><span style="font-size: 10pt;line-height: 1.5;">" des Aufrufers im ACCESS_TOKEN im HTTP-RequestHeader "</span><span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">Authorization</span><span style="font-size: 10pt;line-height: 1.5;">" feststellen, damit E-Rezepte nicht durch Unberechtigte ausgelesen werden können.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124470">
   <p><b>A_22119</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-GET-Operation auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/ChargeItem</span> durch einen Versicherten, den Versicherten anhand der KVNR aus dem ACCESS_TOKEN im "Authorization"-Header des HTTP-Requests identifizieren und die ChargeItems danach filtern, damit der Versicherte nur Abrechnungsinformationen abruft, bei denen er der Begünstigte ist. <b>&lt;=</b></p>
  </div>
  <p id="polarion_95"> <span id="polarion-comment:426"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-132915">
   <p><b>A_22121-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS das Eingrenzen einer Suchanfrage auf&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/ChargeItem</span> über die URL-Parameter gemäß&nbsp;<a href="https://www.hl7.org/fhir/chargeitem.html#search" target="_top" class="descriptionLink">https://www.hl7.org/fhir/chargeitem.html#search</a>&nbsp; mindestens für die Attribut<span style="font-size: 10pt;line-height: 1.5;">e</span> <br> 
    <ul> 
     <li><span style="font-size: 10pt;color: #333333;line-height: 1.5;">ChargeItem.enteredDate</span></li> 
     <li><span style="font-size: 10pt;color: #333333;line-height: 1.5;">ChargeItem.meta.__lastUpdated</span></li> 
    </ul> <span style="font-size: 10pt;line-height: 1.5;">erlauben, damit Versicherte eine Suche nach neuen Abrechnungsinformations-Einträgen&nbsp;</span>durchführen können. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124464">
   <p><b>A_22122</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-GET-Operation auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/ChargeItem</span> eine Liste von ChargeItem Ressourcen ohne die in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">supportingInformation</span> referenzierten Datensätze entsprechend der Filterung und Suchkriterien übermitteln.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124482">
   <p><b>A_22123</b></p>
   <p>Der E-Rezept-Fachdienst KANN beim Aufruf&nbsp;der HTTP-GET-Operation auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/ChargeItem&nbsp;</span>das Suchergebnis in einem Paging-Mechanismus auf mehrere Ergebnis-Bundle aufteilen, damit der Nutzer eine komfortable Navigationsmöglichkeit in seinen Abrechnungsinformationen erhält. <b>&lt;=</b></p>
  </div>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-132931">6.3.2.2 GET /ChargeItem/&lt;id&gt;</h5>
  <p id="polarion_216">Mit dieser Operation können die Details zu einem ChargeItem abgefragt werden. Ein Versicherter ist berechtigt auf eine ChargeItem Ressourcen zuzugreifen, wenn er der Begünstigte ist. Eine Apotheke ist berechtigt auf eine ChargeItem Ressource zuzugreifen, wenn sie diese dem Versicherten bereitgestellt hat und wenn sie den vom Versicherten bereitgestellten AccessCode übermitteln kann.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124480">
   <p><b>A_22124</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-GET-Operation auf eine konkrete über &lt;id&gt; adressierte</span><span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">/ChargeItem/&lt;id&gt;</span> <span style="font-size: 10pt;line-height: 1.5;">Ressource sicherstellen, dass ausschließlich Versicherte oder Apotheken in einer der Rollen</span> 
    <ul>
     <li>oid_versicherter</li>
     <li>oid_oeffentliche_apotheke</li>
     <li>oid_krankenhausapotheke</li>
    </ul><span style="font-size: 10pt;line-height: 1.5;">die Operation am E-Rezept-Fachdienst aufrufen dürfen und die Rolle "</span><span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">professionOID</span><span style="font-size: 10pt;line-height: 1.5;">" des Aufrufers im ACCESS_TOKEN im HTTP-RequestHeader "</span><span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">Authorization</span><span style="font-size: 10pt;line-height: 1.5;">" feststellen, damit E-Rezepte nicht durch Unberechtigte ausgelesen werden können.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124478">
   <p><b>A_22125</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-GET-Operation auf eine konkrete über &lt;id&gt; adressierte<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/ChargeItem/&lt;id&gt;</span> Ressource durch einen Versicherten, den Versicherten anhand der KVNR aus dem ACCESS_TOKEN im "Authorization"-Header des HTTP-Requests identifizieren, diese gegen die in&nbsp;<span style="font-size: 10pt;line-height: 1.5;">"ChargeItem.subject.identifier"&nbsp;</span>hinterlegte KVNR des begünstigten Versicherten prüfen und&nbsp;bei Ungleichheit den Aufruf mit dem HTTP-Fehlercode 403 abweisen, damit ausschließlich der begünstigte Versicherte als Berechtigter eine Abrechnungsinformation abrufen kann. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124477">
   <p><b>A_22126</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-GET-Operation auf eine konkreten über &lt;id&gt; adressierte<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/ChargeItem/&lt;id&gt;</span> Ressource durch eine abgebende Leistungserbringerinstitution, die LEI anhand der Telematik-ID aus dem ACCESS_TOKEN im "Authorization"-Header des HTTP-Requests identifizieren, diese gegen die in&nbsp;<span style="font-size: 10pt;line-height: 1.5;">"ChargeItem.enterer.identifier"&nbsp;</span>hinterlegte Telematik-ID der einstellenden LEI prüfen und&nbsp;bei Ungleichheit den Aufruf mit dem HTTP-Fehlercode 403 abweisen, damit ausschließlich die LEI eine Abrechnungsinformation abrufen kann, welche die Abrechnungsinformation im E-Rezept-Fachdienst bereitgestellt hat. <b>&lt;=</b></p>
  </div>
  <p id="polarion_174"> <span id="polarion-comment:449"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133129">
   <p><b>A_22611-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-GET-Operation auf eine konkreten über &lt;id&gt; adressierte<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/ChargeItem/&lt;id&gt;</span> Ressource durch eine abgebende Leistungserbringerinstitution,&nbsp;<span style="font-size: 10pt;line-height: 1.5;">den im&nbsp;URL-Parameter "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">?ac=...</span>" übertragenen AccessCode gegen den im referenzierten ChargeItem gespeicherten AccessCode <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ChargeItem.identifier:AccessCode</span> als&nbsp;<a href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_AccessCode" target="_top" class="descriptionLink">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_AccessCode</a> prüfen und bei Ungleichheit oder Fehlen des URL-Parameters die Operation mit dem HTTP-Fehlercode 403 abbrechen, damit Zugriffe auf diesen Datensatz nur durch Berechtigte in Kenntnis des AccessCodes erfolgen.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-129966">
   <p><b>A_22127-01</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS beim Aufruf der Operation GET /ChargeItem/&lt;id&gt; durch einen Versicherten zusätzlich zum ChargeItem die folgenden Datensätze im JSON-Format in einem Responsebundle zurück liefern und dafür in jedem Aufruf<br></span> 
    <ul>
     <li><span style="font-size: 10pt;line-height: 1.5;">den Verordnungsdatensatz&nbsp;im XML-Format mit der Signaturidentität des E-Rezept-Fachdienstes&nbsp;ID.FD.OSIG gemäß&nbsp;[RFC5652] mit&nbsp;Profil CAdES-BES ([CAdES]) Enveloping signieren (QES wird dabei entfernt),</span></li>
     <li><span style="font-size: 10pt;line-height: 1.5;">den PKV-Abgabedatensatz&nbsp;im XML-Format mit der Signaturidentität des E-Rezept-Fachdienstes&nbsp;ID.FD.OSIG gemäß&nbsp;[RFC5652#section-11.4] mit&nbsp;Profil CAdES-BES ([CAdES]) Enveloping im <span style="text-decoration: underline;">gegen</span>signieren</span></li>
     <li><span style="font-size: 10pt;line-height: 1.5;">die Quittung&nbsp;im XML-Format mit der Signaturidentität des E-Rezept-Fachdienstes&nbsp;ID.FD.OSIG gemäß&nbsp;[RFC5652] mit&nbsp;Profil CAdES-BES ([CAdES]) Enveloping signieren und</span></li>
     <li><span style="font-size: 10pt;line-height: 1.5;">in jede Fachdienstsignatur die letzte OCSP-Antwort der regelmäßigen Statusprüfung des Signaturzertifikats C.FD.OSIG einbetten (jedes Signatur-Ergebnis wird als <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">dss:Base64Signature</span>-Objekt in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Bundle.signature</span>&nbsp;des jeweiligen JSON-Objekts eingebettet),</span></li>
    </ul><span style="font-size: 10pt;line-height: 1.5;">damit der Versicherte die Daten für die Abrechnung an Kostenträger weiterleiten kann.</span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_212"> <span style="font-size: 10pt;line-height: 1.5;">Hinweis: Außer ChargeItem sind die zurückgegebenen FHIR-Ressourcen vom Typ Bundle und jedes Bundle trägt "seine" Signatur im jeweiligen Attribut Bundle.signature im CAdES-Enveloping-Format. Die signierten Daten sind dadurch doppelt vorhanden, das erspart jedoch die fehleranfällige Normalisierung und Kanonisierung in der Signaturprüfung.</span> </p>
  <p id="polarion_214">Hinweis: Der Verordnungsdatensatz, der PKV-Abgabedatensatz und die Quittung werden zum Abrufzeitpunkt signiert, um die Möglichkeit der Prüfung der Signaturzertifikate im nachfolgenden Abrechnungsprozess sicherzustellen.</p>
  <p id="polarion_215"> <span style="font-style: italic;font-size: 9pt;color: #3366FF;line-height: 1.5;">Hinweis: Es ist geplant, das Signaturzertifikat C.FD.OSIG durch ein eIDAS Siegel zu ersetzen, um eine Prüfung der Signatur außerhalb der TI mit Standardtools zu ermöglichen.</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124498">
   <p><b>A_22128</b></p>
   <p>Der E-Rezept-Fachdienst DARF beim Aufruf der Operation <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">GET /ChargeItem/&lt;id&gt;</span> durch eine abgebende Leistungserbringerinstitution das in <span style="font-size: 10pt;line-height: 1.5;">"ChargeItem.supportingInformation"&nbsp;</span>referenzierte Element&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ChargeItem.supportingInformation:receipt</span>&nbsp;und den Identifier&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.identifier:AccessCode</span> NICHT in den Response übernehmen, sodass die abgebende LEI nur den Verordnungsdatensatz und durch sie änderbaren PKV-Abgabedatensatz erhält. <b>&lt;=</b></p>
  </div>
  <p id="polarion_217">Hinweis: Der Verordnungsdatensatz wird mit QES des Verordnenden an die Apotheke zurück geliefert.</p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-132941">6.3.3 HTTP-Operation PATCH</h4>
  <p id="polarion_218">Die FHIR-Operation führt zum Aktualisieren einer unter &lt;Prescription-ID&gt; gespeicherten ChargeItem Ressource.</p>
  <p id="polarion_219"> <span style="font-size: 10pt;line-height: 1.5;">Diese Operation steht dem Versicherten für das Aktualisieren der Markierungen zur Verfügung.</span> </p>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-132942">6.3.3.1 PATCH /ChargeItem/&lt;id&gt;</h5>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-129663">
   <p><b>A_22879</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-Operation PATCH auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/ChargeItem</span> ohne Angabe einer &lt;id&gt; für eine konkrete Ressource mit dem HTTP-Fehlercode 405 ablehnen, um das Ändern mehrerer Ressourcen über einen Request zu verhindern. &nbsp;</span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_237">Hinweis: Auf die Prüfung, ob die Einwilligung zum Speichern der Abrechnungsinformationen vorliegt, kann verzichtet werden, weil bei einem zwischenzeitlichen Widerruf alle Abrechnungsinformationen des Versicherten vom E-Rezept-Fachdienst gelöscht wurden. Beim Aufruf der Operation PATCH /ChargeItem/&lt;id&gt; wird der HTTP-Fehlercode 404 (Not found) zurückgegeben.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-129658">
   <p><b>A_22875</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf der Http-PATCH-Operation auf eine konkrete über &lt;id&gt; adressierte /ChargeItem/&lt;id&gt; Ressource sicherstellen, dass ausschließlich Nutzer in der Rolle&nbsp; 
    <ul>
     <li>oid_versicherter&nbsp;</li>
    </ul><span style="font-size: 10pt;line-height: 1.5;">die Operation am E-Rezept-Fachdienst aufrufen dürfen und die Rolle "professionOID" des Aufrufers im ACCESS_TOKEN im HTTP-RequestHeader "Authorization" feststellen, damit eine Abrechnungsinformation nicht durch Unberechtigte aktualisiert werden kann.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-129662">
   <p><b>A_22877</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-PATCH-Operation auf eine konkrete über &lt;id&gt; adressierte<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/ChargeItem/&lt;id&gt;</span> Ressource&nbsp;durch einen Versicherten, den Versicherten anhand der KVNR aus dem ACCESS_TOKEN im "Authorization"-Header des HTTP-Requests identifizieren, diese gegen die im gespeicherten Datensatz in "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ChargeItem.subject.identifier</span>"&nbsp;hinterlegte KVNR des begünstigten Versicherten prüfen und bei Ungleichheit den Aufruf mit dem HTTP-Fehlercode 403 abweisen, damit ausschließlich der begünstigte Versicherte als Berechtigter eine Abrechnungsinformation ändert.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-129660">
   <p><b>A_22878</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS die im HTTP-PATCH-Operation auf die Ressource ChargeItem übertragenen Attribute gegen das FHIR-Profil ChargeItem prüfen, auf die Zulässigkeit der änderbaren Felder prüfen:<br></span> 
    <table style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;" class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%|uid=589">
     <tbody>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 96px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Versicherter</td>
       <td style="text-align: left;vertical-align: top;width: 635px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">darf nur Markierungen (extention <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ChargeItem.extension:markingFlag</span>) ändern&nbsp;</span></td>
      </tr>
     </tbody>
    </table><span style="font-size: 10pt;line-height: 1.5;"><br> und bei fehlerhafter Prüfung die Operation mit dem http-Status-Code 400 und einem Hinweis auf unzulässige Änderung gesperrter Attribute in OperationOutcome&nbsp;abbrechen, damit kein Schadcode und keine "fachfremden" Daten in den E-Rezept-Fachdienst hochgeladen werden.&nbsp;</span> <b>&lt;=</b></p>
  </div>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-132938">6.3.4 HTTP-Operation POST</h4>
  <p id="polarion_221"> <span style="font-size: 10pt;line-height: 1.5;">Die FHIR-Operation führt zum Einstellen einer neuen Abrechnungsinformation.&nbsp;</span> </p>
  <p id="polarion_222"> <span style="font-size: 10pt;line-height: 1.5;">Diese Operation steht für das Einstellen den Apotheken&nbsp;zur Verfügung.</span> </p>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-132940">6.3.4.1 POST /ChargeItem</h5>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124495">
   <p><b>A_22129</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf der Http-POST-Operation auf den Endpunkt /ChargeItem sicherstellen, dass ausschließlich Nutzer in der Rolle&nbsp; 
    <ul>
     <li>oid_oeffentliche_apotheke</li>
     <li>oid_krankenhausapotheke&nbsp;</li>
    </ul><span style="font-size: 10pt;line-height: 1.5;">die Operation am E-Rezept-Fachdienst aufrufen dürfen und die Rolle "professionOID" des Aufrufers im ACCESS_TOKEN im HTTP-RequestHeader "Authorization" feststellen, damit eine Abrechnungsinformation nicht durch Unberechtigte eingestellt werden kann.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124492">
   <p><b>A_22130</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS beim Aufruf der Http-POST-Operation auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/ChargeItem</span> sicherstellen, dass ein URL-Parameter "</span><span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">task=...</span><span style="font-size: 10pt;line-height: 1.5;">" übermittelt wurde und bei Fehlen des URL-Parameters die Operation mit dem HTTP-Fehlercode 400 abbrechen.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124488">
   <p><b>A_22131</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS beim Aufruf der Http-POST-Operation auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/ChargeItem</span> sicherstellen, dass zu der im URL-Parameter "</span><span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">task=...</span><span style="font-size: 10pt;line-height: 1.5;">" übertragene Task-ID eine Task Ressource mit dem Status</span> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">Task.status = completed</span><span style="font-size: 10pt;line-height: 1.5;">&nbsp;existiert und bei fehlgeschlagener Prüfung mit dem HTTP-Fehlercode 409&nbsp;abbrechen, damit nur eine Abrechnungsinformation für E-Rezepte mit dem Status „quittiert“ angelegt wird.</span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_220">Aus der Details der Fehlerbeschreibung in OperationOutcome soll für den Nutzer (Angehöriger einer abgebenden LEI) durch eine verständliche Darstellung im Primärsystem hervorgehen, warum die Abgabeinformation nicht bereitgestellt werden kann, damit der Grund dem Versicherten übermittelt werden kann.</p>
  <p id="polarion_173"> <span id="polarion-comment:448"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133130">
   <p><b>A_22132-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf der Http-POST-Operation auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/ChargeItem</span> das im URL-Parameter "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">secret=...</span>" übertragene Secret gegen das im referenzierten Task gespeicherte Secret <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.identifier:Secret</span> als&nbsp;<a class="descriptionLink" target="_top" href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Secret">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Secret</a>&nbsp;prüfen und bei Ungleichheit oder Fehlen des URL-Parameters die Operation mit dem HTTP-Fehlercode 403 abbrechen, damit der Zugriff auf diesen Datensatz nur durch die berechtigten Apotheke in Kenntnis des Secrets erfolgt. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-129206">
   <p><b>A_22731</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS beim Aufruf der Http-POST-Operation auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/ChargeItem</span> sicherstellen, dass der im URL-Parameter "</span><span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">task=...</span><span style="font-size: 10pt;line-height: 1.5;">" referenzierte Task den Flowtype&nbsp;&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.extension:flowType = 200</span>&nbsp;oder <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">209</span> besitzt&nbsp;und bei fehlgeschlagener Prüfung mit dem HTTP-Fehlercode 400 abbrechen, damit nur eine Abrechnungsinformation für E-Rezepte mit zulässigen Flowtype angelegt wird.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124463">
   <p><b>A_22133</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS beim Aufruf der Http-POST-Operation auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/ChargeItem</span> sicherstellen, dass zu der in&nbsp;ChargeItem.subject.identifier&nbsp;übermittelten KVNR ein Consent Datensatz mit&nbsp;Consent.patient.identifier = KVNR und Consent.category.coding.code = CHARGCONS&nbsp;existiert und bei fehlgeschlagener Prüfung die Operation mit dem HTTP-Fehlercode 403 abbrechen, damit nur eine Abrechnungsinformation für Versicherte gespeichert wird, die eine Einwilligung erteilt haben.</span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_238">Aus der Details der Fehlerbeschreibung in OperationOutcome soll für den Nutzer (Angehöriger einer abgebenden LEI) durch eine verständliche Darstellung im Primärsystem hervorgehen, warum die Abgabeinformation nicht bereitgestellt werden kann, damit der Grund dem Versicherten übermittelt werden kann.</p>
  <p id="polarion_239"> <span id="polarion-comment:447"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133132">
   <p><b>A_22136-01</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS die im HTTP-POST-Operation auf die Ressource ChargeItem übertragene ChargeItem Ressource gegen das FHIR-Profil ChargeItem prüfen und</span> <br>
    <ul>
     <li><span style="font-size: 10pt;line-height: 1.5;">die Korrektheit der Rezept-ID&nbsp;<a class="descriptionLink" target="_top" href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_PrescriptionId">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_PrescriptionId</a> im referenzierten Task als <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ChargeItem.identifier</span> ,</span></li>
     <li><span style="font-size: 10pt;line-height: 1.5;">die Korrektheit der Versicherten-ID des Versicherten im referenzierten Task (<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Task.for</span>) gegen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ChargeItem.subject.identifier</span>&nbsp;</span></li>
     <li><span style="font-size: 10pt;line-height: 1.5;">und die Korrektheit der Telematik-ID der Apotheke gemäß ACCESS_TOKEN mit dem Wert in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ChargeItem.enterer.identifier</span></span></li>
    </ul>prüfen und bei Nicht-Konformität das Anlegen der Ressource im E-Rezept-Fachdienst mit dem http-Status-Code 400 ablehnen, damit nur FHIR-valide Ressourcen in den E-Rezept-Fachdienst hochgeladen werden. <b>&lt;=</b></p>
  </div>
  <p id="polarion_172">Der PKV-Abgabedatensatz wird containedbinary im Aufruf übermittelt.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124475">
   <p><b>A_22137</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS beim Aufruf der Http-POST-Operation auf den Endpunkt /ChargeItem den im containedbinary übermittelten PKV-Abgabedatensatz herauslösen und entfernen, die Ressource zur ChargeItem Ressource speichern und in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ChargeItem.supportingInformation:dispenseItem</span> die Referenz hinzufügen.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124474">
   <p><b>A_22138</b></p>
   <p>Der E-Rezept-Fachdienst MUSS die im HTTP-POST-Operation auf die Ressource ChargeItem übertragene PKV-Abgabedatensatz Ressource gegen das FHIR-Profil <a class="descriptionLink" target="_top" href="http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-PKV-PR-ERP-AbgabedatenBundle">http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-PKV-PR-ERP-AbgabedatenBundle</a> prüfen und bei Nicht-Konformität das Anlegen der Ressource im E-Rezept-Fachdienst mit dem http-Status-Code 400 ablehnen, damit nur FHIR-valide Ressourcen in den E-Rezept-Fachdienst hochgeladen werden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124473">
   <p><b>A_22139</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf der Http-POST-Operation auf den Endpunkt /ChargeItem die Signatur des&nbsp;PKV-Abgabedatensatzes gemäß [ETSI_QES]&nbsp;prüfen,&nbsp;und bei fehlender oder nicht gültiger Signatur&nbsp;<span style="font-size: 10pt;line-height: 1.5;">mit Status 400 abbrechen, um ausschließlich authentische Daten zu verwalten.&nbsp;</span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_223"> <span style="font-size: 10pt;line-height: 1.5;">Der PKV-Abgabedatensatz hat QES eines HBAs des Apothe</span>kers oder e<span style="font-size: 10pt;line-height: 1.5;">ine nonQES einer SMC-B der Apotheke.&nbsp;Die Zertifikate QES bzw. nonQES werden anhand ihres Zertifikatstyps (Policy-OID) unterschieden.</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124471">
   <p><b>A_22140</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf der Http-POST-Operation auf den Endpunkt /ChargeItem das Signaturzertifikats des&nbsp;PKV-Abgabedatensatzes prüfen. Das Signaturzertifikat muss anhand der Zertifikatsprüfung für [mathematisch gültig UND zeitlich gültig UND online gültig ] befunden werden und der Aufruf anderenfalls&nbsp;<span style="font-size: 10pt;line-height: 1.5;">mit Status 400 abgebrochen werden, um ausschließlich authentische Daten zu verwalten.</span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_240"> Die Vorgaben für die Prüfung eines QES Zertifikates sind in&nbsp;<span style="font-size: 10pt;line-height: 1.5;">A_20159-* beschrieben.</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124469">
   <p><b>A_22141</b></p>
   <p>Der E-Rezept-Fachdienst MUSS ein Signatur-Zertifikat einer nonQES-Signatur eine Leistungserbringerinstitution gemäß [gemSpec_PKI#TUC_PKI_018] mit folgenden Parametern auf Gültigkeit prüfen: <p class="polarion-rte-caption-paragraph" data-keep-next="true" id="polarion___7">Tabelle <span class="polarion-rte-caption" data-sequence="Tabelle">8</span>: TAB_eRPFD_xxx Parameter Prüfung Signaturzertifikat SMC-B</p>
    <table style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;" class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%|uid=674">
     <tbody>
      <tr>
       <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Parameter</th>
       <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><br></th>
      </tr>
      <tr>
       <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Zertifikat</td>
       <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Signaturzertifikat aus nonQES&nbsp;</td>
      </tr>
      <tr>
       <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">PolicyList</td>
       <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">oid_smc_b_osig&nbsp;</td>
      </tr>
      <tr>
       <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">intendedKeyUsage</td>
       <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">nonRepudiation</td>
      </tr>
      <tr>
       <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">intendedExtendedKeyUsage</td>
       <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">(leer)</td>
      </tr>
      <tr>
       <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">OCSP-Graceperiod</td>
       <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">12 Stunden</td>
      </tr>
      <tr>
       <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Offline-Modus</td>
       <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">nein</td>
      </tr>
      <tr>
       <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Prüfmodus</td>
       <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">OCSP</td>
      </tr>
     </tbody>
    </table>Der E-Rezept-Fachdienst darf die OCSP-Response für die Abfrage des Zertifikatsstatus für 12 Stunden zwischenspeichern. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124462">
   <p><b>A_22134</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS beim Aufruf der Http-POST-Operation auf den Endpunkt /ChargeItem das E-Rezept-Bundle vom Profil <a class="descriptionLink" target="_top" href="https://fhir.kbv.de/StructureDefinition/KBV_PR_ERP_Bundle">https://fhir.kbv.de/StructureDefinition/KBV_PR_ERP_Bundle</a>&nbsp;ohne die Signatur zur im URL-Parameter "task=..." übertragenen Task-ID identifizieren und zur ChargeItem Ressource mit dem Identifier PrescriptionID speichern und in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ChargeItem.supportingInformation:prescriptionItem</span> die Referenz hinzufügen.</span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_241">Für den übernommenen Verordnungsdatensatz gelten nicht die Löschfristen des Tasks, aus dem der Verordnungsdatensatz übernommen wurde.</p>
  <p id="polarion_242"> <span id="polarion-comment:446"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133133">
   <p><b>A_22135-01</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS beim Aufruf der Http-POST-Operation auf den Endpunkt /ChargeItem das Quittung-Bundle vom Profil&nbsp;<a class="descriptionLink" target="_top" href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Bundle">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Bundle</a> ohne die Signatur zur im URL-Parameter "task=..." übertragenen Task-ID identifizieren und zur ChargeItem Ressource mit dem Identifier PrescriptionID speichern und in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ChargeItem.supportingInformation:receipt</span> die Referenz hinzufügen.</span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_171">Für die übernommene Quittung gelten nicht die Löschfristen des Tasks, aus dem die Quittung übernommen wurde.</p>
  <p id="polarion_170"> <span id="polarion-comment:445"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133142">
   <p><b>A_22614-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf der Http-POST-Operation auf den Endpunkt /ChargeItem&nbsp;eine 256-Bit-Zufallszahl mit einer Mindestentropie von 120 Bit erzeug<span style="font-size: 10pt;line-height: 1.5;">en,&nbsp;hexadezimal kodieren ([0-9a-f]{64})</span> und diese im zu speichernden ChargeItem als externe ID in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ChargeItem.identifier:AccessCode</span> als&nbsp;<a class="descriptionLink" target="_top" href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_AccessCode">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_AccessCode</a> hinzufügen, damit nachfolgende Zugriffe auf diesen Datensatz nur durch Berechtigte in Kenntnis des AccessCodes erfolgen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124465">
   <p><b>A_22143</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Erzeugen eines ChargeItem mittels HTTP-POST-Operation die folgenden Elemente schreiben: 
    <ul>
     <li><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ChargeItem.enteredDate</span>: aktueller Zeitstempel<br></li>
    </ul> <b>&lt;=</b></p>
  </div>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-132934">6.3.5 HTTP-Operation PUT</h4>
  <p id="polarion_225"> <span style="font-size: 10pt;line-height: 1.5;">Die FHIR-Operation führt zum Aktualisieren einer unter &lt;Prescription-ID&gt; gespeicherten ChargeItem Ressource.&nbsp;</span> </p>
  <p id="polarion_226"> <span style="font-size: 10pt;line-height: 1.5;">Diese Operation steht der Apotheke, welche die Abrechnungsinformation bereitgestellt hat,&nbsp;für das Aktualisieren des PKV-Abgabedatensatzes zur Verfügung.</span> </p>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-132936">6.3.5.1 PUT /ChargeItem/&lt;id&gt;</h5>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124483">
   <p><b>A_22144</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf der Http-PUT-Operation auf eine konkrete über &lt;id&gt; adressierte /ChargeItem/&lt;id&gt; Ressource sicherstellen, dass ausschließlich Nutzer in der Rolle&nbsp; 
    <ul>
     <li>oid_oeffentliche_apotheke</li>
     <li>oid_krankenhausapotheke&nbsp;</li>
    </ul><span style="font-size: 10pt;line-height: 1.5;">die Operation am E-Rezept-Fachdienst aufrufen dürfen und die Rolle "professionOID" des Aufrufers im ACCESS_TOKEN im HTTP-RequestHeader "Authorization" feststellen, damit eine Abrechnungsinformation nicht durch Unberechtigte aktualisiert werden kann.&nbsp;</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124587">
   <p><b>A_22215</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-PUT-Operation auf eine konkrete über &lt;id&gt; adressierte<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/ChargeItem/&lt;id&gt;</span> Ressource sicherstellen, dass zu der in&nbsp;ChargeItem.subject.identifier&nbsp;übermittelten KVNR ein Consent Datensatz mit&nbsp;Consent.patient.identifier = KVNR und Consent.category.coding.code = CHARGCONS&nbsp;existiert und bei fehlgeschlagener Prüfung die Operation mit dem HTTP-Fehlercode 403 abbrechen, damit nur eine Abrechnungsinformation für Versicherte gespeichert wird, die eine Einwilligung erteilt haben.&nbsp;</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124479">
   <p><b>A_22146</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-PUT-Operation auf eine konkrete über &lt;id&gt; adressierte&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/ChargeItem/&lt;id&gt;</span> Ressource&nbsp;durch eine abgebende Leistungserbringerinstitution (Apotheke), diese anhand der Telematik-ID aus dem ACCESS_TOKEN im "Authorization"-Header des HTTP-Requests identifizieren, diese gegen die im gespeicherten Datensatz in "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ChargeItem.enterer.identifier</span>"&nbsp;hinterlegte Telematik-ID prüfen und bei Ungleichheit den Aufruf mit dem HTTP-Fehlercode 403 abweisen, damit ausschließlich die Apotheke, welche die Abrechnungsinformation bereitgestellt hat, als Berechtigte eine Abrechnungsinformation ändert.</span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_97"> <span id="polarion-comment:427"></span><span id="polarion-comment:473"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-132230">
   <p><b>A_22616-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-PUT-Operation auf eine konkrete über &lt;id&gt; adressierte&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/ChargeItem/&lt;id&gt;</span> Ressource&nbsp;durch eine abgebende Leistungserbringerinstitution (Apotheke),&nbsp;<span style="font-size: 10pt;line-height: 1.5;">den im URL-Parameter "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">?ac=...</span>" übertragenen AccessCode gegen den im referenzierten ChargeItem gespeicherten AccessCode <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ChargeItem.identifier:AccessCode</span> als&nbsp;<a href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_AccessCode" target="_top" class="descriptionLink">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_AccessCode</a> prüfen und bei Ungleichheit oder Fehlen des URL-Parameters die Operation mit dem HTTP-Fehlercode 403 abbrechen, damit Zugriffe auf diesen Datensatz nur durch Berechtigte in Kenntnis des AccessCodes erfolgen.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124501">
   <p><b>A_22148</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-PUT-Operation auf eine konkrete über &lt;id&gt; adressierte <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/ChargeItem/&lt;id&gt;</span> Ressource durch eine abgebende LEI, den im containedbinary übermittelten PKV-Abgabedatensatz herauslösen und entfernen, die Ressource zur ChargeItem Ressource speichern und in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ChargeItem.supportingInformation:dispenseItem</span> die Referenz hinzufügen.&nbsp;</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124499">
   <p><b>A_22149</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-PUT-Operation auf eine konkrete über &lt;id&gt; adressierte <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/ChargeItem/&lt;id&gt;</span> Ressource durch eine abgebende LEI, die im HTTP-PUT-Operation auf die Ressource ChargeItem übertragene PKV-Abgabedatensatz Ressource gegen das FHIR-Profil PKV-Abgabedatensatz prüfen und bei Nicht-Konformität das Anlegen der Ressource im E-Rezept-Fachdienst mit dem http-Status-Code 400 und einem Hinweis auf die FHIR-Invalidität in OperationOutcome ablehnen, damit nur FHIR-valide Ressourcen in den E-Rezept-Fachdienst hochgeladen werden.&nbsp;</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124496">
   <p><b>A_22150</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-PUT-Operation auf eine konkrete über &lt;id&gt; adressierte <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/ChargeItem/&lt;id&gt;</span> Ressource durch eine abgebende LEI, die Signatur des PKV-Abgabedatensatzes gemäß [ETSI_QES] prüfen, und bei fehlender oder nicht gültiger Signatur mit Status 400 und einem Hinweis auf den die ungültige Signatur in OperationOutcome abbrechen, um ausschließlich authentische Daten zu verwalten. &nbsp;</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124493">
   <p><b>A_22151</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-PUT-Operation auf eine konkrete über &lt;id&gt; adressierte /ChargeItem/&lt;id&gt; Ressource durch eine abgebende LEI, das Signaturzertifikats des PKV-Abgabedatensatzes prüfen. Das Signaturzertifikat muss anhand der Zertifikatsprüfung für [mathematisch gültig UND zeitlich gültig UND online gültig] befunden werden und der Aufruf anderenfalls mit Status 400 und einem Hinweis auf das abgelaufene/gesperrte Signaturzertifikat in OperationOutcome abgebrochen werden, um ausschließlich authentische Daten zu verwalten.&nbsp;</span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_224">Die Vorgaben für die Prüfung eines QES Zertifikates sind in A_20159-* beschrieben. Die Vorgaben für die Prüfung eines nonQES Zertifikates sind in A_22141-* beschrieben.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124490">
   <p><b>A_22152</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS die im HTTP-PUT-Operation auf die Ressource ChargeItem übertragene ChargeItem Ressource gegen das FHIR-Profil ChargeItem prüfen, auf die Zulässigkeit der änderbaren Felder prüfen:<br></span> 
    <table style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;" class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%|uid=589">
     <tbody>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 96px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">abgebende LEI</td>
       <td style="text-align: left;vertical-align: top;width: 635px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">darf nur PKV-Abgabedatensatz ändern&nbsp;</span></td>
      </tr>
     </tbody>
    </table><span style="font-size: 10pt;line-height: 1.5;">und bei fehlerhafter Prüfung die Operation mit dem http-Status-Code 400 und einem Hinweis auf unzulässige Änderung gesperrter Attribute in OperationOutcome&nbsp;abbrechen, damit kein Schadcode und keine "fachfremden" Daten in den E-Rezept-Fachdienst hochgeladen werden.&nbsp;</span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_142"> <span id="polarion-comment:444"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133146">
   <p><b>A_22615-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-PUT-Operation auf eine konkrete über &lt;id&gt; adressierte /ChargeItem/&lt;id&gt; Ressource durch eine abgebende LEI&nbsp;eine 256-Bit-Zufallszahl mit einer Mindestentropie von 120 Bit erzeug<span style="font-size: 10pt;line-height: 1.5;">en,&nbsp;hexadezimal kodieren ([0-9a-f]{64})</span> und diese im zu speichernden ChargeItem als externe ID in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ChargeItem.identifier:AccessCode</span> als&nbsp;<a class="descriptionLink" target="_top" href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_AccessCode">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_AccessCode</a> überschreiben, damit nachfolgende Zugriffe auf diesen Datensatz nur durch Berechtigte in Kenntnis des AccessCodes erfolgen. <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-132939">6.4 Ressource Consent</h3>
  <p id="polarion_229"> Für das Speichern der Abrechnungsinformationen eines Versicherten im E-Rezept-Fachdienst muss der Versicherte vorab eine Einwilligung erteilen.&nbsp;<span style="font-size: 10pt;line-height: 1.5;">Für die Übermittlung der Einwilligung wird die FHIR Ressource Consent verwendet.</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124506">
   <p><b>A_22153</b></p>
   <p>Der E-Rezept-Fachdienst MUSS alle Zugriffe auf die Ressource Consent mittels der HTTP-Operationen PUT, PATCH, oder HEAD unterbinden, damit keine unzulässigen Operationen auf die Informationen zur Einwilligung ausgeführt werden können. <b>&lt;=</b></p>
  </div>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-132937">6.4.1 HTTP-Operation DELETE</h4>
  <p id="polarion_231">Die Operation führt zum Löschen der für den Versicherten gespeicherten Einwilligung. Diese Operation steht dem Versicherten, der die Einwilligung erteilt hat, zur Verfügung.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124504">
   <p><b>A_22154</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-Operation DELETE auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Consent</span> ohne Angabe <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">?category</span> mit dem HTTP-Fehlercode 405 ablehnen, um das Löschen mehrerer Ressourcen über einen Request zu verhindern. &nbsp;</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124505">
   <p><b>A_22155</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-Operation DELETE auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Consent</span>&nbsp;die Rolle "professionOID" des Aufrufers im ACCESS_TOKEN im HTTP-RequestHeader "Authorization" feststellen und sicherstellen, dass ausschließlich Versicherte in der Rolle oid_versicherter die Operation am E-Rezept-Fachdienst aufrufen dürfen, damit die Information zur Einwilligung nicht durch Unberechtigte gelöscht werden kann. <b>&lt;=</b></p>
  </div>
  <p id="polarion_141"> <span id="polarion-comment:443"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133147">
   <p><b>A_22874-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-Operation DELETE auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Consent</span>&nbsp;prüfen, <span style="font-size: 10pt;line-height: 1.5;">dass der für <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">?category</span> angegebene Wert im System&nbsp;<a href="https://gematik.de/fhir/erpchrg/CodeSystem/GEM_ERPCHRG_CS_ConsentType" target="_top" class="descriptionLink">https://gematik.de/fhir/erpchrg/CodeSystem/GEM_ERPCHRG_CS_ConsentType</a> enthalten ist und bei fehlerhafter Prüfung den Request mit dem Fehler 400 abbrechen, damit nur Löschrequests für definierte Consent Typen ausgeführt werden.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124513">
   <p><b>A_22157</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-Operation DELETE auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Consent</span> mit <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">?category=CHARGCONS</span>&nbsp;alle dem Versicherten zugeordneten ChargeItem-Ressourcen (<span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">ChargeItem.subject.identifier</span>)&nbsp;anhand der KVNR des Versicherten im ACCESS_TOKEN im "Authorization"-Header des HTTP-Requests identifizieren und löschen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_45"> <span id="polarion-comment:424"></span>Für das Löschen der Abrechnungsinformationen ist "<span style="font-size: 10pt;line-height: 1.5;">A_22117-* - E-Rezept-Fachdienst - Abrechnungsinformation löschen - zu löschende Ressourcen</span>" zu beachten. </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124509">
   <p><b>A_22158</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-Operation DELETE auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Consent</span> die Ressource löschen, bei der <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Consent.patient.identifier</span> der KVNR aus dem ACCESS_TOKEN im "Authorization"-Header des HTTP-Requests sowie&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Consent.category.coding.code</span> dem in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">?category</span> übermittelten Wert entspricht. <b>&lt;=</b></p>
  </div>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-132935">6.4.2 HTTP-Operation GET</h4>
  <p id="polarion_233">Mit der&nbsp;FHIR-Operation kann die Consent Ressource für die im ACCESS_TOKEN angegebene KVNR abgerufen werden. Diese Operation steht Versicherten zur Verfügung.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124511">
   <p><b>A_22159</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-GET-Operation auf den Endpunkt /Consent sicherstellen, dass ausschließlich Versicherte in der Rolle oid_versicherter die Operation am E-Rezept-Fachdienst aufrufen dürfen und die Rolle "professionOID" des Aufrufers im ACCESS_TOKEN im HTTP-RequestHeader "Authorization" feststellen, damit die Information zur Einwilligung nicht durch Unberechtigte ausgelesen werden kann. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124507">
   <p><b>A_22160</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-GET-Operation auf den Endpunkt /Consent die dem Versicherten zugeordneten Consent-Ressourcen anhand der KVNR des Versicherten im ACCESS_TOKEN im "Authorization"-Header des HTTP-Requests identifizieren und in den Response aufnehmen, die in Consent.Patient.identifier die entsprechende KVNR des begünstigten Versicherten referenziert haben, damit ausschließlich Versicherte ihre eigenen Information zu Einwilligungen einsehen können. <b>&lt;=</b></p>
  </div>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-132933">6.4.3 HTTP-Operation POST</h4>
  <p id="polarion_235">Die FHIR-Operation führt zum Schreiben einer neuen Einwilligung. Diese Operation steht Versicherten zur Verfügung.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124510">
   <p><b>A_22161</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-POST-Operation auf den Endpunkt /Consent sicherstellen, dass ausschließlich Versicherte in der Rolle oid_versicherter die Operation am E-Rezept-Fachdienst aufrufen dürfen und die Rolle "professionOID" des Aufrufers im ACCESS_TOKEN im HTTP-RequestHeader "Authorization" feststellen, damit eine Einwilligung nicht durch Unberechtigte erteilt werden kann. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125011">
   <p><b>A_22289</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-POST-Operation auf den Endpunkt /Consent sicherstellen, dass die KVNR im ACCESS_TOKEN&nbsp;im "Authorization"-Header des HTTP-Requests und die KVNR in&nbsp;<span style="font-size: 10pt;line-height: 1.5;"><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Consent.patient.identifier</span>&nbsp; übereinstimmen, damit eine Einwilligung für einen Versicherten nicht durch Dritte erteilt werden kann. Im Fehlerfall muss der Http-Request mit dem Http-Fehlercode 403 abgewiesen werden.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125644">
   <p><b>A_22351</b></p>
   <p>Der E-Rezept-Fachdienst MUSS die im HTTP-POST-Operation auf die Ressource Consent übertragene Consent Ressource gegen das FHIR-Profil Consent prüfen&nbsp;<span style="font-size: 10pt;line-height: 1.5;">und bei Nicht-Konformität das Anlegen der Ressource im E-Rezept-Fachdienst mit dem http-Status-Code 400 ablehnen, damit nur FHIR-valide Ressourcen in den E-Rezept-Fachdienst hochgeladen werden.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124508">
   <p><b>A_22162</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-POST-Operation auf den Endpunkt /Consent sicherstellen, dass noch keine Consent Ressource für die KVNR im ACCESS_TOKEN und&nbsp;&nbsp;<span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">Consent.category.coding.code = CHARGCONS</span>&nbsp; gespeichert ist, um maximal eine Einwilligung für den Versicherten zu speichern. Im Fehlerfall muss der Http-Request mit dem Http-Fehlercode 409 abgewiesen werden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125642">
   <p><b>A_22350</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-POST-Operation auf den Endpunkt /Consent – falls bei den Prüfungen keine Fehler aufgetreten sind, welche zum Abbruch der Operation führen – die übermittelte Ressource persistieren. <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-103622">6.5 Ressource Communication</h3>
  <p id="polarion_103"> Der E-Rezept-Fachdienst ermöglicht eine direkte Kommunikation zwischen Versicherten und Apotheken über die Belieferung von E-Rezepten über den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&lt;Fachdienst-URL&gt;/Communication&nbsp;</span>gemäß der FHIR-Definition in <a href="https://www.hl7.org/fhir/communication.html" target="_top" class="descriptionLink">https://www.hl7.org/fhir/communication.html</a>&nbsp;. </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-104272">
   <p><b>A_19401</b></p>
   <p>Der E-Rezept-Fachdienst MUSS alle Zugriffe auf die Ressource Communication mittels der HTTP-Operationen PUT, PATCH und HEAD unterbinden, damit keine unzulässigen Operationen auf den Kommunikationsnachrichten ausgeführt werden können. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116827">
   <p><b>A_19446-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf&nbsp;der HTTP-GET, DELETE und POST-Operation auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Communication</span>&nbsp;bzw. <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Communication/&lt;id&gt;</span> sicherstellen, dass ausschließlich Versicherte und Apotheken in der Rolle<br> 
    <ul>
     <li>oid_versicherter</li>
     <li>oid_oeffentliche_apotheke</li>
     <li>oid_krankenhausapotheke</li>
    </ul>die Operation am Fachdienst aufrufen dürfen und die Rolle "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">professionOID</span>" des Aufrufers im&nbsp;ACCESS_TOKEN im HTTP-RequestHeader "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Authorization</span>" feststellen, damit der Nachrichtenaustausch nicht zwischen Unbefugten erfolgt. <b>&lt;=</b></p>
  </div>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-103623">6.5.1 HTTP-Operation GET</h4>
  <p id="polarion_143">Die HTTP-Operation GET wird für den Nachrichtenabruf verwendet. Dabei werden alle Anfragen auf Basis der KVNR bzw. Telematik-ID im übergebenen ACCESS_TOKEN gefiltert, um die Nachrichten des jeweiligen Empfängers zu finden. Zusätzliche Filteranfragen für den Abruf ungelesener Nachrichten oder eine Sortierung nach Sendedatum sind zusätzlich möglich.</p>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-103624">6.5.1.1 GET /Communication/</h5>
  <p id="polarion_168"> <span id="polarion-comment:442"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133148">
   <p><b>A_19520-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Abrufen von Nachrichten über die http-Operation GET auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Communication&nbsp;</span>bzw. beim Abruf einer einzelnen Nachricht über <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Communication/&lt;id&gt;</span> ausschließlich die Nachrichten an den Aufrufer zurückgeben, die im Attribut <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Communication.recipient</span> oder <span style="font-size: 10pt;line-height: 1.5;"><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #333333;">Communication.sender</span>&nbsp;</span>mit&nbsp;dem entsprechenden Identifier&nbsp;<a class="descriptionLink" target="_top" href="https://gematik.de/fhir/sid/telematik-id">https://gematik.de/fhir/sid/telematik-id</a> für Apotheken bzw.&nbsp;<a class="descriptionLink" target="_top" href="http://fhir.de/sid/gkv/kvid-10">http://fhir.de/sid/gkv/kvid-10</a>&nbsp;oder&nbsp;<a class="descriptionLink" target="_top" href="http://fhir.de/sid/pkv/kvid-10">http://fhir.de/sid/pkv/kvid-10</a> für Versicherte den gleichen Typ und den identischen Wert haben wie&nbsp;im Attribut "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">idNummer"&nbsp;</span>des übergebenen ACCESS_TOKEN im HTTP-Header "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Authorization</span>" für Versicherten-ID bzw. Telematik-ID, damit keine Nachrichten an Dritte unrechtmäßig ausgelesen werden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-104497">
   <p><b>A_19521</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Abrufen von Nachrichten über die http-Operation GET auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Communication&nbsp;</span>bzw. beim Abruf einer einzelnen Nachricht über <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Communication/&lt;id&gt;</span> den Wert des Attributs Communication.received = &lt;aktuelle Systemzeit&gt; setzen, wenn dieser Wert zum Zeitpunkt des Abrufs der Nachrichten <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">NULL</span> ist, damit Nutzer eine Filtermöglicheit auf "neue Nachrichten" haben. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116833">
   <p><b>A_19522-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS das Eingrenzen einer Suchanfrage auf&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Communication</span> über die URL-Parameter gemäß&nbsp;<a class="descriptionLink" target="_top" href="https://www.hl7.org/fhir/communication.html#search">https://www.hl7.org/fhir/communication.html#search</a>&nbsp;mindestens für die Attribut<span style="font-size: 10pt;line-height: 1.5;">e<br></span> 
    <ul>
     <li><span style="font-size: 10pt;line-height: 1.5;">Communication.sent,</span></li>
     <li><span style="font-size: 10pt;line-height: 1.5;">Communication.received,&nbsp;</span></li>
     <li><span style="font-size: 10pt;color: #333333;line-height: 1.5;">Communication.recipient und&nbsp;</span></li>
     <li><span style="font-size: 10pt;line-height: 1.5;"><span style="color: #333333;">Communication.sender</span> erlauben,</span></li>
    </ul><span style="font-size: 10pt;line-height: 1.5;">damit Versicherte eine Suche nach neuen Nachrichten, Sende- bzw. Empfangsrichtung und eine</span> Sortierung nach Sende- und Empfangsdatum durchführen können. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116826">
   <p><b>A_19534-01</b></p>
   <p>Der E-Rezept-Fachdienst KANN beim Aufruf&nbsp;der HTTP-GET-Operation auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Communication&nbsp;</span>das Suchergebnis in einem Paging-Mechanismus auf mehrere&nbsp;Ergebnis-Bundle aufteilen, damit der Nutzer eine komfortable Navigationsmöglichkeit in seinen Nachrichten erhält. <b>&lt;=</b></p>
  </div>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-103626">6.5.2 HTTP-Operation POST</h4>
  <p id="polarion_162">Mit der&nbsp;HTTP-Operation POST erfolgt der Versand einer Kommunikationsnachricht an eine Identität der Telematikinfrastruktur, welche über ihre systemweit eindeutige Identifikationsnummer Telematik-ID bzw. Versicherten-ID (10-stelliger Anteil der KVNR) adressiert wird.</p>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-103627">6.5.2.1 POST /Communication/</h5>
  <p id="polarion_154"> <span id="polarion-comment:433"></span><span id="polarion-comment:471"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-132977">
   <p><b>A_19447-04</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Einstellen einer Nachricht über die http-Operation POST auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Communication&nbsp;</span>die im http-Request-Body übergebene Communications-Ressource gegen das aus der Kommunikationsbeziehung ableitbare, zulässige Schema gemäß TAB_eRPFD_008 <br> <p data-keep-next="true" class="polarion-rte-caption-paragraph" id="polarion___8"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">9</span>: TAB_eRPFD_008 Nachrichtentyp zu Kommunikationsbeziehung </p> 
    <table id="polarion_wiki macro name=table;params=width=100%" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
     <tbody> 
      <tr> 
       <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 75px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">sender</th> 
       <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 77px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">recipient</th> 
       <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 155px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">zusätzliche Bedingung</th> 
       <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 402px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Schema</th> 
      </tr> 
      <tr> 
       <td style="width: 75px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">KVNR</td> 
       <td style="width: 77px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">TelematikID</td> 
       <td style="width: 155px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Communication.basedOn<br> referenziert Task</td> 
       <td style="width: 402px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><a href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_DispReq" target="_top" class="descriptionLink">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_DispReq</a>&nbsp;</td> 
      </tr> 
      <tr> 
       <td style="width: 75px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">KVNR</td> 
       <td style="width: 77px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">TelematikID</td> 
       <td style="width: 155px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Communication.about<br> referenziert Medication<br> Communication.basedOn<br> referenziert Task</td> 
       <td style="width: 402px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> <a href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_InfoReq" target="_top" class="descriptionLink">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_InfoReq</a>&nbsp;</td> 
      </tr> 
      <tr> 
       <td style="width: 75px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">TelematikID</td> 
       <td style="width: 77px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">KVNR</td> 
       <td style="width: 155px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Communication.basedOn<br> referenziert Task</td> 
       <td style="width: 402px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><a href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_Reply" target="_top" class="descriptionLink">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_Reply</a>&nbsp;</td> 
      </tr> 
      <tr> 
       <td style="width: 75px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">KVNR</td> 
       <td style="width: 77px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">KVNR</td> 
       <td style="width: 155px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Communication.basedOn<br> referenziert Task&nbsp;</td> 
       <td style="width: 402px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><a href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_Representative" target="_top" class="descriptionLink">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_Representative</a>&nbsp;</td> 
      </tr> 
      <tr> 
       <td style="width: 75px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">KVNR</td> 
       <td style="width: 77px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">TelematikID</td> 
       <td style="width: 155px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Communication.basedOn<br> referenziert ChargeItem</td> 
       <td style="width: 402px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><a href="https://gematik.de/fhir/erpchrg/StructureDefinition/GEM_ERPCHRG_PR_Communication_ChargChangeReq" target="_top" class="descriptionLink">https://gematik.de/fhir/erpchrg/StructureDefinition/GEM_ERPCHRG_PR_Communication_ChargChangeReq</a></td> 
      </tr> 
      <tr> 
       <td style="width: 75px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">TelematikID</td> 
       <td style="width: 77px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">KVNR</td> 
       <td style="width: 155px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Communication.basedOn<br> referenziert ChargeItem</td> 
       <td style="width: 402px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><a href="https://gematik.de/fhir/erpchrg/StructureDefinition/GEM_ERPCHRG_PR_Communication_ChargChangeReply" target="_top" class="descriptionLink">https://gematik.de/fhir/erpchrg/StructureDefinition/GEM_ERPCHRG_PR_Communication_ChargChangeReply</a></td> 
      </tr> 
     </tbody> 
    </table> prüfen und den Aufruf bei Nicht-Konformität mit dem http-Status-Code 400 ablehnen, damit ausschließlich konforme E-Rezept-Nachrichten ausgetauscht werden. <b>&lt;=</b></p>
  </div>
  <p id="polarion_134"> <span id="polarion-comment:441"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133150">
   <p><b>A_19448-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Einstellen einer Nachricht über die http-Operation POST auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Communication&nbsp;</span>die Absenderidentifikation aus dem Attribut "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">idNummer"&nbsp;</span>des übergebenen IDP-Token im HTTP-Header "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Authorization</span>" mit dem entsprechenden System&nbsp;<a class="descriptionLink" target="_top" href="https://gematik.de/fhir/sid/telematik-id">https://gematik.de/fhir/sid/telematik-id</a> für Apotheken bzw.&nbsp;<a class="descriptionLink" target="_top" href="http://fhir.de/sid/gkv/kvid-10">http://fhir.de/sid/gkv/kvid-10</a>&nbsp;oder&nbsp;<a class="descriptionLink" target="_top" href="http://fhir.de/sid/pkv/kvid-10">http://fhir.de/sid/pkv/kvid-10</a> für Versicherte übernehmen sowie das Absendedatum <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Communication.sent</span> auf die aktuelle Systemzeit des E-Rezept-Fachdienstes setzen, damit Absender und Sendezeitpunkt für den Empfänger eindeutig sind. <b>&lt;=</b></p>
  </div>
  <p id="polarion_209"> <span id="polarion-comment:470"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-132978">
   <p><b>A_20229-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS die zulässige Anzahl der Communication-Ressourcen des Schemas&nbsp;<a class="descriptionLink" target="_top" href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_Representative">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_Representative</a>&nbsp; zur Versicherter-zu-Versichertem-Kommunikation auf einen konfigurierbaren Maximalwert (Default: 10) je referenziertem Task beschränken und bei Überschreiten des Maximalwerts das Einstellen einer Nachricht mit dem http-Status-Code 429 abbrechen, damit Versicherte den E-Rezept-Fachdienst nicht für beliebige Kommunikation außerhalb der Vertretung in der Einlösung von E-Rezepten benutzen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110766">
   <p><b>A_20511</b></p>
   <p>Der E-Rezept-Fachdienst DARF die Anzahl der Communication-Ressourcen je referenziertem Task für die Versicherter-zu-Versichertem-Kommunikation NICHT zu anderen Zwecken verwenden, als für die Beschränkung der Anzahl auf den maximalen Wert. <b>&lt;=</b></p>
  </div>
  <p id="polarion_208"> <span id="polarion-comment:469"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-132979">
   <p><b>A_20230-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Einstellen einer Nachricht des Schemas&nbsp;<a href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_Representative" target="_top" class="descriptionLink">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_Representative</a> zur Versicherter-zu-Versichertem-Kommunikation über die http-Operation POST auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Communication&nbsp;</span>mit dem http-Status-Code 400 abbrechen, wenn der referenzierte Task nicht im Zustand "ready" oder "in-progress" ist, damit die Weitergabe des Zugriffs auf E-Rezepte ausschließlich auf einlösbare bzw. in Arbeit befindliche Verordnungen beschränkt wird. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-109763">
   <p><b>A_20231</b></p>
   <p>Der E-Rezept-Fachdienst MUSS das Einstellen einer Nachricht über die http-Operation POST auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Communication&nbsp;</span>mit dem http-Status-Code 400 abbrechen, wenn der Empfänger <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Communication.recipient</span> gleich der&nbsp;Absenderidentifikation im Attribut "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">idNummer"&nbsp;</span>des übergebenen IDP-Token im HTTP-Header "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Authorization</span>"&nbsp; ist, damit irreführende Kommunikationsbeziehungen nicht zu einer vermeidbaren Mehrbelastung des E-Rezept-Fachdienstes führen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116843">
   <p><b>A_19450-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS das Einstellen einer Nachricht über die http-Operation POST auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Communication&nbsp;</span>mit dem http-Status-Code 400 abbrechen, wenn <br> 
    <ul>
     <li>der Nachrichteninhalt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Communication.payload</span> größer als 10 kByte ist oder</li>
     <li>in von Versicherten eingestellten Nachrichten in Communication.payload eine externe URLs enthält oder</li>
     <li>ein <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Attachment</span> mit MimeType "<span style="font-size: 11pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #2B4180;line-height: 1.5;">application/*</span>" enthält,</li>
    </ul>damit über den E-Rezept-Fachdienst kein Schadcode verteilt wird.&nbsp;<br> <b>&lt;=</b></p>
  </div>
  <p id="polarion_144"> <span id="polarion-comment:440"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133163">
   <p><b>A_20885-03</b></p>
   <p>Der E-Rezept-Fachdienst MUSS das Einstellen einer Nachricht des Profils "<a class="descriptionLink" target="_top" href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_DispReq">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_DispReq</a>",&nbsp; "<a class="descriptionLink" target="_top" href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_InfoReq">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_InfoReq</a>" oder&nbsp;"<a class="descriptionLink" target="_top" href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_Representative">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_Representative</a>" durch einen Versicherten über die http-Operation POST auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Communication&nbsp;</span>mit dem http-Status-Code 400 abbrechen, wenn <br> 
    <ul>
     <li>die KVNR des in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Communication.basedOn</span> referenzierten Tasks Task.for ungleich der KVNR des Einstellenden in "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">idNummer"&nbsp;</span>des übergebenen ACCESS_TOKEN</li>
    </ul>und&nbsp;<br>
    <ul>
     <li>der http-Header "X-AccessCode" fehlt oder der im http-Header "X-AccessCode" übergebene AccessCode ungleich dem AccessCode-Identifier des referenzierten Tasks</li>
    </ul>ist,&nbsp;um irreführende Testnachrichten zu unterbinden, die eine vermeidbare Mehrbelastung für den E-Rezept-Fachdienst darstellen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_133"> <span id="polarion-comment:439"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133164">
   <p><b>A_21371-02</b></p>
   <p>Der Fachdienst E-Rezept MUSS beim Einstellen einer Nachricht des Profils "<a class="descriptionLink" target="_top" href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_DispReq">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_DispReq</a>", "<a class="descriptionLink" target="_top" href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_InfoReq">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_InfoReq</a>",&nbsp;"<a class="descriptionLink" target="_top" href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_Reply">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_Reply</a>" oder "<a class="descriptionLink" target="_top" href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_Representative">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_Representative</a>" über die http-Operation POST auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Communication&nbsp;</span>mit dem http-Status-Code 400 abbrechen, wenn das Pflichtfeld <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Communication.basedOn</span> einen Task referenziert, der nicht existiert, um Spam und nicht-rezeptbezogene Kommunikation zu verhindern. <b>&lt;=</b></p>
  </div>
  <p id="polarion_72"> <span id="polarion-comment:432"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-132667">
   <p><b>A_22734-01</b></p>
   <p>Der Fachdienst E-Rezept MUSS beim Einstellen einer Nachricht des Profils "<a href="https://gematik.de/fhir/erpchrg/StructureDefinition/GEM_ERPCHRG_PR_Communication_ChargChangeReq" target="_top" class="descriptionLink">https://gematik.de/fhir/erpchrg/StructureDefinition/GEM_ERPCHRG_PR_Communication_ChargChangeReq</a>" oder "<a href="https://gematik.de/fhir/erpchrg/StructureDefinition/GEM_ERPCHRG_PR_Communication_ChargChangeReply" target="_top" class="descriptionLink">https://gematik.de/fhir/erpchrg/StructureDefinition/GEM_ERPCHRG_PR_Communication_ChargChangeReply</a>" über die http-Operation POST auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Communication&nbsp;</span>mit dem http-Status-Code 400 abbrechen, wenn das Pflichtfeld <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Communication.basedOn</span> einen ChargeItem referenziert, der nicht existiert, um Spam und nicht-rezeptbezogene Kommunikation zu verhindern. <b>&lt;=</b></p>
  </div>
  <p id="polarion_130"> <span id="polarion-comment:431"></span><span id="polarion-comment:472"></span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-132668">
   <p><b>A_22367-02</b></p>
   <p>Der E-Rezept-Fachdienst MUSS&nbsp;beim Einstellen einer Nachricht des Profils "<a class="descriptionLink" target="_top" href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_DispReq">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_DispReq</a>",&nbsp; "<a class="descriptionLink" target="_top" href="https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_InfoReq">https://gematik.de/fhir/erp/StructureDefinition/GEM_ERP_PR_Communication_InfoReq</a>" oder "<a class="descriptionLink" target="_top" href="https://gematik.de/fhir/erpchrg/StructureDefinition/GEM_ERPCHRG_PR_Communication_ChargChangeReq">https://gematik.de/fhir/erpchrg/StructureDefinition/GEM_ERPCHRG_PR_Communication_ChargChangeReq</a>" zur Versicherter-zu-Apotheken-Kommunikation über die http-Operation POST auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Communication</span> prüfen, ob für die Telematik-ID des Empfängers Subscriptions registriert sind und für Registrierungen über den Subscription Service eine Notification (<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ping : subscription-id</span>) senden. <b>&lt;=</b></p>
  </div>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-110223">6.5.3 HTTP-Operation DELETE</h4>
  <p id="polarion_119">Mit der&nbsp;HTTP-Operation DELETE kann ein Nutzer eine verschickte Kommunikationsnachricht als Absender löschen, um bspw. einen Irrläufer zurückzurufen. Der E-Rezept-Fachdienst prüft, ob die Nachricht bereits abgerufen wurde. Das Löschen einer ungelesenen Nachricht erfolgt sofort, das Löschen einer bereits abgerufenen Nachricht wird vom E-Rezept-Fachdienst mit einer Warnung umgesetzt, um darauf hinzuweisen, dass die Nachricht als Kopie im Clientsystem des Empfängers vorliegt und das Löschen nicht vor unberechtigter Einsichtnahme schützt.&nbsp;</p>
  <p id="polarion_126">Um den Schutz vor unberechtigter Einsichtnahme in persönliche Daten durchzusetzen, ist es ratsam bei bereits gelesenen Nachrichten den referenzierten E-Rezept-Task zu löschen. Für eine geeignete Nutzerführung auf Clientseite ergänzt der E-Rezept-Fachdienst die http-Response um das Header-Attribut "Warning" mit einem entsprechenden Hinweis. Das Löschen des Task führt direkt auch zum Löschen aller Kommunikationsnachrichten, die auf diesen Task verweisen. Damit kann ein fälschlich adressierter Vertreter eines Versicherten keine Einsicht in die Daten des E-Rezepts mehr nehmen bzw. das E-Rezept in keiner Apotheke mehr einlösen.</p>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-110222">6.5.3.1 DELETE /Communication/</h5>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110234">
   <p><b>A_20258</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf&nbsp;der HTTP-DELETE-Operation auf&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/Communication/&lt;id&gt;</span>&nbsp;die über &lt;id&gt; identifizierte Communication-Ressource anhand der KVNR bzw. Telematik-ID des aufrufenden Nutzers im&nbsp;ACCESS_TOKEN im "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Authorization</span>"-Header des HTTP-Requests über das Absender-Attribut&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Communication.sender</span> lokalisieren und löschen, damit Nutzer irrtümlich versendete oder nicht mehr gewünschte Nachrichten vom E-Rezept-Fachdienst entfernen können. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110235">
   <p><b>A_20259</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Löschen einer&nbsp;Communication-Ressource der http-Response das http-Header-Feld "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Warning</span>" mit dem Zeitpunkt des Nachrichtenabrufs durch den Empfänger ergänzen (z.B. "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Warning: 'Deleted message delivered at 2020-07-01 10:30:00'</span>"), wenn die Nachricht bereits durch den Empfänger abgerufen wurde (<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Communication.received</span> ungleich NULL, bzw. enthält Datum des Abrufs), um dem Absender einen Hinweis anzeigen zu können. <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-103628">6.6 Ressource AuditEvent</h3>
  <p id="polarion_19"> Der E-Rezept-Fachdienst protokolliert alle Zugriffe auf personenbezogene und medizinische Daten der E-Rezepte von Versicherten. Über den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&lt;Fachdienst-URL&gt;/AuditEvent</span> stehen diese für den Abruf durch den jeweils betroffenen Versicherten zur Verfügung. Die Protokolleinträge werden gemäß der Löschfrist im E-Rezept-Fachdienst&nbsp; gespeichert und nach Ablauf dieser Frist automatisch gelöscht. </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-104273">
   <p><b>A_19402</b></p>
   <p>Der E-Rezept-Fachdienst MUSS alle Zugriffe auf die Ressource AuditEvent mittels der HTTP-Operationen PUT, PATCH, HEAD, DELETE und POST unterbinden, damit keine unzulässigen Operationen auf den Protokolldaten ausgeführt werden können. <b>&lt;=</b></p>
  </div>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-104278">6.6.1 HTTP-Operation GET /AuditEvent</h4>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-104267">
   <p><b>A_19395</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf&nbsp;der HTTP-GET-Operation auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/AuditEvent</span> und auf einen konkreten über &lt;id&gt; adressierten <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/AuditEvent/&lt;id&gt;</span>&nbsp;sicherstellen, dass ausschließlich Versicherte in der Rolle<br> 
    <ul> 
     <li>oid_versicherter</li> 
    </ul> die Operation am Fachdienst aufrufen dürfen und die Rolle "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">professionOID</span>" des Aufrufers im&nbsp;ACCESS_TOKEN im HTTP-RequestHeader "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Authorization</span>" feststellen, damit E-Rezept-Protokolleinträge nicht durch Unberechtigte ausgelesen werden können. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-104265">
   <p><b>A_19396</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf&nbsp;der HTTP-GET-Operation auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/AuditEvent&nbsp;</span>die dem Versicherten zugeordneten AuditEvent-Ressourcen anhand der KVNR des Versicherten im&nbsp;ACCESS_TOKEN im "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Authorization</span>"-Header des HTTP-Requests identifizieren, die in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AuditEvent.entity.name</span> die entsprechende KVNR des begünstigten Patienten referenziert haben, damit ausschließlich Versicherte ihre eigenen E-Rezept-Protokolleinträge einsehen können. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-104270">
   <p><b>A_19399</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf&nbsp;der HTTP-GET-Operation auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/AuditEvent</span>&nbsp;eine Sortierung über die Attribute der Protokolleinträge "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">date</span>", "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">agent</span>" und "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">subType</span>" gemäß der Festlegungen für die Ressource AuditEvent&nbsp;<a class="descriptionLink" target="_top" href="https://www.hl7.org/fhir/auditevent.html#search">https://www.hl7.org/fhir/auditevent.html#search</a>&nbsp;in den URL-Parametern zulassen, damit sich Versicherte in ihrem Zugriffsprotokoll besser zurecht finden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-104266">
   <p><b>A_19397</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf&nbsp;der HTTP-GET-Operation auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/AuditEvent&nbsp;</span>die Ergebnisliste der AuditEvent-Ressourcen bei mehr als einem Eintrag als&nbsp;Ergebnis-Bundle an den Aufrufer zurückgeben, damit der Versicherte eine vollständige Einsicht in das Zugriffsprotokoll erhält. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-104268">
   <p><b>A_19398</b></p>
   <p>Der E-Rezept-Fachdienst KANN beim Aufruf&nbsp;der HTTP-GET-Operation auf den Endpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/AuditEvent&nbsp;</span>die Ergebnisliste der AuditEvent-Ressourcen bei mehr als 50 Einträgen das Suchergebnis in einem Paging-Mechanismus auf mehrere&nbsp;Ergebnis-Bundle aufteilen, damit der Versicherte eine komfortable Navigationsmöglichkeit in seinem Zugriffprotokoll erhält. <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-112022">6.7 Ressource Device</h3>
  <p id="polarion_70">Gemäß CapabilityStatement und FHIR-Profilierung stellt der E-Rezept-Fachdienst statische Informationen über seine Produkttypversion zur Verfügung. Mit diesen erhalten Clients eine entsprechende Auskunft und bei Bedarf das Signaturzertifikat C.FD.OSIG für die Signaturprüfung, für welches der E-Rezept-Fachdienst serverseitige Signaturen für die E-Rezept-Quittung, PKV-Abgabeinformationen und den E-Rezept-Datensatz für Versicherte erstellt.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-112023">
   <p><b>A_20744</b></p>
   <p>Der E-Rezept-Fachdienst MUSS über die http-Operation GET /Device dem aufrufenden Clientsystem eine statische Auskunft gemäß der Profilierung der Device-Ressource bereitstellen. <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-126133">6.8 Ressource Subscription</h3>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-126132">6.8.1 HTTP-Operation POST</h4>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125761">
   <p><b>A_22362</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf der Http-POST-Operation auf die /Subscription Ressource sicherstellen, dass ausschließlich Nutzer in der Rolle 
    <ul>
     <li>oid_oeffentliche_apotheke</li>
     <li>oid_krankenhausapotheke&nbsp;</li>
    </ul>die Operation am E-Rezept-Fachdienst aufrufen dürfen und die Rolle "professionOID" des Aufrufers im ACCESS_TOKEN im HTTP-RequestHeader "Authorization" feststellen, damit eine Subscription nicht durch Unberechtigte registriert werden kann. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125759">
   <p><b>A_22363</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf der Http-POST-Operation auf die /Subscription Ressource durch eine abgebende Leistungserbringerinstitution (Apotheke), diese anhand der Telematik-ID aus dem ACCESS_TOKEN im "Authorization"-Header des HTTP-Requests identifizieren, diese gegen die in der Ressource im Element <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">criteria</span> Attribut <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">receipient</span>&nbsp;hinterlegte Telematik-ID prüfen und bei Ungleichheit den Aufruf mit dem HTTP-Fehlercode 403 abweisen, damit ausschließlich die Apotheke für sich selbst eine Subscription registrieren kann. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125760">
   <p><b>A_22364</b></p>
   <p>Der E-Rezept-Fachdienst MUSS beim Aufruf der Http-POST-Operation auf die /Subscription Ressource mit einem Response antworten, welcher eine Subscription Ressource mit 
    <ul>
     <li>Pseudonym der Telematik-ID in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">id</span></li>
     <li>aktueller Timestamp + 12 h in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">end</span></li>
     <li>Bearer Token in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Authorization</span></li>
    </ul>enthält. <b>&lt;=</b></p>
  </div>
  <p id="polarion_157">Beispiel:</p>
  <p id="polarion_158"> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&lt;Subscription&gt;<br> &nbsp; &lt;id value="838dabe4e05416c776d60256c511558f6831f679c613f203d30b58b05555618a"/&gt; <br> &nbsp; &lt;status value="active"/&gt;<br> &nbsp; &lt;end value="2021-01-01T00:00:00Z"/&gt; <br> &nbsp; &lt;criteria value="Communication?received=null&amp;amp;recipient=3-05.2.1001000000.381"/&gt;<br> &nbsp; &lt;channel&gt;<br> &nbsp; &nbsp; &lt;type value="websocket"/&gt;<br> &nbsp; &nbsp; &lt;header value="Authorization: Bearer secret-token-abc-123"/&gt; <br> &nbsp; &lt;/channel&gt;&nbsp;&nbsp;<br> &lt;/Subscription&gt;</span> </p>
  <p id="polarion_159"></p>
  <p id="polarion_160">Hinweis: Der Header wird beim Web Socket Upgrade durch den Client an den Subscription Service übermittelt.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125762">
   <p><b>A_22365</b></p>
   <p>Der E-Rezept-Fachdienst MUSS das Pseudonym innerhalb der VAU mittels eines <span style="font-size: 10pt;line-height: 1.5;">128-Bit-AES-CMAC-Schlüssels erstellen und&nbsp;hexadezimal kodieren (32 Byte lang) (vgl gemSpec_Krypt#A_20163).</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-126303">
   <p><b>A_22383-01</b></p>
   <p>Der E-Rezept-Fachdienst MUSS den AES-CMAC-Schlüssel zur Pseudonymgenerierung regelmäßig mindestens alle 3 Monate ändern.<br> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125771">
   <p><b>A_22366</b></p>
   <p>Der E-Rezept-Fachdienst MUSS für die Registrierung der Subscription einen Bearer-Token mit den Claims 
    <ul>
     <li>subscriptionid: Pseudonym der Telematik-ID</li>
     <li><span style="font-size: 10pt;line-height: 1.5;">iAt: Timestamp wann Subscription erstellt wurde</span></li>
     <li><span style="font-size: 10pt;line-height: 1.5;">exp: Timestamp Ablauf der Subscription</span></li>
    </ul>erstellen und mit einer Identität des E-Rezept-Fachdienstes signier<span style="font-size: 10pt;line-height: 1.5;">en (<span style="color: #172B4D;">Signature Algortihm: <span style="font-family: Arial, Helvetica;">ES256</span></span>).</span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_161">Hinweise:</p>
  <p id="polarion_163">Das Signaturzertifikat muss nicht aus der Komponenten-PKI der TI abgeleitet werden.</p>
  <p id="polarion_164">Es wird kein fester Turnus festgelegt, in dem der Schlüssel gewechselt wird. Ein Wechsel kann über betriebliche Prozesse initiiert werden.</p>
  <p id="polarion_165">Der Schlüssel für die Signatur muss sicher gespeichert, jedoch nicht zwingend im HSM abgelegt werden.</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-126134">6.9 Subscription Service</h3>
  <p id="polarion_156">Der Subscription Service wird außerhalb der VAU betrieben.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125768">
   <p><b>A_22368</b></p>
   <p>Der E-Rezept-Fachdienst MUSS&nbsp;eine Webschnittstelle anbieten, welche Websocket-Verbindungen mit einer Dauer von bis zu 12 h unterstützt. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125770">
   <p><b>A_22369</b></p>
   <p>Der E-Rezept-Fachdienst MUSS&nbsp;an der Webschnittstelle des Subscription Service beim Verbindungsaufbau prüfen, dass der Client einen zeitlich und kryptographisch gültigen Bearer-Token der Schnittstelle <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">GET /Subscription</span> übermittelt und bei nicht-erfolgreicher Prüfung die Verbindung mit dem Fehler 403 ablehnen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125764">
   <p><b>A_22370</b></p>
   <p>Der E-Rezept-Fachdienst MUSS&nbsp;an der Webschnittstelle des Subscription Service beim Verbindungsaufbau ein Upgrade durchführen.&nbsp; <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125766">
   <p><b>A_22371</b></p>
   <p>Der E-Rezept-Fachdienst MUSS&nbsp;an der Webschnittstelle des Subscription Service sicherstellen, dass Verbindungen nach Überschreiten des Timestamp Ablauf der Subscription geschlossen werden.&nbsp; <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125783">
   <p><b>A_22378</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der E-Rezept-Fachdienst DARF in der Verbindung zum Subscription Service anfallende Metadaten (Client-IP-Adresse, etc.) NICHT für eine unbefugte Profilbildung der verbundenen Clients verwenden</span>.&nbsp; <b>&lt;=</b></p>
  </div>
  <p id="polarion_117"> <span style="font-size: 10pt;line-height: 1.5;">Hinweis: Eine Verwendung zur Sicherung der Schnittstelle (DDoS-Schutz, Fehleranalyse in sehr eingeschränktem Maß) ist zulässig (im Sinne einer befugten Profilbildung).</span> </p>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-103629">7 Informationsmodell</h2>
  <p id="polarion_52">Der E-Rezept-Fachdienst verwaltet E-Rezepte mittels der HL7-FHIR-Workflow-Ressource Task. Die Statusübergänge im Task werden durch verschiedene FHIR-Operationen der Ressource Task getriggert. Als Payload eines Tasks werden verschiedene E-Rezept-Bundles als Nutzdaten transportiert bzw. fachdienstseitig erzeugt.</p>
  <ul id="polarion_56"> 
   <li>E-Rezept-Bundle, enveloping in QES-Datensatz enthalten (Task.input),<br> Enthält die eigentlichen Verordnungsdaten, inkl. qualifizierter elektronischer Signatur des Arztes bzw. Zahnarztes</li> 
   <li>Kopie des E-Rezept-Bundles (Task.input),<br> Kopie der Verordnungsdaten für die Einsicht durch den Versicherten, inkl. serverseitiger Signatur</li> 
   <li>Quittungs-Bundle (Task.output),<br> Zusammenstellung aus QES-signierten Verordnungsdaten und Workflowdaten, inkl. serverseitiger Signatur</li> 
  </ul>
  <p id="polarion_57">Für die Nachvollziehbarkeit der Medikamentenabgabe an den Versicherten erwartet der E-Rezept-Fachdienst zum Abschluss des Workflows die Übergabe einer MedicationDispense-Ressource von der abgebenden Leistungserbringerinstitution (Apotheke), die das abgegebene Medikament in einer Medication-Ressource dokumentiert. Die Verbindung zwischen MedicationDispense und Task erfolgt über MedicationDispense.supportingInformation.</p>
  <p id="polarion_96">Über den Zugriff auf personenbezogene medizinische Daten des Tasks und der MedicationDispenses führt der E-Rezept-Fachdienst ein Zugriffsprotokoll mittels der Ressource AuditEvent zum Abruf durch den Versicherten. Das Attribut AuditEvent.entity speichert dabei die Referenz des betroffenen Datenobjekts und die KVNR des Versicherten.&nbsp;</p>
  <p id="polarion_88">Über die Ressource Communication steht Versicherten und Apotheken ein Nachrichtenaustausch zur Verfügung. Communication-Einträge können dabei vom Versicherten eingestellt an Apotheken adressiert werden, Apotheken können Communication-Einträge für Versicherte bereitstellen. Mit der Communication-Ressource stellt der E-Rezept-Fachdienst keine vollwertige Messenger-Plattform zur Verfügung. Nachrichten von Versicherten an Versicherte sind im begrenzten Rahmen (Referenz eines Tasks und maximale Anzahl Nachrichten zu einem Task) zulässig, die Größe transportierbarer Communications-Einträge ist bewusst auf wenige Kilobytes begrenzt, um den Transport von Schadcode zu erschweren und den Nachrichtenaustausch auf die Belieferung von E-Rezepten zu beschränken. Um verschiedene Kommunikationsbeziehungen [Versicherter - Apotheke, Apotheke - Versicherter, Versicherter - Versicherter] abzubilden, werden dezidierte Profile für die Communication-Ressource definiert.&nbsp;Mit diesen Profilen werden Nachrichtentypen realisiert, um die jeweiligen Restriktionen für Verfügbarkeitsanfrage, Einlöseauftrag und Vertreterkommunikation abzubilden.</p>
  <p id="polarion_106">Der E-Rezept-Fachdienst speichert und verwaltet keine Patient-, Practitioner und Organization-Ressourcen. Sämtliche Bezüge zu verordnenden und abgebenden Leistungserbringern, Praxen und Apotheken sowie Versicherten erfolgen über logische Referenzen. Somit wird der Aufbau einer zentralen Patienten-Kartei und Liste verordnender Ärzte im E-Rezept-Fachdienst unnötig. Zudem löscht der E-Rezept-Fachdienst regelmäßig veraltete Daten, um die Verfügbarkeit der für den Workflow notwendigen Daten auf ein Minimum zu beschränken.</p>
  <p id="polarion_81">Der E-Rezept-Fachdienst startet einen E-Rezept-Workflow ausschließlich bei einer gültigen Verordnung, das heißt, das E-Rezept-Bundle muss über eine gültige QES eines zur Verordnung berechtigten Leistungserbringers verfügen. Zudem wird die Patientenreferenz (KVNR) aus genau diesem Datensatz verwendet, um dem Patienten, dem diese Verordnung gemäß ärztlicher Signatur gilt, die Hoheit über das E-Rezept einzuräumen.</p>
  <p id="polarion_87"> Die nachfolgende Abbildung gibt eine Übersicht der verwalteten FHIR-Ressourcen.<span style="background-color: #FF0000;"> </span> </p>
  <p id="polarion_36" style="text-align: center;" class="polarion-rte-caption-paragraph"> <img src="attachments/Informationsmodell_Ressourcen_E-Rezept-Fachdienst.png" style="max-width: 750px;" data-lastmodified="2020-06-02T13:55:58.839+02:00"> </p>
  <p id="polarion_140" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">3</span>:&nbsp; Informationsmodell FHIR-Ressourcen E-Rezept-Fachdienst </p>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-103633">8 Anhang A – Verzeichnisse</h2>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-103634">8.1 Abkürzungen</h3>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=1" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 120px;height: 19.6px;border: 1px solid #CCCCCC;padding: 5px;">Kürzel<br> </th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 611px;height: 19.6px;border: 1px solid #CCCCCC;padding: 5px;">Erläuterung<br> </th> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">AVS</td> 
     <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Apothekenverwaltungssystem</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">FdV</td> 
     <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Frontend des Versicherten</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">FHIR</td> 
     <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Fast Healthcare Interoperable Resources</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 120px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">FQDN</td> 
     <td style="text-align: left;vertical-align: top;width: 611px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Fully Qualified Domain Name</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">HSM</td> 
     <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Hardware Security Module</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">KVNR</td> 
     <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Krankenversichertennummer</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">LEI</td> 
     <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Leistungserbringerinstitution</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">OCSP</td> 
     <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Online Certificate Status Protocol</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">OWASP</td> 
     <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Open Web Application Security Project</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">PVS</td> 
     <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Praxisverwaltungssystem</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">QES</td> 
     <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Qualifizierte Elektronische Signatur</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">SLA</td> 
     <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Service Level Agreement</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">SMC-B</td> 
     <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Security Module Card Typ B, Institutionenkarte</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">TI</td> 
     <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Telematikinfrastruktur</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">TLS</td> 
     <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Transport Layer Security</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">TSL</td> 
     <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Trust Service Status List</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">VAU</td> 
     <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Vertrauenswürdige Ausführungsumgebung</td> 
    </tr> 
   </tbody> 
  </table>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-103635">8.2 Glossar</h3>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=2" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 154px;height: 19.6px;border: 1px solid #CCCCCC;padding: 5px;">Begriff<br> </th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 426.8px;height: 19.6px;border: 1px solid #CCCCCC;padding: 5px;">Erläuterung<br> </th> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 154px;height: 57.2px;border: 1px solid #CCCCCC;padding: 5px;">Funktionsmerkmal </td> 
     <td style="text-align: left;vertical-align: top;width: 426.8px;height: 57.2px;border: 1px solid #CCCCCC;padding: 5px;">Der Begriff beschreibt eine Funktion oder auch einzelne, eine logische Einheit bildende Teilfunktionen der TI im Rahmen der funktionalen Zerlegung des Systems. </td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_181">Das Glossar wird als eigenständiges Dokument (vgl. [gemGlossar]) zur Verfügung gestellt.</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-103636">8.3 Abbildungsverzeichnis</h3>
  <div data-sequence="Abbildung" id="polarion_wiki macro name=tof;params=uid=1"></div>
  <div id="toc_container">
   <p class="toc_title"><h1></h1></p>
   <li><a href="#polarion_30">Abbildung 1:&nbsp;Systemüberblick</a></li>
   <li><a href="#polarion_109">Abbildung 2: Systemkontext E-Rezept-Fachdienst</a></li>
   <li><a href="#polarion_140">Abbildung 3:&nbsp; Informationsmodell FHIR-Ressourcen E-Rezept-Fachdienst</a></li>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-103637">8.4 Tabellenverzeichnis</h3>
  <div data-sequence="Tabelle" id="polarion_wiki macro name=tof;params=uid=2"></div>
  <div id="toc_container">
   <p class="toc_title"><h1></h1></p>
   <li><a href="#polarion___1">Tabelle 1: TAB_eRPFD_005 Parameter Prüfung Signaturzertifikat IDP</a></li>
   <li><a href="#polarion___2">Tabelle 2: TAB_eRPFD_010 Parameter Prüfung Signaturzertifikat&nbsp;</a></li>
   <li><a href="#polarion_244">Tabelle 3:&nbsp;TAB_eRPFD_003 Übersicht HTTP-Statuscodes&nbsp;</a></li>
   <li><a href="#polarion___3">Tabelle 4: TAB_eRPFD_004 Versichertenprotokoll</a></li>
   <li><a href="#polarion___4">Tabelle 5: TAB_eRPFD_007 Löschfristen</a></li>
   <li><a href="#polarion___5">Tabelle 6: Zugriffserlaubnisse&nbsp;</a></li>
   <li><a href="#polarion___6">Tabelle 7 : TAB_eRPFD_006 Parameter Prüfung Signaturzertifikat QES des HBA</a></li>
   <li><a href="#polarion___7">Tabelle 8: TAB_eRPFD_xxx Parameter Prüfung Signaturzertifikat SMC-B</a></li>
   <li><a href="#polarion___8">Tabelle 9: TAB_eRPFD_008 Nachrichtentyp zu Kommunikationsbeziehung</a></li>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-103638">8.5 Referenzierte Dokumente</h3>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-103639">8.5.1 Dokumente der gematik</h4>
  <p id="polarion_186">Die nachfolgende Tabelle enthält die Bezeichnung der in dem vorliegenden Dokument referenzierten Dokumente der gematik zur Telematikinfrastruktur. Der mit der vorliegenden Version korrelierende Entwicklungsstand dieser Konzepte und Spezifikationen wird pro Release in einer Dokumentenlandkarte definiert; Version und Stand der referenzierten Dokumente sind daher in der nachfolgenden Tabelle nicht aufgeführt. Deren zu diesem Dokument jeweils gültige Versionsnummern sind in der aktuellen, von der gematik veröffentlichten Dokumentenlandkarte enthalten, in der die vorliegende Version aufgeführt wird.</p>
  <p id="polarion_187"></p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=4" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 144px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;font-size: 9pt;line-height: 1.5;">[Quelle]<br> </span></th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 587px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;font-size: 9pt;line-height: 1.5;">Herausgeber: Titel<br> </span></th> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 144px;height: 21px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">[gemGlossar]</span></td> 
     <td style="text-align: left;vertical-align: top;width: 587px;height: 21px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">gematik: Glossar der Telematikinfrastruktur</span></td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 144px;height: 21px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">[gemSpec_DM_eRp]</span></td> 
     <td style="text-align: left;vertical-align: top;width: 587px;height: 21px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">gematik: Spezifikation Datenmodell E-Rezept</span></td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 144px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">&nbsp;[gemSpec_eRp_FdV]</span></td> 
     <td style="text-align: left;vertical-align: top;width: 587px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">gematik: Spezifikation E-Rezept-Frontend des Versicherten</span></td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 144px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">[gemSpec_IDP_Dienst]</span></td> 
     <td style="text-align: left;vertical-align: top;width: 587px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">gematik: Spezifikation Identity Provider-Dienst</span></td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 144px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">[gemSpec_IDP_FD]</span></td> 
     <td style="text-align: left;vertical-align: top;width: 587px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">gematik: Spezifikation Identity Provider – Nutzungsspezifikation&nbsp; für Fachdienste</span></td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 144px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">[gemSpec_Krypt]</span></td> 
     <td style="text-align: left;vertical-align: top;width: 587px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">gematik: Übergreifende Spezifikation Verwendung kryptographischer Algorithmen in der Telematikinfrastruktur</span></td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 144px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">[gemSpec_OID]</span></td> 
     <td style="text-align: left;vertical-align: top;width: 587px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">gematik: Spezifikation Festlegung von OIDs</span></td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 144px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">[gemSpec_Perf]</span></td> 
     <td style="text-align: left;vertical-align: top;width: 587px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">gematik: Übergreifende Spezifikation Performance und Mengengerüst TI-Plattform</span></td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 144px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">[gemSpec_PKI]</span></td> 
     <td style="text-align: left;vertical-align: top;width: 587px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">gematik: Übergreifende Spezifikation Performance und Mengengerüst TI-Plattform</span></td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 144px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">[gemSpec_TSL]</span></td> 
     <td style="text-align: left;vertical-align: top;width: 587px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">gematik: Spezifikation TSL-Dienst</span></td> 
    </tr> 
   </tbody> 
  </table>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-103640">8.5.2 Weitere Dokumente</h4>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=5" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">[Quelle]<br> </span></th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">Herausgeber (Erscheinungsdatum): Titel<br> </span></th> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">[BÄK_G0]</span></td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">Zertifikatsprofile für X.509 Basiszertifikate, Version 2.3.2, <br> Bundesärztekammer<br> Revisions-Datum.: 16.05.2011<span style="color: #33FF33;"><br> </span><span style="color: #33CC00;"><a href="https://docplayer.org/13121506-Zertifikatsprofile-fuer-x-509-basiszertifikate-version-2-3-2.html" target="_top" class="descriptionLink">https://docplayer.org/13121506-Zertifikatsprofile-fuer-x-509-basiszertifikate-version-2-3-2.html</a>&nbsp;</span></span></td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">[rfc6902]</span></td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">Definition JSON Patch-Operation<br> <a href="https://tools.ietf.org/html/rfc6902" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc6902</a>&nbsp;</span></td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">[ETSI_QES]</span></td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">DEN/ESI-0019122&nbsp;Electronic Signatures and Infrastructures (ESI); CAdES digital signatures<br> ETSI EN 319 102-1 Procedures for Creation and Validation of AdES Digital Signatures</span></td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">[RFC5652] </span></td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">Cryptographic Message Syntax (CMS), RFC 5652 (September 2009)<br> <a href="https://tools.ietf.org/html/rfc5652" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc5652</a>&nbsp;</span></td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">[CAdES]</span></td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">ETSI: Electronic Signature Formats, Electronic Signatures and Infrastructures (ESI) – Technical Specification, ETSI TS 101 733 V2.2.1, via <a href="http://www.etsi.org" target="_blank" class="descriptionLink">http://www.etsi.org</a></span></td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">[FHIR-Sig]</span></td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">FHIR - Signature (JSON Signature rules for FHIR Resources)<br> <a href="https://www.hl7.org/fhir/datatypes.html#Signature" target="_top" class="descriptionLink">https://www.hl7.org/fhir/datatypes.html#Signature</a>&nbsp;</span></td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">[FHIR-TASK]</span></td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">FHIR Ressource Task<br> <a href="https://www.hl7.org/fhir/task.html" target="_top" class="descriptionLink">https://www.hl7.org/fhir/task.html</a>&nbsp;</span></td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">[FHIR-ResVers]</span></td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">FHIR Policy für Ressourcen Versionierung<br> <a href="https://www.hl7.org/fhir/valueset-versioning-policy.html" target="_top" class="descriptionLink">https://www.hl7.org/fhir/valueset-versioning-policy.html</a>&nbsp;</span></td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">[HTTP-STATUS-CODES]</span></td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">HTTP-Status-Code gemäß RFC-2616<br> <a href="https://tools.ietf.org/html/rfc2616" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc2616</a>&nbsp;</span></td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">[JWT]</span></td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">JSON Web Token (JWT)<br> <a href="https://tools.ietf.org/html/rfc7519" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc7519</a>&nbsp;</span></td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">[JWS]</span></td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">JSON Web Signature (JWS)<br> <a href="https://tools.ietf.org/html/rfc7515" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc7515</a>&nbsp;</span></td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">[DAL_ANDROID]</span></td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">Asset Owners Guide -&nbsp;<span style="color: #202124;">Use statements to enable App Linking, declare default app handlers, ...</span><br> <a href="https://developers.google.com/digital-asset-links/v1/getting-started" target="_top" class="descriptionLink">https://developers.google.com/digital-asset-links/v1/getting-started</a>&nbsp;</span></td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">[RFC7231]</span></td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content<br> <a href="https://tools.ietf.org/html/rfc7231" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc7231</a>&nbsp;</span></td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">[UL_APPLE]</span></td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">Allowing Apps and Websites to Link to Your Content<br> &nbsp;<a href="https://developer.apple.com/documentation/uikit/inter-process_communication/allowing_apps_and_websites_to_link_to_your_content" target="_top" class="descriptionLink">https://developer.apple.com/documentation/uikit/inter-process_communication/allowing_apps_and_websites_to_link_to_your_content</a>&nbsp;</span></td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_129"></p>
  <p id="polarion_201"></p>
 </body>
</html>