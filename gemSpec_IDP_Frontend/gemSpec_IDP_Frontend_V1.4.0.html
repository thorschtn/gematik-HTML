<html>
 <head>
  <link rel="stylesheet" href="attachments/styleSheetForToc.css">
 </head>
 <body>
  <p id="polarion_2"> <br> </p>
  <p id="polarion_3"> <br> </p>
  <p id="polarion_4"> <br> </p>
  <p id="polarion_5"> <br> </p>
  <p id="polarion_6"> <span style="font-weight: bold;text-decoration: underline;font-size: 12pt;font-family: Arial, Helvetica, sans-serif;line-height: 1.5;">Elektronische Gesundheitskarte und Telematikinfrastruktur</span> </p>
  <p id="polarion_7"> <br> </p>
  <p id="polarion_8"> <br> </p>
  <p id="polarion_9"> <br> </p>
  <p id="polarion_10"> <br> </p>
  <p id="polarion_11" style="text-align: center;"> <span style="font-weight: bold;font-size: 28pt;font-family: Arial, Helvetica, sans-serif;line-height: 1.2;">Spezifikation </span> </p>
  <p id="polarion_78" style="text-align: center;"> <span style="font-weight: bold;font-size: 28pt;font-family: Arial, Helvetica, sans-serif;line-height: 1.2;">Identity Provider - Frontend</span> </p>
  <p id="polarion_12" style="text-align: center;"></p>
  <p id="polarion_13"> <br> </p>
  <p id="polarion_14"> <br> </p>
  <p id="polarion_15"> <br> </p>
  <div id="polarion_editor_html_block2" class="polarion-dle-wiki-block"> 
   <div id="polarion_editor_html_block_content" contenteditable="false"></div>
   <pre id="polarion_editor_html_block_source" class="polarion-dle-wiki-block-source" contenteditable="false">
    <table>
     <tr>
      <td>Version</td>
      <td>1.4.0</td>
     </tr>
     <tr>
      <td>Revision</td>
      <td>567567</td>
     </tr>
     <tr>
      <td>Stand</td>
      <td>06.02.23</td>
     </tr>
     <tr>
      <td>Status</td>
      <td>freigegeben</td>
     </tr>
     <tr>
      <td>Klassifizierung</td>
      <td>öffentlich</td>
     </tr>
     <tr>
      <td>Referenzierung</td>
      <td>gemSpec_IDP_Frontend</td>
     </tr>
    </table></pre> 
  </div>
  <p id="polarion_16"></p>
  <h1 id="polarion_wiki macro name=module-workitem;params=id=ML-104189">Dokumentinformationen</h1>
  <p id="polarion_21"> <span style="font-weight: bold;">Änderungen zur Vorversion</span> </p>
  <p id="polarion_22">Anpassungen des vorliegenden Dokumentes im Vergleich zur Vorversion können Sie der nachfolgenden Tabelle entnehmen.</p>
  <p id="polarion_23"></p>
  <p id="polarion_25" data-keep-next="true"> <span style="font-weight: bold;">Dokumentenhistorie</span> </p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=3" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 60.4px;height: 38px;border: 1px solid #CCCCCC;padding: 5px;">Version<br> </th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 67.6px;height: 38px;border: 1px solid #CCCCCC;padding: 5px;">Stand<br> </th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 50px;height: 38px;border: 1px solid #CCCCCC;padding: 5px;">Kap./ Seite<br> </th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 276.4px;height: 38px;border: 1px solid #CCCCCC;padding: 5px;">Grund der Änderung, besondere Hinweise<br> </th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 94px;height: 38px;border: 1px solid #CCCCCC;padding: 5px;">Bearbeitung<br> </th> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 60.4px;height: 18.8px;border: 1px solid #CCCCCC;padding: 5px;">1.0.0</td> 
     <td style="text-align: left;vertical-align: top;width: 67.6px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">30.06.20</td> 
     <td style="text-align: left;vertical-align: top;width: 50px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td> 
     <td style="text-align: left;vertical-align: top;width: 276.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">initiale Erstellung des Dokuments</td> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 60.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">1.1.0</td> 
     <td style="text-align: left;vertical-align: top;width: 67.6px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">12.10.20</td> 
     <td style="text-align: left;vertical-align: top;width: 50px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td> 
     <td style="text-align: left;vertical-align: top;width: 276.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Einarbeitung Scope-Themen zu R4.0.1<br> </td> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 60.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">1.2.0</td> 
     <td style="text-align: left;vertical-align: top;width: 67.6px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">14.06.21</td> 
     <td style="text-align: left;vertical-align: top;width: 50px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td> 
     <td style="text-align: left;vertical-align: top;width: 276.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Einarbeitung IDP 2.2.0 (inkl. entsprechender Anteile aus gemF_Tokenverschlüsselung &amp; gemF_Biometrie) und der Änderungsliste IDP_Maintenance_21.1&nbsp;</td> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 60.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">1.3.0</td> 
     <td style="text-align: left;vertical-align: top;width: 67.6px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">17.12.21</td> 
     <td style="text-align: left;vertical-align: top;width: 50px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td> 
     <td style="text-align: left;vertical-align: top;width: 276.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Einarbeitung IDP 2.3.0 (inkl. entsprechender Anteile aus gemF_sektorale_IDP) </td> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 60.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">1.4.0</td> 
     <td style="text-align: left;vertical-align: top;width: 67.6px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">06.02.23</td> 
     <td style="text-align: left;vertical-align: top;width: 50px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td> 
     <td style="text-align: left;vertical-align: top;width: 276.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Einarbeitung IDP_Maintenance_22.2</td> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_27"></p>
  <h1 id="polarion_wiki macro name=module-workitem;params=id=ML-104190">Inhaltsverzeichnis</h1>
  <div id="polarion_wiki macro name=toc"></div>
  <div id="toc_container">
   <p class="toc_title"><h1></h1></p>
   <li><a href="#polarion_wiki macro name=module-workitem;params=id=ML-104189">Dokumentinformationen</a></li>
   <li><a href="#polarion_wiki macro name=module-workitem;params=id=ML-104190">Inhaltsverzeichnis</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104191">1 Einordnung des Dokumentes</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104192">1.1 Zielsetzung</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104193">1.2 Zielgruppe</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104194">1.3 Geltungsbereich</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104195">1.4 Abgrenzungen</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104196">1.5 Methodik</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104198">2 Systemüberblick</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104199">3 Systemkontext</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104200">3.1 Akteure und Rollen</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104201">3.2 Nachbarsysteme</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104202">4 Zerlegung des Produkttyps</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104218">5 Verteilungssicht</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104203">6 Übergreifende Festlegungen</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-111156">6.1 Kommunikation mit Diensten der TI</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104204">7 Funktionsmerkmale Authenticator-Modul des IDP-Dienstes</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-111161">7.1 Vorbereitende Maßnahmen</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104206">7.2 Schnittstellen des Authenticator-Moduls</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104207">7.2.1 Schnittstellendefinition</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104209">7.2.2 Nutzung</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104216">7.3 Hardwaremerkmale</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-111159">7.4 Zertifikatsprüfung</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-108592">7.5 Zertifikatsprüfung von Internet-Zertifikaten</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-111160">7.6 Zertifikate der Komponenten-PKI</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-118999">7.7 Nutzung von alternativen Authentisierungsmitteln</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-120365">7.7.1 Technisches Konzept</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-120366">7.7.2 Spezifikation</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119008">7.7.2.1 Vorbereitende Maßnahmen</a></li>
   <li> : : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119006">7.7.2.1.1 Registrierung des Authenticator-Moduls</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119007">7.7.2.2 Registrierung von alternativen Authentisierungsmitteln</a></li>
   <li> : : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119009">7.7.2.2.1 Initiative des Nutzers</a></li>
   <li> : : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119010">7.7.2.2.2 Authentifizierung des Nutzers gegenüber dem Pairing-Endpunkt</a></li>
   <li> : : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119011">7.7.2.2.3 Lokale Initialisierung des Geräts</a></li>
   <li> : : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119013">7.7.2.2.4 Einleiten des Registrierungsprozesses durch das Authenticator-Modul</a></li>
   <li> : : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119131">7.7.2.2.5 Abschluss der Registrierung - Rückmeldung an den Nutzer</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119132">7.7.2.3 Verwendung von alternativen Authentisierungsmitteln</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119133">7.7.2.4 Lokale Inspektion von alternativen Authentisierungsmitteln</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119134">7.7.2.5 Lokale Löschung von alternativen Authentisierungsmitteln</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119135">7.7.2.6 Inspektion und Deregistrierung der am Pairing-Endpunkt gespeicherten Daten</a></li>
   <li> : : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119136">7.7.2.6.1 Abschluss von Inspektion und Deregistrierung</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-126131">7.8 Unterstützung der Anmeldung mittels sektoraler Identity Provider</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-126128">7.8.1 Registrierungsdaten des Authenticator-Moduls</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104368">8 Funktionsmerkmale Anwendungsfrontend des IDP Dienstes</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-108589">8.1 Vorbereitende Maßnahmen</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-108588">8.2 Schnittstellen des Anwendungsfrontends</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-111253">8.2.1 Schnittstellendefinition</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-133804">9 Nutzung sektoraler Identity Provider</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104229">10 Anhang A – Interaktionen mit Smartcards der TI</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-109366">10.1 Einleitung</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-109367">10.2 Grober Ablauf aus Kartensicht</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-109368">10.3 Ablauf im Detail</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-109369">10.3.1 Aufbau eines Kommunikationskanals zwischen Authenticator-Moduls und PICC</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-107238">10.3.2 Aufbau eines PACE-Kanals</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-107236">10.3.2.1 Auswahl eines gemeinsamen Satzes von Parametern</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-107234">10.3.2.2 Auswahl des passenden Schlüssels in der Karte</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-107232">10.3.2.3 Ablauf des PACE-Authentisierungsprotokolls</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-107229">10.3.3 Ermitteln des Kartentyps</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-107240">10.3.4 Auswahl des privaten Schlüssels</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-107237">10.3.5 Lesen des X.509-Zertifikates</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-107235">10.3.6 Benutzerverifikation</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-107233">10.3.7 Signieren</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-107230">10.3.7.1 Signaturen mit dem Algorithmus signPSS = RSASSA-PSS</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-107231">10.3.7.2 Signaturen mit dem Algorithmus signECDSA</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-107239">10.3.7.3 Signiervorgang</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104219">11 Anhang B – Verzeichnisse</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104220">11.1 Abkürzungen</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104221">11.2 Glossar</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104222">11.3 Abbildungsverzeichnis</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104223">11.4 Tabellenverzeichnis</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104224">11.5 Referenzierte Dokumente</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104225">11.5.1 Dokumente der gematik</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104226">11.5.2 Weitere Dokumente</a></li>
  </div>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-104191">1 Einordnung des Dokumentes</h2>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104192">1.1 Zielsetzung</h3>
  <p id="polarion_40"> <span style="font-size: 10pt;line-height: 1.5;">Die vorliegende Spezifikation definiert die Anforderungen zu Herstellung, Test und Betrieb eines Identity Provider (IDP) Clients. Der Client besteht aus den logisch voneinander getrennten Komponenten Anwendungsfrontend bzw. Web-Backend und Authenticator-Modul, welche einzeln, aber auch kombiniert in einer Anwendung bereitgestellt werden können. Das Authenticator-Modul übernimmt den Authentifizierungsprozess mit dem IDP-Dienst oder sektoralem Identity Provider. Das Anwendungsfrontend bzw. Web-Backend ist eine Anwendung, welche Zugriff auf Daten innerhalb der Telematikinfrastruktur (TI) erlangen möchte. Um diesen Zugriff zu erhalten, muss eine Authentifikation an einem sektoralen Identity Provider oder mittels Smartcard beim IDP-Dienst durchgeführt werden. Das Authenticator-Modul realisiert dabei den Authentifizierungsprozess und die Kommunikation mit der Smartcard, wodurch das Anwendungsfrontend funktional entlastet wird.</span> </p>
  <p id="polarion_33"> <span style="font-size: 10pt;line-height: 1.5;">Dieses Dokument beschreibt die normativen Anforderungen sowohl zum Anwendungsfrontend bzw. Web-Backend als auch zum Authenticator-Modul.&nbsp;Zudem enthält dieses Dokument informative Hinweise, um bei der Umsetzung zu unterstützen.</span> </p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104193">1.2 Zielgruppe</h3>
  <p id="polarion_44">Das Dokument richtet sich an Hersteller der Anwendung, welche das Authenticator-Modul und das Anwendungsfrontend bzw. Web-Backend beinhaltet. Die Anwendung ist&nbsp;auf Endgeräten des Nutzers (Smartphone oder PC) installiert.</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104194">1.3 Geltungsbereich</h3>
  <p id="polarion_53">Dieses Dokument enthält normative Festlegungen zur Telematikinfrastruktur des deutschen Gesundheitswesens. Der Gültigkeitszeitraum der vorliegenden Version und deren Anwendung in Zulassungs- oder Abnahmeverfahren wird durch die gematik GmbH in gesonderten Dokumenten (z. B. Dokumentenlandkarte, Produkttypsteckbrief, Leistungsbeschreibung) festgelegt und bekannt gegeben.</p>
  <p id="polarion_54"></p>
  <p id="polarion_30"> <span style="font-weight: bold;font-size: 10pt;font-family: Arial, Helvetica, sans-serif;line-height: 1.5;">Schutzrechts-/Patentrechtshinweis</span> </p>
  <p id="polarion_55"> <span style="font-style: italic;font-size: 10pt;font-family: Arial, Helvetica, sans-serif;line-height: 1.5;">Die nachfolgende Spezifikation ist von der gematik allein unter technischen Gesichtspunkten erstellt worden. Im Einzelfall kann nicht ausgeschlossen werden, dass die Implementierung der Spezifikation in technische Schutzrechte Dritter eingreift. Es ist allein Sache des Anbieters oder Herstellers, durch geeignete Maßnahmen dafür Sorge zu tragen, dass von ihm aufgrund der Spezifikation angebotene Produkte und/oder Leistungen nicht gegen Schutzrechte Dritter verstoßen und sich ggf. die erforderlichen Erlaubnisse/Lizenzen von den betroffenen Schutzrechtsinhabern einzuholen. Die gematik GmbH übernimmt insofern keinerlei Gewährleistungen.</span> </p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104195">1.4 Abgrenzungen</h3>
  <p id="polarion_58"> Spezifiziert werden in diesem Dokument die von Authenticator-Modul und Anwendungsfrontend bzw.&nbsp;Web-Backend bereitgestellten Schnittstellen. Benutzte Schnittstellen werden hingegen in der Spezifikation desjenigen Produkttypen beschrieben, der diese Schnittstelle bereitstellt. Auf die entsprechenden Dokumente wird referenziert (siehe auch Anhang <span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-104219" data-option-id="shortoutline"></span>). </p>
  <p id="polarion_232">Das vorliegende Dokument beschreibt ausschließlich die Schnittstellen, welche durch das Authenticator-Modul oder ein Anwendungsfrontend bzw.&nbsp;Web-Backend bereitzustellen sind. Schnittstellen, welche durch den IDP-Dienst oder durch sektorale Identity Provider betrieben werden, sind im Dokument [gemSpec_IDP_Dienst] bzw. [gemSpec_IDP_Sek] beschrieben. Schnittstellen, welche durch Fachdienste zu bedienen sind, werden im Dokument [gemSpec_IDP_FD] beschrieben. Der Federation Master ist in [gemSpec_IDP_FedMaster] beschrieben.</p>
  <p id="polarion_59">Die vollständige Anforderungslage für die in diesem Dokument beschriebenen Anwendungen ergeben sich aus weiteren Konzept- und Spezifikationsdokumenten. Diese sind in dem Produkttypsteckbrief des Produkttyps IDP-Dienst&nbsp;[gemProdT_IDP-Dienst_PTV] verzeichnet.</p>
  <p id="polarion_60">Nicht Bestandteil des vorliegenden Dokumentes sind Festlegungen zu den Themenbereichen, wie beispielsweise der Umgang des Anwendungsfrontends mit den erlangten Fachdaten, welche proprietären Schnittstellen hierbei verwendet werden oder wie An- oder Abmeldeprozesse außerhalb der OpenID Connect (OIDC)- bzw. OpenAuthorization 2.0 (OAuth2) -Funktionalitäten abgebildet werden.</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104196">1.5 Methodik</h3>
  <p id="polarion_65">Anforderungen als Ausdruck normativer Festlegungen werden durch eine eindeutige ID in eckigen Klammern sowie die dem RFC 2119 [RFC2119] entsprechenden, in Großbuchstaben geschriebenen deutschen Schlüsselworte MUSS, DARF NICHT, SOLL, SOLL NICHT, KANN gekennzeichnet.</p>
  <p id="polarion_66"></p>
  <p id="polarion_67"> Sie werden im Dokument wie folgt dargestellt:<span style="font-weight: bold;font-family: Wingdings;"><br> </span> <span style="font-weight: bold;">&lt;AFO-ID&gt; - &lt;Titel der Afo&gt;</span><br> Text / Beschreibung<br> [&lt;=] </p>
  <p id="polarion_69" style="margin-left: 0px;">Dabei umfasst die Anforderung sämtliche zwischen Afo-ID und der Textmarke [&lt;=] angeführten Inhalte.</p>
  <p id="polarion_24"></p>
  <p id="polarion_31"> <span style="font-weight: bold;">Hinweis auf offene Punkte</span> </p>
  <table id="polarion_wiki macro name=table;params=header=no|width=100%|uid=4" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <td style="width: 591.6px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-style: italic;color: #3366FF;">Offene Punkten werden im Dokument in dieser Darstellung ausgewiesen.</span></td> 
    </tr> 
   </tbody> 
  </table>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-104198">2 Systemüberblick</h2>
  <p id="polarion_79">Der Systemüberblick des Authenticator-Moduls bzw. des Anwendungsfrontends unterscheidet sich vom Systemüberblick des Fachdienstes und des IDP-Dienstes geringfügig, weshalb an dieser Stelle auf die Beschreibung in [gemSpec_IDP_Dienst#Kap. 2 Systemüberblick] verwiesen wird. Der Unterschied ist, dass es sich beim Primärsystem um eine, aber auch zwei getrennte Anwendungsteile handeln kann, die in dem hier in diesem Dokument beschriebenen Frontend in einer Anwendung zusammengefasst sind. Es findet im Frontend des Versicherten keine Trennung von Anwendungsfrontend und Authenticator-Modul statt.</p>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-104199">3 Systemkontext</h2>
  <p id="polarion_17">Das Frontend des Nutzers besteht bei mobiler Nutzung in Form eines mobilen Endgeräts mit zwei logisch voneinander getrennten Komponenten, welche kombiniert in einer Anwendung auf derselben Hardware betrieben werden. Hierbei handelt es sich einerseits um das Authenticator-Modul, welches als dezentraler Teil des&nbsp;IDP-Dienstes den Authentifizierungsprozess wiederverwendbar (für weitere Anwendungsfrontends) kapselt und andererseits um das&nbsp;Anwendungsfrontend, welches Zugriff auf Fachdaten eines Fachdienstes erlangen will. Wenn das Anwendungsfrontend auf einen Fachdienst zugreifen will, muss sich der Nutzer über das Authenticator-Modul beim IDP-Dienst identifizieren. Als Identifikationsnachweis wird vom IDP-Dienst der Besitz der Smartcard (HBA, eGK oder SMC-B) erwartet und zudem, dass der aktuelle Nutzer der Smartcard auch die Kenntnis der dazugehörigen PIN hat.</p>
  <p id="polarion_46"> Die folgende Abbildung skizziert den Systemkontext aus der Sicht eines Endgerätes, auf dem das Authenticator-Modul und das Anwendungsfrontend kombiniert in einer Applikation installiert sind. Daraus ergeben sich Schnittstellen zu dem IDP-Dienst, dem Fachdienst und der Smartcard des Nutzers. Anforderungen zu den Schnittstellen des IDP-Dienstes werden für das Authenticator-Modul in&nbsp;<span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-104206" data-option-id="longoutline"></span>&nbsp; beschrieben. Anforderungen zu den Schnittstellen des IDP-Dienstes und des Fachdienstes werden für das Anwendungsfrontend in Kapitel <span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-108588" data-option-id="longoutline"></span>&nbsp; beschrieben. Weiterführende Informationen zur Interaktion werden in Kapitel&nbsp;<span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-104229" data-option-id="longoutline"></span>&nbsp; skizziert.<br> </p>
  <p id="polarion_274" style="text-align: center;"> <img src="attachments/Systemkoontext-Frontend-einApp.png" style="width: 508px;height: 392px;" data-lastmodified="2020-08-05T07:57:04.188+02:00"> </p>
  <p id="polarion_245" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">1</span>: Systemkontext aus Sicht des Frontend (bestehend aus Authenticator-Modul und Anwendungsfrontend) </p>
  <p id="polarion_253"></p>
  <p id="polarion_88"> Will ein Nutzer mit seinem Anwendungsfrontend auf einen Fachdienst zugreifen, kann dieser Zugriff nicht direkt erfolgen. Das Authenticator-Modul übernimmt den Aufruf und schickt diesen an den Authorization-Endpunkt. Der Authentifizierungsprozess des Nutzers verläuft zwischen dem Authenticator-Modul und dem IDP-Dienst. Bei einem positiven Verlauf der Authentifizierung liefert das Authenticator-Modul einen Authorization-Code an das Anwendungsfrontend. Gegen Vorlage dieses Codes erhält das Anwendungsfrontend vom IDP-Dienst sowohl einen&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span> als auch einen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span>. Das Anwendungsfrontend liefert den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> an den Fachdienst und erhält bei positiver Validierung des Tokens Zugang zu den Fachdienstdaten. </p>
  <p id="polarion_89"> Die Beschreibung der einzelnen Prozessschritte ist im Dokument [<span class="polarion-rte-link" data-type="polarion" id="fake" data-custom-label="gemSpec_IDP_Dienst#Kap.3.3" data-url="/wiki/Spezifikation/gemSpec_IDP_Dienst?selection=ML-104323"></span>] enthalten. </p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104200">3.1 Akteure und Rollen</h3>
  <p id="polarion_125"> Die Beschreibung der einzelnen Akteure und Rollen ist im Dokument [<span class="polarion-rte-link" data-type="polarion" id="fake" data-custom-label="gemSpec_IDP_Dienst#Kap.3.1" data-url="/wiki/Spezifikation/gemSpec_IDP_Dienst?selection=ML-104158"></span>] enthalten. </p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104201">3.2 Nachbarsysteme</h3>
  <p id="polarion_98"> Als Nachbarsysteme des Anwendungsfrontends sind das Authenticator-Modul (nur logisch innerhalb einer Anwendung vom Anwendungsfrontend getrennt), der IDP-Dienst (siehe [gemSpec_IDP_Dienst]) sowie die mit dem IDP-Dienst in Verbindung stehenden Fachdienste (siehe [gemSpec_IDP_FD]) zu nennen. Des Weiteren können das Authenticator-Modul und das Anwendungsfrontend als Teil eines Primärsystems realisiert werden. Die Nachbarsysteme ändern sich dadurch nicht.&nbsp;<br> </p>
  <p id="polarion_275" style="text-align: center;"> <img src="attachments/Nachbarsysteme-Frontend-einApp.png" style="width: 650px;height: 318px;" data-lastmodified="2020-08-05T07:59:46.459+02:00"> </p>
  <p id="polarion_269" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">2</span>: Systemüberblick mit Nachbarsystemen </p>
  <p id="polarion_270"></p>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-104202">4 Zerlegung des Produkttyps</h2>
  <p id="polarion_102">Das Frontend lässt sich in zwei Module aufteilen: in ein Authenticator-Modul und ein Anwendungsfrontend (GUI), welche in einer Applikation kombiniert sind. Bei der Nutzung innerhalb eines Primärsystems kann das Primärsystem auch vollständig die Funktionalität des Authenticator-Moduls übernehmen. Die Aufteilung in unterschiedliche Module existiert nur logisch, aber nicht in Form von unterschiedlichen Anwendungen.</p>
  <p id="polarion_233" style="text-align: center;"> <img src="attachments/Zerlegung-Frontend-einApp.png" style="width: 333px;height: 305px;" data-lastmodified="2020-08-05T08:05:12.891+02:00"> </p>
  <p id="polarion_94" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">3</span>: Zerlegung des Frontends </p>
  <p id="polarion_265"></p>
  <p id="polarion_42"> <span style="font-weight: bold;">Authenticator-Modul</span> </p>
  <p id="polarion_103">Das Authenticator-Modul bietet die Schnittstelle zum IDP-Dienst an und ist gemeinsam mit dem Anwendungsfrontend in einer mobilen App kombiniert. Für Primärsysteme muss das Authenticator-Modul&nbsp;als Bestandteil des Primärsystems implementiert werden (siehe [gemILF_PS_eRp]). Als Primärsysteme sollen hier PVS (ärztliche und zahnärztliche Praxisverwaltungssystem), KIS (Krankenhausinformationssystem) und AVS (Apothekenverwaltungssystem) genannt sein. Die Beschreibung des Authenticator-Moduls erfolgt in diesem Dokument, weil das Authenticator-Modul einen wesentlichen Bestandteil des Nutzer-Endgerätes/Gerät des Versicherten (GdV) darstellt und somit nicht in der zentralen Providerzone der Telematikinfrastruktur&nbsp;betrieben wird. Authenticator-Modul und Anwendungsfrontend werden in diesem Zusammenhang als ortsveränderliche Komponenten auf unsicheren Endgeräten betrachtet.</p>
  <p id="polarion_266"></p>
  <p id="polarion_87"> <span style="font-weight: bold;">Anwendungsfrontend</span> </p>
  <p id="polarion_105"> Das Anwendungsfrontend <span style="font-size: 10pt;line-height: 1.5;">ist eine Software, welche innerhalb der Telematikinfrastruktur lesend oder schreibend auf die Daten der Fachdienste zugreift</span>. </p>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-104218">5 Verteilungssicht</h2>
  <p id="polarion_142"> Die Beschreibung der theoretisch möglichen Verwendung unterschiedlicher Authenticator-Modul-Profile bleibt hier aus, da durch das beschriebene Authenticator-Modul ausschließlich ein einziger IDP-Dienst adressiert wird. Es ist somit für den IDP-Dienst der TI ausschließlich ein einziges Authenticator-Modul zugelassen. Die gematik behält sich das Recht vor, hieran Änderungen vorzunehmen.<br> </p>
  <p id="polarion_187" style="text-align: center;"> <img src="attachments/Verteilung-Endgerät-einApp.png" style="width: 616px;height: 263px;" data-lastmodified="2020-08-05T08:00:40.521+02:00"> </p>
  <p id="polarion_195" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">4</span>: Verteilungssicht beim Einsatz eines mobilen Endgerätes&nbsp; </p>
  <p id="polarion_200"> <br> Teilsysteme (Module der App des Versicherten) sind zusammen auf einem Gerät, aber niemals auf mehreren Geräten verteilt, vorhanden. Als Liste der möglichen Teilsysteme seien die folgenden genannt: </p>
  <ul id="polarion_202"> 
   <li>Mobiles Endgerät des Nutzers (z. B. Android Smartphone, Apple iPhone)</li> 
   <li>Stationäres Endgerät des Nutzers (z. B. Konnektor, PVS, AVS, KIS)</li> 
  </ul>
  <p id="polarion_205"> <span style="font-style: italic;">Hinweis: Die beiden Teilsysteme Authenticator-Modul und Anwendungsfrontend können in zukünftigen Versionen ggf. auch auf getrennten Endgeräten &lt;&lt;device&gt;&gt; betrieben werden.</span> </p>
  <p id="polarion_212"> Bei der Nutzung eines stationären Endgerätes und eines Primärsystems, sind das Authenticator-Modul und das Anwendungsfrontend Teil des Primärsystems.<br> </p>
  <p id="polarion_214" style="text-align: center;"> <img src="attachments/Verteilung-Primärsystem2.png" style="width: 546px;height: 269px;" data-lastmodified="2020-07-28T08:44:01.874+02:00"> </p>
  <p id="polarion_224" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">5</span>: Verteilungssicht beim Einsatz eines stationären Endgerätes und eines Primärsystems </p>
  <p id="polarion_235"></p>
  <p id="polarion_264">In jedem Fall benötigt jeder Nutzer genau ein Endsystem, auf welchem das Authenticator-Modul gemeinsam mit dem Anwendungsfrontend installiert und eingerichtet ist.</p>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-104203">6 Übergreifende Festlegungen</h2>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-111156">6.1 Kommunikation mit Diensten der TI</h3>
  <p id="polarion_85"> Anwendungsfrontends und das Authenticator-Modul nutzen TLS-Verbindungen für die Kommunikation zu den Diensten der TI.<br> Das Anwendungsfrontend und das Authenticator-Modul ermitteln die Informationen zu den Endpunkten des Identity Providers&nbsp;aus dem Discovery Document. </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111164">
   <p><b>A_20606</b></p>
   <p>Das Anwendungsfrontend MUSS mit dem IDP-Dienst über TLS kommunizieren. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111162">
   <p><b>A_20607</b></p>
   <p>Das Authenticator-Modul MUSS mit dem IDP-Dienst der TI <span style="font-size: 10pt;line-height: 1.5;">über TLS kommunizieren.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111163">
   <p><b>A_20608</b></p>
   <p>Das Anwendungsfrontend MUSS bei jedem Verbindungsaufbau den IdP-Dienst anhand seines TLS-Zertifikats authentifizieren und MUSS die Verbindung ablehnen, falls die Authentifizierung fehlschlägt. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111167">
   <p><b>A_20609</b></p>
   <p>Das Authenticator-Modul MUSS bei jedem Verbindungsaufbau den IDP-Dienst anhand seines TLS-Zertifikats authentifizieren und MUSS die Verbindung ablehnen, falls die Authentifizierung fehlschlägt. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111168">
   <p><b>A_20610</b></p>
   <p>Das Authenticator-Modul MUSS in allen HTTP-Requests an den IDP-Dienst den HTTP-Header „user-agent“ gemäß [RFC7231] mit <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&lt;Hersteller-ID&gt; &lt;Produktkürzel&gt;/&lt;Produktversion&gt;</span> gemäß der Produktidentifikation des E-Rezept-FdV befüllen.&nbsp; <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111166">
   <p><b>A_20612</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Das Authenticator-Modul MUSS die Fehlermeldung des IDP-Dienstes an den Benutzer durchreichen, wenn dieser die Durchführung des Authentifizierungsprozesses ablehnt</span>. <b>&lt;=</b></p>
  </div>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-104204">7 Funktionsmerkmale Authenticator-Modul des IDP-Dienstes</h2>
  <p id="polarion_120">Das Authenticator-Modul ist ein Modul, welches gemeinsam mit dem Anwendungsfrontend in einer Applikation für mobile Endgeräte wie Smartphones bereitgestellt wird.&nbsp;Bei Nutzung eines Primärsystems&nbsp;wird die Funktionalität des Authenticator-Moduls vom Primärsystem selbst realisiert.</p>
  <p id="polarion_121"> Die Bereitstellung der&nbsp;<span style="font-size: 10pt;line-height: 1.5;">Anwenderfrontends&nbsp;</span>erfolgt über die dem jeweiligen Betriebssystem üblicherweise zur Verfügung stehenden Portale in einer sicheren, für den Nutzer kostenfreien Form. Im Falle des Betriebssystems Android erfolgt die Bereitstellung im Google Play Store oder dem zukünftig für dieses Betriebssystem etablierten Portal. </p>
  <p id="polarion_122">Für das Betriebssystem iOS findet die sichere Bereitstellung im Apple App Store statt, wobei dem Nutzer auch hier keine Kosten durch den Abruf der Software entstehen dürfen.</p>
  <p id="polarion_81"> Aufgabe des Authenticator-Moduls ist, die von einem Anwendungsfrontend zum Zugriff auf Fachdienste benötigten <span style="font-weight: normal;font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span><span style="font-weight: bold;font-family: 'Courier New', Courier, monospace, HanWangKanTan;">,&nbsp;<span style="font-weight: normal;">ACCESS_TOKEN</span></span> und&nbsp;<span style="font-weight: normal;font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> mit Zustimmung des Nutzers (Resource Owner) und nach eingehender Überprüfung dessen Identität am Authorization-Endpunkt zu beantragen. Hierfür wird vom Authorization-Endpunkt ein <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> ausgestellt, der vom Authenticator-Modul an das Anwendungsfrontend übergeben wird. Das gleichzeitig vom Authorization-Endpunkt übergebene <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> wird vom Authenticator-Modul selbst gespeichert und wird von diesem für einen zukünftigen Authentifizierungsprozess ohne erneute Abfrage der Zugangsdaten des Nutzers verwendet.&nbsp;<span style="color: #000000;">Das SSO-Token erfüllt hier die Funktion eines Refresh-Token</span><span style="color: #0000FF;">.<span id="polarion-comment:866"></span>&nbsp;</span>Durch Übergabe des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> erhält das Anwendungsfrontend am Token-Endpunkt das <span style="font-weight: normal;font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span><span style="font-weight: bold;font-family: 'Courier New', Courier, monospace, HanWangKanTan;"> </span><span style="font-family: Arial, Helvetica;"><span style="font-weight: normal;">und</span><span style="font-weight: bold;"> </span></span><span style="font-weight: normal;font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span>. </p>
  <p id="polarion_84"> Die für die Beantragung des&nbsp;<span style="font-weight: normal;font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span> und <span style="font-weight: normal;font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span>&nbsp;notwendigen Informationen bekommt das Authenticator-Modul vom Anwendungsfrontend übergeben. Weitere Informationen bezieht das Authenticator-Modul mittels Near Field Communication-Schnittstelle&nbsp;(NFC) von einer Smartcard. Die notwendige elektronische Signatur&nbsp;im Challenge-Response-Verfahren ruft das Authenticator-Modul ebenfalls von der Smartcard ab und fordert hierbei den Nutzer zur PIN-Eingabe auf. Im Fall eines Primärsystems erfolgt diese Aktion ohne Interaktion mit dem Nutzer im Hintergrund. Weitere nicht normative Informationen hierzu finden sich im Kapitel <span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-104229" data-option-id="shortoutline"></span>. </p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-111161">7.1 Vorbereitende Maßnahmen</h3>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111169">
   <p><b>A_20613</b></p>
   <p>D<span style="font-size: 10pt;line-height: 1.5;">as Authenticator-Modul MUSS das Discovery Document [RFC8414] bei eingeschaltetem Gerät regelmäßig alle 24 Stunden einlesen und auswerten, und danach die darin aufgeführten URI zu den benötigten</span> öffentlichen Schlüsseln (Public Keys – <span style="font-size: 10pt;line-height: 1.5;">PUK) und Diensten verwenden.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111170">
   <p><b>A_20614</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Das Authenticator-Modul MUSS die Signatur des Discovery Document&nbsp;mathematisch prüfen und auf ein zeitlich gültiges C.FD.SIG-Zertifikat mit der Rollen-OID <span style="font-style: italic;">oid_idpd</span> zurückführen können, welches von einer ihm bekannten Komponenten-PKI ausgestellt wurde.</span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_95"> Details zur Aktualisierung und sicheren Aufbewahrung der Komponenten-CAs finden sich in <span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-111160" data-option-id="longoutline"></span>. </p>
  <p id="polarion_36"> Details zur Kodierung der Signatur des Discovery Document finden sich in [gemSpec_IDP_Dienst#Kapitel 5.1.3 <span style="font-size: 10pt;line-height: 1.5;">Schutz des Discovery Document</span>]. </p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104206">7.2 Schnittstellen des Authenticator-Moduls</h3>
  <p id="polarion_126">Schnittstellen des Authenticator-Moduls sind diejenigen, an welchen es Anfragen durch das Anwendungsfrontend&nbsp;empfängt&nbsp;und jene, welche das Authenticator-Modul selbst verwendet, um mit dem Authorization-Endpunkt des IDP-Dienstes in Kontakt zu treten.</p>
  <p id="polarion_206"> Das Authenticator-Modul nimmt die Authentifizierungs-Anfrage des Anwendungsfrontends entgegen und nutzt den Authorization-Endpunkt des IDP-Dienstes, um die Anfrage einzureichen. Der Authorization-Endpunkt des IDP-Dienstes antwortet – nach positiver Validierung der Anfrage – mit einem <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span>. Das Authenticator-Modul nimmt den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> und leitet diesen an das Anwendungsfrontend weiter. Nachfolgende Abbildung skizziert die Schnittstellen des Authenticator-Moduls. Komponenten und Schnittstellen, welche nicht direkt vom Authenticator-Modul genutzt werden, sind in der Abbildung grau hinterlegt. </p>
  <p id="polarion_140" style="text-align: center;"> <img src="attachments/Authenticator-Comp-neu2.png" style="width: 617px;height: 464px;" data-lastmodified="2020-07-27T05:22:12.794+02:00"> </p>
  <p id="polarion_209" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">6</span>: Schnittstellen des Authenticator-Moduls </p>
  <p id="polarion_210"></p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-104207">7.2.1 Schnittstellendefinition</h4>
  <p id="polarion_240">Eingehende Daten am Authenticator-Modul stammen vom IDP-Dienst und wurden&nbsp;dort zuvor mit dem aktuellen Signaturzertifikat signiert. Zusätzlich wird die Integrität durch den TLS-Kanal geschützt.</p>
  <p id="polarion_35"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-112751">
   <p><b>A_20917</b></p>
   <p>Das Authenticator-Modul MUSS vor der Übertragung des Authorization Request (siehe [A_20601]) überprüfen, ob noch ein gültiges <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> im Dateisystem (siehe [A_20499-*]) vorhanden ist.<br> Ist ein solches <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> im Dateisystem vorhanden, MUSS das Authenticator-Modul dieses <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> an den Authorization-Endpunkt senden.<br> Ist kein solches <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> im Dateisystem vorhanden, MUSS das Authenticator-Modul die Anfrage gemäß [A_20601] fortsetzen und somit einen neuen Authentifizierungsprozess einleiten. <b>&lt;=</b></p>
  </div>
  <p id="polarion_93"> <span style="font-style: italic;">Hinweis: Die Prüfung der Gültigkeit des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> ergibt sich aus dessen maximaler Gültigkeitsdauer, welche je nach Fachdienst unterschiedlich sein kann und insgesamt durch den Anbieter des IDP-Dienstes eingegrenzt ist. Eine Integritätsprüfung des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> ist nicht möglich, weil das <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> für den Authorization-Endpunkt mit dessen öffentlichen Schlüssel verschlüsselt ist</span>. </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111151">
   <p><b>A_20601</b></p>
   <p>Das Authenticator-Modul MUSS den Authorization-Request, welchen dieses&nbsp;vom Anwendungsfrontend erhalten hat, an den Authorization-Server des IdP-Dienstes schicken. Der Authorization-Request MUSS&nbsp;folgende Parameter enthalten: 
    <ul>
     <li>"<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">response_type</span>"</li>
     <li>"<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">scope</span>"</li>
     <li>"<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">client_id</span>"</li>
     <li>"<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">redirect_uri</span>"</li>
     <li><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">"code_challenge"</span> (Hashwert des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">"code_verifier"</span>) [<a class="descriptionLink" target="_top" href="https://tools.ietf.org/html/rfc7636#section-4.2">RFC7636 # section-4.2</a>]<br></li>
     <li><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">"code_challenge_method"</span> HASH-Algorithmus (S256) [<a class="descriptionLink" target="_top" href="https://tools.ietf.org/html/rfc7636#section-4.3">RFC7636 # section-4.3</a>]</li>
    </ul> <b>&lt;=</b></p>
  </div>
  <p id="polarion_197"> <span style="font-style: normal;font-family: Arial, Helvetica;">Der Aufbau der Anfrage entspricht [gemSpec_IDP_Dienst#Kapitel </span>7.1 Authorization Request]<span style="font-style: normal;font-family: Arial, Helvetica;">.</span> </p>
  <p id="polarion_215"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111150">
   <p><b>A_20600</b></p>
   <p>Das Authenticator-Modul MUSS den&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">user_consent</span> und den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE_TOKEN</span> vom Authorization-Endpunkt des IDP-Dienstes entgegennehmen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_171"> <span style="font-style: italic;">Hinweis 1</span>: <span style="font-style: italic;">Der Authorization-Endpunkt des IDP-Dienstes, welcher die Nutzerauthentifizierung durchführt und für die Ausstellung des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> zuständig ist, liefert den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">user_consent</span> und das <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE_TOKEN</span> als Antwort auf den Authorization-Request des Authenticator-Moduls.</span> </p>
  <p id="polarion_19"> <span style="font-style: italic;">Hinweis 2: Der Aufbau der Antwort und des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE_TOKEN</span> entspricht [gemSpec_IDP_Dienst#Kapitel 7.2 Authorization Response].</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110803">
   <p><b>A_20525</b></p>
   <p>Das Authenticator-Modul MUSS im Zusammenhang mit der PIN-Abfrage für die Signatur des&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE_TOKEN</span> durch die Smartcard im selben Dialog die Consent-Freigabe des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">user_consent</span> durch den Nutzer einfordern, damit dieser durch die PIN-Eingabe seine Willenserklärung abgibt und der Verwendung seiner Daten in diesen Claims zustimmt. <b>&lt;=</b></p>
  </div>
  <p id="polarion_20"> <span style="font-style: italic;">Hinweis:</span> <span style="font-style: italic;">Bei Primärsystemen kann auf eine erneute PIN-Eingabe und Consent-Freigabe verzichtet werden, solange sich die SMC-B im freigeschalteten Modus befindet.</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111187">
   <p><b>A_19908-01</b></p>
   <p>Das Authenticator-Modul MUSS die Signatur des&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE_TOKEN</span> gegen den aktuellen öffentlichen Schlüssel des Authorization-Endpunktes&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PUK_AUTH</span> prüfen. Liegt dem Authenticator-Modul der öffentliche Schlüssel des Authorization-Endpunktes noch nicht vor, <span style="font-weight: normal;">MUSS</span> es diesen vom Authorization Server gemäß den Angaben der Adresse <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PUK_URI_AUTH</span> im Discovery Document abrufen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_86">Das Authenticator-Modul wird vom Anwendungsfrontend zur Authentifizierung gegenüber dem IDP-Dienst herangezogen. Das Anwendungsfrontend ist eine beim IDP-Dienst als "OpenID Connect-Client" registrierte Software. Das Anwendungsfrontend erhält seinerseits bei der Registrierung am IDP-Dienst einen eindeutigen Identifier.</p>
  <p id="polarion_241"> Da sich Authenticator-Modul und Anwendungsfrontend immer auf ein und demselben Endgerät des Nutzers befinden, ist es nicht notwendig, dass der IDP-Dienst deren Adressierung im Voraus kennt. Will nun das Anwendungsfrontend einen Zugriff auf den entsprechenden Fachdienst initiieren, leitet es eine Anfrage an die vom IDP-Dienst bekanntgegebene URI. Die Anfrage wird innerhalb der Anwendung dem Authenticator-Modul zugewiesen. Das Authenticator-Modul bereitet die Anfrage auf und prüft, ob alle Voraussetzungen erfüllt sind. Dann leitet das Authenticator-Modul die Anfrage an den Authorization-Endpunkt des IDP-Dienstes weiter. Der IDP-Dienst erzeugt eine <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">session_id</span> und fordert (im Falle eines mobilen Endgerätes) vom Authenticator-Modul die Signatur einer&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE</span> durch das vorgesehene Identifikationsmittel. Im Falle eines Versicherten die eGK, und im Falle einer Leistungserbringerinstitution die SM-B welche über das Primärsystems durch die Operation ExternalAuthenticate des Konnektors gemäß [gemSpec_Kon#4.1.13.4] bzw. [gemILF_PS#4.4.6.1] angesprochen wird. Das Token wird hierbei nicht selbst signiert, sondern der darüber gebildete HASH-Wert (siehe Abschnitt <span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-107239" data-option-id="longoutline"></span> in diesem Dokument). </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118600">
   <p><b>A_20700-07</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Das Authenticator-Modul MUSS die vom Authorization-Endpunkt empfangene <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE_TOKEN</span>&nbsp;mit dem Zertifikat C.CH.AUT aus der Smartcard des Nutzers signieren. Hierbei wird der über die&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE_TOKEN</span>&nbsp;gebildete HASH-Wert zur Signatur überreicht (siehe Abschnitt&nbsp;<span class="polarion-rte-link" data-type="polarion" id="fake" data-custom-label="9.3.7.3&nbsp;Signiervorgang" data-url="/wiki/Spezifikation/gemSpec_IDP_Frontend?selection=ML-107239"></span>&nbsp;in diesem Dokument).<br> </span> Im Fall der Authentisierung mit einem alternativen Authentisierungsmittel signiert das Authenticator-Modul die folgenden Daten mithilfe des PrK_SE_AUT: <br> 
    <ul> 
     <li><span style="font-size: 10pt;line-height: 1.5;">das vom Authorization-Endpunkt bezogene <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE-TOKEN</span>,</span></li> 
     <li><span style="font-size: 10pt;line-height: 1.5;">das auf dem Gerät gespeicherte Authentifizierungszertifikat C.CH.AUT,</span></li> 
     <li><span style="font-size: 10pt;line-height: 1.5;">den Key-Identifier für das Schlüsselpaar PrK_SE_AUT/PuK_SE_AUT,</span></li> 
     <li><span style="font-size: 10pt;line-height: 1.5;">die aktuell erhobenen Geräteinformationen,</span></li> 
     <li><span style="font-size: 10pt;line-height: 1.5;">die Art des vom Nutzer verwendeten, lokalen Authentisierungsmittels zur Freischaltung der Anwendung des Schlüssels PrK_SE_AUT.</span></li> 
    </ul> Es MUSS hierbei eine Datenstruktur vom Typ "Signed_Authentication_Data" produzieren. Der zur Signatur zu verwendende Algorithmus MUSS ECDSA mit SHA-256 sein. Das Feld&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">amr</span> MUSS hierbei wie folgt in Abhängigkeit der vom Nutzer verwendeten Methode belegt werden:<span style="font-size: 10pt;line-height: 1.5;"><span style="background-color: #FFFF33;"><br> </span><br> </span> <p class="polarion-rte-caption-paragraph" style="text-align: left;" id="polarion___1"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">1</span>:&nbsp;&nbsp;Belegung des&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">amr</span>-Claims durch das Authenticator-Modul </p> 
    <table id="polarion_wiki macro name=table;params=width=100%|uid=739" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
     <tbody> 
      <tr> 
       <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 365px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Art&nbsp;</th> 
       <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 366px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Authentication-Method-Reference ("amr")</th> 
      </tr> 
      <tr> 
       <td style="vertical-align: top;width: 365px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Biometrisch</td> 
       <td style="vertical-align: top;width: 366px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">["mfa","hwk","generic-biometric"]</td> 
      </tr> 
      <tr> 
       <td style="vertical-align: top;width: 365px;height: 20px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">PIN</td> 
       <td style="vertical-align: top;width: 366px;height: 20px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">["mfa","hwk","kba"]</td> 
      </tr> 
      <tr> 
       <td style="vertical-align: top;width: 365px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Passwort</td> 
       <td style="vertical-align: top;width: 366px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">["mfa","hwk","kba"]&nbsp;</td> 
      </tr> 
      <tr> 
       <td style="vertical-align: top;width: 365px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Muster</td> 
       <td style="vertical-align: top;width: 366px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">["mfa","hwk","kba"]&nbsp;</td> 
      </tr> 
     </tbody> 
    </table> <b>&lt;=</b></p>
  </div>
  <p id="polarion_18"> <span style="font-style: italic;">Hinweis: Der Datentyp "Signed_Authentication_Data" ist in Anhang C des Dokuments [gemSpec_IDP_Dienst] beschrieben.</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-114491">
   <p><b>A_20526-01</b></p>
   <p>Das Authenticator-Modul MUSS das eingereichte <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE_TOKEN</span> mittels JWS (JSON Web Signature) mit der Smartcard signieren, und das Authentifizierungszertifikat der verwendeten Smartcard als x5c Parameter einbetten. Dieses Objekt mittels JWE (JSON Web Encryption) mit dem öffentlichen Schlüssel des Authorization-Endpunktes&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PuK_IDP_ENC</span> verschlüsseln und in Form eines HTTP-POST-Requests an den Authorization-Endpunkt senden.<br> <b>&lt;=</b></p>
  </div>
  <p id="polarion_181"> <span style="font-style: italic;">Hinweis 1: Das Signieren und Verschlüsseln des&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE_TOKEN</span> ist durch die Verwendung eines Nested JWT [angelehnt an den folgenden Draft: <a href="https://tools.ietf.org/html/draft-yusef-oauth-nested-jwt-03" target="_top" class="descriptionLink">https://tools.ietf.org/html/draft-yusef-oauth-nested-jwt-03</a> zu realisieren. Im cty-Header ist "NJWT" zu setzen, um anzuzeigen, dass es sich um einen Nested JWT handelt. Das Signieren wird dabei durch die Verwendung einer JSON Web Signature (JWS) [RFC7515 # section-Compact Serialization] gewährleistet. Die Verschlüsselung des signierten Token wird durch die Nutzung der JSON Web Encryption (JWE) [RFC7516 # section-3] sichergestellt. Als Verschlüsselungsalgorithmus ist ECDH-ES (Elliptic Curve Diffie-Hellman Ephemeral Static key agreement) vorgesehen.</span> </p>
  <p id="polarion_207"> <span style="color: #000000;"><span style="font-style: italic;">Hinweis 2</span>: Der Aufbau der Anfrage entspricht [gemSpec_IDP_Dienst#Kapitel </span>7.3 Authentication Request<span style="color: #000000;">].</span><span style="color: #FF0000;">&nbsp;</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110806">
   <p><b>A_20527</b></p>
   <p>Das Authenticator-Modul MUSS den vom Authorization-Endpunkt empfangenen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> an das Anwendungsfrontend übertragen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_41"> <span style="font-style: italic;">Hinweis 1: Der Authorization-Endpunkt liefert den&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> gemeinsam mit dem <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span>" innerhalb einer HTTP-Redirection (HTTP-Status Code 302) an das Authenticator-Modul zurück. Der Wert des Attributs&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">location</span> der HTTP 302 Response ist die vom Anwendungsfrontend beim mobilen Betriebssystem registrierte URI. Beim Aufruf der URI wird automatisch das Anwendungsfrontend mit der Verarbeitung der URI gestartet.</span> </p>
  <p id="polarion_61"> <span style="font-style: italic;"><span style="color: #000000;">Hinweis 2: Der Aufbau der Header entspricht [gemSpec_IDP_Dienst#</span>Kapitel 7.4 Authentication Response].</span> </p>
  <p id="polarion_106"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110324">
   <p><b>A_20284</b></p>
   <p>Das Authenticator-Modul <span style="font-weight: normal;">MUSS </span>das vom Token-Endpunkt ausgegebene&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> in der HTTP/1.1 Statusmeldung 302 verarbeiten. Das Authenticator-Modul MUSS das <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> ablehnen, wenn dieses außerhalb der mit dem Token-Endpunkt&nbsp;etablierten TLS-Verbindung übertragen wird. <b>&lt;=</b></p>
  </div>
  <p id="polarion_167"> <span style="font-style: italic;">Hinweis: Der IDP-Dienst hat das <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> mit dem privaten Schlüssel <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PRK_AUTH</span> für sich signiert und verschlüsselt. Das Authenticator-Modul kann und braucht den Inhalt des Tokens nicht zu lesen. Durch die Vorlage des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> kann bei Bedarf ein neuer&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> am Authorization-Endpunkt ohne die erneute Authentisierung des Nutzers erzeugt werden.</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116341|project=Mainline_OPB1|layout_workitem_type=leafRequirement|layout_content_type=section|serverPath=https://polarion.int.gematik.de">
   <p><b>A_21322</b></p>
   <p>Das Authenticator-Modul MUSS empfangene SSO-Token gegen unberechtigten Zugriff schützen.<span id="polarion-comment:797"></span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-114497">
   <p><b>A_20499-01</b></p>
   <p>Das Authenticator-Modul MUSS <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN </span>löschen, wenn der Anwender einen aktiven Logout durchführt. Dazu MUSS das Authenticator-Modul dem Anwender eine auslösende Funktionalität anbieten.&nbsp;<br> <b>&lt;=</b></p>
  </div>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-104209">7.2.2 Nutzung</h4>
  <p id="polarion_185"> Die im Abschnitt&nbsp;<span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-104207" data-option-id="shortoutline"></span>&nbsp;beschriebenen Schnittstellen des Authenticator-Moduls werden durch das Anwendungsfrontend genutzt. Die Nutzung durch das Anwendungsfrontend erfolgt hierbei zwangsläufig vom gleichen Gerät aus. </p>
  <p id="polarion_188">Die verwendeten Standards sind:</p>
  <ul id="polarion_238"> 
   <li><span style="font-size: 10pt;line-height: 1.5;">RFC3986 (URI)</span></li> 
   <li><span style="font-size: 10pt;line-height: 1.5;">RFC7165 (JOSE)</span></li> 
   <li><span style="font-size: 10pt;line-height: 1.5;">RFC7231 (HTTP)</span></li> 
   <li><span style="font-size: 10pt;line-height: 1.5;">RFC7515 (JWS JSON SIGNATURE)</span></li> 
   <li><span style="font-size: 10pt;line-height: 1.5;">RFC7516 (JWE JSON ENCRYPTION)</span></li> 
   <li><span style="font-size: 10pt;line-height: 1.5;">RFC7517 (JWK JSON KEY)</span></li> 
   <li><span style="font-size: 10pt;line-height: 1.5;">RFC7518 (JWE JSON ALGORITHM)</span></li> 
   <li><span style="font-size: 10pt;line-height: 1.5;">RFC7519 (JWT JSON WEB TOKEN)</span></li> 
   <li><span style="font-size: 10pt;line-height: 1.5;">RFC7520 (JOSE Protection)</span></li> 
   <li><span style="font-size: 10pt;line-height: 1.5;">RFC7521 (Assertion Authorization)</span></li> 
   <li><span style="font-size: 10pt;line-height: 1.5;">RFC7522 (Assertion SAML 2.0)</span></li> 
   <li><span style="font-size: 10pt;line-height: 1.5;">RFC7523 (JSON TOKEN Profile)</span></li> 
   <li><span style="font-size: 10pt;line-height: 1.5;">RFC6749 (OAuth 2.0 Authorization)</span></li> 
   <li><span style="font-size: 10pt;line-height: 1.5;">RFC6750 (OAuth 2.0 Bearer)&nbsp;</span></li> 
   <li><span style="font-size: 10pt;line-height: 1.5;">RFC7636 (Proof Key for Code Exchange by OAuth Public Clients)&nbsp;</span></li> 
   <li><span style="font-size: 10pt;line-height: 1.5;">RFC7662 (OAuth 2.0 TOKEN INTROSPECTION)</span></li> 
   <li><span style="font-size: 10pt;line-height: 1.5;">RFC8252 (OAuth 2.0 for Native Apps)</span></li> 
  </ul>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104216">7.3 Hardwaremerkmale</h3>
  <p id="polarion_169">Das Authenticator-Modul greift auf die NFC-Schnittstelle des Nutzer-Endgerätes oder auf einen angeschlossenen Smartcard-Reader zu, um das nonQES-Signatur-Zertifikat auszulesen und gegen Einforderung der PIN-Eingabe im Challenge-Response-Verfahren eine Signatur auszulösen.</p>
  <p id="polarion_176">Das Endgerät des Nutzers muss in der Lage sein über NFC mit der eGK oder dem HBA zu kommunizieren. Die hierfür notwendige Middleware ist als gegebene Voraussetzung anzusehen und somit Bestandteil des Betriebssystems bzw. wird zusammen mit dem Authenticator-Modul installiert und ist insofern durch den Anbieter des IDP-Dienstes bereitzustellen.</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-111159">7.4 Zertifikatsprüfung</h3>
  <p id="polarion_234"> Das Authenticator-Modul verwendet bei den in TAB_Authenticator_001 dargestellten Aktivitäten Zertifikate.<br> </p>
  <p id="polarion_28" style="text-align: left;" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">2</span>: TAB_Authenticator_001 – Zertifikatsnutzung des Authenticator-Modul </p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=6" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 128px;height: 38px;border: 1px solid #CCCCCC;padding: 5px;">Aktivität</th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 58px;height: 38px;border: 1px solid #CCCCCC;padding: 5px;">Zertifikat der TI</th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 85px;height: 38px;border: 1px solid #CCCCCC;padding: 5px;">Zertifikatstyp</th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 238px;height: 38px;border: 1px solid #CCCCCC;padding: 5px;">Rollen-OID</th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 52px;height: 38px;border: 1px solid #CCCCCC;padding: 5px;">Nutzung</th> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 128px;height: 57px;border: 1px solid #CCCCCC;padding: 5px;">TLS-Verbindungsaufbau zum IDP-Dienst</td> 
     <td style="text-align: left;vertical-align: top;width: 58px;height: 57px;border: 1px solid #CCCCCC;padding: 5px;">nein</td> 
     <td style="text-align: left;vertical-align: top;width: 85px;height: 57px;border: 1px solid #CCCCCC;padding: 5px;">TLS Internet Zertifikat</td> 
     <td style="text-align: left;vertical-align: top;width: 238px;height: 57px;border: 1px solid #CCCCCC;padding: 5px;">n/a</td> 
     <td style="text-align: left;vertical-align: top;width: 52px;height: 57px;border: 1px solid #CCCCCC;padding: 5px;">aktiv</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 128px;height: 57px;border: 1px solid #CCCCCC;padding: 5px;">Prüfung des&nbsp;Discovery Document</td> 
     <td style="text-align: left;vertical-align: top;width: 58px;height: 57px;border: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="text-align: left;vertical-align: top;width: 85px;height: 57px;border: 1px solid #CCCCCC;padding: 5px;">C.FD.SIG</td> 
     <td style="text-align: left;vertical-align: top;width: 238px;height: 57px;border: 1px solid #CCCCCC;padding: 5px;">oid_idpd</td> 
     <td style="text-align: left;vertical-align: top;width: 52px;height: 57px;border: 1px solid #CCCCCC;padding: 5px;">aktiv</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 128px;height: 57px;border: 1px solid #CCCCCC;padding: 5px;">Signatur der Challenge des IDP mittels Smartcard</td> 
     <td style="text-align: left;vertical-align: top;width: 58px;height: 57px;border: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="text-align: left;vertical-align: top;width: 85px;height: 57px;border: 1px solid #CCCCCC;padding: 5px;">C.CH.AUT<br> C.HP.AUT<br> C.HCI.AUT</td> 
     <td style="text-align: left;vertical-align: top;width: 238px;height: 57px;border: 1px solid #CCCCCC;padding: 5px;">oid_versicherter<br> gemäß [gemSpec_OID#Tab_PKI_402]<br> gemäß [gemSpec_OID#Tab_PKI_403]</td> 
     <td style="text-align: left;vertical-align: top;width: 52px;height: 57px;border: 1px solid #CCCCCC;padding: 5px;">passiv</td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_297"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-112746">
   <p><b>A_20617-01</b></p>
   <p>Das Authenticator-Modul MUSS aktiv verwendete Zertifikate (bspw. für den TLS-Verbindungsaufbau), welche auf Root-Zertifikaten aus der TSL basieren, gemäß "TUC_PKI_018" auf Integrität und Authentizität prüfen. Das Authenticator-Modul MUSS die von dem Zertifikat und den darin enthaltenen Attributen (bspw. öffentliche Schlüssel) abhängenden Arbeitsabläufe ablehnen, wenn die Prüfung kein positives Ergebnis ("gültig") liefert.&nbsp;Das Authenticator-Modul MUSS alle öffentlichen Schlüssel, die es verwenden will, auf eine positiv verlaufene Zertifikatsprüfung zurückführen können. <b>&lt;=</b></p>
  </div>
  <p id="polarion_104"> <span style="font-style: italic;">Hinweis</span>: <span style="font-style: italic;">"Ein Zertifikat aktiv verwenden" bedeutet im Sinne von&nbsp;[<span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-112746" data-option-id="longoutline"></span>], dass ein Authenticator-Modul einen dort aufgeführten öffentlichen Schlüssel innerhalb einer kryptografischen Operation (Signaturprüfung, Verschlüsselung, Signaturprüfung von öffentlichen (EC)DH-Schlüsseln etc.) nutzt. Erhält ein Authenticator-Modul bspw. einen Access Token, in dem Signaturen und Zertifikate enthalten sind, und behandelt es diesen Token als opakes Datenobjekt, ohne die Zertifikate darin gesondert zu betrachten, dann verwendet das Authenticator-Modul diese Zertifikate im Sinne von [<span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-112746" data-option-id="longoutline"></span>] passiv.</span> </p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-108592">7.5 Zertifikatsprüfung von Internet-Zertifikaten</h3>
  <p id="polarion_228">Folgende Vorgaben gelten für die Prüfung von Internet-Zertifikaten.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111157">
   <p><b>A_20068-01</b></p>
   <p>Das Authenticator-Modul MUSS das Internet-seitige Zertifikat des IdP-Dienstes prüfen. Hierfür MUSS das Authenticator-Modul sowohl eine Signaturprüfung als auch eine Prüfung der zeitlichen Gültigkeit durchführen. Falls diese Prüfung negativ ausfällt, MUSS es das Zertifikat als "ungültig" bewerten.&nbsp;<br>Das Authenticator-Modul MUSS das Zertifikat anhand der Signaturprüfung auf ein CA-Zertifikat einer CA, die die "CA/Browser Forum Baseline Requirements for the Issuance and Management of Publicly-Trusted Certificates" (https://cabforum.org/baseline-requirements-documents/) erfüllt, zurückführen können.&nbsp;Ansonsten MUSS es das Zertifikat als "ungültig" bewerten. <b>&lt;=</b></p>
  </div>
  <p id="polarion_229"> <span style="font-style: italic;">Hinweis: Eine positiv ausgefallene Signaturprüfung von A_20068-01 ist gleichbedeutend damit, dass das CA-Zertifikat im Zertifikats-Truststore eines aktuellen Webbrowsers vorhanden ist.</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111175">
   <p><b>A_20618</b></p>
   <p>Das Authenticator-Modul MUSS bei jedem Verbindungsaufbau den IdP-Dienst anhand seines TLS-Zertifikats authentifizieren und MUSS die Verbindungen ablehnen, falls die Authentifizierung fehlschlägt. <b>&lt;=</b></p>
  </div>
  <p id="polarion_231"> <span style="font-style: italic;">Hinweis 1: Der IDP-Dienst authentisiert sich mit einem extended-validation-X.509-Zertifikat.&nbsp;<br> Hinweis 2: Es gelten die Bedingungen für den TLS-Handshake gemäß [gemSpec_PKI#GS-A_4662].</span> </p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-111160">7.6 Zertifikate der Komponenten-PKI</h3>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-112015">
   <p><b>A_20743</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der Anbieter des Authenticator-Moduls MUSS sicherstellen, dass das aktuell verwendete Authenticator-Modul mit den gültigen Zertifikaten der Komponenten-CA der TI arbeitet. Er MUSS ebenfalls hierzu mindestens einmal monatlich einen Abgleich der im Authenticator-Modul eingebundenen Zertifikate mit den in der TSL hinterlegten durchführen. Der Anbieter des Authenticator-Moduls MUSS ein Update veröffentlichen, wenn der Fingerprint der Zertifikate in der TSL nicht mit denen im Authenticator-Modul übereinstimmen.</span> <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-118999">7.7 Nutzung von alternativen Authentisierungsmitteln</h3>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-120365">7.7.1 Technisches Konzept</h4>
  <p id="polarion_190">Das Authenticator-Modul realisiert Funktionen zur&nbsp;</p>
  <ul id="polarion_226"> 
   <li>Erhebung von Gerätedaten,</li> 
   <li>Erzeugung eines Schlüsselpaars auf dem Gerät des Versicherten und Auswahl von lokalen Authentisierungsmitteln,</li> 
   <li>Durchführung des Registrierungsprozesses zur Hinterlegung der Pairing-Daten einschließlich des öffentlichen Schlüssels am IDP-Dienst,</li> 
   <li>Anwendung des privaten Schlüssels zum Zweck der Authentisierung gegenüber dem IDP-Dienst,</li> 
   <li>Inspektion der am Pairing-Endpunkt gespeicherten Pairing-Daten,</li> 
   <li>Inspektion der lokal gespeicherten Daten und</li> 
   <li>Durchführung des Deregistrierungsprozesses.</li> 
  </ul>
  <p id="polarion_267">Die Erhebung von Gerätedaten obliegt dem Authenticator-Modul; ihre Bewertung dem IDP-Dienst. Die technische Konzeption basiert auf Nutzung der vom Betriebssystem und von der Hardware gebotenen Möglichkeiten zur lokalen Authentisierung und der Realisierung eines geeigneten Schlüsselspeichers. Das Authenticator-Modul setzt im Zuge der Schlüsselerzeugung die notwendigen Parameter. Nicht angestrebt bzw. spezifiziert sind rein Software-basierte Lösungen zur Schlüsselverwaltung oder Authentifizierungsverfahren zur autorisierten Anwendung des privaten Schlüssels, die nicht auf der Kombination von Betriebssystem und Gerätehardware beruhen.&nbsp;</p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-120366">7.7.2 Spezifikation</h4>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-119008">7.7.2.1 Vorbereitende Maßnahmen</h5>
  <h6 id="polarion_wiki macro name=module-workitem;params=id=ML-119006">7.7.2.1.1 Registrierung des Authenticator-Moduls</h6>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-117507">
   <p><b>A_21515</b></p>
   <p>Das Authenticator-Modul MUSS im Sinne eines Anwendungsfrontends wie in Abschnitt 7.1 aus [gemSpec_IDP_Frontend] beim IdP-Dienst registriert sein. Sofern das Authenticator-Modul nicht als eigenständige Anwendung auftritt, sondern in ein Frontend integriert ist, erbt das Authenticator-Modul die registrierte client_id des Anwendungsfrontends. <b>&lt;=</b></p>
  </div>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-119007">7.7.2.2 Registrierung von alternativen Authentisierungsmitteln</h5>
  <h6 id="polarion_wiki macro name=module-workitem;params=id=ML-119009">7.7.2.2.1 Initiative des Nutzers</h6>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118710">
   <p><b>A_21573</b></p>
   <p><span style="font-weight: normal;">Das Authenticator-Modul MUSS dem Nutzer die Option zur Registrierung von alternativen Authentisierungsmitteln anbieten.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118712">
   <p><b>A_21574</b></p>
   <p>Das Authenticator-Modul MUSS dem Nutzer Warnhinweise geben, dass die Sicherheit des Verfahrens bei der Verwendung von Folgendem beeinträchtigt werden kann: 
    <ul>
     <li>Geräten, bei denen ein sog. "Rooten" oder ein "Jailbreak" vollzogen wurde.</li>
     <li>Installationen, bei denen es sich um Simulationsumgebungen der eigentlichen Zielplattform handelt.</li>
     <li>Geräten, die gemeinschaftlich verwendet werden.</li>
     <li>Geräten, die einem Mobile-Device-Management unterliegen, z. B. bei Dienstgeräten im Rahmen von COPE ("Corporate Owned, Personally Enabled")-Lösungen.</li>
     <li>Installationen innerhalb von Containerlösungen auf Mobilgeräten zur Abschottung von Unternehmensanwendungen im Rahmen von BYOD ("Bring-Your-Own-Device")-Lösungen.</li>
    </ul>Der Nutzer MUSS diese Aussage zur Kenntnis nehmen und diesen Umstand über die Benutzeroberfläche bestätigen. Im Fall der Ablehnung durch den Nutzer DARF das Authenticator-Modul die Verwendung von alternativen Authentisierungsmitteln NICHT anbieten. Das Authenticator-Modul MUSS bei einer technischen Detektion von solchen Umständen auf das Anbieten der Verwendung von alternativen Authentisierungsmitteln verzichten. Es MUSS den Nutzer dann über die Gründe des Wegfallens der Option zur Verwendung von alternativen Authentisierungsmitteln aufklären. <b>&lt;=</b></p>
  </div>
  <h6 id="polarion_wiki macro name=module-workitem;params=id=ML-119010">7.7.2.2.2 Authentifizierung des Nutzers gegenüber dem Pairing-Endpunkt</h6>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118711">
   <p><b>A_21575</b></p>
   <p>Das Authenticator-Modul MUSS zur Einleitung des Registrierungsprozesses ein <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> über den IDP-Dienst beziehen. <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Das ACCESS_TOKEN</span> MUSS erkennen lassen, dass die Authentifizierung direkt auf Basis der eGK oder auf Basis eines <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> erfolgte, das auf Basis einer Authentifizierung mit der eGK ausgestellt wurde. <b>&lt;=</b></p>
  </div>
  <h6 id="polarion_wiki macro name=module-workitem;params=id=ML-119011">7.7.2.2.3 Lokale Initialisierung des Geräts</h6>
  <div class="heading-7" id="polarion_wiki macro name=module-workitem;params=id=ML-119014"></div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118713">
   <p><b>A_21576</b></p>
   <p>Sofern für das verwendete Gerät und Nutzer bereits ein alternatives Authentisierungsmittel registriert ist, MUSS das Authenticator-Modul den Nutzer zur Deregistrierung der Pairing-Daten auffordern. Der Nutzer MUSS jederzeit die Möglichkeit haben, ein von ihm registriertes alternatives Authentisierungsmittel zu erneuern. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118714">
   <p><b>A_21577</b></p>
   <p>Das Authenticator-Modul DARF KEINE biometrischen Referenzmerkmale erheben, Templates erstellen, speichern, verarbeiten oder diese zum IdP-Dienst übertragen. Das Authenticator-Modul DARF KEINE anderen vom Nutzer gesetzten wissensbasierten Faktoren (z. B. PINs, Muster, Passwörter) erheben, speichern, verarbeiten oder zum IdP-Dienst übertragen und zur Authentifizierung verwenden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118715">
   <p><b>A_21578</b></p>
   <p>Das Authenticator-Modul SOLL prüfen, ob biometrische Referenzmerkmale oder wissensbasierte Faktoren auf dem Gerät in einer gesicherten Umgebung gespeichert werden. Hierzu MÜSSEN über Betriebssystem-APIs bereitgestellte Informationen ausgewertet werden. <b>&lt;=</b></p>
  </div>
  <p id="polarion_308"> <span style="font-style: italic;">Hinweis: Die Anforderung adressiert keine faktische funktionale Prüfung, sondern eine vorab durchgeführte Auswertung von Informationen, die über Betriebssystem-APIs bereitgestellt werden. </span> </p>
  <div class="heading-7" id="polarion_wiki macro name=module-workitem;params=id=ML-119015"></div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118716">
   <p><b>A_21579</b></p>
   <p>Das Authenticator-Modul MUSS sicherstellen, dass die Erzeugung des Schlüsselpaares PrK_SE_AUT/PuK_SE_AUT, dessen Speicherung, Anwendung und die Löschung des PrK_SE_AUT ausschließlich&nbsp;durch eine gesonderte, vertrauenswürdige Ausführungsumgebung erfolgt, die 
    <ul>
     <li><span style="font-weight: normal;">den Zugriff auf den PrK_SE_AUT als Datenobjekt pauschal allen Anwendungen entzieht (hierbei eingeschlossen sind Geräte-Backups).&nbsp;</span></li>
     <li><span style="font-weight: normal;">die die Anwendung des Schlüssels auf Daten zum Zweck der Signaturbildung auf das Authenticator-Modul und denjenigen am Gerät authentifizierten Nutzer beschränkt, der den Schlüssel PrK_SE_AUT erzeugt hat.</span></li>
    </ul><span style="font-weight: normal;">Das Authenticator-Modul MUSS bei Verfügbarkeit einer auf Hardware-Ebene realisierten Absonderung der oben genannten Ausführungsumgebung diese zwingend nutzen.&nbsp;Eine reine auf Software-basierte Implementierung DARF NICHT verwendet werden.&nbsp;Hierzu MÜSSEN über Betriebssystem-APIs bereitgestellte Informationen ausgewertet werden.</span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_309"> <span style="font-style: italic;">&nbsp;Hinweis 1: Die Anforderung adressiert keine faktische funktionale Prüfung, sondern eine vorab durchgeführte Auswertung von Informationen, die über Betriebssystem-APIs bereitgestellt werden</span>.&nbsp; </p>
  <p id="polarion_284"> <span style="font-style: italic;">Hinweis 2: Zum Begriff "Ausführungsumgebung" siehe die Erläuterung in Abschnitt [gemSpec_IDP_Dienst#5.4.1 Zielsetzung].&nbsp;</span> </p>
  <p id="polarion_118"> <span style="font-style: italic;">Hinweis 3: Die Anforderung soll ausschließen, dass Implementierungen des Authenticator-Moduls unter ggf. möglicher Umgehung der Betriebssystem-APIs eigene (z. B. Software-basierte) Lösungen implementieren oder, sofern möglich, andere Hardwareeinheiten als die fest im Gerät verbauten verwenden.</span> </p>
  <p id="polarion_285"> <span style="font-style: italic;">Hinweis 4: Im Fall von&nbsp;&nbsp;</span> </p>
  <ul id="polarion_286"> 
   <li><span style="font-style: italic;">Android-Geräten muss das Gerät eine StrongBox Keymaster-Implementierung besitzen. Diese muss verwendet werden.</span></li> 
   <li><span style="font-style: italic;">Apple iOS-Geräten muss das Gerät mit einer Secure-Enclave ausgestattet sein. Diese muss verwendet werden.&nbsp;</span></li> 
  </ul>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118717">
   <p><b>A_21580</b></p>
   <p>Das Authenticator-Modul MUSS für die Schlüsselerzeugung des Schlüsselpaars PuK_SE_AUT/PrK_SE_AUT Mechanismen des Geräts verwenden. Es DARF kryptographische Schlüssel NICHT selbst erzeugen, innerhalb des ihm zur Verfügung stehenden Speicherbereichs speichern oder auf Daten anwenden.&nbsp; <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118718">
   <p><b>A_21581</b></p>
   <p>Das Authenticator-Modul MUSS sicherstellen, dass die in der folgenden Tabelle genannten Algorithmen zur Anwendung des PrK_SE_AUT zur Verfügung stehen:<br> <p data-keep-next="true" class="polarion-rte-caption-paragraph" style="text-align: left;" id="polarion___2">Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">3</span>:&nbsp;Kryptographische Verfahren</p>
    <table id="polarion_wiki macro name=table;params=width=100%|uid=676" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;">
     <tbody>
      <tr>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 76px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Schema</th>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 390px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Algorithmus</th>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 103px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Schlüssel</th>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 76px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Signatur</td>
       <td style="text-align: left;vertical-align: top;width: 390px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ECDSA auf Basis der Kurve P-256 und SHA-256</td>
       <td style="text-align: left;vertical-align: top;width: 103px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">PrK_SE_AUT</td>
      </tr>
     </tbody>
    </table> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118719">
   <p><b>A_21582</b></p>
   <p>Das Authenticator-Modul MUSS dem Nutzer die Wahl einer lokal verfügbaren Authentisierungsmethode überlassen, die zur autorisierten Anwendung des PrK_SE_AUT verwendet wird, das Authenticator-Modul&nbsp; 
    <ul>
     <li>MUSS hierbei auf dem Gerät bereits unter dem Nutzeraccount registrierte Mittel anbieten. Der Nutzer MUSS hierbei eine Auswahl treffen können,</li>
     <li>MUSS dem Benutzer hierbei mindestens eine pauschale Gruppierung in biometrische oder wissensbasierte Faktoren anbieten. Zugelassen sind die in der folgenden Tabelle&nbsp;genannten Mittel,</li>
     <li>DARF den Nutzer zur Anlage solcher Mittel auffordern.</li>
    </ul>Das Authenticator-Modul MUSS den Nutzer über spezifische Schwächen seiner Wahl aufklären (z. B. solcher in Verbindung mit der Anwendung von Mustern) und ggf. Hinweise zu einer geeigneten Verwendung geben. Das Authenticator-Modul MUSS in den Parametern, die dem Betriebssystem zur Schlüsselerzeugung gesetzt werden, festlegen,<br> 
    <ul>
     <li>auf Basis welcher der vom Nutzer gewählten Mittel die Anwendung des Schlüssels PrK_SE_AUT auf Daten durch den Nutzer autorisiert wird,</li>
     <li>dass die Anwendung des Schlüssels PrK_SE_AUT auf den zum Zeitpunkt der Erzeugung verwendeten Nutzeraccount beschränkt ist.</li>
    </ul><p style="text-align: left;" class="polarion-rte-caption-paragraph" data-keep-next="true" id="polarion___3">Tabelle <span class="polarion-rte-caption" data-sequence="Tabelle">4</span>: Zugelassene, lokale Authentisierungsmittel</p>
    <table style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;" class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%|uid=681">
     <tbody>
      <tr>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 141px;height: 35px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Art</th>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 391px;height: 35px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Faktor</th>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 188px;height: 35px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Zugelassen:</th>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 141px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="4" colspan="1">biometrisch</td>
       <td style="text-align: left;vertical-align: top;width: 391px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Finger</td>
       <td style="text-align: left;vertical-align: top;width: 188px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 391px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Stimme</td>
       <td style="text-align: left;vertical-align: top;width: 188px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 391px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Gesicht</td>
       <td style="text-align: left;vertical-align: top;width: 188px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 391px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Iris</td>
       <td style="text-align: left;vertical-align: top;width: 188px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 141px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="3" colspan="1">wissensbasiert</td>
       <td style="text-align: left;vertical-align: top;width: 391px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">PIN</td>
       <td style="text-align: left;vertical-align: top;width: 188px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 391px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Passwort</td>
       <td style="text-align: left;vertical-align: top;width: 188px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 391px;height: 20px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Muster</td>
       <td style="text-align: left;vertical-align: top;width: 188px;height: 20px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 141px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;" rowspan="4" colspan="1">Präsenz</td>
       <td style="text-align: left;vertical-align: top;width: 391px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Wischen</td>
       <td style="text-align: left;vertical-align: top;width: 188px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">nein</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 391px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Kopplung mit einer Uhr</td>
       <td style="text-align: left;vertical-align: top;width: 188px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">nein</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 391px;height: 26px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Knopfdruck</td>
       <td style="text-align: left;vertical-align: top;width: 188px;height: 26px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">nein</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 391px;height: 21px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Körpersensoren</td>
       <td style="text-align: left;vertical-align: top;width: 188px;height: 21px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">nein</td>
      </tr>
     </tbody>
    </table> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118720">
   <p><b>A_21583</b></p>
   <p>Das Authenticator-Modul MUSS sicherherstellen, dass die von Gerät und Hardware realisierten Mechanismen zur biometrischen Authentisierung bzw. Authentifizierung von ausreichender Qualität sind.&nbsp; <b>&lt;=</b></p>
  </div>
  <p id="polarion_279"> <span style="font-style: italic;">Hinweis: Als qualitativ ausreichend werden biometrische Mittel der Güte Biometric.STRONG im Kontext von Android-Implementierungen angesehen (siehe [androidbiom]). Im Fall von Apple-iOS-Geräten sind die vom Gerät implementierten biometrischen Mittel qualitativ ausreichend, wenn das Gerät mit einer Secure-Enclave ausgestattet ist.&nbsp;</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118721">
   <p><b>A_21584</b></p>
   <p>Das Authenticator-Modul MUSS sich zur Implementierung der Authentifizierungsverfahren zur autorisierten Anwendung des PrK_SE_AUT auf diejenigen Mechanismen beschränken, die durch die Kombination von Betriebssystem und Hardware zur Verfügung gestellt werden.&nbsp;Das Authenticator-Modul DARF hierbei ausschließlich die vom Betriebssystem zur Verfügung gestellte Information über eine erfolgreiche oder nicht-erfolgreiche Authentifizierung und deren Art verarbeiten. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118722">
   <p><b>A_21585</b></p>
   <p>Das Authenticator-Modul MUSS die Parameter für die Erzeugung des Schlüsselpaars PrK_SE_AUT/PuK_SE_AUT so setzen, dass sichergestellt ist, dass der Schlüssel PrK_SE_AUT ausschließlich über das Authenticator-Modul auf Daten anwendbar ist. Eine App-übergreifende Nutzung MUSS ausgeschlossen werden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118723">
   <p><b>A_21586</b></p>
   <p>Das Authenticator-Modul MUSS bei der Übergabe des Kommandos zur Schlüsselerzeugung an das Betriebssystem in den Parametern festlegen, dass bei folgenden Systemereignissen der private Schlüssel PrK_SE_AUT nicht mehr verwendbar ist: 
    <ul>
     <li>Löschung des lokalen Geräte-Accounts, innerhalb dessen der PrK_SE_AUT erzeugt wurde.&nbsp;</li>
     <li>Setzen von schwachen Authentifizierungsmethoden oder entfernen von Authentifizierungsmethoden des Geräte-Accounts.</li>
     <li>Reset des Gerätes oder Deinstallation von Betriebssystem-Updates.</li>
     <li>Re-Enrolment oder Löschung von biometrischen Referenzmerkmalen.</li>
    </ul> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118725">
   <p><b>A_21587</b></p>
   <p>Das Authenticator-Modul MUSS die Parameter für die Erzeugung des Schlüsselpaars PrK_SE_AUT/PuK_SE_AUT so setzen, dass sichergestellt ist, dass der Schlüssel PrK_SE_AUT ausschließlich zum Zweck der Signaturbildung auf Daten angewendet werden kann.&nbsp; <b>&lt;=</b></p>
  </div>
  <div class="heading-7" id="polarion_wiki macro name=module-workitem;params=id=ML-119012"></div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118724">
   <p><b>A_21588</b></p>
   <p>Das Authenticator-Modul MUSS einen Key-Identifier zur Identifikation des Schlüsselpaars PrK_SE_AUT/PuK_SE_AUT gegenüber dem IdP-Dienst erzeugen. Der Key-Identifier MUSS so erzeugt werden, dass die Erzeugung ein und desselben Identifiers über verschiedene Geräte eines Nutzers mit hoher Wahrscheinlichkeit ausgeschlossen ist. Der Key-Identifier MUSS zufällig erzeugt werden. Er DARF NICHT aus Nutzer- oder Gerätedaten abgeleitet werden. Der zum IdP-Dienst übertragene Key-Identifier MUSS eine Länge von 32 Byte besitzen. Der Wert KANN zur Referenzierung des PrK_SE_AUT im lokalen Schlüsselspeicher verwendet werden. Der Key-Identifier selbst oder ein Datenobjekt, aus dem er abgeleitet werden kann, MUSS auf dem Endgerät gespeichert werden. Der Key-Identifier selbst oder das Datenobjekt MUSS gegen Löschung und anwendungsübergreifende Verwendung geschützt sein. <b>&lt;=</b></p>
  </div>
  <p id="polarion_287"> <span style="font-style: italic;">Umsetzungshinweis: Lokale Schlüsselspeicher haben ggf. eigene Anforderungen an die Art eines Identifiers. Es wird empfohlen, einen solchen durch einmaliges Anwenden von SHA-256 auf die geforderte Länge zu bringen.</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118727">
   <p><b>A_21589</b></p>
   <p><span style="font-weight: normal;">Das Authenticator-Modul MUSS ein Schlüsselpaar PrK_SE_AUT/PuK_SE_AUT erzeugen. Das Schlüsselpaar MUSS für die Anwendung des Algorithmus&nbsp;ECDSA auf Basis der Kurve P-256 geeignet sein. Das Authenticator-Modul MUSS hierbei über die Betriebssystem-APIs die in Abschnitt&nbsp;[gemSpec_IDP_Frontend#Parameter für die Schlüsselerzeugung und Auswahl eines Schlüsselspeichers]<br> beschriebenen Parameter zur Durchsetzung der dort genannten Anforderungen und die Schlüssel innerhalb des dort identifizierten Schlüsselspeichers setzen.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118726">
   <p><b>A_21590</b></p>
   <p>Das Authenticator-Modul DARF den Schlüssel PrK_SE_AUT ausschließlich zum Zweck der Authentifizierung gegenüber dem IdP-Dienst verwenden. Es DARF dem Nutzer keine andere Option anbieten oder den Schlüssel anderweitig verwenden. <b>&lt;=</b></p>
  </div>
  <h6 id="polarion_wiki macro name=module-workitem;params=id=ML-119013">7.7.2.2.4 Einleiten des Registrierungsprozesses durch das Authenticator-Modul</h6>
  <p id="polarion_204">Die in folgenden Abschnitt genannten Anforderungen adressieren die Einleitung des Registrierungsprozesses durch das Authenticator-Modul:&nbsp;</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118734">
   <p><b>A_21591</b></p>
   <p>Das Authenticator-Modul MUSS die folgenden Informationen über das verwendete Gerät über Betriebssystem-APIs erheben: 
    <ul>
     <li>Name des Herstellers,</li>
     <li>Name des Produkts,</li>
     <li>Name des Modells,</li>
     <li>Name des Betriebssystems und</li>
     <li>Version des Betriebssystems.</li>
    </ul>Hierbei MUSS der Datentyp "Device_Type" gebildet werden. Die hier erhobenen Geräteinformationen MÜSSEN zusammen mit einem vom Nutzer für das Gerät vergebenen Namen zur Datenstruktur "Device_Informationen" kombiniert werden. <b>&lt;=</b></p>
  </div>
  <p id="polarion_290"> <span style="font-style: italic;">Hinweis: Die genaue Spezifikation der Schemata ist in den Tabellen "Schema Datentyp "Device_Information"" und "Schema Datentyp "Device_Type"" in [gemSpec_IDP_Dienst], Anhang C dargestellt.</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118735">
   <p><b>A_21592</b></p>
   <p><span style="font-weight: normal;">Das Authenticator-Modul MUSS den Nutzer auffordern, die entstandenen Pairing-Daten mit dem Schlüssel PrK_CH_AUT der eGK zu signieren. Die Werte der im Datenmodell "Pairing_Data" genannten Claims MÜSSEN wie folgt belegt werden:<br> <br> </span> <p data-keep-next="true" class="polarion-rte-caption-paragraph" style="text-align: left;" id="polarion___4"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">5</span>: Pairing-Daten </p> 
    <table id="polarion_wiki macro name=table;params=width=100%|uid=710" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
     <tbody> 
      <tr> 
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 192.727px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Claim</th> 
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 387.273px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Wert</th> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 192.727px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">issuer</td> 
       <td style="text-align: left;vertical-align: top;width: 387.273px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">IssuerDN aus dem Authentifizierungszertifikat C.CH.AUT</td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 192.727px;height: 37.2727px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">not_after</td> 
       <td style="text-align: left;vertical-align: top;width: 387.273px;height: 37.2727px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Validity/Not_after-Angabe aus dem Authentifizierungszertifikat C.CH.AUT</td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 192.727px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">serialnumber</td> 
       <td style="text-align: left;vertical-align: top;width: 387.273px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Seriennummer des Authentifizierungszertifikats C.CH.AUT</td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 192.727px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">auth_cert_subject_public_key_info</td> 
       <td style="text-align: left;vertical-align: top;width: 387.273px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">SubjectPublicKeyInfo-Struktur des Authentifizierungszertifikats C.CH.AUT</td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 192.727px;height: 37.2727px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">key_identifier</td> 
       <td style="text-align: left;vertical-align: top;width: 387.273px;height: 37.2727px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Der erzeugte Identifikator für das Schlüsselpaar PuK_SE_AUT/PrK_SE_AUT</td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 192.727px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">product</td> 
       <td style="text-align: left;vertical-align: top;width: 387.273px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Der Produktname des verwendeten Geräts</td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 192.727px;height: 37.2727px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">se_subject_public_key_info</td> 
       <td style="text-align: left;vertical-align: top;width: 387.273px;height: 37.2727px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">SubjectPublicKeyInfo-Struktur, bestehend aus dem auf dem Endgerät erzeugten öffentlichen Schlüssel und den zu verwendenden Algorithmen</td> 
      </tr> 
     </tbody> 
    </table> <br> Die Kodierung der einzelnen Felder erfolgt wie in Anhang C, gem&nbsp;dargelegt. Der im Claim "product" enthaltene Wert MUSS identisch mit dem gleichnamigen Claim des produzierten Werts in der Device_Type-Datenstruktur sein. <b>&lt;=</b></p>
  </div>
  <p id="polarion_296"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118731">
   <p><b>A_21593</b></p>
   <p>Das Authenticator-Modul MUSS die signierten Pairing-Daten, die erhobenen Geräteinformationen und das Authentifizierungszertifikat C.CH.AUT zu einer Instanz der Datenstruktur "Registration_Data" gemäß [gemSpec_IDP_Dienst], Abschnitt C,&nbsp;zusammenführen.&nbsp; <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116900">
   <p><b>A_21416</b></p>
   <p>Das Authenticator-Modul MUSS Registrierungsdaten in Form eines "Registration_Data"-Objekts produzieren und diese mit dem&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PuK_IDP_ENC</span> aus dem Discovery Document verschlüsseln. <b>&lt;=</b></p>
  </div>
  <p id="polarion_313"> <span style="font-style: italic;">Hinweis: Der Datentyp "Registration_Data" ist in Anhang C des Dokuments [gemSpec_IDP_Dienst] beschrieben.</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116898">
   <p><b>A_21414</b></p>
   <p>Das Authenticator-Modul MUSS das zur Autorisierung und Authentifizierung des Nutzers verwendete <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN </span>mit dem öffentlichen Schlüssel <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PuK_IDP_ENC</span> aus dem Discovery Document verschlüsseln.<br> Dazu muss es vorher unter Verwendung des "Token-Key", der dem Token-Endpunkt übermittelt wurde, entschlüsselt werden.<br> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116901">
   <p><b>A_21417</b></p>
   <p>Das Authenticator-Modul überträgt die verschlüsselten Registrierungsdaten zusammen mit dem bezogenen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> an den Pairing-Endpunkt. <b>&lt;=</b></p>
  </div>
  <p id="polarion_289"> <span style="font-style: italic;">Hinweis: Das Authenticator-Modul muss den http-Request an den Pairing-Endpunkt wie in Anhang C [gemSpec_IDP_Dienst]&nbsp;beschrieben gestalten.</span> </p>
  <h6 id="polarion_wiki macro name=module-workitem;params=id=ML-119131">7.7.2.2.5 Abschluss der Registrierung - Rückmeldung an den Nutzer</h6>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118728">
   <p><b>A_21595</b></p>
   <p>Das Authenticator-Modul MUSS das Authentifizierungszertifikat C.CH.AUT nach erfolgreicher Registrierung für die Verwendung in weiteren Authentifizierungsvorgängen lokal auf dem Endgerät speichern. Die Speicherung MUSS so erfolgen, dass eine missbräuchliche Verwendung des Zertifikats durch andere Anwendungen in ausreichendem Maß verhindert wird. Das Authenticator-Modul DARF im Fall einer nicht erfolgreichen Registrierung das Authentifizierungszertifikat C.CH.AUT NICHT speichern. <b>&lt;=</b></p>
  </div>
  <p id="polarion_112"> <span style="font-style: italic;">Hinweis: Unter einer missbräuchlichen Verwendung wird eine von der Verwendung des C.CH.AUT zur Authentifizierung am IDP-Dienst abweichende Verwendung verstanden.</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118729">
   <p><b>A_21596</b></p>
   <p>Das Authenticator-Modul KANN den vom Nutzer vergebenen Namen des Geräts lokal speichern. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118732">
   <p><b>A_21597</b></p>
   <p>Das Authenticator-Modul MUSS dem Nutzer eine eindeutige Rückmeldung über entweder die erfolgreiche Anlage eines Pairing oder die Ablehnung der Anlage eines Pairing geben. Beruht die Ablehnung auf einem als nicht geeignet erkannten Gerätetyps, MUSS dem Nutzer dieser Umstand dargelegt werden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118730">
   <p><b>A_21598</b></p>
   <p>Das Authenticator-Modul MUSS bei fehlschlagender Registrierung alle lokal erzeugten Daten (einschließlich der erzeugten kryptographischen Schlüssel) über die Betriebssystem-APIs des Geräts löschen. <b>&lt;=</b></p>
  </div>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-119132">7.7.2.3 Verwendung von alternativen Authentisierungsmitteln</h5>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118737">
   <p><b>A_21599</b></p>
   <p>Das Authenticator-Modul MUSS dem Nutzer die Option zur Verwendung von alternativen Authentisierungsmitteln anbieten, sofern solche zur Verfügung stehen und am Pairing-Endpunkt registriert wurden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116914">
   <p><b>A_21430</b></p>
   <p>Das Authenticator-Modul MUSS dem Benutzer die Authentisierung auf Basis der registrierten Informationen anbieten. Die Initiierung MUSS in gleicher Weise wie der in Abschnitt 6.2.1 [gemSpec_IDP_Frontend] dargestellte Authorization-Request erfolgen. <br> Der Authorization-Request MUSS vom Authorization-Endpunkt in der gleichen Weise behandelt werden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118736">
   <p><b>A_21600</b></p>
   <p>Das Authenticator-Modul MUSS aktuelle Geräteinformationen über die Betriebssystem-APIs einholen und dabei eine Device-Information-Struktur wie in [gemSpec_IDP_Dienst} Abschnitt C beschrieben konstruieren.&nbsp; <b>&lt;=</b></p>
  </div>
  <p id="polarion_291"> <span style="font-style: italic;">Hinweis: Anforderungen an die Gestaltung der Signatur der vom Authorization-Endpunkt des IDP-Dienstes übermittelten Challenge und die hierbei zu signierenden Daten finden sich in <span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-118600" data-option-id="longoutline"></span>.</span> </p>
  <p id="polarion_196"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116915">
   <p><b>A_21431</b></p>
   <p>Das Authenticator-Modul MUSS die produzierte Signed_Authentication_Data-Struktur mit dem <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PuK_IDP_ENC</span> aus dem Discovery Document verschlüsseln und an den Authorization-Endpunkt als Antwort auf die vom Authorization-Endpunkt empfangene Challenge übermitteln. Der Wert des Header-Claims <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">exp</span>&nbsp;der hierbei produzierten "Encrypted_Authentication_Data"-Struktur MUSS hierbei identisch mit dem gleichnamigen Claim aus den Body-Claims des empfangenen Challenge-Token belegt werden. <b>&lt;=</b></p>
  </div>
  <p id="polarion_293"> <span style="font-style: italic;">Hinweis: Die Struktur des Datentyps "Encrypted_Authentication_Data" ist in Anhang C des Dokuments [gemSpec_IDP_Dienst] beschrieben.</span> </p>
  <p id="polarion_213"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118740">
   <p><b>A_21601</b></p>
   <p><span style="font-weight: normal;">Das Authenticator-Modul MUSS die Fehlermeldungen des Authorization-Endpunkts bei Fehlschlag der Authentifizierung dem Nutzer anzeigen.&nbsp;</span> <b>&lt;=</b></p>
  </div>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-119133">7.7.2.4 Lokale Inspektion von alternativen Authentisierungsmitteln</h5>
  <p id="polarion_298">Die Inspektionsfunktion gestattet dem Nutzer die folgenden lokal gespeicherten Daten einzusehen:</p>
  <ul id="polarion_300"> 
   <li>die Metadaten des lokal gespeicherten Authentifizierungszertifikats C.CH.AUT,</li> 
   <li>den von ihm gegenüber dem IDP-Dienst vergebenen Namen des Endgeräts und</li> 
   <li>den lokal gespeicherten Key-Identifier.</li> 
  </ul>
  <p id="polarion_301">Motivation: Die Funktion macht dem Nutzer eine erfolgte Registrierung und die zur Anwendung von alternativen Authentisierungsmitteln auf seinem Gerät gespeicherten Daten transparent.&nbsp;</p>
  <p id="polarion_302"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118738">
   <p><b>A_21602</b></p>
   <p>Das Authenticator-Modul MUSS dem Nutzer bei erfolgter Registrierung seines Geräts diesen Umstand anzeigen und darstellen welche Daten zur Verwendung von alternativen Authentisierungsmittel auf seinem Gerät gespeichert sind. <b>&lt;=</b></p>
  </div>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-119134">7.7.2.5 Lokale Löschung von alternativen Authentisierungsmitteln</h5>
  <p id="polarion_218">Dem Nutzer wird durch die Löschung der folgenden Daten die Möglichkeit gegeben, ein von ihm registriertes Pairing zu deaktivieren.&nbsp;Die Löschung umfasst:&nbsp;</p>
  <ul id="polarion_304"> 
   <li>den Key-Identifier,</li> 
   <li>das Authentifizierungszertifikats C.CH.AUT,</li> 
   <li>den vom Nutzer vergebenen Namen für das Mobilgerät</li> 
   <li>die Löschung oder dauerhafte Unbrauchbarmachung des Schlüssels PrK_SE_AUT.</li> 
  </ul>
  <p id="polarion_305">Die Durchführung der Löschung führt zu einer Deaktivierung des Pairings, nicht aber zum Entfernen der Pairing-Daten am Pairing-Endpunkt. Der Benutzer wird über den Fortbestand der dort vorhandenen Daten informiert.</p>
  <p id="polarion_306">Motivation: Die Realisierung der Funktion soll dem Nutzer ohne eine bestehende Verbindung mit dem IDP-Dienst eine Deaktivierung des von ihm registrierten alternativen Authentisierungsmittels ermöglichen.&nbsp;</p>
  <p id="polarion_307"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118739">
   <p><b>A_21603</b></p>
   <p><span style="font-weight: normal;">Das Authenticator-Modul MUSS dem Nutzer die Möglichkeit geben, lokal gespeicherte Daten dauerhaft zu löschen und über Betriebssystem-APIs des Geräts eine Löschung des PrK_SE_AUT auszulösen. Die Löschung MUSS eventuell vorhandene <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> mit einbeziehen.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118746">
   <p><b>A_21604</b></p>
   <p><span style="font-weight: normal;">Das Authenticator-Modul MUSS den Nutzer bei der lokalen Löschung seiner Registrierungsdaten darauf hinweisen, dass eine zukünftige Anmeldung hiermit ausgeschlossen ist, aber die Daten weiterhin am IdP-Dienst hinterlegt sind. Es MUSS den Benutzer darauf hinweisen, dass ein Entfernen über die am Pairing-Endpunkt realisierte Deregistrierungsfunktion erfolgen kann.&nbsp;</span> <b>&lt;=</b></p>
  </div>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-119135">7.7.2.6 Inspektion und Deregistrierung der am Pairing-Endpunkt gespeicherten Daten</h5>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118743">
   <p><b>A_21605</b></p>
   <p>Das Authenticator-Modul MUSS dem Nutzer die Möglichkeit zur Inspektion der am Pairing-Endpunkt gespeicherten Pairing-Daten und zur Deaktivierung der Pairing-Daten geben. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116926">
   <p><b>A_21442</b></p>
   <p>Die Authentisierung des Nutzers und die Autorisierung des Authenticator-Moduls am Pairing-Endpunkt zur Nutzung der Inspektions- und Deregistrierungsfunktion MUSS über den IDP-Dienst auf Basis eines von ihm erstellten <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> erfolgen. Der Scope der Anfrage ist „openid pairing“.<br> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116927">
   <p><b>A_21443</b></p>
   <p>Das zur Authentifizierung des Nutzers und Autorisierung des Authenticator-Moduls verwendete ACCESS_TOKEN MUSS vom Authenticator-Modul mit dem öffentlichen Schlüssel PuK_IDP_Enc aus dem Discovery Document verschlüsselt werden.<br> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116928">
   <p><b>A_21444</b></p>
   <p>Das Authenticator-Modul MUSS das bezogene <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> an den Pairing-Endpunkt übertragen. Die hierbei verwendeten Request-Parameter MÜSSEN um einen Indikator erweitert werden, die die Nutzung der Inspektionsfunktion anzeigen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_189"> <span style="font-style: italic;">Hinweis: Das Authenticator-Modul muss den http-Request an den Pairing-Endpunkt wie in Anhang C, [gemSpec_IDP_Dienst] beschrieben gestalten.&nbsp;</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118742">
   <p><b>A_21608</b></p>
   <p>Das Authenticator-Modul MUSS dem Nutzer die Möglichkeit zur Deaktivierung jedes der angezeigten Pairing-Daten geben. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116930">
   <p><b>A_21446</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Das Authenticator-Modul MUSS den Key-Identifier des zur Löschung angefragten Pairings zusammen mit einem <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> an den Pairing-Endpunkt übertragen.</span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_292"> <span style="font-style: italic;">Hinweis: Das Authenticator-Modul muss den http-Request an den Pairing-Endpunkt wie&nbsp;Anhang C, [gemSpec_IDP_Dienst]&nbsp;beschrieben gestalten.&nbsp;</span> </p>
  <h6 id="polarion_wiki macro name=module-workitem;params=id=ML-119136">7.7.2.6.1 Abschluss von Inspektion und Deregistrierung</h6>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118741">
   <p><b>A_21607</b></p>
   <p>Das Authenticator-Modul MUSS die in der Antwort des Pairing-Endpunkts enthaltenen Pairing-Daten auf der Nutzeroberfläche abbilden. Die Anzeige MUSS pro Pairing-Eintrag die folgenden Daten enthalten: 
    <ul>
     <li>die im Pairing-Eintrag enthaltenen Werte zum registrierten Produktnamen des Geräts, Seriennummer, Aussteller und Gültigkeitsende des zur Authentifizierung verwendeten Authentifizierungszertifikats C.CH.AUT und den Key-Identifier,</li>
     <li>den vom Nutzer vergebenen Namen des Geräts,</li>
     <li>den Zeitpunkt der Anlage des Pairing.</li>
    </ul> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118809">
   <p><b>A_21617</b></p>
   <p>Das Authenticator-Modul MUSS dem Benutzer das Ergebnis der Deregistrierung des von ihm gewählten Pairing auf der Benutzeroberfläche anzeigen. Es MUSS anzeigen, 
    <ul>
     <li>ob das Pairing deaktiviert wurde bzw. in welcher Frist dies geschieht.</li>
     <li>ob technische Fehler eine Deaktivierung verhindern.</li>
    </ul> <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-126131">7.8 Unterstützung der Anmeldung mittels sektoraler Identity Provider</h3>
  <p id="polarion_319">Im Rahmen der Zugänglichmachung des E-Rezepts für Versicherte ohne NFC-fähige eGK sollen ab dem 01.01.2022 Kassen-eigene Authentifizierungssysteme an&nbsp;das E-Rezept angebunden werden. Diese werden im Folgenden als sektorale Identity Provider bezeichnet, um sie vom zentralen IDP-Dienst abzugrenzen, welcher die Authentisierung der Nutzer direkt oder indirekt über die eGK realisiert und die bereitgestellten Attribute von dieser ableitet.&nbsp;</p>
  <p id="polarion_320">Zur Einbindung eines sektoralen Identity Provider wird im ersten Schritt der zentrale IDP-Dienst als Mittler zwischen dem Anwendungsfrontend, den sektoralen Identity Providern und den Fachdiensten (primär dem E-Rezept) eingesetzt.</p>
  <p id="polarion_321">Dies wird später mit der Etablierung einer Föderation von Identity Providern abgelöst.</p>
  <p id="polarion_323"> Im Kontext der vorliegenden Spezifikation wird angenommen, dass zu einem sektoralen Identity Provider-Dienst mindestens ein dediziertes Authenticator-Modul existiert, welches in der Lage ist, die Authentifizierung eines Nutzers zu übernehmen, d. h. den Nutzer mit spezifischen Methoden gegenüber dem sektoralen Identity Provider-Dienst zu authentifizieren und eine hiernach vom sektoralen Identity Provider-Dienst produzierte Attestierungen in Form eines <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> über das Authenticator-Modul an den anfragenden IDP-Dienst zurückzugeben. Unter einem sektoralen Authenticator-Modul werden hierbei eigenständige Anwendungen auf dem Endgerät des Benutzers verstanden. Die Delegierung der Authentifizierung an ein Authenticator-Modul und den zugehörigen sektoralen Identity Provider erfolgt auf Initiative des Nutzers.&nbsp; </p>
  <p id="polarion_324"> Zur Realisierung des in [<span style="font-size: 10pt;line-height: 1.5;">gemSpec_IDP_Sek#</span><span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-122072" data-option-id="long"></span>]&nbsp;definierten Flows einschließlich der hierbei erforderlichen Übergabe des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span>&nbsp;und anderer Daten, bedürfen eines wechselseitigen Aufrufs zwischen dem Authenticator-Modul des IDP-Dienstes und dem gewählten&nbsp;Authenticator-Modul des sektoralen Identity Provider. Dies wird im Folgenden als App2App-Kommunikation bezeichnet (siehe [RFC8252], Abschnitt "7.2. Claimed "https" Scheme URI Redirection",&nbsp;&nbsp;<a href="https://datatracker.ietf.org/doc/html/rfc8252#section-5" target="_top" class="descriptionLink">https://datatracker.ietf.org/doc/html/rfc8252#section-5</a>).&nbsp;Die genaue Interaktionsform ist von den Spezifika des verwendeten Betriebssystems abhängig.&nbsp; </p>
  <p id="polarion_322"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-126119">
   <p><b>A_22424</b></p>
   <p>Im Falle der Nutzung von alternativen Authentisierungsanwendungen MUSS der Authenticator des IDP-Dienstes&nbsp;sicherstellen, dass die Einwilligung des Nutzers zur Datenverarbeitung durch den Anbieter des IDP-Dienstes eingeholt wird&nbsp;und nur nach dessen Zustimmung der Anwendungsfall ermöglicht werden kann. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125019">
   <p><b>A_22296</b></p>
   <p>Das Authenticator-Modul des IDP-Dienstes MUSS die Liste der bekannten&nbsp;alternativen Authentisierungsanwendungen unter der im Discovery Document des IDP-Dienstes unter&nbsp;"kk_app_list_uri" gefundenen Adresse&nbsp;beziehen und ihre&nbsp;Integrität prüfen.<br> <span title="Added">Die Signatur des unter "<span style="font-size: 10pt;line-height: 1.5;">kk_app_list_uri" heruntergeladenen JWS muss&nbsp;</span>mathematisch geprüft und auf ein zeitlich gültiges C.FD.SIG-Zertifikat mit der Rollen-OID <span style="font-style: italic;">"</span><span style="font-style: normal;">oid_idpd</span><span style="font-style: italic;">"</span> zurückgeführt werden, welches von einer dem Authenticator-Modul bekannten CA der Komponenten-PKI ausgestellt wurde.<span id="polarion-comment:859"></span></span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125017">
   <p><b>A_22294</b></p>
   <p>Das Authenticator-Modul des IDP-Dienstes MUSS dem Nutzer die Option zur Verwendung von sektoralen Identity Providern zur Authentisierung ermöglichen. Hierzu MÜSSEN ihm die Namen "kk_app_name"&nbsp;der verfügbaren alternativen Authentisierungsanwendungen,&nbsp;aus der zuvor heruntergeladenen Liste, in nachvollziehbarer Form auf der Benutzeroberfläche dargestellt und ihm eine Auswahl angeboten werden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125016">
   <p><b>A_22295</b></p>
   <p>Bei Auswahl eines sektoralen Identity Provider durch den Nutzer MUSS das Authenticator-Modul des IDP-Dienstes einen Authorization-Request an den Third-Party Authorization Endpo<span style="font-size: 10pt;line-height: 1.5;">int des IDP-Dienstes senden. Der Authorization Request entspricht der in [gemSpec_IDP_Dienst#7.1] genannten Form, aber MUSS um einen weiteren Parameter "kk_app_id" ergänzt werden, dessen Wert dem Identifikator (kk_app_id)&nbsp;des Authenticator-Moduls eines sektoralen IDP-Dienstes entspricht, welcher zum vom Benutzer ausgewählten Namen (kk_app_name) gehört.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125045">
   <p><b>A_22299</b></p>
   <p>Im Falle der Nutzung von alternativen Authentisierungsanwendungen MUSS das Authenticator-Modul&nbsp;des IDP-Dienstes&nbsp;die Antwort des IDP-Dienstes&nbsp;als Authorization Request an die in der target_url des redirect enthaltene URI weiterleiten und sich dabei den verwendeten "state" Parameter merken, um später erhaltene Antworten des sektoralen Identity Provider zuzuordnen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_136"> <span style="font-style: italic;">Hinweis: Es wird hierbei angenommen, dass auf dem Endgerät des Nutzers ein zum sektoralen Identity Provider gehörendes Authenticator-Modul existiert, das für die angegebene URL als Handler registriert ist.</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125060">
   <p><b>A_22313</b></p>
   <p>Das Authenticator-Modul des IDP-Dienstes MUSS für Aufrufe zu Authenticator-Modulen sektoraler Identity Provider die Verifikationsmechanismen des Betriebssystems verwenden. Die folgenden Parameter müssen gesetzt sein:&nbsp;<br>Android: Keine weiteren.<br>iOS: .universalLinksOnly:false <b>&lt;=</b></p>
  </div>
  <p id="polarion_192"> <span style="font-style: italic;">Hinweis:</span>&nbsp;<span style="font-style: italic;font-size: 10pt;line-height: 1.5;">Durch den Verzicht auf die zwingende Nutzung von Universal Links hat der Anbieter des sektoraler Identity Providers&nbsp;die Möglichkeit über die Webseite eine Fehlerbehandlung bei nicht installiertem Authenticator-Modul&nbsp;zu machen.</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125046">
   <p><b>A_22300</b></p>
   <p><span title="Added">Das Authenticator-Modul des IDP-Dienstes MUSS sich um App-zu-App-Aufrufe zu verarbeiten im Betriebssystem unter der URI <a class="descriptionLink" target="_top" href="https://das-e-rezept-fuer-deutschland.de">https://das-e-rezept-fuer-deutschland.de</a>&nbsp;registrieren.<span id="polarion-comment:864"></span></span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125047">
   <p><b>A_22301</b></p>
   <p>Das Authenticator-Modul&nbsp;des IDP-Dienstes MUSS den Authorization Code "AUTHORIZATION_CODE_IDP",&nbsp; den state-Parameter sowie den Parameter "kk_app_redirect_uri", welche mittels App2App-Kommunikation vom&nbsp;Authenticator-Modul des sektoralen Identity Provider übergeben werden, akzeptieren, wenn der state mit dem Wert einer kürzlich vom IDP-Dienst erhaltenen Anfrage übereinstimmt. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125048">
   <p><b>A_22302</b></p>
   <p>Das Authenticator-Modul&nbsp;des IDP-Dienstes MUSS den empfangenen Authorization Code "AUTHORIZATION_CODE_IDP",&nbsp; den state-Parameter sowie den Parameter "kk_app_redirect_uri" als HTTP-POST an den im Discovery Document referenzierten Third-Party Authorization Endpoint des IDP-Dienstes weiterleiten. <b>&lt;=</b></p>
  </div>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-126128">7.8.1 Registrierungsdaten des Authenticator-Moduls</h4>
  <p id="polarion_325">Aufgrund der genannten Abhängigkeiten sind zu den folgenden Anforderungen jeweils die geforderten Ausgestaltungen für Android und iOS genannt. Bei beiden Betriebssystemen werden Apps - analog zu web-basierten Anwendungen - über URLs adressiert, die von den installierten Apps beansprucht werden. Die Eindeutigkeit der Zuordnung zwischen URL und App wird in beiden Fällen durch Daten&nbsp;innerhalb der Distribution und unter der URL abrufbaren Informationen hergestellt (sog. Asset-Link-Dateien im Fall von Android bzw. Apple-App-Site-Association-Dateien im Fall Apple/iOS).&nbsp;&nbsp;</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125555">
   <p><b>A_22349</b></p>
   <p>Der Anbieter des Authenticator-Modul des IDP-Dienstes MUSS sicherstellen, dass die durch das Betriebssystem notwendigen Voraussetzungen für die Funktionsfähigkeit des Authenticator-Moduls des IDP (z.B. Manifest, Entitlement, Dateien im .well-known Verzeichnis der verwendeten Domain aus A_22300) erfüllt sind. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125015">
   <p><b>A_22291</b></p>
   <p>Das Authenticator-Modul des IDP-Dienstes MUSS zur korrekten Funktion der&nbsp;App2App-Kommunikation in seiner Android-Distribution in seinem Manifest mindestens den folgenden Intent aufnehmen: 
    <table style="width: 100%;margin-left: 0px;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;" class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%">
     <tbody>
      <tr>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 157.9px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Objekt</th>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 415.962px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Ausgestaltung</th>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 76.9375px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Ergänzung</th>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 157.9px;height: 307.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">AndroidManifest.xml/Intent</td>
       <td style="text-align: left;vertical-align: top;width: 415.962px;height: 307.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&lt;intent-filter android:autoVerify="true"&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &lt;action android:name="android.intent.action.VIEW" /&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &lt;category android:name="android.intent.category.DEFAULT"/&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;category android:name="android.intent.category.BROWSABLE"/&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;data&nbsp;android:scheme="https" android:host="<span style="font-weight: bold;"><a class="descriptionLink" target="_top" href="https://das-e-rezept-fuer-deutschland.de">https://das-e-rezept-fuer-deutschland.de</a></span>"/&gt;<br> &lt;/intent-filter&gt;</span></td>
       <td style="text-align: left;vertical-align: top;width: 76.9375px;height: 307.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Das Flag "autoVerfiy" MUSS auf "true" gesetzt werden.&nbsp;<br> Der Parameter &lt;URL&gt; MUSS dem beim zentralen IDP-Dienst registrierten Wert entsprechen.&nbsp;<br></td>
      </tr>
     </tbody>
    </table> <b>&lt;=</b></p>
  </div>
  <p id="polarion_315"> <span style="font-style: italic;">Hinweis: Das gesetzte Flag ist notwendige Voraussetzung für die Etablierung der App als Default Handler für die im Host-Parameter genannten URL.&nbsp;&nbsp;</span> </p>
  <p id="polarion_316"> <span style="font-weight: bold;"> </span> </p>
  <p id="polarion_333"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125013">
   <p><b>A_22292</b></p>
   <p>Das Authenticator-Modul&nbsp;des IDP-Dienstes MUSS zur korrekten Funktion der&nbsp;App2App-Kommunikation in seiner iOS-Distribution mindestens das folgende Entitlement aufnehmen:&nbsp;<br> <br> 
    <table id="polarion_wiki macro name=table;params=width=100%" class="polarion-Document-table" style="width: 100%;margin-left: 0px;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;">
     <tbody>
      <tr>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 163.65px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Objekt</th>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 557.612px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Inhalt</th>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 163.65px;height: 200px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">*.entitlement</td>
       <td style="text-align: left;vertical-align: top;width: 557.612px;height: 200px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br> &lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;<br> &lt;plist version="1.0"&gt;<br> &lt;dict&gt;<br> &nbsp; &nbsp; &lt;key&gt;com.apple.developer.associated-domains&lt;/key&gt;<br> &nbsp; &nbsp; &lt;array&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &lt;string&gt;applinks:erezept.dev.gematik.solutions&lt;/string&gt;<br> &nbsp; &nbsp; &lt;/array&gt;<br> &nbsp; &nbsp; &lt;key&gt;com.apple.developer.default-data-protection&lt;/key&gt;<br> &nbsp; &nbsp; &lt;string&gt;NSFileProtectionCompleteUnlessOpen&lt;/string&gt;<br> &nbsp; &nbsp; &lt;key&gt;com.apple.developer.nfc.readersession.formats&lt;/key&gt;<br> &nbsp; &nbsp; &lt;array&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &lt;string&gt;TAG&lt;/string&gt;<br> &nbsp; &nbsp; &lt;/array&gt;<br> &lt;/dict&gt;<br> &lt;/plist&gt;</span></td>
      </tr>
     </tbody>
    </table> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125014">
   <p><b>A_22293</b></p>
   <p>Das Authenticator-Modul des IDP-Dienstes MUSS sicherstellen, dass unter <span style="font-weight: bold;"><a href="https://das-e-rezept-fuer-deutschland.de" target="_top" class="descriptionLink">https://das-e-rezept-fuer-deutschland.de</a></span> die Dateien folgenden Inhalts im Verzeichnis ./well-known hinterlegt sind:<br> 
    <table id="polarion_wiki macro name=table;params=width=100%" class="polarion-Document-table" style="width: 100%;margin-left: 0px;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;">
     <tbody>
      <tr>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 93.1625px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Plattform</th>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 78.4px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Dateiname</th>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 452.763px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Inhalt</th>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 93.1625px;height: 136.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Google/Android</td>
       <td style="text-align: left;vertical-align: top;width: 78.4px;height: 136.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">assetLink.json</td>
       <td style="text-align: left;vertical-align: top;width: 452.763px;height: 136.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><pre><span style="font-size: 8pt;line-height: 1.5;">[{</span></pre><pre><span style="font-size: 8pt;line-height: 1.5;">&nbsp; "relation": ["delegate_permission/common.handle_all_urls"],</span></pre><pre><span style="font-size: 8pt;line-height: 1.5;">&nbsp; "target": {</span></pre><pre><span style="font-size: 8pt;line-height: 1.5;">&nbsp;&nbsp;&nbsp; "namespace": "android_app",</span></pre><pre><span style="font-size: 8pt;line-height: 1.5;">&nbsp;&nbsp;&nbsp; "package_name": "&lt;Beispiel:com.example.erpfasttrack&gt;",</span></pre><pre><span style="font-size: 8pt;line-height: 1.5;">&nbsp;&nbsp;&nbsp; "sha256_cert_fingerprints":</span></pre><pre><span style="font-size: 8pt;line-height: 1.5;">&nbsp;&nbsp;&nbsp; [...]</span></pre><pre><span style="font-size: 8pt;line-height: 1.5;">&nbsp; }</span></pre><pre><span style="font-size: 8pt;line-height: 1.5;">}]</span></pre></td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 93.1625px;height: 167.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Apple/iOS</td>
       <td style="text-align: left;vertical-align: top;width: 78.4px;height: 167.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">apple-app-site-association</td>
       <td style="text-align: left;vertical-align: top;width: 452.763px;height: 167.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><pre><span style="font-size: 8pt;line-height: 1.5;">{</span></pre><pre><span style="font-size: 8pt;line-height: 1.5;">&nbsp; "applinks": {</span></pre><pre><span style="font-size: 8pt;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "details": [</span></pre><pre><span style="font-size: 8pt;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></pre><pre><span style="font-size: 8pt;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "appIDs": [ "A9FL89PFFL.de.gematik.erp4ios.eRezept" ],</span></pre><pre><span style="font-size: 8pt;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "paths": ["*"]</span></pre><pre><span style="font-size: 8pt;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></pre><pre><span style="font-size: 8pt;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ]</span></pre><pre><span style="font-size: 8pt;line-height: 1.5;">&nbsp;&nbsp; },<br>....</span></pre><pre><span style="font-size: 8pt;line-height: 1.5;">}</span></pre></td>
      </tr>
     </tbody>
    </table> <b>&lt;=</b></p>
  </div>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-104368">8 Funktionsmerkmale Anwendungsfrontend des IDP Dienstes</h2>
  <p id="polarion_124">Das Anwendungsfrontend ist eine Software-Komponente, welche darauf zugeschnitten ist, Daten der Fachdienste der Telematikinfrastruktur zu verarbeiten. Die Verarbeitung tritt hier in Form von Erstellung, Änderung, Anzeige, Weitergabe und Löschung auf. Um den agierenden Akteur vor dessen Zugriff auf die Fachdienste zu identifizieren, ist der Besitz einer Smartcard und der damit verbundenen PIN notwendig.</p>
  <p id="polarion_183">Es liegt jedoch nicht im Fokus der Fachdienste, Identitätskontrollen durchzuführen und zu überprüfen, ob eine aktuell vorgetragene Identität valide und gültig ist. Aus diesem Grund wurde die Instanz IDP-Dienst geschaffen, deren alleinige Aufgabe es ist, bereits ausgegebene Identifikationsmittel auf deren aktuelle Gültigkeit und Integrität hin zu überprüfen und gleichzeitig sicherzustellen, dass der vortragende Akteur vermeintlich auch berechtigt ist, das Identifikationsmittel nutzen zu dürfen. Aus diesem Grund wird bei einigen Funktionalitäten im Zusammenhang mit der Smartcard eine PIN-Abfrage angefordert. Diese soll sicherstellen, dass Besitz (Smartcard) und Wissen (PIN) zur selben Zeit quasi am selben Ort zusammenkommen und willentlich eine bestimmte Aktion auslösen.</p>
  <p id="polarion_248">Das Anwendungsfrontend muss die in diesem Dokument beschriebenen Schnittstellen bedienen, um auf in der TI als zentrale oder dezentrale Plattformleistung angebotene Fachdienste zugreifen zu können.</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-108589">8.1 Vorbereitende Maßnahmen</h3>
  <p id="polarion_34"> <span style="font-size: 11pt;line-height: 1.5;"> </span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111153">
   <p><b>A_20603</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Das Anwendungsfrontend MUSS sich über einen organisatorischen Prozess am IdP-Dienst registrieren und die vom IdP-Dienst dabei vergebene&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">client_id</span> im Anwendungsfrontend speichern. Diese MUSS vom Anwendungsfrontend bei Nutzung des IdP-Dienstes übertragen werden.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-112009">
   <p><b>A_20740</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Das Anwendungsfrontend MUSS beim IdP-Dienst bei der Registrierung eine&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">redirect_uri</span> hinterlegen.&nbsp;</span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_45"> <span style="font-style: italic;">Hinweis: Der IDP-Dienst nutzt die registrierte&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">redirect_uri</span> im späteren Verlauf dazu, eine Redirection auszuführen. Dabei wird der ausgestellte&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> vom Authenticator-Modul an das Anwendungsfrontend weitergeleitet.</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-112010">
   <p><b>A_20741</b></p>
   <p>Das Anwendungsfrontend MUSS den vom <span style="font-size: 10pt;line-height: 1.5;">IdP-Dienst bei der Registrierung bekanntgegebenen Downloadpunkt des Discovery Document als konfigurierbaren Parameter speichern</span>. <b>&lt;=</b></p>
  </div>
  <p id="polarion_219"> <span style="font-style: italic;">Hinweis: Über das Discovery Document können u. a. die URIs der Endpunkte des IDP-Dienstes und die Adressen der dazugehörigen öffentlichen Schlüssel bezogen werden.</span> </p>
  <p id="polarion_37"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110768">
   <p><b>A_20512</b></p>
   <p>Das&nbsp;<span id="polarion-comment:315"></span>Anwendungsfrontend <span style="font-weight: normal;">MUSS</span> das Discovery Document [<a class="descriptionLink" target="_top" href="https://tools.ietf.org/html/rfc8414">RFC8414</a>] löschen, wenn dieses 24 Stunden alt oder älter ist. Das Anwendungsfrontend MUSS das Discovery Document neu herunterladen, einlesen und auswerten und danach die&nbsp;darin aufgeführten URI zu den&nbsp;benötigten öffentlichen Schlüsseln (PUKs) und Diensten verwenden, wenn kein aktuelles Discovery Document vorliegt. <b>&lt;=</b></p>
  </div>
  <p id="polarion_26"> <span style="font-style: italic;">Hinweis: Der IDP-Dienst übergibt den&nbsp;Downloadpunkt während der organisatorischen Registrierung des Anwendungsfrontends bzw. des Primärsystems beim IDP-Dienst.</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111179">
   <p><b>A_20623</b></p>
   <p>Das Anwendungsfrontend MUSS die Signatur des Discovery Document mathematisch prüfen und auf ein zeitlich gültiges C.FD.SIG-Zertifikat mit der Rollen-OID <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">oid_idpd</span> zurückführen können, welches rückführbar ist auf ein CA-Zertifikat aus einer authentischen, integren und zeitlich gültigen TSL. <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-108588">8.2 Schnittstellen des Anwendungsfrontends</h3>
  <p id="polarion_39">Das Anwendungsfrontend hat Schnittstellen zum logisch getrennten, aber in einer Applikation kombinierten Authenticator-Modul, sowie zum IDP-Dienst und zum Fachdienst.</p>
  <p id="polarion_146"> Es initiiert seine Authentifizierungsanfrage, welche vom Authenticator-Modul übernommen und im Auftrag des Anwendungsfrontends beim IDP-Dienst eingereicht wird. Nach erfolgreicher Authentifizierung übergibt der IDP-Dienst einen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> an das Authenticator-Modul zurück. Dieser Code wird an das Anwendungsfrontend weitergereicht. Das Anwendungsfrontend erhält vom IDP-Dienst durch Vorlage des Codes einen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span> und einen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span>. Durch Vorlage des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> erhält das Anwendungsfrontend Zugriff auf die Daten des Fachdienstes.<br> Nachfolgende Abbildung skizziert die beschriebenen Schnittstellen des Anwendungsfrontends. Schnittstellen zwischen anderen Komponenten sind dabei grau angedeutet. </p>
  <p id="polarion_227"></p>
  <p id="polarion_230" style="text-align: center;"> <img src="attachments/Anwendungsfrontend-Comp-neu2.png" style="width: 431px;height: 476px;" data-lastmodified="2020-07-27T06:49:59.214+02:00"> </p>
  <p id="polarion_141" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">7</span>: Schnittstellen des Anwendungsfrontends </p>
  <p id="polarion_211"></p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-111253">8.2.1 Schnittstellendefinition</h4>
  <p id="polarion_220"> Das Anwendungsfrontend übergibt seine Authentifizierungs-Anfrage an das Authenticator-Modul. Es reicht den vom Authenticator-Modul übergebenen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> beim IDP-Dienst ein und erhält nach positiver Validierung einen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span> und einen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span>. Das Anwendungsfrontend nutzt den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span>, um Fachdaten vom Fachdienst anzufragen. </p>
  <p id="polarion_221"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110417">
   <p><b>A_20309</b></p>
   <p>Das Anwendungsfrontend MUSS&nbsp;zur Laufzeit einen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CODE_VERIFIER</span> (Zufallswert) gemäß [<a href="https://tools.ietf.org/html/rfc7636#section-4.1" target="_top" class="descriptionLink">RFC7636 # section-4.1</a>] bilden. Der <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CODE_VERIFIER</span> MUSS eine Entropie von mindestens 43 und maximal 128 Zeichen enthalten. Das Anwendungsfrontend MUSS über den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CODE_VERIFIER</span> einen HASH-Wert, die sogenannte <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CODE_CHALLENGE,</span> gemäß [<a href="https://tools.ietf.org/html/rfc7636#section-4.2" target="_top" class="descriptionLink">RFC7636 # section-4.2</a>] bilden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110728">
   <p><b>A_20483</b></p>
   <p>Das Anwendungsfrontend MUSS über das Authenticator-Modul den Antrag zum<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;"> AUTHORIZATION_CODE</span> für einen&nbsp;<span style="font-size: 11pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">ACCESS_TOKEN</span> via Private-Use URI Scheme Redirection&nbsp; [<a href="https://tools.ietf.org/html/rfc8252#section-7.1" target="_top" class="descriptionLink">RFC8252 # section-7.1</a>] beim Authorization-Endpunkt in Form eines HTTP/1.1 GET-Request stellen und dabei die folgenden Attribute anführen: <br> 
    <div style="margin-left: 2em;"> 
     <ul> 
      <li>"<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">response_type</span>"</li> 
      <li>"<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">scope</span>"</li> 
      <li>"<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">client_id</span>"</li> 
      <li>"<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">redirect_uri</span>"</li> 
      <li><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">"code_challenge"</span> (Hashwert des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">"code_verifier"</span>) [<a href="https://tools.ietf.org/html/rfc7636#section-4.2" target="_top" class="descriptionLink">RFC7636 # section-4.2</a>]<br> </li> 
      <li><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">"code_challenge_method"</span> HASH-Algorithmus (S256) [<a href="https://tools.ietf.org/html/rfc7636#section-4.3" target="_top" class="descriptionLink">RFC7636 # section-4.3</a>]</li> 
     </ul> 
    </div> <b>&lt;=</b></p>
  </div>
  <p id="polarion_203"> <span style="font-style: italic;">Hinweis: Der Aufbau der Anfrage entspricht [gemSpec_IDP_Dienst#Kapitel 7.1 Authorization Request].</span><br> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-108618">
   <p><b>A_20085</b></p>
   <p>Das Anwendungsfrontend MUSS leicht verständliche Fehlermeldungen ausgeben. Eine exakte Form der Fehlermeldung ist nicht vorgegeben [<a class="descriptionLink" target="_top" href="https://tools.ietf.org/html/rfc6749#section-1.7">RFC6749 # section-1.7</a>]. <b>&lt;=</b></p>
  </div>
  <p id="polarion_64"> <span style="font-style: italic;">Hinweis: Wenn möglich, sollen dem Nutzer Hilfestellungen gegeben werden, anhand derer man die Wiederholung des Fehlers vermeiden kann.</span> </p>
  <p id="polarion_311"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116343">
   <p><b>A_21323</b></p>
   <p>Das Anwendungsfrontend MUSS vor dem Abrufen von <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span> und <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> einen zufälligen 256 Bit AES-Schlüssel ("Token-Key“) erzeugen.&nbsp; <b>&lt;=</b></p>
  </div>
  <p id="polarion_268"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116344">
   <p><b>A_21324</b></p>
   <p>Das Anwendungsfrontend MUSS dem <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">KEY_VERIFIER</span> bilden, indem "Token-Key" und <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CODE_VERIFIER</span> in einem JSON-Objekt kodiert werden.<br> <b>&lt;=</b></p>
  </div>
  <p id="polarion_222"> <span style="font-style: italic;">Hinweis: Der Aufbau des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">KEY_VERIFIER </span>entspricht [gemSpec_IDP_Dienst#Kapitel 7.5 Token Request].&nbsp;</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116347">
   <p><b>A_20529-01</b></p>
   <p>Das Anwendungsfrontend MUSS den&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">KEY_VERIFIER</span> mittels JWE (<span style="font-size: 10pt;line-height: 1.5;">JSON Web Encryption (JWE) [<a href="https://tools.ietf.org/html/rfc7516#section-3" target="_top">RFC7516 # section-3</a>])&nbsp;</span>und <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PuK_IDP_ENC</span> verschlüsseln und zusammen mit dem&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> TLS-gesichert als HTTP/1.1 POST Request an den Token-Endpunkt senden.<br> <b>&lt;=</b></p>
  </div>
  <p id="polarion_280"> <span style="font-style: italic;">Hinweis 1: Der Aufbau der Anfrage entspricht [gemSpec_IDP_Dienst#Kapitel 7.5 Token Request].</span> </p>
  <p id="polarion_32"> <span style="font-style: italic;">Hinweis 2: Als Verschlüsselungsalgorithmus für den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">KEY_VERIFIER</span> ist ECDH-ES (Elliptic Curve Diffie-Hellman Ephemeral Static key agreement) vorgesehen.</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107999">
   <p><b>A_19937</b></p>
   <p>Das Anwendungsfrontend <span style="font-weight: normal;">MUSS</span> in der Lage sein, die vom Token-Endpunkt übertragenen Fehlermeldungen anzuzeigen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111155">
   <p><b>A_20605</b></p>
   <p>Das Anwendungsfrontend MUSS den Inhalt der Fehlermeldungen sowie mögliche Hinweise zur Fehlervermeidung vom Token-Endpunkt übernehmen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_107"> <span style="font-style: italic;">Hinweis: Es ist insbesondere der Inhalt der Fehlermeldung gemeint. Die Formatierung darf den Gegebenheiten des Endgerätes entsprechend angepasst werden.</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-108609">
   <p><b>A_20079</b></p>
   <p>Das Anwendungsfrontend MUSS im Falle eines Timeout selbständig eine Fehlermeldung generieren, wenn eine Fehlermeldung durch den Token-Endpunkt ausbleibt. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116348">
   <p><b>A_19938-01</b></p>
   <p>Das Anwendungsfrontend MUSS das vom Token-Endpunkt ausgegebene <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span> als HTTP/1.1-Statusmeldung 200 verarbeiten und mittels "Token-Key" entschlüsseln. <br> Das Anwendungsfrontend MUSS das&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span> ablehnen, wenn dieses außerhalb der mit dem Token-Endpunkt etablierten TLS-Verbindung übertragen wird oder nicht mit dem vorher übermittelten "Token-Key" verschlüsselt war.&nbsp;<br> <b>&lt;=</b></p>
  </div>
  <p id="polarion_281"> <span style="font-style: italic;">Hinweis 1: Der Aufbau der Antwort und des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN </span>entspricht [gemSpec_IDP_Dienst#Kapitel 7.6 Token Response]</span> </p>
  <p id="polarion_217"> <span style="font-style: italic;">Hinweis 2: Das Anwendungsfrontend nimmt sowohl den</span><span style="font-style: normal;"> </span><span style="font-style: italic;"><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span>, als auch den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN </span>aus der Antwort des Token-Endpunktes des IDP-Dienstes. Der Token-Endpunkt antwortet mit dem Token auf die erfolgreiche Übergabe und Validierung des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE </span>durch das Anwendungsfrontend.&nbsp;</span><span style="font-style: normal;">&nbsp;</span> </p>
  <p id="polarion_109"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111180">
   <p><b>A_20625</b></p>
   <p>Das Anwendungsfrontend MUSS die Signatur des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN </span>mathematisch prüfen und auf ein zeitlich gültiges C.FD.SIG-Zertifikat mit der Rollen-OID oid_idpd zurückführen können, welches rückführbar ist auf ein CA-Zertifikat aus einer authentischen, integren und zeitlich gültigen TSL. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116349">
   <p><b>A_20283-01</b></p>
   <p>Das Anwendungsfrontend MUSS das vom Token-Endpunkt ausgegebene <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN </span>in der HTTP/1.1-Statusmeldung 200 verarbeiten und mittels "Token-Key" entschlüsseln.&nbsp;<br> Das Anwendungsfrontend MUSS das <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN </span>ablehnen, wenn dieses außerhalb der mit dem Token-Endpunkt etablierten TLS-Verbindung übertragen wird oder nicht mit dem vorher übermittelten "Token-Key" verschlüsselt war.&nbsp;<br> <b>&lt;=</b></p>
  </div>
  <p id="polarion_312"> <span style="font-style: italic;">Hinweis: Der Aufbau der Antwort und des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> entspricht [gemSpec_IDP_Dienst#Kapitel 7.6 Token Response].&nbsp;</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111152">
   <p><b>A_20602</b></p>
   <p>Das Anwendungsfrontend MUSS das <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> im Rahmen des entsprechenden fachlichen Aufrufs beim Fachdienst einreichen, um Zugang zu den angeforderten Daten zu erhalten. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116354">
   <p><b>A_21325</b></p>
   <p>Das Anwendungsfrontend MUSS den entschlüsselten&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span>, zusätzlich zur Übertragung mittels TLS, auf Anwendungsebene verschlüsselt zum Fachdienst übertragen.&nbsp; <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116355">
   <p><b>A_21326</b></p>
   <p>Das Anwendungsfrontend&nbsp; MUSS&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> beim Beenden sowie nach Ablauf ihrer Gültigkeit sicher löschen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116356">
   <p><b>A_21327</b></p>
   <p>Das Anwendungsfrontend&nbsp; MUSS&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span> beim Beenden sowie nach Ablauf ihrer Gültigkeit sicher löschen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116357">
   <p><b>A_21328</b></p>
   <p>Das Anwendungsfrontend&nbsp; MUSS empfangene&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span> und&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> gegen unberechtigten Zugriff schützen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_111"></p>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-133804">9 Nutzung sektoraler Identity Provider</h2>
  <p id="polarion_1">Zu einem sektoralen IDP gehört ein Authenticator-Modul. Sektoraler IDP und Authenticator-Modul zum sektoralen IDP sind in [gemSpec_IDP_Sek] spezifiziert. Die nachfolgenden Anforderungen beziehen sich auf das Anwendungsfrontend der Authenticator-Module zum sektoralen IDP.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133240">
   <p><b>A_23082</b></p>
   <p>Anwendungsfrontends MÜSSEN, sofern nicht anderweitig ein sektoraler Identity Provider zuvor gemerkt oder festgelegt wurde, die IDP-Liste vom Authorization-Server herunterladen, auf Integrität prüfen und (bei erfolgreicher Prüfung) dem Benutzer zur Auswahl anzeigen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133238">
   <p><b>A_23083</b></p>
   <p><span style="color: #330033;">Anwendungsfrontends SOLL zur Auslösung der Benutzerauthentifizierung einen OAuth Authorization Request an den zugehörigen Authorization-Server schicken.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133239">
   <p><b>A_23084</b></p>
   <p><span style="color: #330033;">Anwendungsfrontends MÜSSEN bei Erhalt einer URI-PAR nach <a class="descriptionLink" target="_top" href="https://www.rfc-editor.org/rfc/rfc9126.html#name-successful-response">https://www.rfc-editor.org/rfc/rfc9126.html#name-successful-response</a> das Authenticator-Modul mittels der übergebenen Redirect-URL aufrufen und hierbei ggf. die Link-Technologie des jeweiligen Betriebssystems verwenden.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133241">
   <p><b>A_23085</b></p>
   <p><span style="color: #330033;">Anwendungsfrontends MÜSSEN sich mittels Universal-Link bzw. App-Link unter der URL des Authorization-Servers im Betriebssystems registrieren.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133242">
   <p><b>A_23086</b></p>
   <p><span style="color: #330033;">Anwendungsfrontends MÜSSEN den&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> vom Authenticator-Modul annehmen und an den Authorization-Server weiterleiten.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133230">
   <p><b>A_23081</b></p>
   <p>Anwendungsfrontends und Web-Backend MÜSSEN bei Inaktivität des Nutzers von 10 Minuten automatisch zwischengespeicherte <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> und <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">REFRESH_TOKEN</span> löschen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133288">
   <p><b>A_23097</b></p>
   <p>Anwendungsfrontends MÜSSEN den Nutzern die Möglichkeit zum Abmelden bieten, und in diesem Fall zwischengespeicherte <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACESS_TOKEN</span> und <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">REFRESH_TOKEN</span> verwerfen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133243|layout=2">
   <p><b>AF_10119</b></p>
   <p><span style="font-weight: normal;color: #000000;">Das Anwendungsfrontend SOLL folgenden Anwendungsfall umsetzen.</span><br> <p data-keep-next="true" class="polarion-rte-caption-paragraph" style="text-align: left;" id="polarion___5"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">6</span> : Anwendungsfall "Abruf des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span>" </p> 
    <table id="polarion_wiki macro name=table;params=width=100%|uid=204" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
     <tbody> 
      <tr> 
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 130px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Attribute</th> 
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 600px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Bemerkung</th> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 130px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Beschreibung</td> 
       <td style="text-align: left;vertical-align: top;width: 600px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Ein Anwender möchte einen in der TI registrierte Fachdienst nutzen. Der Fachdienst muss sicherstellen, dass der Anwender zur Nutzung des Dienstes berechtigt ist. Hierzu authentisiert sich der Anwender gegenüber einem sektoralen Identity Provider, bei dem er registriert ist. Nach Abschluss der Authentisierung des Nutzers gegenüber dem sektoralen Identity Provider, erhält das Anwendungsfrontend oder Web-Backend vom Authorization-Server den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> mit, dem er das <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> abrufen kann.<br> </td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 130px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Akteur</td> 
       <td style="text-align: left;vertical-align: top;width: 600px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Anwender der Fachanwendung</td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 130px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Auslöser</td> 
       <td style="text-align: left;vertical-align: top;width: 600px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Ein Anwender möchte eine Gesundheitsanwendung der TI (Fachdienst) nutzen. Als Voraussetzung muss er sich bei einem sektoralen Identity Provider authentifizieren, bei welchem er registriert ist. Nach Abschluss der Authentifizierung erhält der Authorization-Server vom sektoralen Identity Provider einen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span> (entsprechend&nbsp;<span class="polarion-rte-link" data-type="polarion" id="fake" data-custom-label="AF_10118 - &quot;Benutzerauthentifizierung und Erhalt des ID_TOKEN&quot;" data-url="/wiki/Spezifikation/gemSpec_IDP_FD?selection=ML-133235"></span>).<br> </td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 130px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Komponenten</td> 
       <td style="text-align: left;vertical-align: top;width: 600px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> 
        <ul> 
         <li>Anwendungsfrontend oder Web-Backend</li> 
         <li>Authorization-Server eines Fachdienstes</li> 
         <li>Fachdienst API<br> </li> 
        </ul> </td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 130px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Vorbedingung</td> 
       <td style="text-align: left;vertical-align: top;width: 600px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> Der Authorization-Server hat entsprechend dem&nbsp;<span class="polarion-rte-link" data-type="polarion" id="fake" data-custom-label="AF_10118 - &quot;Benutzerauthentifizierung und Erhalt des ID_TOKEN&quot;" data-url="/wiki/Spezifikation/gemSpec_IDP_FD?selection=ML-133235"></span>&nbsp;den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span> erhalten.<br> </td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 130px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Ablauf</td> 
       <td style="text-align: left;vertical-align: top;width: 600px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> 
        <ol> 
         <li>Der Authorization-Server sendet einen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> an das Anwendungsfrontend oder Web-Backend ([gemSpec_IDP_Sek] Tabelle: <span style="font-style: italic;">"Parameter des Redirect-Request"</span>).</li> 
         <li>Das Anwendungsfrontend oder Web-Backend ruft mit diesem <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> den Token-Endpunkt des Authorization-Servers auf.</li> 
         <li>Der Authorization-Server sendet einen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> und ggf. ein <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">REFRESH_TOKEN</span> zurück.</li> 
         <li>Das Anwendungsfrontend oder Web-Backend ruft mittels des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> die Fachdienst-API auf.<br> </li> 
        </ol> </td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 130px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Ergebnis</td> 
       <td style="text-align: left;vertical-align: top;width: 600px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Das Anwendungsfrontend oder Web-Backend hat den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> zum Zugriff&nbsp;auf die Fachdienst API.</td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 130px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Akzeptanzkriterien</td> 
       <td style="text-align: left;vertical-align: top;width: 600px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span class="polarion-rte-link" data-type="workItem" id="fake" data-item-id="ML-133246" data-option-id="short"></span>, <span class="polarion-rte-link" data-type="workItem" id="fake" data-item-id="ML-133244" data-option-id="short"></span>,&nbsp;<span class="polarion-rte-link" data-type="workItem" id="fake" data-item-id="ML-133245" data-option-id="short"></span>&nbsp;</td> 
      </tr> 
      <tr> 
       <td style="text-align: left;vertical-align: top;width: 130px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Alternativen</td> 
       <td style="text-align: left;vertical-align: top;width: 600px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> 
        <ol> 
         <li><span style="color: #000000;">Das Anwendungsfrontend oder Web-Backend hat bereits zuvor ein <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> erhalten, welches abgelaufen ist.</span></li> 
         <li><span style="color: #000000;">Um ein neues <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> zu erhalten, ruft das Anwendungsfrontend oder Web-Backend den Authorization-Server mittels&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">REFRESH_TOKEN</span> auf (anstelle des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span>).</span></li> 
         <li><span style="color: #000000;">Der Authorization-Server antwortet mit einem gültigen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> und ggf. einem neuen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">REFRESH_TOKEN</span>.</span></li> 
         <li><span style="color: #000000;">Das Anwendungsfrontend oder Web-Backend ruft mittels des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> die Fachdienst-API auf.</span></li> 
        </ol> </td> 
      </tr> 
     </tbody> 
    </table> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133246|layout=3">
   <p><b>ML-133246</b></p>
   <p><span style="font-weight: normal;">Der Nutzer wurde erfolgreich authentifiziert.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133244|layout=3">
   <p><b>ML-133244</b></p>
   <p><span style="font-weight: normal;">Es wurde ein <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> und ggf. <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">REFRESH_TOKEN</span> für den Nutzer und den Authentisierungskontext ausgestellt.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133245|layout=3">
   <p><b>ML-133245</b></p>
   <p><span style="font-weight: normal;">Die OAuth 2.0 Security Best Current Practice <a class="descriptionLink" target="_top" href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-security-topics">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-security-topics</a> wurden eingehalten.</span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_29"></p>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-104229">10 Anhang A – Interaktionen mit Smartcards der TI</h2>
  <p id="polarion_43">Das folgende Kapitel hat einen rein informativen Charakter und soll Hilfestellung beim Verständnis&nbsp;der Interaktion mit Smartcards der TI geben. Es ergeben sich aus den Beschreibungen keine normativen Anforderungen, welche umzusetzen wären. Normative Vorgaben aus referenzierten Dokumenten bleiben führend. Als Ziel soll hiermit ein grundsätzliches Verständnis der Abläufe vermittelt werden, welches eine Realisierung der Kommunikation des Authenticator-Moduls mit den Smartcards erleichtert.&nbsp;</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-109366">10.1 Einleitung</h3>
  <p id="polarion_47" class="MsoNormal">Zur Nutzung bestimmter Dienste der Telematikinfrastruktur ist eine Authentisierung der zugreifenden Person erforderlich. Dieses Dokument betrachtet ein Konzept für folgende User Story aus Kartensicht:</p>
  <p id="polarion_48">Ein Kartennutzer möchte eine eGK oder einen HBA über die kontaktlose Schnittstelle nutzen, um sich mittels Challenge- Response-Verfahren zu authentisieren. Soll die Challenge durch die SMC-B signiert werden, wird hierbei die Funktion "externalAuthenticate" des PTV-Konnektors verwendet, wenn sich die SMC-B im freigeschalteten Zustand befindet.</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-109367">10.2 Grober Ablauf aus Kartensicht</h3>
  <p id="polarion_49">Das Authenticator-Modul&nbsp;verwendet folgenden Ablauf, wobei hier nur Interaktionen mit der Karte dargestellt werden:</p>
  <ol id="polarion_50"> 
   <li>Von der Karte wird das zur Identität gehörende X.509-Zertifikat gelesen.</li> 
   <li>Es wird eine Nutzerauthentisierung durchgeführt.</li> 
   <li>Der zur Identität&nbsp;gehörende private Schlüssel wird zum Signieren einer Challenge genutzt. Die Signatur ist die zugehörige Response.</li> 
  </ol>
  <p id="polarion_51"> Aus Sicht einer eGK oder eines HBA stellt sich die User Story wie folgt dar (siehe Abbildung "Überblick zum Ablauf"):<span id="polarion-comment:861"></span> </p>
  <ol id="polarion_52"> 
   <li>Der User bringt die Karte in das Feld eines NFC-Kartenlesers. Dadurch bootet die Karte und es wird ein Kommunikationskanal etabliert.</li> 
   <li>Das Authenticator-Modul etabliert einen PACE-Kanal zur Karte.</li> 
   <li>Das Authenticator-Modul ermittelt den Kartentyp.</li> 
   <li>Das Authenticator-Modul wählt den privaten Schlüssel der zu verwendenden Identität aus.</li> 
   <li>Das Authenticator-Modul liest das X.509-Zertifikat aus.</li> 
   <li>Das Authenticator-Modul stößt eine Nutzerverifikation an.</li> 
   <li>Das Authenticator-Modul sendet ein Token zur Karte, welches von dieser signiert wird.</li> 
   <li>Dem Authenticator-Modul ist es möglich, beliebig viele weitere Token zur Karte zu schicken, um diese von der Karte signieren zu lassen.</li> 
   <li>Die Story endet damit, dass der User die Karte aus dem Feld des NFC-Kartenlesers entfernt, wodurch die Karte abgeschaltet wird.</li> 
  </ol>
  <p id="polarion_56">Erläuterungen zu Abbildung "Überblick zum Ablauf": Betrachtet wird hier ein System, welches aus folgenden Komponenten besteht:</p>
  <ol id="polarion_57"> 
   <li>Auf einem mobilen Gerät (in Abbildung "Überblick zum Ablauf" nicht gezeigt) ist eine Software installiert, welche (unter anderem) das Authenticator-Modul enthält.</li> 
   <li>Das Authenticator-Modul greift mit Hilfe diverser Komponenten des mobilen Gerätes via NFC-Schnittstelle auf eine Karte mit kontaktloser Schnittstelle zu.</li> 
   <li>Die Karte mit kontaktloser Schnittstelle wird in Abbildung 8 mit PICC (Proximity Integrated Circuit Card) bezeichnet.</li> 
   <li>Das Authenticator-Modul wird (ganz grob) in folgende zwei Komponenten unterteilt:</li> 
   <ol> 
    <li>"Secure Messaging Layer", eine Komponente, welche einen PACE-Kanal zur PICC etabliert und dann für eine kryptographisch gesicherte Kommunikation verantwortlich ist.</li> 
    <li>"other", der Rest des Authenticator-Moduls, der nicht zur Komponente Secure Messaging Layer gehört.<br> </li> 
   </ol> 
  </ol>
  <p id="polarion_62" style="text-align: center;"> <img src="attachments/Overview.png" style="max-width: 750px;" data-lastmodified="2020-05-19T10:32:54.382+02:00"> </p>
  <p id="polarion_63" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">8</span>: Überblick zum Ablauf </p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-109368">10.3 Ablauf im Detail</h3>
  <p id="polarion_68">Die folgenden Unterkapitel schildern den Ablauf zum Signieren einer Challenge im Detail. Ziel der Darstellung in diesem Kapitel ist es, dass ein Entwickler in die Lage versetzt wird, auf Basis dieser Beschreibung (plus den Informationen aus verlinkten Dokumenten) die auf der kontaktlosen Nutzung von Smartcards der TI basierten Funktionen eines Authenticator-Moduls zu entwickeln.</p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-109369">10.3.1 Aufbau eines Kommunikationskanals zwischen Authenticator-Moduls und PICC</h4>
  <p id="polarion_70">Wie ein Kommunikationskanal zwischen Authenticator-Modul und der&nbsp;PICC etabliert wird, hängt von der Hard- und Software des Gerätes ab, auf welchem das Authenticator-Modul läuft und mit welchem die PICC verbunden wird.</p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-107238">10.3.2 Aufbau eines PACE-Kanals</h4>
  <p id="polarion_71" class="MsoNormal">Nach Aufbau eines Kommunikationskanals ist das Authenticator-Modul in der Lage, Kommandonachrichten an die PICC zu senden und korrespondierende Antwortnachrichten von dort zu empfangen. Da es sich bei NFC um eine Funkschnittstelle handelt, ist mit der Möglichkeit zu rechnen, dass Angreifer die Kommunikation belauschen oder beeinflussen. Aus Sicherheitsgründen sind Karten der TI so konfiguriert, dass sie (von wenigen Ausnahmen abgesehen) Funktionen über die kontaktlose Schnittstelle nur im Rahmen einer kryptographisch gesicherten Verbindung bereitstellen. Dem Stand der Technik entsprechend wird dabei PACE eingesetzt.</p>
  <p id="polarion_72" class="MsoNormal">PACE (Password Authenticated Connection Establishment) bietet die Möglichkeit, selbst mit schwachen Passwörtern einen kryptographisch starken Kommunikationskanal zu etablieren. Das PACE-Protokoll wird kurz in [gemSpec_COS#15.4.2] beschrieben. Die dortige Beschreibung geht auf [TR-03110] zurück.</p>
  <p id="polarion_73" class="MsoNormal">Der Aufbau eines PACE-Kanals gliedert sich grob in zwei Phasen:</p>
  <ol id="polarion_74"> 
   <li>Auswahl eines gemeinsamen Satzes von Parametern</li> 
   <li><span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;"> </span>Ablauf des PACE-Authentisierungsprotokolls</li> 
  </ol>
  <p id="polarion_75" class="MsoNormal">Anschließend sind beide Kommunikationspartner im Besitz starker kryptographischer Schlüssel, mit deren Hilfe sie die weitere Kommunikation absichern.</p>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-107236">10.3.2.1 Auswahl eines gemeinsamen Satzes von Parametern</h5>
  <p id="polarion_76" class="MsoNormal">In [TR-03110] sind mehrere Varianten beschrieben, mittels eines (schwachen) Passwortes starke kryptographische Schlüssel zu vereinbaren. Drei dieser Varianten sind in [gemSpec_COS] verpflichtend enthalten. Welche Variante eine Karte der TI konkret unterstützt, ist in der Datei EF.CardAccess konform zu [TR-03110] codiert.</p>
  <p id="polarion_77" class="MsoNormal">Eine allgemeine Funktion zum Aufbau eines PACE-Kanals würde die Daten aus EF.CardAccess auswerten. Derzeit wird in [gemSpec_eGK_ObjSys],&nbsp;[gemSpec_HBA_ObjSys] und [gemSpec_HBA_ObjSys_G2.1]&nbsp;nur genau eine PACE-Variante verwendet. Zudem ist zu erwarten, dass die derzeit verwendete Variante mindestens bis zum Jahre 2026 verwendet wird. Deshalb wird hier folgende Empfehlung für die Implementierung des Authenticator-Moduls ausgesprochen:</p>
  <p id="polarion_80" class="MsoNormal">Das Authenticator-Modul verwendet die PACE-Variante "id-PACE-ECDH-GM-AES-CBC-CMAC-128" und den Schlüssel SK.CAN mit der Schlüsselreferenz keyRef='02'.</p>
  <p id="polarion_82" class="MsoNormal">Die verwendete PACE-Variante legt unter anderem die Domainparameter der zu verwendenden elliptischen Kurve fest.</p>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-107234">10.3.2.2 Auswahl des passenden Schlüssels in der Karte</h5>
  <p id="polarion_83" class="MsoNormal"> Vor dem Durchlauf des PACE-Protokolls ist auf der PICC der zugehörige Schlüssel SK.CAN auszuwählen. Dies geschieht mittels des Manage<span style="font-family: 'Times New Roman', Times;"> </span>Security Environment Kommandos gemäß [gemSpec_COS#(N102.448)] mit den Parametern OID und keyRef gemäß der in <span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-107236" data-option-id="shortoutline"></span>&nbsp;ausgewählten PACE-Variante. Gemäß der dort gegebenen Empfehlung gilt also: </p>
  <ul id="polarion_90"> 
   <li>OID = " id-PACE-ECDH-GM-AES-CBC-CMAC-128" und</li> 
   <li> keyRef='02'.</li> 
  </ul>
  <p id="polarion_91" class="MsoNormal">Falls die PICC auf dieses Kommando NICHT mit dem Trailer '9000' = NoError antwortet, ist die PICC zu keiner der im Literaturverzeichnis aufgelisteten Objektsystemspezifikationen konform. In diesem Fall wird empfohlen, den Use Case abzubrechen.</p>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-107232">10.3.2.3 Ablauf des PACE-Authentisierungsprotokolls</h5>
  <p id="polarion_92" class="MsoNormal"> Der Ablauf des PACE-Authentisierungsprotokolls ist in [gemSpec_COS#CosA_8da] beschrieben. In der dortigen Abbildung sind drei Komponenten zu sehen, die wie folgt mit den Komponenten aus der unteren Abbildung "Sequenzdiagramm PACE-Authentisierung"<span style="font-style: italic;">&nbsp;</span>korrespondieren: </p>
  <p id="polarion_96"></p>
  <p id="polarion_97" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">7</span>: Zusammenhang CosA_8da mit der folgenden Abbildung </p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=98" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 140px;height: 22px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">[COS#CosA_8da] <br> </span></th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 200px;height: 22px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Abbildung 9</span></th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 380px;height: 22px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;"> Anmerkung </span></th> 
    </tr> 
    <tr> 
     <td style="width: 140px;height: 28px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> COSb <span style="font-style: italic;">PCD</span><br> </td> 
     <td style="width: 200px;height: 28px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> Secure Messaging Layer<br> </td> 
     <td rowspan="2" style="width: 380px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Teilkomponente des NFC-Authenticator-Moduls, welche einen PACE-Kanal etabliert und anschließend für die geschützte Nachrichtenübertragung zur PICC sorgt.<br> </td> 
    </tr> 
    <tr> 
     <td style="width: 140px;height: 28.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> Steuersoftware<br> </td> 
     <td style="width: 200px;height: 28.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> Secure Messaging Layer<br> </td> 
    </tr> 
    <tr> 
     <td style="width: 140px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> COSa <span style="font-style: italic;">PICC</span><br> </td> 
     <td style="width: 200px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> PICC<br> </td> 
     <td style="width: 380px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Karte der TI, eGK oder HBA<br> </td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_99" class="MsoNormal">&nbsp;</p>
  <p id="polarion_100" style="text-align: center;" class="polarion-rte-caption-paragraph"> <img src="attachments/PACE.png" style="max-width: 750px;" data-lastmodified="2020-05-19T11:06:25.682+02:00"> </p>
  <p id="polarion_101" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">9</span>: Sequenzdiagramm PACE-Authentisierung </p>
  <p id="polarion_108"></p>
  <p id="polarion_113" class="MsoNormal"> Die PICC ist mit einer CAN (Card Access Number) ausgestattet. Die CAN ist auf dem Kartenkörper aufgedruckt. (Für die eGK siehe&nbsp;<span style="font-size: 10pt;line-height: 1.5;">gemSpec_eGK_Opt - z.B. Abb_eGKOPT_5. Für den HBA gibt es keine Vorgaben der gematik zum Layout, mit Card-G2-A_2038 nur eine Pflicht der Bedruckung).</span>&nbsp;Die Komponente "Secure Messaging Layer" benötigt die CAN, um das PACE-Protokoll erfolgreich zu durchlaufen. Typischerweise wird die CAN einmalig vom Karteninhaber eingegeben. Es ist aber auch eine automatische Erkennung der CAN (etwa per Kamera) denkbar. Hier wird davon ausgegangen, dass der "Secure Messaging Layer" eine Komponente ist, die durch Übergabe der CAN zum Durchlaufen des PACE-Protokolls angestoßen wird. </p>
  <p id="polarion_114" class="MsoNormal">Im Gutfall wird das PACE-Protokoll erfolgreich durchlaufen und im "Secure Messaging Layer" wurden dabei dieselben kryptographischen Schlüssel etabliert wie in der PICC.</p>
  <p id="polarion_115" class="MsoNormal">Im Schlechtfall scheitert einer der im Folgenden beschriebenen Schritte. Dann ist davon auszugehen, dass die aktuelle PICC nicht in der Lage ist, ein Token zu signieren. Gründe für das Scheitern umfassen unter anderem:</p>
  <ol id="polarion_116"> 
   <li>Die im "Secure Messaging Layer" verwendete CAN stimmt nicht mit der CAN überein, die in der PICC gespeichert ist.</li> 
   <li>Bei der PICC handelt es sich weder um eine eGK noch um einen HBA.</li> 
  </ol>
  <p id="polarion_117" class="MsoNormal">Im Folgenden werden die Nachrichten genauer beschrieben, die zwischen "Secure Messaging Layer" und PICC ausgetauscht werden.</p>
  <p id="polarion_123" class="MsoNormal">Der "Secure Messaging Layer" erzeugt ein ephemeres Schlüsselpaar (~SK1.PCD, ~PK1.PCD), Details dazu in [gemSpec_COS#(N085.066)a.4].</p>
  <p id="polarion_127" class="MsoNormal"> <span style="font-weight: bold;">Message 1:</span> Der "Secure Messaging Layer" sendet ein General Authenticate Kommando gemäß [gemSpec_COS#(N106.550)a] zur PICC. </p>
  <p id="polarion_128" class="MsoNormal"> <span style="font-weight: bold;">Message 2:</span> Die Antwortdaten der PICC enthalten das Kryptogramm z. </p>
  <p id="polarion_130" class="MsoNormal">Der "Secure Messaging Layer" errechnet mittels CAN und z die Zahl s gemäß [gemSpec_COS#(N085.066)b].</p>
  <p id="polarion_131" class="MsoNormal"> <span style="font-weight: bold;">Message 3:</span> Der "Secure Messaging Layer" sendet ein General Authenticate Kommando gemäß [gemSpec_COS#(N106.552)a] zur PICC, welches ~PK1.PCD enthält. </p>
  <p id="polarion_132" class="MsoNormal"> <span style="font-weight: bold;">Message 4:</span> Die Antwortdaten der PICC enthalten das Kryptogramm ~PK1.PICC. </p>
  <p id="polarion_133" class="MsoNormal">Der "Secure Messaging Layer" errechnet mittels der Zahl s, dem Schlüssel ~SK1.PCD und ~PK1.PICC gemäß [gemSpec_COS#(N085.066)c] ephemere Domainparameter ~D und ein weiteres ephemeres Schlüsselpaar (~SK2.PCD, ~PK2.PCD).</p>
  <p id="polarion_134" class="MsoNormal"> <span style="font-weight: bold;">Message 5:</span> Der "Secure Messaging Layer" sendet ein General Authenticate Kommando gemäß [gemSpec_COS#(N106.556)] zur PICC, welches ~PK2.PCD enthält. </p>
  <p id="polarion_135" class="MsoNormal"> <span style="font-weight: bold;">Message 6:</span> Die Antwortdaten der PICC enthalten den Schlüssel ~PK2.PICC. </p>
  <p id="polarion_137" class="MsoNormal">Der "Secure Messaging Layer" errechnet mittels ~D, SK2.PCD und ~PK2.PICC gemäß [gemSpec_COS#(N085.066)d] Sessionkeys k.MAC und k.ENC, sowie den MAC T.PCD.</p>
  <p id="polarion_138" class="MsoNormal"> <span style="font-weight: bold;">Message 7:</span> Der "Secure Messaging Layer" sendet ein General Authenticate Kommando gemäß [gemSpec_COS#(N106.560)] zur PICC, welches T.PCD enthält. </p>
  <p id="polarion_139" class="MsoNormal"> <span style="font-weight: bold;">Message 8:</span> Die Antwortdaten der PICC enthalten den MAC T.PICC </p>
  <p id="polarion_143" class="MsoNormal">Der "Secure Messaging Layer" überprüft T.PICC gemäß [gemSpec_COS#(N085.066)e].</p>
  <p id="polarion_144" class="MsoNormal">Falls kein Fehler auftrat, wird die Routine zum Etablieren des PACE-Kanals erfolgreich beendet. Damit liegen in der Komponente "Secure Messaging Layer" Sessionkeys vor. Die weitere Beschreibung geht davon aus, dass alle Kommandonachrichten des Authenticator-Moduls über die Komponente "Secure Messaging Layer" gesendet werden. Die Komponente "Secure Messaging Layer" schützt dabei Kommandonachrichten mit "Secure Messaging" gemäß [gemSpec_COS#13.2]. Die von der PICC empfangenen Antwortnachrichten sind kryptographisch gemäß [gemSpec_COS#13.3] geschützt und der "Secure Messaging Layer" prüft und entschlüsselt die Antwortnachrichten der PICC so, dass sie im Klartext und in der in [gemSpec_COS#14] beschriebenen Form zur Verfügung gestellt werden.</p>
  <p id="polarion_145" class="MsoNormal">Es wird empfohlen, dass nach Aufbau des PACE-Kanals das Masterfile (MF) gemäß [gemSpec_COS#(N040.800)] selektiert wird. Wenn die PICC dieses Kommando erfolgreich durchgeführt hat, dann ist die PICC zuverlässig in einem Zustand, mit dem im Folgenden weitergearbeitet werden kann.</p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-107229">10.3.3 Ermitteln des Kartentyps</h4>
  <p id="polarion_147" class="MsoNormal">In der vorliegenden Dokumentversion&nbsp;dieser Spezifikation gilt die hier beschriebene Ermittlung des Kartentyps,&nbsp;der in [gemSpec_eGK_ObjSys_G2.1], [gemSpec_HBA_ObjSys] und [gemSpec_HBA_ObjSys_G2.1] definiert ist. Andere Kartentypen der TI (derzeit sind das SMC-B, gSMC-K und gSMC-KT) unterstützen das kontaktlose Interface nicht und werden hier nicht betrachtet.</p>
  <p id="polarion_148" class="MsoNormal">Unter anderem gibt es folgende Möglichkeiten, den Kartentyp für die hier relevanten Karten zu ermitteln:</p>
  <ol id="polarion_149"> 
   <li><span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;"> </span>Auslesen des ersten Rekords von EF.DIR gemäß [gemSpec_COS#(N066.100)].</li> 
   <ol> 
    <li><span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;"> </span>Vorteil: Die Antwortdaten sind kurz und weisen eindeutig auf den Kartentyp hin.</li> 
    <li><span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;"> </span>Nachteil: Daten aus der Datei EF.DIR lassen sich über die kontaktlose Schnittstelle nur nach Aufbau eines PACE-Kanals auslesen.</li> 
   </ol> 
   <li><span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;"> </span>Selektieren des Masterfiles (MF) ohne Applikation Identifier (AID) und Rückgabe der File Control Parameter (FCP) gemäß [gemSpec_COS#(N041.300)]. In diesem Fall ergäbe sich der Kartentyp aus dem Attribut AID, welches Teil der FCP ist.</li> 
   <ol> 
    <li><span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;"> </span>Vorteil: Funktioniert immer und über die kontaktlose Schnittstelle auch ohne PACE.</li> 
    <li><span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;"> </span>Nachteile:</li> 
    <ol> 
     <li><span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;"> </span>Die FCP-Daten sind je nach Implementierung sehr umfangreich und es ist möglich, dass zum vollständigen Empfang "extended length" erforderlich ist, weil die FCP-Daten mehr als 256 Byte umfassen. Das Feature "extended length" war zumindest in der Vergangenheit für mobile Endgeräte problematisch.</li> 
     <li><span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;"> </span>Die FCP-Daten werden als BER-TLV-Struktur ausgegeben. Es erscheint nicht vorteilhaft, nur für die Interpretation der FCP-Daten einen BER-TLV-Parser zu implementieren.</li> 
    </ol> 
   </ol> 
   <li><span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;"> </span>Selektieren des Masterfiles (MF) mit Applikation Identifier (AID) gemäß [gemSpec_COS#(N040.800)], wobei dabei die <span style="font-style: italic;">applicationIdentifier&nbsp;</span>Werte für eGK und HBA im Rahmen einer "Trial and Error"-Vorgehensweise durchzuprobieren wären. Die Karte antwortet entweder mit '6A82'=FileNotFound (Kartentyp und gewählter Wert von <span style="font-style: italic;">applicationIdentifier&nbsp;</span>passen nicht zusammen) oder mit '900'=NoError (Kartentyp und gewählter Wert von <span style="font-style: italic;">applicationIdentifier</span> passen zusammen).</li> 
   <ol> 
    <li><span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;"> </span>Vorteil: Funktioniert immer und über die kontaktlose Schnittstelle auch ohne PACE.</li> 
    <li><span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;"> </span>Nachteil: "Trial and Error" verschlechtert die Performance, falls viele Versuche erforderlich sind.</li> 
   </ol> 
  </ol>
  <p id="polarion_150" class="MsoNormal"> Empfehlung: Erst nach Aufbau des PACE-Kanals ist eine kryptographisch gesicherte und damit zuverlässige Kommunikation möglich. Deshalb wird empfohlen, den Kartentyp durch Auslesen des ersten Rekords von EF.DIR zu ermitteln.<br> </p>
  <p id="polarion_151" style="text-align: center;" class="polarion-rte-caption-paragraph"> <img src="attachments/EstimateCardtype.png" style="max-width: 750px;" data-lastmodified="2020-05-19T11:18:25.910+02:00"> </p>
  <p id="polarion_152" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">10</span>: Ablauf zur Ermittlung des Kartentyps </p>
  <p id="polarion_153" class="MsoNormal"></p>
  <p id="polarion_154">Die Kommando-Application Protocol Data Unit (APDU) gemäß [gemSpec_COS#(N066.100) lautet in diesem Fall konkret: '00 B2 01F4 00'.</p>
  <p id="polarion_155" class="MsoNormal">Die Antwort-APDU enthält (im Erfolgsfall) Daten und einen Trailer: Fallunterscheidung: Falls</p>
  <ol id="polarion_156"> 
   <li><span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;"> </span>die Daten gleich '61094F07D2760001448000' sind, handelt es sich um eine eGK und der Trailer der Antwort-APDU ist irrelevant.</li> 
   <li><span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;"> </span>die Daten gleich '61084F06D27600014601' sind, handelt es sich um einen HBA und der Trailer der Antwort-APDU ist irrelevant.</li> 
   <li><span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;"> </span>der Trailer gleich '9000' = NoError ist und die Daten keinen der vorgenannten Werte enthalten, dann handelt es sich weder um eine eGK noch um einen HBA.</li> 
   <li><span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;"> </span>der Trailer gleich '6281' = CorruptDataWarning ist, dann wurden die Daten in der PICC möglicherweise verfälscht. Dieser Fall tritt äußerst selten auf. Falls entschieden wird, mit so einer PICC trotzdem weiter zu arbeiten, dann wird empfohlen, anhand der Länge und des Inhaltes der Daten zu entscheiden, mit welchem Wert der unterstützten Kartentypen die vorliegenden Daten die größere Ähnlichkeit aufweisen.</li> 
  </ol>
  <p id="polarion_157" class="MsoNormal">Nach Interpretation der Antwort-APDU entscheidet das Authenticator-Modul, ob eine eGK, ein HBA oder ein unbekannter (nicht unterstützter) Kartentyp vorliegt.</p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-107240">10.3.4 Auswahl des privaten Schlüssels</h4>
  <p id="polarion_158" class="MsoNormal">Für den Kartentyp eGK sind private Schlüssel sowohl auf RSA-Basis als auch auf Basis elliptischer Kurven verfügbar. Dasselbe gilt für den Kartentyp HBA basierend auf [gemSpec_HBA_ObjSys_G2.1]. Lediglich für den Kartentyp HBA basierend auf [gemSpec_HBA_ObjSys] steht nur RSA-Kryptographie zur Verfügung.</p>
  <p id="polarion_159" class="MsoNormal">Gemäß [TR–03116-1#3.2] ist die Moduluslänge von 2048 Bit für RSA-Schlüssel nur bis Ende 2023 zulässig. Deshalb wird empfohlen, – sofern vorhanden – Schlüssel basierend auf elliptischen Kurven einzusetzen.</p>
  <p id="polarion_160" class="MsoNormal"> Nach dem bis hierher beschriebenen Ablauf aus <span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-107238" data-option-id="shortoutline"></span>&nbsp;und <span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-107229" data-option-id="shortoutline"></span>&nbsp;liegt zwar der Kartentyp fest, nicht aber die Information, ob es sich um einen HBA gemäß [gemSpec_HBA_ObjSys] oder [gemSpec_HBA_ObjSys_G2.1] handelt. Unter anderem gibt es folgende Möglichkeiten herauszufinden, ob ein vorliegender HBA Schlüssel basierend auf elliptischen Kurven unterstützt: </p>
  <ol id="polarion_161"> 
   <li><span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;"> </span>Selektieren des ELC-Schlüssels, falls das gelingt, sind solche Schlüssel vorhanden.</li> 
   <ol> 
    <li><span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;"> </span>Vorteil: Einfach.</li> 
    <li><span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;"> </span>Nachteil: "Trial and Error"-Methode. In <span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-107229" data-option-id="shortoutline"></span>&nbsp;wurde davon abgeraten, weil es einfache Ersatzmöglichkeiten gibt.</li> 
   </ol> 
   <li><span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;"> </span>Auslesen von EF.ATR und Interpretieren des Inhaltes, hier Produktidentifikation des initialisierten Objektsystems.</li> 
   <ol> 
    <li><span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;"> </span>Vorteil: Eindeutige Aussage.</li> 
    <li><span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;"> </span>Nachteil: Aufwendige Interpretation der BER-TLV-Strukturen.</li> 
   </ol> 
   <li><span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;"> </span>Auslesen von EF.Version2 und interpretieren des Inhaltes, hier Produkttypversion des aktiven Objektsystems.</li> 
   <ol> 
    <li><span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;"> </span>Vorteil: Eindeutige Aussage.</li> 
    <li><span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;"> </span>Nachteil: Aufwendige Interpretation der BER-TLV-Strukturen.</li> 
   </ol> 
  </ol>
  <p id="polarion_162" class="MsoNormal"> Zur Vereinfachung der Implementierung wird folgende Vorgehensweise empfohlen: Falls im Ablauf gemäß <span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-107229" data-option-id="shortoutline"></span>&nbsp;als Kartentyp ermittelt wurde </p>
  <ol id="polarion_163"> 
   <li><span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;"> </span>eGK, dann wird <span style="font-style: italic;">keyRef</span>='82' und <span style="font-style: italic;">algId</span>='00' verwendet <span style="font-family: Wingdings, 'Wingdings Regular';">à</span>PrK.CH.AUT.E256, signECDSA.</li> 
   <li>HBA, dann wird <span style="font-style: italic;">keyRef</span>='86' und <span style="font-style: italic;">algId</span>='00' verwendet <span style="font-family: Wingdings, 'Wingdings Regular';">à</span>PrK.HP.AUT.E256, signECDSA.</li> 
   <li>HBA und die Selektion des privaten Schlüssels mit <span style="font-style: italic;">keyRef</span>='86' schlägt fehl, dann wird <span style="font-style: italic;">keyRef</span>='82' und <span style="font-style: italic;">algId</span>='05' verwendet <span style="font-family: Wingdings, 'Wingdings Regular';">à</span>PrK.CH.AUT.R2048, signPSS.</li> 
  </ol>
  <p id="polarion_164" style="text-align: center;" class="polarion-rte-caption-paragraph"> <img src="attachments/SelectPrivatekey.png" style="max-width: 750px;" data-lastmodified="2020-05-19T11:25:40.323+02:00"> </p>
  <p id="polarion_165" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">11</span>: Ablauf zur Selektion des privaten Schlüssels </p>
  <p id="polarion_166" class="MsoNormal"></p>
  <p id="polarion_168">Vor der Selektion des privaten Schlüsselobjektes ist zunächst die passende Anwendung auf der PICC zu selektieren, in diesem Fall das DF.ESIGN. Die Kommando-APDU gemäß [gemSpec_COS#(N042.700)] lautet in diesem Fall (sowohl für eGK als auch für HBA): '00 A4 040C 0A A000000167455349474E'. Die zugehörige Antwort-APDU enthält lediglich "trailer_1". Falls "trailer_1" ungleich '9000' = NoError ist, dann handelt es sich weder um eine eGK noch um einen HBA.</p>
  <p id="polarion_170" class="MsoNormal">Nach Selektion der Anwendung DF.ESIGN wird gemäß der Empfehlung der private Schlüssel gemäß [gemSpec_COS#(N102.900)] selektiert. Die Kommando APDU lautet dann:</p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=171" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 204px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;"> Kartentyp gemäß<br> </span></th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 58.4px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;"> <span style="font-style: italic;">keyRef</span> <br> </span></th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 47.2px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;"> <span style="font-style: italic;">algId</span> <br> </span></th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 208.8px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;"> Kommando APDU<br> </span></th> 
    </tr> 
    <tr> 
     <td style="width: 204px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[gemSpec_eGK_ObjSys_G2.1]<br> </td> 
     <td style="width: 58.4px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> '82'<br> </td> 
     <td style="width: 47.2px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> '00'<br> </td> 
     <td style="width: 208.8px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> '00 22 41B6 06 840182800100'<br> </td> 
    </tr> 
    <tr> 
     <td style="width: 204px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> [gemSpec_HBA_ObjSys_G2.1]<br> </td> 
     <td style="width: 58.4px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> '86'<br> </td> 
     <td style="width: 47.2px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> '00'<br> </td> 
     <td style="width: 208.8px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> '00 22 41B6 06 840186800100'<br> </td> 
    </tr> 
    <tr> 
     <td style="width: 204px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> [gemSpec_HBA_ObjSys]<br> </td> 
     <td style="width: 58.4px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> '82'<br> </td> 
     <td style="width: 47.2px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> '05'<br> </td> 
     <td style="width: 208.8px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> '00 22 41B6 06 840182800105'<br> </td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_172" class="MsoNormal"> Die zugehörige Antwort APDU enthält lediglich "trailer_2". Falls "trailer_2" gleich '9000' = NoError ist, dann wurde der private Schlüssel erfolgreich selektiert. Falls "trailer_2" ungleich '9000' ist, dann enthält die Anwendung DF.ESIGN keinen privaten Signaturschlüssel mit der angegebenen <span style="font-style: italic;">keyRef</span> und <span style="font-style: italic;">algId</span>. </p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-107237">10.3.5 Lesen des X.509-Zertifikates</h4>
  <p id="polarion_173" class="MsoNormal">Das zum privaten Schlüsselobjekt zugehörige X.509-Zertifikat enthält Informationen, die für die Validierung einer Signatur erforderlich sind. Deshalb ist die Kenntnis des X.509-Zertifikates signifikant. Die Informationsmenge im X.509-Zertifikat ist so groß (bis zu 1.900 Byte), dass sie nicht bei allen zulässigen Implementierungen mit einem einzigen Kommando aus der PICC auslesbar ist. Hinzu kommt, dass es für mobile Geräte eine Obergrenze in der Datenmenge gibt, die im Rahmen eines Kommando-Antwortpaares austauschbar ist. Für das Auslesen des X.509-Zertifikates sind also zwei Puffergrößen relevant:</p>
  <ol id="polarion_174"> 
   <li><span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;"> </span>Puffergröße der PICC: Der Wert der Puffergröße ließe sich aus der Datei EF.ATR auslesen.</li> 
   <li>Puffergröße des mobilen Endgerätes: Es ist nicht bekannt, wie dieser Wert sicher zu ermitteln wäre.</li> 
  </ol>
  <p id="polarion_175" class="MsoNormal">Empfehlung: Es wird empfohlen, beim Auslesen des X.509-Zertifikates eine Blockgröße von 223 zu wählen. Damit ist die Größe einer gesicherten Antwortnachricht kleiner als 256 Byte. Der Wert von 256 Byte erscheint ein sicherer Wert für die Puffergröße mobiler Endgeräte. Dieser Wert ist erheblich kleiner als die 1033 Byte, die gemäß [gemSpec_COS#(N029.890)a.4] mindestens zu unterstützen sind.</p>
  <p id="polarion_177" class="MsoNormal"> Alles in allem wird das X.509-Zertifikat also in mehreren Blöcken zu je (empfohlenen) 223 Byte gelesen. Dabei ist zu unterscheiden zwischen dem ersten Lesekommando und allen weiteren Lesekommandos. Es wird empfohlen, im ersten Lesekommando gemäß [gemSepc_COS#(N051.500)], also <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Read Binary</span>-Kommando und mit <span style="font-style: italic;">shortFileIdentifier</span> vorzugehen. Alle weiteren Lesekommandos verwenden [gemSpec_COS#(N051.100)], also <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Read Binary</span>-Kommando ohne <span style="font-style: italic;">shortFileIdentifier</span>. </p>
  <p id="polarion_178"> Im ersten Lesekommando wird <span style="font-style: italic;">offset</span>&nbsp;=&nbsp;0 gewählt. Bei allen weiteren Lesekommandos (im Sinne einer do-while-Schleife) wird der <span style="font-style: italic;">offset</span> auf die Anzahl der bislang ausgelesenen Byte gesetzt. Die do-while-Schleife bricht ab, wenn die Antwortnachricht auf ein Lesekommando keine Antwortdaten mehr erhält, sondern nur noch den obligatorischen Trailer. Welchen Wert dieser Trailer hat, ist für den weiteren Verlauf irrelevant, sofern die bis dahin ausgelesenen Daten (konkateniert) ein valides X.509-Zertifikat ergeben. Die Validierung des X.509-Zertifikates ist nicht Gegenstand dieses Dokumentes. </p>
  <p id="polarion_179" style="text-align: center;" class="polarion-rte-caption-paragraph"> <img src="attachments/Read_x.509-Certificate.png" style="max-width: 750px;" data-lastmodified="2020-05-19T11:32:48.982+02:00"> </p>
  <p id="polarion_180" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">12</span>: Ablauf zum Auslesen des X.509-Zertifikates </p>
  <p id="polarion_182" class="MsoNormal"></p>
  <p id="polarion_184"> Das erste Lesekommando wählt gleichzeitig die zu lesende Datei aus. Deshalb enthält das erste Lesekommando einen <span style="font-style: italic;">shortFileIdentifier</span>. Der <span style="font-style: italic;">shortFileIdentifier&nbsp;</span>ist in Abhängigkeit vom Kartentypen gemäß <span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-107229" data-option-id="shortoutline"></span>&nbsp;und des ausgewählten privaten Schlüssels gemäß <span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-107240" data-option-id="shortoutline"></span> zu wählen. </p>
  <p id="polarion_276" style="text-align: left;" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle&nbsp;<span data-sequence="Tabelle" class="polarion-rte-caption">8</span>: Auswahl des shortFileIdentifier </p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=185" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 204px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Kartentyp gemäß<br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 134.4px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> <span style="font-style: italic;">privater Schlüssel</span> <br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 37.6px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> <span style="font-style: italic;">SFI</span> <br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 208.8px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> Kommando APDU<br> </th> 
    </tr> 
    <tr> 
     <td style="width: 204px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> [gemSpec_eGK_ObjSys_G2.1]<br> </td> 
     <td style="width: 134.4px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> PrK.CH.AUT.E256<br> </td> 
     <td style="width: 37.6px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> 
      <div style="text-align: center;">
       4
      </div> </td> 
     <td style="width: 208.8px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> '00 B0 8400 DF'<br> </td> 
    </tr> 
    <tr> 
     <td style="width: 204px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> [gemSpec_HBA_ObjSys_G2.1]<br> </td> 
     <td style="width: 134.4px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> PrK.HP.AUT.E256<br> </td> 
     <td style="width: 37.6px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> 
      <div style="text-align: center;">
       6
      </div> </td> 
     <td style="width: 208.8px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> '00 B0 8600 DF'<br> </td> 
    </tr> 
    <tr> 
     <td style="width: 204px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> [gemSpec_HBA_ObjSys]<br> </td> 
     <td style="width: 134.4px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> PrK.HP.AUT.R2048<br> </td> 
     <td style="width: 37.6px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> 
      <div style="text-align: center;">
       1
      </div> </td> 
     <td style="width: 208.8px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> '00 B0 8100 DF'<br> </td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_198" class="MsoNormal">&nbsp;</p>
  <p id="polarion_199" class="MsoNormal"> Für die weiteren Lesekommandos ist ein <span style="font-style: italic;">offset</span> zu wählen, der gleich der Anzahl N der bislang ausgelesenen Bytes entspricht. N in hexadezimaler Darstellung besteht aus einem most-significant-byte MSByte_N und einem least-significant-byte LSByte_N. Die folgende Tabelle zeigt die (ungesicherte) Kommando APDU für alle weiteren Lesekommandos (diese sind unabhängig vom Kartentyp und unabhängig vom ausgewählten privaten Schlüsselobjekt): </p>
  <p id="polarion_277" style="text-align: left;" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">9</span>: Kommando APDU für Lesekommandos </p>
  <table id="polarion_wiki macro name=table;params=header=no|width=50%|uid=1" class="polarion-Document-table" style="width: 50%;margin-left: 0px;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 189.528px;height: 19.4969px;border: 1px solid #CCCCCC;padding: 5px;"> zweites Lesekommando<br> </td> 
     <td style="text-align: left;vertical-align: top;width: 125.975px;height: 19.4969px;border: 1px solid #CCCCCC;padding: 5px;"> '00 B0 00DF DF'<br> </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 189.528px;height: 19.4969px;border: 1px solid #CCCCCC;padding: 5px;"> drittes Lesekommando<br> </td> 
     <td style="text-align: left;vertical-align: top;width: 125.975px;height: 19.4969px;border: 1px solid #CCCCCC;padding: 5px;"> '00 B0 01BE DF'<br> </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 189.528px;height: 19.4969px;border: 1px solid #CCCCCC;padding: 5px;"> viertes Lesekommando<br> </td> 
     <td style="text-align: left;vertical-align: top;width: 125.975px;height: 19.4969px;border: 1px solid #CCCCCC;padding: 5px;"> '00 B0 029D DF'<br> </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 189.528px;height: 19.4969px;border: 1px solid #CCCCCC;padding: 5px;"> fünftes Lesekommando<br> </td> 
     <td style="text-align: left;vertical-align: top;width: 125.975px;height: 19.4969px;border: 1px solid #CCCCCC;padding: 5px;"> '00 B0 03C7 DF'<br> </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 189.528px;height: 19.4969px;border: 1px solid #CCCCCC;padding: 5px;"> sechstes Lesekommando<br> </td> 
     <td style="text-align: left;vertical-align: top;width: 125.975px;height: 19.4969px;border: 1px solid #CCCCCC;padding: 5px;"> '00 B0 04B5 DF'<br> </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 189.528px;height: 19.4969px;border: 1px solid #CCCCCC;padding: 5px;"> siebtes Lesekommando<br> </td> 
     <td style="text-align: left;vertical-align: top;width: 125.975px;height: 19.4969px;border: 1px solid #CCCCCC;padding: 5px;"> '00 B0 053A DF'<br> </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 189.528px;height: 19.4969px;border: 1px solid #CCCCCC;padding: 5px;"> achtes Lesekommando<br> </td> 
     <td style="text-align: left;vertical-align: top;width: 125.975px;height: 19.4969px;border: 1px solid #CCCCCC;padding: 5px;"> '00 B0 0619 DF'<br> </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 189.528px;height: 19.4969px;border: 1px solid #CCCCCC;padding: 5px;"> neuntes Lesekommando<br> </td> 
     <td style="text-align: left;vertical-align: top;width: 125.975px;height: 19.4969px;border: 1px solid #CCCCCC;padding: 5px;"> '00 B0 06F8 DF'<br> </td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_237" class="MsoNormal">&nbsp;</p>
  <p id="polarion_239" class="MsoNormal">Aus dem obigen Text und Abbildung 12 geht die Empfehlung hervor, die Schleife dann abzubrechen, wenn die Antwortnachricht keine Daten (oder, was dasselbe ist, leere Daten) enthält. Diese Vorgehensweise hat den Vorteil, dass der Wert des Trailers irrelevant ist. Typischerweise wird bei dieser Vorgehensweise ein Kommando zu viel geschickt. Falls die Anzahl an Bytes im X.509-Zertifikat kein Vielfaches der Blockgröße (hier 223) ist, dann gibt die PICC im Trailer anfangs '9000' = NoError zurück, dann bei vorhandenen Daten (also Anzahl Bytes in data_x größer null) '6282' = EndOfFileWarning, und wenn dann doch noch weiter gelesen wird '6B00' = OffsetTooBig zurück. Für den (eher untypischen) Fall, dass die Anzahl Bytes im X.509-Zertifikat ein Vielfaches der gewählten Blockgröße ist, wird nie '6282' = EndOfFileWarning gemeldet. Eine Implementierung, welche mit der minimalen Anzahl an Lesebefehlen auskommen will, hat dies zu berücksichtigen.</p>
  <p id="polarion_242" class="MsoNormal">Weil das auszulesende X.509-Zertifikat als ASN.1-Codierung vorliegt, ist es möglich, die genaue Anzahl der Bytes durch Analyse der ersten ausgelesenen Bytes zu ermitteln. Es erscheint nicht sinnvoll, diesen Aufwand zu treiben.</p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-107235">10.3.6 Benutzerverifikation</h4>
  <p id="polarion_243" class="MsoNormal">Die Verwendung des privaten Schlüsselobjektes ist erst nach einer Benutzerverifikation möglich. Es wird empfohlen, die Benutzerverifikation erst nach Validierung des X.509-Zertifikates durchzuführen, weil eine Benutzerverifikation bei nicht validem X.509-Zertifikat überflüssig erscheint. Für die im Rahmen dieses Dokumentes betrachteten privaten Schlüsselobjekte ist die Benutzerverifikation nach einem Aktivieren der PICC nur genau einmal notwendig. Anschließend lassen sich die hier behandelten privaten Schlüsselobjekte beliebig oft verwenden.</p>
  <p id="polarion_244" class="MsoNormal">Für die Benutzerverifikation ist dem Authenticator-Modul das Geheimnis (also die PIN) bekanntzugeben. Typischerweise wird die PIN vom Benutzer eingegeben. Für die Benutzerverifikation ist die Zahlenfolge der PIN in einen Format-2-PIN-Block gemäß [gemSpec_COS#(N008.100)] umzuwandeln. Die folgende Tabelle enthält einige Beispiele für eine derartige Umwandlung.</p>
  <p id="polarion_272" style="text-align: left;" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">10</span>: Beispielhafte Umwandlungen einer PIN </p>
  <table id="polarion_wiki macro name=table;params=width=50%|uid=2" class="polarion-Document-table" style="width: 50%;margin-left: 0px;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 67.0126px;height: 19.4969px;border: 1px solid #CCCCCC;padding: 5px;"> PIN<br> </th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 130.031px;height: 19.4969px;border: 1px solid #CCCCCC;padding: 5px;"> Format-2-PIN-Block<br> </th> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 67.0126px;height: 19.4969px;border: 1px solid #CCCCCC;padding: 5px;"> 123456<br> </td> 
     <td style="text-align: left;vertical-align: top;width: 130.031px;height: 19.4969px;border: 1px solid #CCCCCC;padding: 5px;"> 26123456FFFFFFFF<br> </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 67.0126px;height: 19.4969px;border: 1px solid #CCCCCC;padding: 5px;"> 7531246<br> </td> 
     <td style="text-align: left;vertical-align: top;width: 130.031px;height: 19.4969px;border: 1px solid #CCCCCC;padding: 5px;"> 277531246FFFFFFF<br> </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 67.0126px;height: 19.4969px;border: 1px solid #CCCCCC;padding: 5px;"> 87654321<br> </td> 
     <td style="text-align: left;vertical-align: top;width: 130.031px;height: 19.4969px;border: 1px solid #CCCCCC;padding: 5px;"> 2887654321FFFFFF<br> </td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_246" class="MsoNormal"></p>
  <p id="polarion_247" style="text-align: center;" data-keep-next="true"> &nbsp;<img src="attachments/VerifyUser.png" style="max-width: 750px;" data-lastmodified="2020-05-19T11:37:01.064+02:00"> </p>
  <p id="polarion_250" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">13</span>: Ablauf zur Verifikation des Benutzers </p>
  <p id="polarion_251" class="MsoNormal"></p>
  <p id="polarion_252">Für die Benutzerverifikation ist nur eine Kommandonachricht erforderlich. Welches Passwortobjekt dabei verwendet wird, hängt vom Kartentyp ab.</p>
  <p id="polarion_273" style="text-align: left;" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">11</span>: Passwortobjekt in Abhängigkeit des Kartentyps </p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=253" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 204px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> Kartentyp gemäß<br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 96px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> Password <br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 65.6px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> <span style="font-style: italic;">pwdId</span> <br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 234.4px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> Kommando APDU <br> </th> 
    </tr> 
    <tr> 
     <td style="width: 204px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[gemSpec_eGK_ObjSys_G2.1<br> </td> 
     <td style="width: 96px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> MRPIN.home<br> </td> 
     <td style="width: 65.6px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> 2<br> </td> 
     <td style="width: 234.4px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> '00 20 0002 08 Format-2-PIN-Block'<br> </td> 
    </tr> 
    <tr> 
     <td style="width: 204px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> [gemSpec_HBA_ObjSys_G2.1]<br> </td> 
     <td rowspan="2" style="width: 96px;height: 39.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> PIN.CH<br> </td> 
     <td rowspan="2" style="width: 65.6px;height: 39.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> 1<br> </td> 
     <td rowspan="2" style="width: 234.4px;height: 39.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> '00 20 0001 08 Format-2-PIN-Block'<br> </td> 
    </tr> 
    <tr> 
     <td style="width: 204px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> [gemSpec_HBA_ObjSys]<br> </td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_254" class="MsoNormal">Falls die Antwort-APDU den Trailer '9000' = NoError enthält, lassen sich mit dem privaten Schlüsselobjekt Signaturen erstellen.</p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-107233">10.3.7 Signieren</h4>
  <p id="polarion_255" class="MsoNormal">Typischerweise sind per digitaler Signatur geschützten Artefakte mitunter sehr groß (etwa einige Megabyte oder auch Gigabyte). Wegen der begrenzten Bandbreite ist es nicht sinnvoll, die kompletten Artefakte zu einer Karte zu übertragen. Technisch bedeutet dies, dass der Signaturvorgang arbeitsteilig abläuft. Sicherheitstechnisch unbedenkliche Operationen laufen außerhalb der Karte ab und nur die sicherheitskritischen Operationen werden in der Karte ausgeführt. Dazu wird an der Schnittstelle zur Karte ein Zwischenergebnis der Signaturberechnung übergeben.</p>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-107230">10.3.7.1 Signaturen mit dem Algorithmus signPSS = RSASSA-PSS</h5>
  <p id="polarion_256" class="MsoNormal"> Der Algorithmus signPSS = RSASSA-PSS ist in [PKCS&nbsp;#1] Kapitel 8.1.1 beschrieben. Dabei wird die zu signierende Nachricht <span style="font-style: italic;">M</span> zunächst gemäß EMSA-PSS-Encode codiert. Das Codierverfahren EMSA-PSS-Encode ist in [PKCS&nbsp;#1] Kapitel 9.1.1 beschrieben. Außerhalb der Karte werden dabei die Schritte gemäß [PKCS&nbsp;#1] Kapitel 9.1.1 Steps 1 und 2 mit dem Hash-Algorithmus SHA-256 durchgeführt. Als Ergebnis liegt der Hashwert <span style="font-style: italic;">mHash&nbsp;</span>vor, der in <span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-107239" data-option-id="shortoutline"></span> weiterverarbeitet wird. </p>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-107231">10.3.7.2 Signaturen mit dem Algorithmus signECDSA</h5>
  <p id="polarion_257" class="MsoNormal"> Der Algorithmus signECDSA ist in [TR–03111#4.2.1.1] beschrieben. Dort wird in Actions&nbsp;5 der Hashwert H<sub><span style="font-family: Symbol, 'Symbol Regular';">t</span></sub>(M) verwendet. Im vorliegenden Fall ist dieser Wert wie folgt zu berechnen: H<sub><span style="font-family: Symbol, 'Symbol Regular';">t</span></sub>(M)&nbsp;=&nbsp;<span style="font-style: italic;">mHash</span>&nbsp;=&nbsp;SHA-256 Hashwert der Nachricht <span style="font-style: italic;">M</span>. Als Ergebnis liegt der Hashwert <span style="font-style: italic;">mHash</span> vor, der in <span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-107239" data-option-id="shortoutline"></span>&nbsp;weiterverarbeitet wird. </p>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-107239">10.3.7.3 Signiervorgang</h5>
  <p id="polarion_258" class="MsoNormal"> Eine Nachricht <span style="font-style: italic;">challenge&nbsp;</span>wird signiert. Hier wird davon ausgegangen, dass dem Authenticator-Modul die zu signierende Nachricht <span style="font-style: italic;">challenge</span> übergeben wird. Zunächst berechnet das Authenticator-Modul gemäß <span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-107230" data-option-id="shortoutline"></span>&nbsp;oder <span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-107231" data-option-id="shortoutline"></span>&nbsp;den SHA-256 Hashwert zu <span style="font-style: italic;">challenge&nbsp;</span>gemäß <span style="font-style: italic;">mHash</span> = SHA-256(<span style="font-style: italic;">challenge</span>). </p>
  <p id="polarion_259" style="text-align: center;" class="MsoNormal"> <img src="attachments/SignToken.png" style="max-width: 750px;" data-lastmodified="2020-05-19T11:45:52.558+02:00"> </p>
  <p id="polarion_260" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">14</span>: Ablauf eines Signaturvorgangs </p>
  <p id="polarion_261" class="MsoNormal"></p>
  <p id="polarion_262"> Für den Signaturvorgang ist nur eine Kommando-APDU erforderlich: '00 2A 9E9A 20 <span style="font-style: italic;">mHash</span>00'. </p>
  <p id="polarion_263" class="MsoNormal">Falls die Antwort-APDU Daten enthält (response also nicht leer ist), dann war der Signaturvorgang erfolgreich.</p>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-104219">11 Anhang B – Verzeichnisse</h2>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104220">11.1 Abkürzungen</h3>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=1" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 94px;height: 19.6px;border: 1px solid #CCCCCC;padding: 5px;">Kürzel<br> </th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 486.8px;height: 19.6px;border: 1px solid #CCCCCC;padding: 5px;">Erläuterung<br> </th> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">APDU</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Application Protocol Data Unit (Nachricht, die auf der Applikationsebene zwischen einer Smartcard und der externen Welt ausgetauscht wird)</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">AVS</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Apothekenverwaltungssystem</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">CAN</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Card Access Number (Kartenzugriffsnummer, auf dem Kartenkörper aufgedruckte Ziffernfolge)</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">eGK</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Elektronische Gesundheitskarte</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">FCP</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">File Control Parameter (Liste mit Eigenschaften einer Datei, die auf einer Smartcard gespeichert ist)</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">GdV</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Gerät des Versicherten</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">HBA</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Heilberufsausweis</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">IDP</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Identity Provider</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JavaScript Object Notation</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JWE</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON Web Encryption</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JWS</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON Web Signature</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JWT</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON Web Token</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">KIS</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Krankenhausinformationssystem</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">NFC</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Near Field Communication (Kommunikation im Nahfeld einer Antenne)</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">OAuth 2.0</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Open Authorization 2.0</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> OIDC</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">OpenID Connect</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">PACE</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Password Authenticated Connection Establishment&nbsp;(Passwort authentisierter Verbindungsaufbau)</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">PIN</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Personal Identification Number</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">PICC</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Proximity Integrated Circuit Card (kontaktlose Smartcard)</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">PKI</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Public Key Infrastructure</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">PVS</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Praxisverwaltungssystem, ärztliche oder zahnärztliches</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">QES</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Qualifizierte Elektronische Signatur</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">SMC-B</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Security Module Card Typ B, Institutionenkarte</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">TI</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Telematikinfrastruktur</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">TLS</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Transport Layer Security</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">URI</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Uniform Resource Identifier</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">URL</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Uniform Resource Locator<br> </td> 
    </tr> 
   </tbody> 
  </table>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104221">11.2 Glossar</h3>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=2" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 194px;height: 19.6px;border: 1px solid #CCCCCC;padding: 5px;">Begriff<br> </th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 536px;height: 19.6px;border: 1px solid #CCCCCC;padding: 5px;">Erläuterung<br> </th> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 57.2px;border: 1px solid #CCCCCC;padding: 5px;">Access Token</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 57.2px;border: 1px solid #CCCCCC;padding: 5px;">Ein Access Token (nach [<a href="https://tools.ietf.org/html/rfc6749#section-1.4" target="_top" class="descriptionLink">RFC6749 # section-1.4</a>])&nbsp;wird vom Client (Anwendungsfrontend) benötigt, um auf geschützte Daten eines Resource Servers zuzugreifen. Die Repräsentation kann als JSON Web Token erfolgen. </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 20px;border: 1px solid #CCCCCC;padding: 5px;">Account</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 20px;border: 1px solid #CCCCCC;padding: 5px;">Eine lokales Konto eines Nutzers auf einem Gerät.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 42px;border: 1px solid #CCCCCC;padding: 5px;">Alternatives Authentisierungsmittel</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 42px;border: 1px solid #CCCCCC;padding: 5px;">Mit einem bereits etablierten Authentisierungsmittel verknüpftes Mittel zur Authentisierung gegenüber Fachdiensten.&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 57.2px;border: 1px solid #CCCCCC;padding: 5px;">Authentifizierung des Nutzers am Gerät oder lokale Authentifizierung</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 57.2px;border: 1px solid #CCCCCC;padding: 5px;">Authentifizierungsmittel des Nutzers zur Nutzung eines Kontos auf einem Mobilgerät.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 57.2px;border: 1px solid #CCCCCC;padding: 5px;">Authentifizierungszertifikat</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 57.2px;border: 1px solid #CCCCCC;padding: 5px;">Unter einem Authentifizierungszertifikat werden&nbsp; im Kontext der Registrierung und Verwendung von alternativen Authentisierungsmittel Zertifikate vom Typ C.CH.AUT der eGK verstanden.&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 57.2px;border: 1px solid #CCCCCC;padding: 5px;">Authorization-Endpunkt<br> </td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 57.2px;border: 1px solid #CCCCCC;padding: 5px;">Der Authorization Endpunkt ist diejenige Schnittstelle, an welcher der Authenticator die zu validierenden Nutzerinformationen SCOPE, CONSENT-Freigabe und Nutzerzertifikat zwecks Prüfung entgegen nimmt und einen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> heraus gibt.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 57.2px;border: 1px solid #CCCCCC;padding: 5px;">Authorization Server</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 57.2px;border: 1px solid #CCCCCC;padding: 5px;">OAuth2-Rolle <span style="font-size: 10pt;line-height: 1.5;">(siehe [<a href="https://tools.ietf.org/html/rfc6749#section-1.1" target="_top" class="descriptionLink">RFC6749 # section-1.1</a>])</span>: Der Authorization Server ist Teil des IDP-Dienstes. Der Server authentifiziert den Resource Owner (Nutzer) und stellt Access Tokens für den vom Resource Owner erlaubten Anwendungsbereich (Scope) für einen Resource Server bzw. eine auf einem Resource Server existierende Protected Resource aus.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 28px;border: 1px solid #CCCCCC;padding: 5px;">Autorisierte Anwendung eines Schlüssels</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 28px;border: 1px solid #CCCCCC;padding: 5px;">Anwendung eines kryptographischen Schlüssels auf Daten durch einen berechtigten Nutzer.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">Betriebssystem (oder Plattform)</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">Der Name des Betriebssystems eines Geräts.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">Besitz (eines Geräts)</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">Verwendungshoheit eines Nutzers über ein Mobilgerät.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">Bewertung (eines Gerätetyps)</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">Sicherheitsbezogene Einstufung eines Gerätetyps mit Bezug auf seine Eignung als Authentisierungsmittel</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">Block/Allow-Liste(n)</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">Registrierung von Gerätetypen und Zuordnung zu einer Bewertung.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Consent</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Consent ist der Raum von Attributen, welche vom IDP-Dienst bezogen auf die im Claim des jeweiligen Fachdienstes eingeforderten Attribute zusammenfasst. Es besteht Einigkeit zwischen dem was gefordert wird und welche Attribute im Token bestätigt werden.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Claim</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Ein Key/Value-Paar im Payload eines JSON Web Token.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Client</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">OAuth2-Rolle (siehe [<a href="https://tools.ietf.org/html/rfc6749#section-1.1" target="_top" class="descriptionLink">RFC6749 # section-1.1</a>]): Eine Anwendung (Relying Party), die auf geschützte Ressourcen des Resource Owners zugreifen möchte, die vom Resource Server bereitgestellt werden. Der Client kann auf einem Server (Webanwendung), Desktop-PC, mobilen Gerät etc. ausgeführt werden.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Discovery Document</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Ein OpenID Connect-Metadatendokument (siehe [<a href="https://openid.net/specs/openid-connect-discovery-1_0.html" target="_top" class="descriptionLink">openid-connect-discovery 1.0</a>]), das den Großteil der Informationen enthält, die für eine App zum Durchführen einer Anmeldung erforderlich sind. Hierzu gehören Informationen wie z.B. die zu verwendenden URLs und der Speicherort der öffentlichen Signaturschlüssel des Dienstes.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Funktionsmerkmal</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Der Begriff beschreibt eine Funktion oder auch einzelne, eine logische Einheit bildende Teilfunktionen der TI im Rahmen der funktionalen Zerlegung des Systems.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Gerät</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Alle Arten von mobilen Endgeräten.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Geräteinformationen</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Die Kombination der Informationen zum Typ eines Geräts und dem Namen eines Geräts.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Hersteller</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Der Name des Herstellers eines Geräts.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Inspektion</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Einsicht des Nutzers in die für die Anwendung von alternativen Authentisierungsmitteln gespeicherten Daten auf seinem Gerät oder innerhalb des IDP-Dienstes.&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">ID-Token</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Ein auf JSON basiertes und nach [<a href="https://tools.ietf.org/html/rfc7519" target="_top" class="descriptionLink">RFC7519</a>] (JWT) genormtes Identitäts-Token, mit dem ein Client (Anwendungsfrontend) die Identität eines Nutzers überprüfen kann.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Key-Identifier</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Einem kryptographischen Schlüssel oder einem Schlüsselpaar zugeordnete Zeichenkette zur Identifikation des Schlüssels.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Löschung oder Invalidierung</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Unter Löschung eines Schlüssels sollen pauschal alle Operationen verstanden werden, die einen kryptographischen Schlüssel dauerhaft einer Anwendung entziehen.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Modell</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Der vom Hersteller vergebene Name des Geräts.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Name (eines Geräts)</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Ein vom Nutzer vergebener Name eines Geräts.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Open Authorization 2.0</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Ein Protokoll zur Autorisierung für Web-, Desktop und mobile Anwendungen. Dabei wird es einem Endbenutzer (Resource Owner) ermöglicht, einer Anwendung (Client) den Zugriff auf Daten oder Dienste (Resources) zu ermöglichen, die von einem Dritten (Resource Server) bereitgestellt werden.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">OpenID Connect</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">OpenID Connect (OIDC) ist eine Authentifizierungsschicht, die auf dem Autorisierungsframework OAuth 2.0 basiert. Es ermöglicht Clients, die Identität des Nutzers anhand der Authentifizierung durch einen Autorisierungsserver zu überprüfen (siehe [<a href="https://openid.net/specs/openid-connect-core-1_0.html&nbsp;" target="_top" class="descriptionLink">openid-connect-core 1.0</a>]).</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Pairing</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Prüfbare Verbindung von kryptographischem Schlüsselmaterial zu einer innerhalb der Telematikinfrastruktur registrierten kryptographischen Identität.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Produkt-Name</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Der vom Hersteller für den Endkunden vergebene Name eines Geräts.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">JSON Web Token</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Ein auf JSON basiertes und nach [<a href="https://tools.ietf.org/html/rfc7519" target="_top" class="descriptionLink">RFC7519</a>] (JWT) genormtes Access Token. Das JWT ermöglicht den Austausch von verifizierbaren Claims innerhalb seines Payloads.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Resource Owner</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">OAuth2-Rolle (siehe [<a href="https://tools.ietf.org/html/rfc6749#section-1.1" target="_top" class="descriptionLink">RFC6749 # section-1.1</a>]): Eine Entität (Nutzer), die einem Dritten den Zugriff auf ihre geschützten Ressourcen gewähren kann. Diese Ressourcen werden durch den Resource Server bereitgestellt. Ist der Resource Owner eine Person, wird diese als Nutzer bezeichnet.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 73px;border: 1px solid #CCCCCC;padding: 5px;">Resource Server</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 73px;border: 1px solid #CCCCCC;padding: 5px;">OAuth2-Rolle (siehe [<a href="https://tools.ietf.org/html/rfc6749#section-1.1" target="_top" class="descriptionLink">RFC6749 # section-1.1</a>]): Der Server (Dienst), auf dem die geschützten Ressourcen (Protected Resources) liegen. Er ist in der Lage, auf Basis von Access Tokens darauf Zugriff zu gewähren. Ein solcher Token repräsentiert die delegierte Autorisierung des Resource Owners.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">SSO-Token</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Gegen Vorlage eines gültigen SSO Token ist keine erneute Nutzerauthentifizierung für die Ausstellung eines Access Tokens am IDP-Dienst nötig. <span style="color: #000000;">Das SSO-Token übernimmt damit hier die Funktion eines Refresh-Token im Rahmen des eRezeptes.</span></td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Token-Endpunkt</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Der Token-Endpunkt ist die Schnittstelle des IDP-Dienstes an welcher Anwendungsfrontends und Fachdienste gegen Vorlage des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE </span>ein <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> und ggf. weitere Token erhält.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Typ (eines Geräts)</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Eine existente Kombination von Gerät und Betriebssystem beschrieben durch&nbsp;<br> Namen des Herstellers, Namen des Produkts, Betriebssystem und Version des Betriebssystems.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Version (eines Betriebssystems)</td> 
     <td style="text-align: left;vertical-align: top;width: 536px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Die Bezeichnung der Version des Betriebssystems eines Geräts.</td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_294"></p>
  <p id="polarion_295">Das Glossar wird als eigenständiges Dokument (vgl. [gemGlossar]) zur Verfügung gestellt.</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104222">11.3 Abbildungsverzeichnis</h3>
  <div data-sequence="Abbildung" id="polarion_wiki macro name=tof;params=uid=1"></div>
  <div id="toc_container">
   <p class="toc_title"><h1></h1></p>
   <li><a href="#polarion_245">Abbildung 1: Systemkontext aus Sicht des Frontend (bestehend aus Authenticator-Modul und Anwendungsfrontend)</a></li>
   <li><a href="#polarion_269">Abbildung 2: Systemüberblick mit Nachbarsystemen</a></li>
   <li><a href="#polarion_94">Abbildung 3: Zerlegung des Frontends</a></li>
   <li><a href="#polarion_195">Abbildung 4: Verteilungssicht beim Einsatz eines mobilen Endgerätes&nbsp;</a></li>
   <li><a href="#polarion_224">Abbildung 5: Verteilungssicht beim Einsatz eines stationären Endgerätes und eines Primärsystems</a></li>
   <li><a href="#polarion_209">Abbildung 6: Schnittstellen des Authenticator-Moduls</a></li>
   <li><a href="#polarion_141">Abbildung 7: Schnittstellen des Anwendungsfrontends</a></li>
   <li><a href="#polarion_63">Abbildung 8: Überblick zum Ablauf</a></li>
   <li><a href="#polarion_101">Abbildung 9: Sequenzdiagramm PACE-Authentisierung</a></li>
   <li><a href="#polarion_152">Abbildung 10: Ablauf zur Ermittlung des Kartentyps</a></li>
   <li><a href="#polarion_165">Abbildung 11: Ablauf zur Selektion des privaten Schlüssels</a></li>
   <li><a href="#polarion_180">Abbildung 12: Ablauf zum Auslesen des X.509-Zertifikates</a></li>
   <li><a href="#polarion_250">Abbildung 13: Ablauf zur Verifikation des Benutzers</a></li>
   <li><a href="#polarion_260">Abbildung 14: Ablauf eines Signaturvorgangs</a></li>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104223">11.4 Tabellenverzeichnis</h3>
  <div data-sequence="Tabelle" id="polarion_wiki macro name=tof;params=uid=2"></div>
  <div id="toc_container">
   <p class="toc_title"><h1></h1></p>
   <li><a href="#polarion___1">Tabelle 1:&nbsp;&nbsp;Belegung des&nbsp;amr-Claims durch das Authenticator-Modul</a></li>
   <li><a href="#polarion_28">Tabelle 2: TAB_Authenticator_001 – Zertifikatsnutzung des Authenticator-Modul</a></li>
   <li><a href="#polarion___2">Tabelle 3:&nbsp;Kryptographische Verfahren</a></li>
   <li><a href="#polarion___3">Tabelle 4: Zugelassene, lokale Authentisierungsmittel</a></li>
   <li><a href="#polarion___4">Tabelle 5: Pairing-Daten</a></li>
   <li><a href="#polarion___5">Tabelle 6 : Anwendungsfall "Abruf des ACCESS_TOKEN"</a></li>
   <li><a href="#polarion_97">Tabelle 7: Zusammenhang CosA_8da mit der folgenden Abbildung</a></li>
   <li><a href="#polarion_276">Tabelle&nbsp;8: Auswahl des shortFileIdentifier</a></li>
   <li><a href="#polarion_277">Tabelle 9: Kommando APDU für Lesekommandos</a></li>
   <li><a href="#polarion_272">Tabelle 10: Beispielhafte Umwandlungen einer PIN</a></li>
   <li><a href="#polarion_273">Tabelle 11: Passwortobjekt in Abhängigkeit des Kartentyps</a></li>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104224">11.5 Referenzierte Dokumente</h3>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-104225">11.5.1 Dokumente der gematik</h4>
  <p id="polarion_186">Die nachfolgende Tabelle enthält die Bezeichnung der in dem vorliegenden Dokument referenzierten Dokumente der gematik zur Telematikinfrastruktur. Der mit der vorliegenden Version korrelierende Entwicklungsstand dieser Konzepte und Spezifikationen wird pro Release in einer Dokumentenlandkarte definiert; Version und Stand der referenzierten Dokumente sind daher in der nachfolgenden Tabelle nicht aufgeführt. Deren zu diesem Dokument jeweils gültige Versionsnummern sind in der aktuellen, von der gematik veröffentlichten Dokumentenlandkarte enthalten, in der die vorliegende Version aufgeführt wird.</p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=4" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 186px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">[Quelle]<br> </th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 545px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">Titel<br> </th> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 186px;height: 14px;border: 1px solid #CCCCCC;padding: 5px;">[gemGlossar] </td> 
     <td style="text-align: left;vertical-align: top;width: 545px;height: 14px;border: 1px solid #CCCCCC;padding: 5px;">Glossar der Telematikinfrastruktur</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 186px;height: 11px;border: 1px solid #CCCCCC;padding: 5px;">[gemSpec_COS]</td> 
     <td style="text-align: left;vertical-align: top;width: 545px;height: 11px;border: 1px solid #CCCCCC;padding: 5px;">Spezifikation des Card Operating System (COS), Elektrische Schnittstelle<br> </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 186px;height: 11px;border: 1px solid #CCCCCC;padding: 5px;">[gemSpec_HBA_ObjSys]</td> 
     <td style="text-align: left;vertical-align: top;width: 545px;height: 11px;border: 1px solid #CCCCCC;padding: 5px;">Spezifikation des elektronischen Heilberufsausweises, HBA Objektsystem</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 186px;height: 11px;border: 1px solid #CCCCCC;padding: 5px;">[gemSpec_HBA_ObjSys_G2.1]</td> 
     <td style="text-align: left;vertical-align: top;width: 545px;height: 11px;border: 1px solid #CCCCCC;padding: 5px;">Spezifikation des elektronischen Heilberufsausweises, HBA Objektsystem</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 186px;height: 11px;border: 1px solid #CCCCCC;padding: 5px;">[gemSpec_IDP_Dienst]</td> 
     <td style="text-align: left;vertical-align: top;width: 545px;height: 11px;border: 1px solid #CCCCCC;padding: 5px;">Spezifikation Identity Provider-Dienst</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 186px;height: 11px;border: 1px solid #CCCCCC;padding: 5px;">[gemSpec_IDP_FD]</td> 
     <td style="text-align: left;vertical-align: top;width: 545px;height: 11px;border: 1px solid #CCCCCC;padding: 5px;">Spezifikation Identity Provider-Frontend<br> </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 186px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">[gemSpec_Krypt]</td> 
     <td style="text-align: left;vertical-align: top;width: 545px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">Übergreifende Spezifikation: Verwendung kryptographischer Algorithmen in der Telematikinfrastruktur</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 186px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">[gemSpec_OM]</td> 
     <td style="text-align: left;vertical-align: top;width: 545px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">Übergreifende Spezifikation Operations und Maintenance</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 186px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">[gemSpec_eGK_ObjSys_G2.1]</td> 
     <td style="text-align: left;vertical-align: top;width: 545px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">Spezifikation der elektronischen Gesundheitskarte, eGK-Objektsystem<br> </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 186px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">[gemSpec_PKI]</td> 
     <td style="text-align: left;vertical-align: top;width: 545px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">Übergreifende Spezifikation - Spezifikation PKI</td> 
    </tr> 
   </tbody> 
  </table>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-104226">11.5.2 Weitere Dokumente</h4>
  <p id="polarion_249">Die weiteren zu beachtenden Dokumente sind folgender Tabelle zu entnehmen.</p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=5" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 89px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[Quelle]<br> </th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 642px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Herausgeber (Erscheinungsdatum): Titel<br> </th> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 89px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[PKCS#1]</td> 
     <td style="text-align: left;vertical-align: top;width: 642px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">PKCS #1 v2.1: RSA Cryptography Standard, RSA Laboratories (Juni 2002)<br> ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1.pdf </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 89px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[openid-connect-core]&nbsp;</td> 
     <td style="text-align: left;vertical-align: top;width: 642px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">OpenID Connect Core 1.0 (November 2014) <br> <a href="https://openid.net/specs/openid-connect-core-1_0.html" target="_top" class="descriptionLink">https://openid.net/specs/openid-connect-core-1_0.html</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 89px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[openid-connect-discovery]</td> 
     <td style="text-align: left;vertical-align: top;width: 642px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">OpenID Connect Discovery 1.0 (November 2014)<br> <a href="https://openid.net/specs/openid-connect-discovery-1_0.html&nbsp;" target="_top" class="descriptionLink">https://openid.net/specs/openid-connect-discovery-1_0.html&nbsp;</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 89px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[RFC6749]</td> 
     <td style="text-align: left;vertical-align: top;width: 642px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">The OAuth 2.0 Authorization Framework (Oktober 2012) <br> <a href="https://tools.ietf.org/html/rfc6749" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc6749</a></td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 89px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[RFC6750]</td> 
     <td style="text-align: left;vertical-align: top;width: 642px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">The OAuth 2.0 Authorization Framework: Bearer Token Usage (Oktober 2012) <br> <a href="https://tools.ietf.org/html/rfc6750" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc6750</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 89px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[RFC7231]</td> 
     <td style="text-align: left;vertical-align: top;width: 642px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content (Juni 2014)<br> <a href="https://tools.ietf.org/html/rfc7231" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc7231</a>&nbsp;</span></td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 89px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[RFC7515]</td> 
     <td style="text-align: left;vertical-align: top;width: 642px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">JSON Web Signature (Mai 2015)<br> <a href="https://tools.ietf.org/html/rfc7515" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc7515</a>&nbsp;</span></td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 89px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[RFC7516]</td> 
     <td style="text-align: left;vertical-align: top;width: 642px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">JSON Web Encryption (Mai 2015)<br> <a href="https://tools.ietf.org/html/rfc7516" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc7516</a>&nbsp;</span></td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 89px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[RFC7519]&nbsp;</td> 
     <td style="text-align: left;vertical-align: top;width: 642px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON Web Token (Mai 2015) <br> <a href="https://tools.ietf.org/html/rfc7519" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc7519</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 89px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[RFC7523]</td> 
     <td style="text-align: left;vertical-align: top;width: 642px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants (Mai 2015) <br> <a href="https://tools.ietf.org/html/rfc7523" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc7523</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 89px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[RFC7636]</td> 
     <td style="text-align: left;vertical-align: top;width: 642px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">Proof Key for Code Exchange by OAuth Public Clients (September 2015)<br> <a href="https://tools.ietf.org/html/rfc7636" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc7636</a>&nbsp;</span><br> </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 89px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[RFC8252]</td> 
     <td style="text-align: left;vertical-align: top;width: 642px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">OAuth 2.0 for Native Apps (Oktober 2017)<br> <a href="https://tools.ietf.org/html/rfc8252" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc8252</a>&nbsp;</span>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 89px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[TR-03110]</td> 
     <td style="text-align: left;vertical-align: top;width: 642px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Technische Richtlinie 3110 des Bundesamtes für Sicherheit in der Informationstechnik<br> <a href="https://www.bsi.bund.de/DE/Publikationen/TechnischeRichtlinien/tr03110/index_htm.html" target="_top" class="descriptionLink">https://www.bsi.bund.de/DE/Publikationen/TechnischeRichtlinien/tr03110/index_htm.html</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 89px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[TR–03111]</td> 
     <td style="text-align: left;vertical-align: top;width: 642px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Technical Guideline TR-03111, Elliptic Curve Cryptography,&nbsp;Version 2.10 (Juni 2018)&nbsp;<br> <a href="https://www.bsi.bund.de/DE/Publikationen/TechnischeRichtlinien/tr03111/index_htm.html" target="_top" class="descriptionLink">https://www.bsi.bund.de/DE/Publikationen/TechnischeRichtlinien/tr03111/index_htm.html</a>&nbsp; </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 89px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[TR-03116-1]</td> 
     <td style="text-align: left;vertical-align: top;width: 642px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Technische Richtlinie BSI TR-03116-1, Kryptographische Vorgaben für Projekte der Bundesregierung,<br> Version: 3.20, Datum:21.09.2018,&nbsp;Status: Veröffentlichung (September 2018)<br> <a href="https://www.bsi.bund.de/DE/Publikationen/TechnischeRichtlinien/tr03116/index_htm.html" target="_top" class="descriptionLink">https://www.bsi.bund.de/DE/Publikationen/TechnischeRichtlinien/tr03116/index_htm.html</a>&nbsp; </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 89px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[RFC8176]</td> 
     <td style="text-align: left;vertical-align: top;width: 642px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Authentication Method Reference Values<br> <a href="https://tools.ietf.org/html/rfc8176" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc8176</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 89px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[androidbiom]</td> 
     <td style="text-align: left;vertical-align: top;width: 642px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Measuring Biometric Unlock Security&nbsp;<br> <a href="https://source.android.com/security/biometric/measure" target="_top" class="descriptionLink">https://source.android.com/security/biometric/measure</a>&nbsp;</td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_288"></p>
  <p id="polarion_38"></p>
  <p id="polarion_119"></p>
 </body>
</html>