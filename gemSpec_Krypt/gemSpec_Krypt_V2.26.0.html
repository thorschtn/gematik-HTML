<html>
 <head>
  <link rel="stylesheet" href="attachments/styleSheetForToc.css">
 </head>
 <body>
  <p id="polarion_1"></p>
  <p id="polarion_80"> <br> </p>
  <p id="polarion_4"> <br> </p>
  <p id="polarion_5"> <br> </p>
  <p id="polarion_6"> <span style="font-weight: bold;text-decoration: underline;font-size: 12pt;line-height: 1.5;">Elektronische Gesundheitskarte und Telematikinfrastruktur</span> </p>
  <p id="polarion_7"> <br> </p>
  <p id="polarion_8"> <br> </p>
  <p id="polarion_9"> <br> </p>
  <p id="polarion_10" style="text-align: center;"> <span style="font-weight: bold;font-size: 28pt;line-height: 1.2;">Übergreifende Spezifikation</span> </p>
  <p id="polarion_11" style="text-align: center;"> <span style="font-weight: bold;font-size: 28pt;line-height: 1.2;">Verwendung kryptographischer Algorithmen in der</span><br> <span style="font-weight: bold;font-size: 28pt;line-height: 1.2;">Telematikinfrastruktur</span> </p>
  <p id="polarion_12"> <br> </p>
  <p id="polarion_17"></p>
  <p id="polarion_21"></p>
  <div id="polarion_editor_html_block1" class="polarion-dle-wiki-block"> 
   <div id="polarion_editor_html_block_content" contenteditable="false"></div>
   <pre id="polarion_editor_html_block_source" class="polarion-dle-wiki-block-source" contenteditable="false">
    <table>
     <tr>
      <td>Version</td>
      <td>2.26.0</td>
     </tr>
     <tr>
      <td>Revision</td>
      <td>587120</td>
     </tr>
     <tr>
      <td>Stand</td>
      <td>09.03.2023</td>
     </tr>
     <tr>
      <td>Status</td>
      <td>freigegeben</td>
     </tr>
     <tr>
      <td>Klassifizierung</td>
      <td>öffentlich</td>
     </tr>
     <tr>
      <td>Referenzierung</td>
      <td>gemSpec_Krypt</td>
     </tr>
    </table></pre> 
  </div>
  <p id="polarion_13"> <br> </p>
  <h1 id="polarion_wiki macro name=module-workitem;params=id=ML-7841">Dokumentinformationen</h1>
  <p id="polarion_18"> <span style="font-weight: bold;">Änderungen zur Vorversion</span> </p>
  <p id="polarion_19">Anpassungen des vorliegenden Dokumentes im Vergleich zur Vorversion können Sie der nachfolgenden Tabelle entnehmen.</p>
  <p id="polarion_384"></p>
  <p id="polarion_20"> <span style="font-weight: bold;">Dokumentenhistorie</span> </p>
  <table id="polarion_wiki macro name=table;params=width=99.74%|uid=1" class="polarion-Document-table" style="width: 99.74%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">Version</span></th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">Datum</span></th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">Grund der Änderung, besondere Hinweise</span></th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">Bearbeitung</span></th> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;padding: 5px;">1.4.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">03.07.08</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">freigegeben (für Release 2.3.4)</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">1.9.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">26.06.12</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Kommentierung</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">1.10.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">13.09.12</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Einarbeitung der Gesellschafterkommentare</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.0.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">15.10.12</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">bQS Kommentare eingearbeitet</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.1.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">06.06.13</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Erweiterung im Rahmen der PP-Erstellung Konnektor (kryptographische Vorgaben für die SAK); Anpassung an das fortgeschriebene PP Konnektor ORS1 (BSI-CC-PP-0046), Konsistenz zur veränderten gemSpec_Kon herstellen</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.2.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">21.02.14</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Losübergreifende Synchronisation</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.3.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">17.06.14</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Entfernung des CBC-Modus bei der Dokumentenver- und -entschlüsselung gemäß P11-Änderungsliste</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.4.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">17.07.15</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Einarbeitung Änderungen aus Errata 1.4.6</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.5.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">03.05.16</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Anpassungen zum Online-Produktivbetrieb (Stufe 1)</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.6.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">24.08.16</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Einarbeitung weiterer Kommentare</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.7.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">28.10.16</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Anpassungen gemäß Änderungsliste</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.8.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">20.04.17</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Start der Migration 120-Bit-Sicherheitsniveau kryptographische Verfahren in der TI (PKI der Kartengeneration 2.1), Anpassungen gemäß Änderungsliste</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.9.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">19.12.17</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">C_6260 (IPsec), C_6289 (qeS)</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.10.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">14.05.18</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">C_6195 (IPsec), C_6374 (ed. IPsec), C_6375 (TLS für SM), C_6399 (IPsec)</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.11.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">26.10.18</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Veröffentlichung im Rahmen von Release 2.1.3</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.11.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">29.10.18</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">C_6639 (RSA 2048 Bit Zertifikate) etc., redaktionelle Aktualisierung der Anforderungen A_14653,&nbsp;A_15699 im Rahmen von Release 2.1.3</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.12.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">18.12.18</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ePA-Inhalte ergänzt</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.13.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">15.05.19</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Anpassungen gemäß Änderungsliste P18.1</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.14.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">28.06.19</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Anpassungen gemäß Änderungsliste P19.1</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.15.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">02.10.19</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Anpassungen gemäß Änderungsliste P20.1/2</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.16.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">02.03.20</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Anpassungen gemäß Änderungsliste P20.4/21.1</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.16.1</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">27.08.20</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Anpassungen gemäß Änderungsliste P21.4</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.16.2</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">05.11.20</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Anpassungen gemäß Änderungsliste P21.6</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.17.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">30.06.20</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Anpassungen gemäß Änderungsliste P22.1 und Scope-Themen aus Systemdesign R4.0.0</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.18.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">12.11.20</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Einarbeitung Scope-Themen zu R4.0.1</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.19.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">19.02.21</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Anpassungen gemäß Änderungsliste P22.5&nbsp;</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.19.1</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">30.06.21</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Ergänzung fehlender Referenzen bzgl. Prüfung der VAU-Identität (informative Erläuterung in Kapitel 7.1 (C_10599)), Rückbau C_10062 (aus Konn_Maintenance_21.3)</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.20.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">02.09.21</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;padding: 5px;">Einarbeitung Konn_Maintenance_21.5 (Kapitel 6.13 neu), Umbenennung Begriffe (aus "aAdG-NetG" wird&nbsp;"WANDA Basic", aus "aAdG" und "aAdG-NetG-TI" wird "WANDA Smart")</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.21.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">31.01.22</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;padding: 5px;">Einarbeitung ePA_Maintenance_21.5 und Konn_Maintenance_21.6</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.22.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">01.03.22</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;padding: 5px;">Einarbeitung E-Rezept_Maintenance_21.3</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.23.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">20.09.22</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">Einarbeitung&nbsp;gemSpec_Krypt_Maintenance_22.1 (neu: Kap. 2.5)<br> Einarbeitung Änderungsliste E-Rezept_Ma</span>intenance 22.2</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.24.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">08.12.22</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Einarbeitung CI_Maintenance_22.5, Konn_Maintenance_22.5 und 22.6,&nbsp;Kap. 5.4 Typo raus, redaktionelle Anpassungen</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.25.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">14.02.23</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Einarbeitung VSDM++, Maintenance_23.1</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 68px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">2.26.0</td> 
     <td style="text-align: left;vertical-align: top;width: 81px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">09.03.23</td> 
     <td style="text-align: left;vertical-align: top;width: 442px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Einarbeitung Konn_Maintenance_23.0</td> 
     <td style="text-align: left;vertical-align: top;width: 117px;height: 12px;border: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_79"></p>
  <h1 id="polarion_wiki macro name=module-workitem;params=id=ML-7842">Inhaltsverzeichnis</h1>
  <div id="polarion_wiki macro name=toc"></div>
  <div id="toc_container">
   <p class="toc_title"><h1></h1></p>
   <li><a href="#polarion_wiki macro name=module-workitem;params=id=ML-7841">Dokumentinformationen</a></li>
   <li><a href="#polarion_wiki macro name=module-workitem;params=id=ML-7842">Inhaltsverzeichnis</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7843">1 Einführung</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7844">1.1 Zielsetzung und Einordnung des Dokuments</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7845">1.2 Zielgruppe</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7846">1.3 Geltungsbereich</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7847">1.4 Abgrenzung des Dokuments</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7848">1.5 Methodik</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7851">2 Einsatzszenarioübergreifende Algorithmen</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7853">2.1 Identitäten</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7854">2.1.1 X.509-Identitäten</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7855">2.1.1.1 Digitale nicht-qualifizierte elektronische Signaturen</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7857">2.1.1.2 Qualifizierte elektronische Signaturen</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7859">2.1.1.3 TLS-Authentifizierung</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7861">2.1.1.4 IPsec-Authentifizierung</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7863">2.1.1.5 Digitale Signaturen durch TI-Komponenten</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7865">2.1.1.6 Verschlüsselung</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7867">2.1.2 CV-Identitäten</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7872">2.1.2.1 CV-Zertifikate G2</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7874">2.1.2.2 CV-Certification-Authority (CV-CA) Zertifikat G2</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7876">2.2 Zufallszahlengeneratoren</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7878">2.3 Hilfestellung bei der Umsetzung (Zufallsgeneratoren)</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7879">2.4 Schlüsselerzeugung und Schlüsselbestätigung</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-94319">2.4.1 Prüfung auf angreifbare (schwache) Schlüssel</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-92592">2.4.2 ECC-Schlüssel in X.509-Zertifikaten</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-92593">2.4.3 RSA-Schlüssel in X.509-Zertifikaten</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-134187">2.5 Einmalpasswörter</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7886">3 Konkretisierung der Algorithmen für spezifische Einsatzszenarien</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7887">3.1 Kryptographische Algorithmen für XML-Dokumente</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7889">3.1.1 XML-Signaturen für nicht-qualifizierte Signaturen</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7891">3.1.2 XML-Signaturen für qualifizierte elektronische Signaturen</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7893">3.1.3 Webservice Security Standard (WSS)</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7894">3.1.4 XML-Verschlüsselung – Symmetrisch</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7896">3.1.5 XML-Verschlüsselung – Hybrid</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7900">3.2 Karten-verifizierbare Authentifizierung und Verschlüsselung</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7905">3.2.1 Card-to-Card-Authentisierung G2</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7907">3.2.2 Card-to-Server (C2S) Authentisierung und Trusted Channel G2</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7911">3.3 Netzwerkprotokolle</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7912">3.3.1 IPsec-Kontext</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7919">3.3.2 TLS-Verbindungen</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7936">3.3.3 DNSSEC-Kontext</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7938">3.4 Masterkey-Verfahren (informativ)</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7939">3.5 Hybride Verschlüsselung binärer Daten</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7940">3.5.1 Symmetrischer Anteil der hybriden Verschlüsselung binärer Daten</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7942">3.5.2 Asymmetrischer Anteil der hybriden Verschlüsselung binärer Daten</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7944">3.6 Symmetrische Verschlüsselung binärer Daten</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7946">3.7 Signatur binärer Inhaltsdaten (Dokumente)</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7948">3.8 Signaturen innerhalb von PDF/A-Dokumenten</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7950">3.9 Kartenpersonalisierung</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7952">3.10 Bildung der pseudonymisierten Versichertenidentität</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7954">3.11 Spezielle Anwendungen von Hashfunktionen</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7957">3.11.1 Hashfunktionen und OCSP (informativ)</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7958">3.12 kryptographische Vorgaben für die SAK des Konnektors</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7960">3.13 Migration im PKI-Bereich</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7962">3.14 Spezielle Anwendungen von kryptographischen Signaturen</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-92331">3.15 ePA-spezifische Vorgaben</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-93948">3.15.1 Verbindung zur VAU</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-93950">3.15.2 Vorgaben für ePA-Schlüssel und ePA-Chiffrate</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-93949">3.15.3 ePA-Aktensysteminterne Schlüssel</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-93951">3.15.4 ePA-spezifische TLS-Vorgaben</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-94642">3.15.5 Schlüsselableitungsfunktionalität ePA</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-109241">3.16 E-Rezept-spezifische Vorgaben</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-107285">3.17 KOM-LE-spezifische Vorgaben</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-137117">3.18 HMAC-Sicherung der Prüfziffer VSDM</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7966">4 Umsetzungsprobleme mit der TR-03116-1</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7967">4.1 XMLDSig und PKCS1-v2.1</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7969">4.2 XMLEnc: Die Nutzung von RSAES-OAEP und AES-GCM</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7970">4.3 XML Signature Wrapping und XML Encryption Wrapping</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7971">4.4 Güte von Zufallszahlen</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7972">5 Migration 120-Bit-Sicherheitsniveau</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7973">5.1 PKI-Begriff Schlüsselgeneration</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7974">5.2 X.509-Root der TI</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-92596">5.3 TSL-Dienst und ECDSA-basierte TSL allgemein</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-92829">5.4 ECC-Unterstützung bei TLS</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-92704">5.5 ECC-Unterstützung bei IPsec</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-92907">5.6 ECDSA-Signaturen</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-93561">5.6.1 ECDSA-Signaturen im XML-Format</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-93562">5.6.2 ECDSA-Signaturen im CMS-Format</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-92597">5.7 ECIES</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-93738">5.7.1 ECIES und authentisierte Broadcast-Encryption</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-94026">5.7.2 ECIES und mobKT</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-92595">5.8 ECC-Migration eHealth-KT</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-127120">5.8.1 Interoperabilität zwischen eHealth-KT und Konnektor</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-92604">5.9 ECC-Migration Konnektor</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-92708">5.10 Verschiedene Produkttypen und ECC-Migration (informativ)</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-92333">6 Kommunikationsprotokoll zwischen ePA-VAU und ePA-Clients</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-92332">6.1 Motivation</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-92334">6.2 Übersicht</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-92336">6.3 VAUClientHello-Nachricht</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-92337">6.4 VAUServerHello-Nachricht</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-92338">6.5 Schlüsselableitung</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-92422">6.6 VAUClientSigFin-Nachricht</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-92421">6.7 VAUServerFin-Nachricht</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-92339">6.8 Nutzerdatentransport</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-92340">6.9 VAUServerError-Nachricht</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-92341">6.10 Abbrechen des Protokollablaufs</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-100241">6.11 VAU-Kanal und MTOM/XOP</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-110895">6.12 Zusätzliche HTTP-Header-Informationen</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-123510">6.13 Tracing in Nichtproduktivumgebungen</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-126984">6.14 Optionale PQC-Erweiterung (informativ)</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-109239">7 Kommunikationsprotokoll zwischen E-Rezept-VAU und E-Rezept-Clients</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-109240">7.1 Übersicht (informativ)</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-109242">7.2 Definition</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-114468">7.2.1 E-Rezept-VAU-Identität</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-114467">7.2.2 Client-seitige Prüfung der E-Rezept-VAU-Identität</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-114466">7.2.3 E-Rezept-VAU-Request und -Response</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-114469">7.2.4 Zufallsquelle für Clients</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-126985">8 Post-Quanten-Kryptographie (informativ)</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-94999">9 Erläuterungen (informativ)</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-94998">9.1 Prüfung auf angreifbare (schwache) Schlüssel</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-95000">9.2 RSA-Schlüssel in X.509-Zertifikaten</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7977">10 Anhang – Verzeichnisse</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7978">10.1 Abkürzungen</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7979">10.2 Glossar</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7980">10.3 Abbildungsverzeichnis</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-34052">10.4 Tabellenverzeichnis</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-34053">10.5 Referenzierte Dokumente</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7981">10.5.1 Dokumente der gematik</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-7982">10.5.2 Weitere Dokumente</a></li>
  </div>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-7843">1 Einführung</h2>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7844">1.1 Zielsetzung und Einordnung des Dokuments</h3>
  <p id="polarion_24">Die vorliegende übergreifende Spezifikation definiert Anforderungen an Produkte der TI bezüglich kryptographischer Verfahren. Diese Anforderungen sind als übergreifende Regelungen relevant für Interoperabilität und Verfahrenssicherheit.</p>
  <p id="polarion_25">Für die TI ist die Technische Richtlinie 03116 Teil 1 [BSI-TR-03116-1] normativ, d. h. nur dort aufgeführte kryptographische Verfahren dürfen von Produkten in der TI verwendet werden. Wenn mehrere unterschiedliche Produkttypen der TI zusammenarbeiten ist es bez. der Interoperabilität nicht sinnvoll wenn jeder beteiligte Produkttyp alle dort aufgeführten Verfahren umsetzen muss, da er vermuten muss die Gegenstelle beherrscht nur eine Teilmenge der dort aufgeführten Verfahren. Um einen gemeinsamen Nenner zu definieren, legt dieses Dokument für bestimmte Einsatzzwecke ein Mindestmaß an verpflichtend zu implementierenden Verfahren aus [BSI-TR-03116-1] fest, oftmals mit spezifischen Parametern. Ein Produkttyp ist frei, weitere Verfahren aus der [BSI-TR-03116-1] optional zu implementieren, kann sich jedoch nicht ohne Weiteres darauf verlassen, dass sein potentieller Kommunikationspartner diese auch beherrscht.</p>
  <p id="polarion_26"> In Bezug auf die Formulierung der Ende-Daten der Zulässigkeit eines kryptographischen Verfahrens wird die Konvention aus der TR-02102- und der TR-03116-Familie verwendet, d. .h.,&nbsp;eine Aussage „Algorithmus X ist geeignet bis Ende 2029+“ <span id="polarion-comment:516"></span>&nbsp;bedeutet generell nicht, dass Algorithmus X nach Ende 2029 nicht mehr geeignet ist, sondern lediglich, dass über die Eignung nach Ende 2029 keine explizite Aussage gemacht wird und dass aus heutiger Sicht die weitere Eignung nicht ausgeschlossen ist. Aussagen über den Betrachtungszeitraum hinaus sind mit einem höheren Maß an Spekulation verbunden.&nbsp;<span style="font-size: 10pt;line-height: 1.5;">Sollte bei den Angaben zum Ende der zeitlichen Zulässigkeit kein "+" aufgeführt sein (bspw. "Ende 2025") , so bedeutet dies, dass eine Verlängerung der Zulässigkeit über den aufgeführten Zeitpunkt hinaus nicht geplant ist.&nbsp;<span id="polarion-comment:517"></span></span> </p>
  <p id="polarion_27">Bei neuen Erkenntnissen über die verwendeten kryptographischen Algorithmen, die zu einer Änderung der TR-03116-1 führen, wird eine Anpassung dieses Dokumentes erfolgen. Für Verwendungszwecke, bei denen bereits eine Migration zu stärkeren Algorithmen in Planung ist oder die Verwendung von Algorithmen unterschiedlicher Stärke zulässig ist, wird ein Ausblick gegeben, bis wann welche Algorithmen ausgetauscht sein müssen. Bei den Migrationsstrategien für kryptographische Algorithmen ist darauf zu achten, dass hinterlegte Objekte umzuschlüsseln sind bzw. die älteren Algorithmen (unter der Bedingung, dass sie sicherheitstechnisch noch geeignet sind) für eine gewisse Übergangsphase weiter unterstützt werden müssen und danach zuverlässig in den Komponenten deaktiviert werden müssen.</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7845">1.2 Zielgruppe</h3>
  <p id="polarion_28">Das Dokument richtet sich an Hersteller und Anbieter von Produkten der TI, die kryptographische Objekte verwalten.</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7846">1.3 Geltungsbereich</h3>
  <p id="polarion_29">Dieses Dokument enthält normative Festlegungen zur Telematikinfrastruktur des deutschen Gesundheitswesens. Der Gültigkeitszeitraum der vorliegenden Version und deren Anwendung in Zulassungsverfahren wird durch die gematik GmbH in gesonderten Dokumenten (z. B. Dokumentenlandkarte, Produkttypsteckbrief, Leistungsbeschreibung) festgelegt und bekannt gegeben.</p>
  <p id="polarion_30"> <span style="font-weight: bold;font-style: italic;">Schutzrechts-/Patentrechtshinweis</span> </p>
  <p id="polarion_31"> <span style="font-style: italic;font-size: 10pt;line-height: 1.5;">Die nachfolgende Spezifikation ist von der gematik allein unter technischen Gesichtspunkten erstellt worden. Im Einzelfall kann nicht ausgeschlossen werden, dass die Implementierung der Spezifikation in technische Schutzrechte Dritter eingreift. Es ist allein Sache des Anbieters oder Herstellers, durch geeignete Maßnahmen dafür Sorge zu tragen, dass von ihm aufgrund der Spezifikation angebotene Produkte und/oder Leistungen nicht gegen Schutzrechte Dritter verstoßen und sich ggf. die erforderlichen Erlaubnisse/Lizenzen von den betroffenen Schutzrechtsinhabern einzuholen. Die gematik GmbH übernimmt insofern keinerlei Gewährleistungen.</span> </p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7847">1.4 Abgrenzung des Dokuments</h3>
  <p id="polarion_32">Aufgabe des Dokumentes ist es nicht, eine Sicherheitsbewertung von kryptographischen Algorithmen vorzunehmen. Dieser Gesichtspunkt wird in [BSI-TR-03116-1] behandelt. Es werden lediglich die dort vorgegebenen Algorithmen weiter eingeschränkt, um die Herstellung der Interoperabilität zu unterstützen.</p>
  <p id="polarion_33">Es ist nicht Ziel dieses Dokumentes, den Prozess zum Austauschen von Algorithmen zu definieren, sondern lediglich den zeitlichen Rahmen für die Verwendbarkeit von Algorithmen festzulegen und somit auf den Bedarf für die Migration hinzuweisen.</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7848">1.5 Methodik</h3>
  <p id="polarion_34">Anforderungen als Ausdruck normativer Festlegungen werden durch eine eindeutige ID sowie die dem RFC 2119 [RFC-2119] entsprechenden, in Großbuchstaben geschriebenen deutschen Schlüsselworte MUSS, DARF NICHT, SOLL, SOLL NICHT, KANN gekennzeichnet.</p>
  <p id="polarion_35">Sie werden im Dokument wie folgt dargestellt:</p>
  <p id="polarion_36"> <span style="font-weight: bold;">&lt;AFO-ID&gt; - &lt;Titel der Afo&gt;</span><br> Text / Beschreibung<br> <span style="font-weight: bold;">[</span>&lt;=<span style="font-weight: bold;">]</span> </p>
  <p id="polarion_37"></p>
  <p id="polarion_38"> Dabei umfasst die Anforderung sämtliche zwischen Afo-ID und der Textmarke [&lt;=] angeführten Inhalte.<br> </p>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-7851">2 Einsatzszenarioübergreifende Algorithmen</h2>
  <p id="polarion_41">Nachfolgend werden grundlegende Festlegungen zur Verwendung von Algorithmen innerhalb der Telematikinfrastruktur getroffen. Diese Anforderungen sind unabhängig von den im nachfolgenden Kapitel definierten Einsatzszenarien und werden durch diese verwendet.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7852|layout=1">
   <p><b>GS-A_3080</b></p>
   <p><p style="margin-left: 0px;"><span>Die Lebensdauer von asymmetrischen Schlüsseln und somit die in einem Zertifikat angegebene Gültigkeit</span><span>s</span><span>dauer SOLL maximal 5 Jahre betragen.</span></p> <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7853">2.1 Identitäten</h3>
  <p id="polarion_43">Der Begriff „kryptographische Identität“ (nachfolgend nur noch als Identität bezeichnet) bezeichnet einen Verbund aus Identitätsdaten und einem kryptographischen Objekt, das bspw. im Rahmen einer Authentisierung und Authentifizierung verwendet werden kann. Im Allgemeinen handelt es sich um Schlüsselpaare, bestehend aus öffentlichem und privatem Schlüssel, sowie einem Zertifikat, das die Kombination aus Attributen und öffentlichem Schlüssel durch eine übergeordnete Instanz (CA – Certification Authority) bestätigt.</p>
  <p id="polarion_44">Bei den Algorithmenvorgaben für Identitäten muss u. a. spezifiziert werden:</p>
  <ul id="polarion_45"> 
   <li>für welche Algorithmen und für welchen Verwendungszweck die Schlüssel verwendet werden (Bestimmte Verwendungszwecke schließen einander aus, bspw. dürfen nicht Signaturschlüssel für die Sicherung von Authentizität und Integrität von Dokumenten als Signaturschlüssel für beliebige Challenges im Rahmen einer Authentisierung verwendet werden.),</li> 
   <li>welche Algorithmen für die Signatur des Zertifikates verwendet werden,</li> 
   <li>mit welchen Algorithmen die OCSP-Responses signiert werden und</li> 
   <li>wie die Zertifikate des OCSP-Responders signiert sind.</li> 
  </ul>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-7854">2.1.1 X.509-Identitäten</h4>
  <p id="polarion_46">Eine X.509-Identität ist eine Identität gemäß Abschnitt 2.1, bei der ein X.509-Zertifikat [RFC-5280] verwendet wird.</p>
  <p id="polarion_47"> Bei der Aufteilung von X.509-Identitäten wurden die Identitäten zunächst nach Gruppen für verschiedene Einsatzzwecke des Schlüssels unterteilt und diese bei Bedarf um einen notwendigen Einsatzkontext erweitert. Aus dieser Aufteilung ergibt sich die nachfolgend tabellarisch dargestellte Übersicht der Arten von X.509-Identitäten. Der exemplarische Einsatzort der Identitäten ist hierbei rein informativ, die Ausprägung wird in den Spezifikationen festgelegt, die eine kryptographische Identität benötigen.<br> </p>
  <p id="polarion_49" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">1</span>: Tab_KRYPT_001 Übersicht über Arten von X.509-Identitäten </p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=12" style="width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 83px;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Referenz</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 150px;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Gruppe</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 198px;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Kontext</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 270px;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Exemplarische Identitäten zur Verwendung (nicht vollständig)</span><br> </th> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 83px;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">2.1.1.1</span><br> </td> 
     <td rowspan="3" style="vertical-align: top;width: 150px;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Identitäten für die Erstellung von Signaturen</span><br> </td> 
     <td style="vertical-align: top;width: 198px;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Identitäten für die Erstellung nicht-qualifizierter digitaler Signaturen</span><br> </td> 
     <td style="vertical-align: top;width: 270px;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">OSIG-Identität der SMC-B bzw. HSM-B</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 83px;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">2.1.1.2</span><br> </td> 
     <td style="vertical-align: top;width: 198px;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Identitäten für die Erstellung qualifizierter Signaturen</span><br> </td> 
     <td style="vertical-align: top;width: 270px;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">QES-Identität des HBA</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 83px;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">2.1.1.5</span><br> </td> 
     <td style="vertical-align: top;width: 198px;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Signaturidentitäten, die in den Diensten der TI-Plattform und den Fachdiensten zum Einsatz kommen.</span><br> </td> 
     <td style="vertical-align: top;width: 270px;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Fachdienstsignatur</span><br> <span style="font-size: 10pt;line-height: 1.5;">Signatur durch zentrale Komponente der TI-Plattform</span><br> <span style="font-size: 10pt;line-height: 1.5;">Code-Signatur</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 83px;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">2.1.1.3</span><br> </td> 
     <td rowspan="2" style="vertical-align: top;width: 150px;height: 249px;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Identitäten für die Client-Server-Authentifizierung</span><br> </td> 
     <td style="vertical-align: top;width: 198px;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Identitäten für den Aufbau von TLS-Verbindungen</span><br> </td> 
     <td style="vertical-align: top;width: 270px;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Fachdienst TLS – Server</span><br> <span style="font-size: 10pt;line-height: 1.5;">Fachdienst TLS – Client</span><br> <span style="font-size: 10pt;line-height: 1.5;">zentrale TI-Plattform TLS – Server</span><br> <span style="font-size: 10pt;line-height: 1.5;">zentrale TI-Plattform TLS – Client</span><br> <span style="font-size: 10pt;line-height: 1.5;">AUT-Identität der SMC-B</span><br> <span style="font-size: 10pt;line-height: 1.5;">AUT-Identität des Kartenterminals</span><br> <span style="font-size: 10pt;line-height: 1.5;">AUT-Identität des Anwendungskonnektors</span><br> <span style="font-size: 10pt;line-height: 1.5;">AUT-Identität der SAK</span><br> <span style="font-size: 10pt;line-height: 1.5;">AUT-Identität der eGK</span><br> <span style="font-size: 10pt;line-height: 1.5;">AUTN-Identität der eGK</span><br> <span style="font-size: 10pt;line-height: 1.5;">AUT-Identität des HBA</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 83px;height: 29px;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">2.1.1.4</span><br> </td> 
     <td style="vertical-align: top;width: 198px;height: 29px;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Identitäten für den Aufbau von IPsec-Verbindungen</span><br> </td> 
     <td style="vertical-align: top;width: 270px;height: 29px;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">ID.NK.VPN</span><br> <span style="font-size: 10pt;line-height: 1.5;">ID.VPNK.VPN</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 83px;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">2.1.1.6</span><br> </td> 
     <td style="vertical-align: top;width: 150px;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Verschlüsselungs-zertifikate</span><br> </td> 
     <td style="vertical-align: top;width: 198px;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Identitäten, für die medizinische Daten verschlüsselt werden</span><br> </td> 
     <td style="vertical-align: top;width: 270px;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">ENC-Identität</span> <span style="font-size: 10pt;line-height: 1.5;">&nbsp;des Versicherten </span><br> <span style="font-size: 10pt;line-height: 1.5;">ENCV-Identität</span> <span style="font-size: 10pt;line-height: 1.5;">der eGK&nbsp;des Versicherten</span><br> <span style="font-size: 10pt;line-height: 1.5;">ENC-Identität des HBA</span><br> <span style="font-size: 10pt;line-height: 1.5;">ENC-Identität der SMC-B</span><br> </td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_51">Für den Aufbau der X.509-Zertifikate gelten die Vorgaben aus den jeweiligen Spezifikationen der X.509-Zertifikate.</p>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-7855">2.1.1.1 Digitale nicht-qualifizierte elektronische Signaturen</h5>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-137572">
   <p><b>GS-A_4357-02</b></p>
   <p>Alle Produkttypen, die X.509-Identitäten bei der Erstellung oder Prüfung digitaler nicht-qualifizierter elektronischer Signaturen verwenden, MÜSSEN die in Tab_KRYPT_002 aufgeführten Algorithmen unterstützen und die Tabellenvorgaben erfüllen. <br>Produkttypen, die Zertifikate (X.509-Identitäten) auf Basis der Schlüsselgeneration „ECDSA“ ausstellen (vgl. Abschnitt 5.1) oder verwenden, MÜSSEN die in Tab_KRYPT_002a aufgeführten Algorithmen und die Tabellenvorgaben erfüllen. <br> <b>&lt;=</b></p>
  </div>
  <p id="polarion_53"></p>
  <p id="polarion_54" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">2</span>: Tab_KRYPT_002 Algorithmen für X.509-Identitäten zur Erstellung nicht-qualifizierter Signaturen für die Schlüsselgeneration „RSA“ </p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=6" style="width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 218pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Anwendungsfall</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 330pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Vorgaben</span><br> </th> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 218pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Art und Kodierung des öffentlichen Schlüssels</span><br> </td> 
     <td style="vertical-align: top;width: 330pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">RSA&nbsp;(OID 1.2.840.113549.1.1.1)</span><br> <span style="font-size: 10pt;line-height: 1.5;">zu verwendende Schlüssellänge: 2048 Bit, zulässig bis Ende 2025<span id="polarion-comment:520"></span>, vgl. auch A_15590</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 218pt;height: 92pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Signatur eines Zertifikats</span><br> <span style="font-size: 10pt;line-height: 1.5;">Signatur einer OCSP-Response</span><br> <span style="font-size: 10pt;line-height: 1.5;">Signatur eines OCSP-Responder-Zertifikates</span><br> <span style="font-size: 10pt;line-height: 1.5;">Signatur einer CRL</span><br> <span style="font-size: 10pt;line-height: 1.5;">Signatur des Zertifikats das Basis der Signaturprüfung einer CRL ist</span><br> </td> 
     <td style="vertical-align: top;width: 330pt;height: 92pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">sha256withRSAEncryption</span><br> <span style="font-size: 10pt;line-height: 1.5;">(OID 1.2.840.113549.1.1.11)</span><br> <span style="font-size: 10pt;line-height: 1.5;">zu verwendende Schlüssellänge: 2048 Bit, zulässig&nbsp;bis Ende 2025, vgl. auch A_15590</span><br> </td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_56" class="polarion-rte-caption-paragraph"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-76959">
   <p><b>A_15590</b></p>
   <p>
    <div style="margin-left: 7.1pt;"> 
    </div> Ein TSP-X.509-nonQES, der X.509-Zertifikate erstellt auf Basis der Schlüsselgeneration „RSA“ (d. h., für den die Vorgaben aus Tab_KRYPT_002 gelten), MUSS das Ende der Zertifikatsgültigkeitsdauer für das auszustellende Zertifikat unabhängig von der in Tab_KRYPT_002 festgelegten Endedaten der Zulässigkeit der verwendeten RSA-Schlüssellängen festlegen.
    <div style="margin-left: 7.1pt;"></div> <b>&lt;=</b></p>
  </div>
  <p id="polarion_71">Erläuterung: Die technische Durchsetzung des Endes der Zulässigkeit von RSA mit weniger als 3000 Bit Schlüssellänge in X.509-Zertifikaten erfolgt durch die Herausnahme der entsprechenden RSA-basierten Sub-CA-Zertifikate aus der TSL zum Zeitpunkt des Ablaufens der Zulässigkeit (gemäß TIP1-A_2062). Ein TSP muss bez. der Zertifikatsgültigkeitsdauer der von ihm ausgegebenen Zertifikate das nach Spezifikationslage definierte Verhalten zeigen (i. A. Zertifikatsgültigkeitsdauer der ausgegebenen Zertifikate von 5 Jahren). Ein TSP kann auch mit dem Kartenherausgeber&nbsp;beliebige Gültigkeitsdauern unter 5 Jahren für die Laufzeit der vom TSP ausgegebenen Zertifikate vereinbaren.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-136447">
   <p><b>A_23458</b></p>
   <p><span style="background-color: #FFFF99;"></span>Der Konnektor SOLL NICHT die Zulässigkeitszeiträume kryptographischer Algorithmen technisch durchsetzen.<span style="background-color: #FFFF99;"></span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_459">Erläuterung: Analog zu A_15590 für die TSP der TI gilt, dass die Unterbindung der Verwendung von RSA mit Schlüssellängen unter 3000 Bit durch die gematik erfolgt durch die Herausnahme der entsprechenden RSA-basierten Sub-CA-Zertifikate aus der TSL zum Zeitpunkt des Ablaufens der Zulässigkeit (gemäß TIP1-A_2062).</p>
  <p id="polarion_72"></p>
  <p id="polarion_57" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">3</span>: Tab_KRYPT_002a Algorithmen für X.509-Identitäten zur Erstellung nicht-qualifizierter Signaturen für die Schlüsselgeneration „ECDSA“ </p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=7" style="width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 188pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Anwendungsfall</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 360pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Vorgabe</span><br> </th> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 188pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Art und Kodierung des öffentlichen Schlüssels</span><br> </td> 
     <td style="vertical-align: top;width: 360pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">ecPublicKey</span><br> <span style="font-size: 10pt;line-height: 1.5;">{OID 1.2.840.10045.2.1}</span><br> <span style="font-size: 10pt;line-height: 1.5;"><span style="font-weight: bold;">Entweder</span><br> auf der Kurve brainpoolP256r1 [RFC-5639#3.4, brainpoolP256r1]<br> zulässig bis Ende 2029+<span id="polarion-comment:521"></span><br> <span style="font-weight: bold;">oder</span><br> auf der Kurve P-256&nbsp;[FIPS-186-4]<br> zulässig bis Ende 2029+<br> <br> Verständnishinweis: vgl. auch A_23139 bezüglich der Entweder-Oder-Beziehung</span><br> <br> <span style="font-size: 10pt;line-height: 1.5;">Die Kodierung des öffentlichen Punkt erfolgt nach [RFC5480, Abschnitt 2], vgl. Beispiel in Abschnitt 5.2)</span><br> <br> <span style="font-size: 10pt;line-height: 1.5;">Der privater Schlüssel muss zufällig und gleichverteilt aus {1, …, q-1} gewählt werden. (q ist die Ordnung des&nbsp;Basispunkts und ceil(log<sub>2</sub> q)=256 ).</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 188pt;height: 122pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Signatur eines Zertifikats</span><br> <span style="font-size: 10pt;line-height: 1.5;">Signatur einer OCSP-Response</span><br> <span style="font-size: 10pt;line-height: 1.5;">Signatur eines OCSP-Responder-Zertifikates</span><br> <span style="font-size: 10pt;line-height: 1.5;">Signatur einer CRL</span><br> <span style="font-size: 10pt;line-height: 1.5;">Signatur des Zertifikats das Basis der Signaturprüfung einer CRL ist</span><br> </td> 
     <td style="vertical-align: top;width: 360pt;height: 122pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">ecdsa-with-SHA256 [RFC-3279] {OID 1.2.840.10045.4.3.2}</span><br> <span style="font-size: 10pt;line-height: 1.5;"><span style="font-weight: bold;">Entweder</span><br> auf der Kurve brainpoolP256r1 [RFC-5639#3.4, brainpoolP256r1]<br> zulässig bis Ende 2029+<br> <span style="font-weight: bold;">oder</span><br> auf der Kurve P-256&nbsp;[FIPS-186-4]<br> zulässig bis Ende 2029+</span><br> <br> <span style="font-size: 10pt;line-height: 1.5;">vgl. Beispiel in Abschnitt 5.2</span><br> <br> <span style="font-size: 10pt;line-height: 1.5;">Der privater Schlüssel muss zufällig und gleichverteilt aus {1, …, q-1} gewählt werden. (q ist die Ordnung des Basispunkts und ceil(log<sub>2</sub> q)=256 ).</span><br> </td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_59">Aktuell werden in der TI CRLs ausschließlich im Rahmen des IPsec-Verbindungsaufbaus (Verbindung der Konnektoren in die TI) verwendet.</p>
  <p id="polarion_61">Für die maximale Gültigkeitsdauer der Zertifikate gilt die Anforderung [GS-A_3080].</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124725">
   <p><b>A_22220</b></p>
   <p>Ein Konnektor KANN bei einer Zertifikatsprüfung alle im SOGIS-Katalog [SOGIS-2020] als zulässig aufgeführten kryptographischen Signaturverfahren inkl. der dem jeweiligen Verfahren zugehörigen Domainparametern (Mindestschlüssellängen, Kurvenparameter etc.) für eine Zertifikatsprüfung verwenden<span style="font-size: 10pt;line-height: 1.5;">, sofern die Angaben aus [gemSpec_Krypt#Tab_KRYPT_002 und _002a (und auch _003 und _003a)] als Mindestvorgaben (Mindestschlüssellängen, Mindestgrößen der Kurvenparameter etc.) eingehalten werden.&nbsp;</span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_386"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-102837">
   <p><b>A_19073</b></p>
   <p>Die Anbieter CVC-TSP eGK, Anbieter HBA und Anbieter SMC-B MÜSSEN CV-Zertifikate tagesgenau in der Laufzeit auf die am kürzest gültigen X.509-Zertifikate der "Schlüsselgeneration ECDSA" der Karte beschränken.<br> Sind keine X.509-Zertifikate der "Schlüsselgeneration ECDSA" auf der Karte vorgesehen, dann MUSS die Laufzeit auf die am kürzest gültigen X.509-Zertifikate der "Schlüsselgeneration RSA" der Karte beschränkt werden. <b>&lt;=</b></p>
  </div>
  <p id="polarion_133"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-103083">
   <p><b>A_19173</b></p>
   <p>Der Anbieter HBA, Anbieter SMC-B und der Anbieter X.509 TSP eGK MÜSSEN alle X.509-Zertifikate der "Schlüsselgeneration ECDSA" der Karte tagesgenau in der Laufzeit auf die der am längsten gültigen CV-Zertifikate der Karte beschränken. Sind keine X.509-Zertifikate der "Schlüsselgeneration ECDSA" auf der Karte vorgesehen, dann MUSS die Laufzeit aller X.509-Zertifikate der "Schlüsselgeneration RSA" der Karte tagesgenau in der Laufzeit auf die der am längsten gültigen CV-Zertifikate der Karte beschränkt werden. <b>&lt;=</b></p>
  </div>
  <p id="polarion_232">Hinweis: "Tagesgenau"&nbsp;bedeutet, dass der Zeitpunkt sich nicht im Kalenderdatum, jedoch in der Uhrzeit unterscheiden darf.&nbsp;</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133686">
   <p><b>A_23139</b></p>
   <p>Ein TSP-X.509-nonQES, der nicht die X.509-Root-CA der TI ist, MUSS sicherstellen, dass<br> 
    <ol> 
     <li>ein öffentlicher ECC-Schlüssel im CA-Zertifikat,</li> 
     <li>die öffentlichen ECC-Schlüssel der zum CA-Zertifikat aus (1) zugehörigen OCSP-Zertifikate (vgl. [RFC-6960#4.2.2.2] bzw. A_23142), und</li> 
     <li>die öffentlichen ECC-EE-Schlüssel in den EE-Zertifikate, die durch die CA mit dem Schlüssel aus (1) prüfbar sind,</li> 
    </ol> die gleichen Kurvenparameter (brainpoolP256r1, P-256 etc. vgl. [gemSpec_Krypt#Tab_KRYPT_002a]) besitzen.<span style="background-color: #FFFF99;"><br> </span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_185">Verständnishinweis:</p>
  <p id="polarion_377"> Die Chipkarten der TI verwenden für ihre ECC-EE-Schlüssel alle die Kurvenparameter brainpoolP256r1. Dies ist in den Objektsystem-Spezifikationen (und damit auch den Objektsystemen) der Chipkarten fixiert. Die CA-en, die EE-Zertifikate für diese Chipkarten bestätigen, müssen n<span style="background-color: #FFFFFF;">ach A_23139-* ebe</span>nfalls ein ECC-Schlüsselpaar auf Basis von&nbsp;brainpoolP256r1 verwenden. </p>
  <p id="polarion_378"> Die Komponenten-PKI der TI besitzt mehrere CA-Zertifikate. Es gibt mindestens ein CA-Zertifikat, das für die Prüfung der ECC-EE-Zertifikate von SMC-K, SMC-KT und der meisten Fachdienste verwendet wird. Dieses CA-Zertifikat verwendet ebenfalls als öffentlichen Prüfschlüssel ein Schlüssel auf brainpoolP256r1-Basis <span style="background-color: #FFFFFF;">(A_23139-*)</span>. </p>
  <p id="polarion_379">Für bestimmte Fachdienste, die zukünftig direkt von einen Primärsystem per TLS erreichbar sein sollen, sollen TLS-Zertifikate in der Komponenten-PKI der TI erzeugt werden können, die anstatt brainpool-Kurvenpunkte (brainpoolP256r1) NIST-Kurvenpunkte (P-256) als öffentliche Schlüssel enthalten. Grund dafür ist die deutlich bessere Unterstützung der NIST-Kurvenparameter durch verschiedene Standard-Kryptographie-Softwarebibliotheken.</p>
  <p id="polarion_380">Es gibt in der Komponenten-PKI mindestens ein CA-Zertifikat, dessen öffentlicher ECC-Schlüssel NIST-kurvenbasiert ist.&nbsp;Falls ein Fachdienst einen CSR mit einen NIST-Kurvenpunkt als öffentlichen Schlüssel einreicht bei der Komponenten-PKI, dann wird dieser unter der CA bestätigt, die NIST-kurvenbasiert ist.</p>
  <p id="polarion_381">In der Regel werden X.509-Root-CA-Zertifikate (RCA7 etc.) NIST-kurvenbasiert sein. Damit kann ein PVS mit einer Kryptographie-Softwarebibliothek ohne brainpool-Kurvenunterstützung&nbsp;mit solch einem Root-CA-Zertifikat die komplette Zertifikatskette bis zum Fachdienst prüfen.</p>
  <p id="polarion_424">Für die X.509-Root-CA gilt A_23139-* absichtlich nicht.</p>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-7857">2.1.1.2 Qualifizierte elektronische Signaturen</h5>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-137573">
   <p><b>GS-A_4358-01</b></p>
   <p>Alle Produkttypen, die X.509-Identitäten für die Erstellung oder Prüfung von qualifizierten elektronischen Signaturen verwenden, MÜSSEN mindestens alle in Tabelle Tab_KRYPT_003 aufgeführten Algorithmen unterstützen und die Tabellenvorgaben erfüllen.&nbsp;&nbsp;&nbsp;&nbsp;<br>TSP-X.509-QES, die qualifizierte Zertifikate (X.509-Identitäten) auf Basis der Schlüsselgeneration „ECDSA“ (vgl. Abschnitt 5.1) erstellen oder verwenden MÜSSEN die in Tab_KRYPT_003a aufgeführten Algorithmen und die Tabellenvorgaben erfüllen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_64" class="polarion-rte-caption-paragraph"></p>
  <p id="polarion_65" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">4</span>: Tab_KRYPT_003 Algorithmen für X.509-Identitäten zur Erstellung qualifizierter elektronischer Signaturen für die Schlüsselgeneration „RSA“ </p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=15" style="width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 108pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Anwendungsfälle</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 238pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Vorgaben</span><br> </th> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 108pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Signatur des VDA-Zertifikats</span><br> </td> 
     <td style="vertical-align: top;width: 329pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Nachdem die eIDAS-Verordnung das Signaturgesetz vollständig abgelöst hat, steht es einem VDA frei zu entscheiden welche Signatur (bspw. signiert von einer beliebigen VDA-internen CA) sein VDA-Zertifikat haben soll. Insbesondere kann die Signatur mit einem Nicht-RSA-Verfahren erstellt werden.</span><br> <span style="font-size: 10pt;line-height: 1.5;">Eine auswertende Komponente muss mit beliebigen (also auch nicht-RSA basierten) Signaturen eines VDA-Zertifikats umgehen können (bspw. Signatur des VDA-Zertifikats nicht auswerten, Authentizität und Integrität des Zertifikats wird über die Vertrauensliste sichergestellt).</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 108pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Art und Kodierung des öffentlichen EE-Schlüssels</span><br> </td> 
     <td style="vertical-align: top;width: 238pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="text-decoration: underline;font-size: 10pt;color: #000000;line-height: 1.5;">RSA-Signaturvariante:</span><br> <span style="font-weight: bold;font-size: 10pt;color: #000000;line-height: 1.5;">Entweder</span><br> <span style="font-size: 10pt;color: #000000;line-height: 1.5;">OID 1.2.840.113549.1.1.1 (rsaEncryption)</span><br> <span style="font-size: 10pt;color: #000000;line-height: 1.5;">(zulässig bis gemäß [SOG-IS-2020])&nbsp;</span><br> <span style="font-weight: bold;font-size: 10pt;color: #000000;line-height: 1.5;">oder</span><br> <span style="font-size: 10pt;color: #000000;line-height: 1.5;">OID 1.2.840.113549.1.1.10 (id-RSASSA-PSS) [RFC-5756].</span><br> <span style="font-size: 10pt;line-height: 1.5;">&nbsp;(zulässig bis gemäß [SOG-IS-2020])<br> </span><br> <span style="font-size: 10pt;color: #000000;line-height: 1.5;">Die Auswahl obliegt dem EE-Zertifikatsausgebenden VDA.</span><br> <br> <span style="text-decoration: underline;font-size: 10pt;color: #000000;line-height: 1.5;">RSA-Schlüssellänge:</span><br> <span style="font-size: 10pt;color: #000000;line-height: 1.5;">zu verwendende Schlüssellänge: 2048 Bit, zulässig</span> <span style="font-size: 10pt;color: #000000;line-height: 1.5;">bis vgl. Angabe in [SOG-IS-2020]</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 108pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Signatur eines</span><br> <span style="font-size: 10pt;line-height: 1.5;">Zertifikats,</span><br> <span style="font-size: 10pt;line-height: 1.5;">Signatur einer OCSP-Response oder</span><br> <span style="font-size: 10pt;line-height: 1.5;">Signatur eines OCSP-Responder-Zertifikates</span><br> </td> 
     <td style="vertical-align: top;width: 238pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Entweder</span><br> <span style="font-size: 10pt;line-height: 1.5;">sha256withRSAEncryption (OID 1.2.840.113549.1.1.11)</span><br> <span style="font-size: 10pt;color: #000000;line-height: 1.5;">(zulässig bis gemäß [SOG-IS-2020])</span><br> <span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">oder</span><br> <span style="font-size: 10pt;color: #000000;line-height: 1.5;">id-RSASSA-PSS (1.2.840.113549.1.1.10) [RFC-5756]</span><br> <span style="font-size: 10pt;color: #000000;line-height: 1.5;">(zulässig bis gemäß [SOG-IS-2020])</span><br> <br> <span style="font-size: 10pt;line-height: 1.5;">zu verwendende Schlüssellänge: 2048 Bit, zulässig bis vgl. Angabe in [SOG-IS-2020]</span><br> <br> <span style="font-size: 10pt;line-height: 1.5;">Die Hashfunktion für die Hashwertberechnung der TBSCertificate-Datenstruktur MUSS eine nach [SOG-IS-2020] zulässige Hashfunktion („Agreed Hash Function“) sein. Als Hashfunktion SOLL SHA-256 [FIPS-180-4] verwendet werden.</span><br> <span style="font-size: 10pt;line-height: 1.5;">Als MGF MUSS MGF1 [PKCS#1] verwendet werden. Die innerhalb der MGF1 verwendete Hashfunktion MUSS die gleiche Hashfunktion sein, wie die Hashfunktion der Hashwertberechnung der TBSCertificate-Datenstruktur. (Dies entspricht der Empfehlung aus [RFC-5756] bzw. [RFC-4055, 3.1] und dient der Komplexitätsreduktion.)</span><br> <span style="font-size: 10pt;line-height: 1.5;">Die Saltlänge MUSS mindestens 256 Bit betragen.(Die Maximallänge des Salts ergibt sich nach [PKCS#1] in Abhängigkeit von der Länge des Moduls.)</span><br> </td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_67" class="polarion-rte-caption-paragraph"></p>
  <p id="polarion_68" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">5</span>: Tab_KRYPT_003a Algorithmen für X.509-Identitäten zur Erstellung qualifizierter Signaturen für die Schlüsselgeneration „ECDSA“ </p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=16" style="width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 105pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Anwendungsfall</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 163pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Vorgabe</span><br> </th> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 105pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Signatur des VDA-Zertifikats</span><br> </td> 
     <td style="vertical-align: top;width: 340pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Nachdem die eIDAS-Verordnung das Signaturgesetz vollständig abgelöst hat, steht es einem VDA frei zu entscheiden welche Signatur (bspw. signiert von einer beliebigen VDA-internen CA) sein VDA-Zertifikat haben soll. Insbesondere kann die Signatur mit einem Nicht-ECDSA-Verfahren erstellt werden.</span><br> <span style="font-size: 10pt;line-height: 1.5;">Eine auswertende Komponente muss mit beliebigen (also auch nicht-ECDSA basierten) Signaturen eines VDA-Zertifikats umgehen können (bspw. Signatur des VDA-Zertifikats nicht auswerten, Authentizität und Integrität des Zertifikats wird über die Vertrauensliste sichergestellt).</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 105pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Art und Kodierung des öffentlichen</span><br> <span style="font-size: 10pt;line-height: 1.5;">EE-Schlüssels</span><br> </td> 
     <td style="vertical-align: top;width: 163pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">ecPublicKey {OID 1.2.840.10045.2.1}</span><br> <span style="font-size: 10pt;line-height: 1.5;">auf der Kurve brainpoolP256r1 [RFC-5639#3.4, brainpoolP256r1]</span><br> <span style="font-size: 10pt;line-height: 1.5;">(zulässig bis gemäß [SOG-IS-2020])</span><br> <br> <span style="font-size: 10pt;line-height: 1.5;">Die Kodierung des öffentlichen Punkt erfolgt nach [RFC5480, Abschnitt 2], vgl. Beispiel in Abschnitt 5.2). Der private Schlüssel muss zufällig und gleichverteilt aus {1, …, q-1} gewählt werden. (q ist die Ordnung des Basispunkts und ceil(log<sub>2</sub> q)=256 ).</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 105pt;height: 80pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Signatur eines</span><br> <span style="font-size: 10pt;line-height: 1.5;">Zertifikats,</span><br> <span style="font-size: 10pt;line-height: 1.5;">Signatur einer OCSP-Response oder</span><br> <span style="font-size: 10pt;line-height: 1.5;">Signatur eines OCSP-Responder-Zertifikates</span><br> </td> 
     <td style="vertical-align: top;width: 163pt;height: 80pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">ecdsa-with-SHA256 [RFC-3279] {OID 1.2.840.10045.4.3.2}</span><br> <span style="font-size: 10pt;line-height: 1.5;">auf Kurve der brainpoolP256r1 [RFC-5639#3.4, brainpoolP256r1]</span><br> <span style="font-size: 10pt;line-height: 1.5;">(zulässig bis gemäß [SOG-IS-2020])</span><br> <br> <span style="font-size: 10pt;line-height: 1.5;">vgl. Beispiel in Abschnitt 5.2</span><br> </td> 
    </tr> 
   </tbody> 
  </table>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-7859">2.1.1.3 TLS-Authentifizierung</h5>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-137575">
   <p><b>GS-A_4359-02</b></p>
   <p>Alle Produkttypen, die X.509-Identitäten für eine TLS-Authentifizierung verwenden, MÜSSEN alle in Tab_KRYPT_002 aufgeführten Algorithmen unterstützen und die Tabellenanforderungen erfüllen.&nbsp;&nbsp;&nbsp;&nbsp;<br>Produkttypen die Zertifikate (X.509-Identitäten) auf Basis der Schlüsselgeneration „ECDSA“ ausstellen (vgl. Abschnitt 5.1) oder verwenden, MÜSSEN die in Tab_KRYPT_002a aufgeführten Algorithmen und die Tabellenvorgaben erfüllen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-126196">
   <p><b>A_22457</b></p>
   <p>Alle Produkttypen, die als TLS-Client gegenüber dem eHealth-Kartenterminal agieren, DÜRFEN bei beidseitig authentisierten TLS-Verbindungen NICHT Ciphersuiten mit Authentisierungsalgorithmen (RSA bzw. ECDSA) anbieten, wenn sie nicht auch für die Clientauthentisierung Schlüsselmaterial und Zertifikat für diese Authentisierungsalgorithmen besitzen.&nbsp; <b>&lt;=</b></p>
  </div>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-7861">2.1.1.4 IPsec-Authentifizierung</h5>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-137576">
   <p><b>GS-A_4360-01</b></p>
   <p>Alle Produkttypen, die X.509-Identitäten für eine IPsec-Authentifizierung verwenden, MÜSSEN alle in Tab_KRYPT_002 aufgeführten Algorithmen unterstützen und die Tabellenanforderungen erfüllen.&nbsp;&nbsp;&nbsp;&nbsp;<br>Produkttypen die Zertifikate (X.509-Identitäten) auf Basis der Schlüsselgeneration „ECDSA“ ausstellen (vgl. Abschnitt 5.1) oder verwenden, MÜSSEN die in Tab_KRYPT_002a aufgeführten Algorithmen und die Tabellenvorgaben erfüllen. <b>&lt;=</b></p>
  </div>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-7863">2.1.1.5 Digitale Signaturen durch TI-Komponenten</h5>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-137578">
   <p><b>GS-A_4361-02</b></p>
   <p>Alle Produkttypen, die X.509-Identitäten verwenden, die zur Erstellung und Prüfung digitaler Signaturen in Bezug auf TI-Komponenten (technische X.509-Zertifikate) genutzt werden, MÜSSEN alle in Tab_KRYPT_002 aufgeführten Algorithmen unterstützen und die Tabellenanforderungen erfüllen.&nbsp;&nbsp;&nbsp;&nbsp;<br>Produkttypen die Zertifikate (X.509-Identitäten) auf Basis der Schlüsselgeneration „ECDSA“ ausstellen (vgl. Abschnitt 5.1) oder verwenden, MÜSSEN die in Tab_KRYPT_002a aufgeführten Algorithmen und die Tabellenvorgaben erfüllen. <b>&lt;=</b></p>
  </div>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-7865">2.1.1.6 Verschlüsselung</h5>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-137580">
   <p><b>GS-A_4362-02</b></p>
   <p>Alle Produkttypen, die X.509-Identitäten für die Verschlüsselung (Verschlüsselungszertifikate) verwenden, MÜSSEN alle in Tab_KRYPT_002 aufgeführten Algorithmen unterstützten und die Tabellenanforderungen erfüllen.&nbsp;&nbsp;&nbsp;&nbsp;<br>Produkttypen die Zertifikate (X.509-Identitäten) auf Basis der Schlüsselgeneration „ECDSA“ ausstellen (vgl. Abschnitt 5.1) oder verwenden, MÜSSEN die in Tab_KRYPT_002a aufgeführten Algorithmen und die Tabellenvorgaben erfüllen. <b>&lt;=</b></p>
  </div>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-7867">2.1.2 CV-Identitäten</h4>
  <p id="polarion_74">CV-Identitäten werden für die Authentifizierung zwischen Karten verwendet.</p>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-7872">2.1.2.1 CV-Zertifikate G2</h5>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-137582">
   <p><b>GS-A_4365-02</b></p>
   <p>Alle Produkttypen, die CV-Zertifikate der Kartengeneration G2 erstellen oder prüfen, MÜSSEN die in Tab_KRYPT_006 aufgeführten Algorithmen verwenden und die Tabellenanforderungen erfüllen.<br> <b>&lt;=</b></p>
  </div>
  <p id="polarion_76" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">6</span>: Tab_KRYPT_006 Algorithmen für CV-Zertifikate </p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=10" style="width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 122pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Algorithmen Typ</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 188pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Algorithmus</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 137pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Schlüssellänge</span><br> </th> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 122pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">über das Zertifikat bestätigtes Schlüsselpaar</span><br> </td> 
     <td style="vertical-align: top;width: 188pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Authentisierung ohne Sessionkey-Aushandlung</span><br> <span style="font-size: 10pt;line-height: 1.5;">[RFC-5639#3.4, brainpoolP256r1]</span><br> <span style="font-size: 10pt;line-height: 1.5;">ecdsa-with-SHA256</span><br> <span style="font-size: 10pt;line-height: 1.5;">{OID 1.2.840.10045.4.3.2}</span><br> <br> <span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Authentisierung mit Sessionkey-Aushandlung</span><br> <span style="font-size: 10pt;line-height: 1.5;">[RFC-5639#3.4, brainpoolP256r1]</span><br> <span style="font-size: 10pt;line-height: 1.5;">authS_gemSpec-COS-G2_ecc-with-sha256</span><br> <span style="font-size: 10pt;line-height: 1.5;">{OID 1.3.36.3.5.3.1}</span><br> </td> 
     <td style="vertical-align: top;width: 137pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">256 Bit bis Ende 2029+<span id="polarion-comment:522"></span></span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 122pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Signatur des Endnutzerzertifikats</span><br> </td> 
     <td style="vertical-align: top;width: 188pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-5639#3.4, brainpoolP256r1]</span><br> <span style="font-size: 10pt;line-height: 1.5;">ecdsa-with-SHA256</span><br> <span style="font-size: 10pt;line-height: 1.5;">{OID 1.2.840.10045.4.3.2}</span><br> </td> 
     <td style="vertical-align: top;width: 137pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">256 Bit bis Ende 2029+</span><br> </td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_91">Für die maximale Gültigkeitsdauer der Zertifikate gilt die Anforderung [GS-A_3080].</p>
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-7874">2.1.2.2 CV-Certification-Authority (CV-CA) Zertifikat G2</h5>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-137584">
   <p><b>GS-A_4366-02</b></p>
   <p>Alle Produkttypen, die CV-CA-Zertifikate der Kartengeneration G2 erstellen oder prüfen, MÜSSEN dien Tab_KRYPT_007 aufgeführten Algorithmen verwenden und die Tabellenanforderungen erfüllen.<br> <b>&lt;=</b></p>
  </div>
  <p id="polarion_77" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">7</span>: Tab_KRYPT_007 Algorithmen für CV-CA-Zertifikate </p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=11" style="width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 195px;height: 5px;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Algorithmen Typ</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 302px;height: 5px;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Algorithmus</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 217px;height: 5px;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Schlüssellänge</span><br> </th> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 195px;height: 27pt;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">über das Zertifikat bestätigtes Schlüsselpaar</span><br> </td> 
     <td style="vertical-align: top;width: 302px;height: 27pt;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-5639#3.4, brainpoolP256r1]</span><br> <span style="font-size: 10pt;line-height: 1.5;">ecdsa-with-SHA256</span><br> <span style="font-size: 10pt;line-height: 1.5;">{OID 1.2.840.10045.4.3.2}</span><br> </td> 
     <td style="vertical-align: top;width: 217px;height: 27pt;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">256 Bit bis Ende 2029+<span id="polarion-comment:523"></span></span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 195px;height: 35pt;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Signatur des CA-Zertifikates</span><br> </td> 
     <td style="vertical-align: top;width: 302px;height: 35pt;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-5639#3.4, brainpoolP256r1]</span><br> <span style="font-size: 10pt;line-height: 1.5;">ecdsa-with-SHA256</span><br> <span style="font-size: 10pt;line-height: 1.5;">{OID 1.2.840.10045.4.3.2}</span><br> </td> 
     <td style="vertical-align: top;width: 217px;height: 35pt;border: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">256 Bit bis Ende 2029+</span><br> </td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_96">Für die maximale Gültigkeitsdauer der Zertifikate gilt die Anforderung [GS-A_3080].</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7876">2.2 Zufallszahlengeneratoren</h3>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7877">
   <p><b>GS-A_4367</b></p>
   <p>Alle Produkttypen, die Zufallszahlen generieren, MÜSSEN die Anforderungen aus [BSI-TR-03116-1#3.<span style="text-decoration: line-through;background-color: #FFFF99;"></span>8 Erzeugung von Zufallszahlen] erfüllen.<br> <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7878">2.3 Hilfestellung bei der Umsetzung (Zufallsgeneratoren)</h3>
  <p id="polarion_14">(Hinweis: dies ist das ehemalige „Kapitel 5.2.4 Hilfestellung bei der Umsetzung der Anforderungen“. Der Text in diesem Abschnitt entstand in enger Abstimmung mit dem BSI auf Gesellschafterwunsch.)</p>
  <p id="polarion_98">Die Sicherheit eines deterministischen Zufallszahlengenerators (DRNGs) hängt maßgeblich von drei Faktoren ab:</p>
  <ul id="polarion_99"> 
   <li>von der Entropie des Seeds,</li> 
   <li>vom algorithmischen Anteil (generelles Design) und</li> 
   <li>dem Schutz des inneren Zustands (und der zur Ausgabe vorgesehenen Zufallszahlen).</li> 
  </ul>
  <p id="polarion_100">Der Nachweis, dass der algorithmische Anteil eines DRNGs den Anforderungen einer bestimmten Funktionalitätsklasse genügt, kann schwierig und aufwändig sein. Deshalb wurde das BSI gebeten, die DRNGs in [FIPS-186-2+CN1] und [ANSI-X9.31] in Bezug auf die kryptographische Güte ihres algorithmischen Anteils zu bewerten.</p>
  <p id="polarion_101">Das Ergebnis ist:</p>
  <p id="polarion_102"> A) [FIPS-186-2+CN1]: Lässt man in dem DRNG aus Appendix 3.1 (S. 16f.) in Schritt 3c bzw. in dem DRNG aus Algorithmus 1 (Change Notice 1, S. 72f.) in Schritt 3.3 den Term "mod q" weg, so werden gleich verteilt 160-Bit Zufallszahlen bzw. 320-Bit Zufallszahlen erzeugt (vgl. Abschnitt „General Purpose Random Number Generation“ (Change Notice 1, S. 74)).&nbsp;&nbsp;&nbsp;&nbsp;<br> Beide DRNGs sind dann </p>
  <ol id="polarion_103"> 
   <li>algorithmisch geeignet für die Klasse K4 [AIS-20-1999] und</li> 
   <li>erfüllen die algorithmischen Anforderungen aus DRG.3 [AIS-20].</li> 
  </ol>
  <p id="polarion_104">Ob eine konkrete Implementierung eines dieser DRNG bspw. Teil der Klasse DRG.3 ist, bleibt im Einzelfall zu prüfen, da dazu u. a. auch Fragen über die Initialisierung zu beantworten sind (vgl. (DRG.3.1) [KS-2011]).</p>
  <p id="polarion_105">Das BSI empfiehlt bei den Zufallsgeneratoren aus [FIPS-186-2+CN1] nach Möglichkeit SHA-256 [FIPS-180-4] anstatt SHA-1 zu verwenden. Folgt man der Empfehlung, so ist der Algorithmus dementsprechend zu adaptieren.</p>
  <p id="polarion_106">B) [ANSI-X9.31]: Der Zufallsgenerator aus Appendix A.2.4 ist</p>
  <p id="polarion_107">(1) algorithmisch geeignet für die Klasse K3 [AIS-20-1999] und</p>
  <p id="polarion_108">(2) erfüllt die algorithmischen Anforderungen aus DRG.2 [AIS-20].</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7879">2.4 Schlüsselerzeugung und Schlüsselbestätigung</h3>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7880">
   <p><b>GS-A_4368</b></p>
   <p>Alle Produkttypen, die Schlüssel erzeugen, MÜSSEN die Anforderungen aus [BSI-TR-03116-1#3.<span style="text-decoration: line-through;background-color: #FFFF99;"></span>9 Schlüsselerzeugung] erfüllen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_110"> <span style="font-style: italic;font-size: 10pt;line-height: 1.5;">Hinweis: im Rahmen der Sicherheitszertifizierung von Komponenten, wie bspw. des Konnektors, wird dies überprüft.</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7881">
   <p><b>GS-A_5021</b></p>
   <p><p style="margin-left: 0px;"><span>Ein Herausgeber von Sicherheitsmodulen für kryptographisches Schlüsselmaterial, welche in der TI genutzt werden (also bspw. eGK, SMC-B, HSM-B, SMC-KT und HBA), MUSS sicherstellen, dass auf dem Sicherheitsmodul gespeicherten Schlü</span><span>s</span><span>sel die Anforderungen aus [BSI-TR-03116-1#3.5 Schlüsse</span><span>l</span><span>erzeugung] erfüllen.</span></p> <b>&lt;=</b></p>
  </div>
  <p id="polarion_112"> <span style="font-style: italic;font-size: 10pt;line-height: 1.5;">Hinweis: Dies ist eine Anforderung an Kartenherausgeber, die so sicherstellen müssen, dass das in den Sicherheitsmodulen (also auch HSM-B) zur Verfügung stehende kryptographische Schlüsselmaterial geeignet ist Daten mit sehr hohem Schutzbedarf schützen zu können. (siehe auch Kapitel 4.4)</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7882">
   <p><b>GS-A_5338</b></p>
   <p>
    <div style="margin-left: 40px;"></div>Ein Kartenherausgeber oder, falls der Kartenherausgeber einen Dritten mit der Kartenpersonalisierung beauftragt, der Kartenpersonalisierer für HBA oder SMC-B MUSS sicherstellen, dass bei der Personalisierung der Karten HBA und SMC-B alle asymmetrischen Schlüsselpaare, bei denen die privaten Schlüssel auf der Karte gespeichert werden, auf der Karte erzeugt werden. <br> <b>&lt;=</b></p>
  </div>
  <p id="polarion_114">Aufgrund des geringeren Mengengerüsts bei HBA und SMC-B ist dort die On-Card-Generierung der entsprechenden Schlüsselpaare möglich. Somit (vgl. auch [PP-0082, FPT_EMS.1] ist technisch sichergestellt, dass keine Kopie der privaten Schlüssel außerhalb der Chipkarte existiert (Kontext: Ende-zu-Ende-Verschlüsselung von medizinischen Daten).</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7883">
   <p><b>GS-A_5386</b></p>
   <p>Ein Kartenherausgeber, der G2-Karten herausgibt, MUSS sicherstellen, dass bei der Personalisierung der Karten alle für eine Karte zu personalisierenden privaten und geheimen Schlüssel kartenindividuell sind. Bei Beauftragung eines Dritten mit der Schlüsselerzeugung ist dies durch den Dritten sicherzustellen.&nbsp;&nbsp;&nbsp;&nbsp;<br> Falls symmetrische Schlüssel (bspw. SK.CMS.AES128) nicht pro Karte zufällig erzeugt werden, sondern mit einem Schlüsselableitungsverfahren erzeugt werden, so MUSS der Kartenherausgeber sicherstellen, dass<br> 
    <ol> 
     <li>das verwendete Schlüsselableitungsverfahren (KDF) unumkehrbar und nicht-vorhersagbar ist (Hilfestellung: Beispiele in [gemSpec_Krypt, 2.4 und 3.4]).<br> </li> 
     <li>der Masterkey (Key Derivation Key (KDK)) GS-A_4368 erfüllt (insbesondere Entropie-Vorgaben). Der KDK MUSS eine Mindestentropie von 120 Bit besitzen. <br> </li> 
    </ol> <b>&lt;=</b></p>
  </div>
  <p id="polarion_116">Für private Schlüssel bei HBA und SMC-B wird die kartenindividuelle Erzeugung und Personalisierung durch GS-A_5338 technisch sichergestellt. Je nach verwendetem COS, insbesondere dessen spezifischen Personalisierungsverfahrens, kann es sein, dass ein Kartenherausgeber symmetrische Schlüssel aus technischen Gründen personalisieren muss, obwohl er später nicht plant mit diesen Schlüsseln bspw. im Rahmen eines CMS zu arbeiten. Es ist sicherheitskritisch, dass auch diese symmetrischen Schlüssel ebenfalls die Anforderungen GS-A_5021 bzw. GS-A_4368 erfüllen.</p>
  <p id="polarion_117">Als geeignete Schlüsselableitungsverfahren (KDF) für die Erzeugung von kartenindividuellen Schlüssel sind bspw. folgende Verfahren geeignet:</p>
  <ul id="polarion_118"> 
   <li>alle Verfahren aus [NIST-SP-800-108] mittels CMAC [NIST-SP-800-38B],</li> 
   <li>alle Verfahren aus [NIST-SP-800-56-A] bzw. [NIST-SP-800-56-B] mittels jeder nach [BSI-TR-03116-1] zulässigen Hashfunktion,</li> 
   <li>alle Verfahren aus [NIST-SP-800-56C] mittels CMAC [NIST-SP-800-38B] oder eines HMAC, der auf einer nach [BSI-TR-03116-1] zulässigen Hashfunktion basiert,</li> 
   <li>das Verfahren nach [ANSI-X9.63, Abschnitt 5.6.3] mittels jeder nach [BSI-TR-03116-1] zulässigen Hashfunktion.</li> 
  </ul>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-94319">2.4.1 Prüfung auf angreifbare (schwache) Schlüssel</h4>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-93447">
   <p><b>A_17294</b></p>
   <p>Ein TSP-X.509-nonQES MUSS vor einer Zertifikatserzeugung den durch das Zertifikat zu bestätigenden öffentlichen Schlüssel auf dessen kryptographische Angreifbarkeit hin prüfen.&nbsp;<br> Falls die Prüfung des öffentlichen Schlüssels das Ergebnis „angreifbar“ liefert, so MUSS der TSP die Zertifikatserstellung für diesen Schlüssel ablehnen.&nbsp;<br> Mindestumfang der Prüfung MÜSSEN&nbsp; 
    <ol> 
     <li>der Test auf die "Debian-OpenSSL-PRNG-Schwachstelle" und</li> 
     <li>der Test auf die Anfälligkeit gegen den ROCA-Angriff sein.&nbsp;</li> 
    </ol> Der TSP MUSS den Mindestumfang der Prüfung bei Bekanntwerden neuer Angriffsmöglichkeiten gemäß [gemSpec_DS_Anbieter#GS-A_5560] erweitern. <b>&lt;=</b></p>
  </div>
  <p id="polarion_183"> TSPs,&nbsp;die&nbsp;im&nbsp;Internet TLS-Zertifikate ausgeben (bspw. für&nbsp;die&nbsp;Verwendung von&nbsp;HTTPS),&nbsp;müssen&nbsp;aufgrund&nbsp;der Baseline&nbsp;Requirement&nbsp;des CA/Browser Forums&nbsp;(<a href="https://cabforum.org/baseline-requirements-documents/" target="_top" class="descriptionLink">https://cabforum.org/baseline-requirements-documents/</a>&nbsp;) vor der Zertifikatserzeugung kryptographische Prüfungen des zu bestätigenden öffentlichen Schlüssels durchführen. Analog&nbsp;gilt dies mit <span class="polarion-rte-link" data-type="crossReference" id="fake" data-custom-label="A_17294" data-item-id="ML-93447" data-option-id="custom"></span>&nbsp; auch für TI-TSPs. Die gematik stellt auf Anfrage eine Beispielimplementierung für die Tests des Mindestumfangs bereit.&nbsp; </p>
  <p id="polarion_85"> Unter&nbsp;<a href="https://security.googleblog.com/2022/08/announcing-open-sourcing-of-paranoids.html" target="_top" class="descriptionLink">https://security.googleblog.com/2022/08/announcing-open-sourcing-of-paranoids.html</a>&nbsp;ist eine Vielzahl von Schlüsseltests als OpenSource verfügbar. </p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-92592">2.4.2 ECC-Schlüssel in X.509-Zertifikaten</h4>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7976">
   <p><b>GS-A_5518</b></p>
   <p><p style="margin-left: 0px;"><span>Alle Produkttypen, die X.509-Zertifikate erstellen und dabei öffentliche Punkte auf einer elliptischen Kurve in diesen Zertifikaten bestätigen, MÜSSEN überprüfen, ob die zu bestätigenden Punkte auch auf der zugehörigen Kurve (im Regelfall brai</span><span>n</span><span>poolP256r1 [RFC-5639#3.4]) liegen. Falls nein, MUSS der Produkttyp eine Zertif</span><span>i</span><span>katsausstellung ve</span><span>r</span><span>weigern. </span></p> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-92600">
   <p><b>A_17091</b></p>
   <p>Ein TSP-X.509-nonQES MUSS sicherstellen, dass wenn er ECC-Schlüssel für eine Zertifikatserstellung erhält, diese in unkomprimierter Form (d. h. explizite Aufführung der vollständigen x- und y-Koordinaten [BSI-TR-03111#Abschnitt 3.2.1 "Uncompressed Encoding"]) vom Antragsteller übergeben werden. <br> <b>&lt;=</b></p>
  </div>
  <p id="polarion_149">Hinweis: Diese Kodierungsform (uncompressed encoding) ist auch die Form, wie sie letztendlich in den X.509-Zertifikaten verwendet wird. Weiterhin kann ein TSP in dieser Form mit der Prüfung aus GS-A_5518 sicherstellen, dass keine Fehlkodierung des zu bestätigenden ECC-Schlüssels aufgetreten ist.</p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-92593">2.4.3 RSA-Schlüssel in X.509-Zertifikaten</h4>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-92601">
   <p><b>A_17092</b></p>
   <p>Ein TSP KANN im Rahmen der Zertifikatsbeantragung, bei denen öffentliche RSA-Schlüssel bestätigt werden, folgende Tests auf die RSA-Schlüssel anwenden. Wenn ein u. g. Test das Ergebnis FAIL als Ergebnis liefert, so ist der Schlüssel fehlerhaft und der TSP muss die Zertifikatserstellung für diesen Schlüssel ablehnen.<br> 
    <ol>
     <li>Ist der öffentliche Exponent e (des untersuchten RSA-Schlüssels) prim und gilt 2^16&lt;e&lt;2^256 (vgl. [BSI-TR-03116-1#3.2 RSA])?<br> Falls nein, ist das Ergebnis FAIL.<br></li>
     <li>Ist der Modulus des untersuchten RSA-Schlüssels kleiner als 2^2048?<br> Falls nein, ist das Ergebnis FAIL.<br></li>
     <li>Ist der Modulus des untersuchten RSA-Schlüssels relativ prim zu allen Primzahlen kleiner als 100?<br> Falls nein, ist das Ergebnis FAIL.<br></li>
    </ol> <b>&lt;=</b></p>
  </div>
  <p id="polarion_174"> Erläuterungen zu <span class="polarion-rte-link" data-type="crossReference" id="fake" data-custom-label="A_17092" data-item-id="ML-92601" data-option-id="custom"></span>&nbsp;befinden sich in Abschnitt&nbsp;<span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-95000" data-option-id="shortoutline"></span>.&nbsp; </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-92602">
   <p><b>A_17093</b></p>
   <p>Ein TSP KANN im Rahmen der Zertifikatsbeantragung, bei denen öffentliche RSA-Schlüssel bestätigt werden, folgenden Test auf die RSA-Schlüssel anwenden. Wenn ein Test das Ergebnis FAIL liefert, so ist der Schlüssel fehlerhaft und der TSP muss die Zertifikatserstellung für diesen Schlüssel ablehnen.<br> 
    <ol> 
     <li>Ist die Entropie des kodierten RSA-Schlüssels (im Sinne von [gemSpec_Krypt#<span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-95000" data-option-id="shortoutline"></span>&nbsp;], entropy()-Funktion) kleiner als 6.72? Falls ja, so ist das Ergebnis FAIL.<br> </li> 
    </ol> <b>&lt;=</b></p>
  </div>
  <p id="polarion_176"> Erläuterungen zu&nbsp;<span class="polarion-rte-link" data-type="crossReference" id="fake" data-custom-label="A_17093" data-item-id="ML-92602" data-option-id="custom"></span>&nbsp;&nbsp;befinden sich in Abschnitt&nbsp;<span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-95000" data-option-id="shortoutline"></span>. </p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-134187">2.5 Einmalpasswörter</h3>
  <p id="polarion_422">Bei verschiedenen Registrierungs- oder Anmeldeprozessen werden Einmalpasswörter (insbesondere bei KIM) verwendet. Für diese Einmalpasswörter gilt folgende Vorgabe:</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-128514">
   <p><b>A_22686</b></p>
   <p>Alle Produkttypen, die Einmalpasswörter (One-Time-Passwords, OTP) erzeugen, MÜSSEN sicherstellen, dass diese Einmalpasswörter eine Mindestentropie von 120 Bit besitzen. D. h. sie werden zufällig erzeugt und sind mit praktischer Sicherheit - Wahrscheinlichkeit gleich 1 – 2^(–120)) - nicht erratbar. <b>&lt;=</b></p>
  </div>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-7886">3 Konkretisierung der Algorithmen für spezifische Einsatzszenarien</h2>
  <p id="polarion_122">In den nachfolgenden Abschnitten werden die kryptographischen Algorithmen für verschiedene Einsatzszenarien spezifiziert. In diesem Zusammenhang sind ausschließlich die kryptographischen Aspekte der Einsatzszenarien relevant.</p>
  <p id="polarion_123" style="text-align: center;"> <br> <img src="attachments/image5.png" style="width: 582px;height: 368px;"><br> </p>
  <p id="polarion_81" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">1</span>: Verwendung von Algorithmen nach Zonen und OSI-Schicht </p>
  <p id="polarion_125">Abbildung 1 stellt beispielhaft die für die Vertraulichkeit von medizinischen Daten relevanten Algorithmen auf den verschiedenen OSI-Schichten in einer Übersicht dar. Es besteht in dieser Abbildung kein Anspruch auf Vollständigkeit.</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7887">3.1 Kryptographische Algorithmen für XML-Dokumente</h3>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7888">
   <p><b>GS-A_4370</b></p>
   <p>Alle Produkttypen, die XML-Dokumente<br> 
    <ul> 
     <li>verschlüsseln, MÜSSEN dies mittels CMS <span style="text-decoration: line-through;"></span>[RFC-5652] oder XMLEnc durchführen,<br> </li> 
     <li>signieren, MÜSSEN dies mittels CMS <span style="text-decoration: line-through;"></span>[RFC-5652] oder XMLDSig durchführen. <br> </li> 
    </ul> <b>&lt;=</b></p>
  </div>
  <p id="polarion_127">XML-Signaturen sind bezüglich der verwendeten Algorithmen selbst beschreibend, die für die Erstellung einer Signatur verwendeten Algorithmen sind in der Signatur aufgeführt.</p>
  <p id="polarion_128">Zur vollständigen Spezifikation der Algorithmen für XML-Signaturen müssen für alle Signaturbestandteile Algorithmen spezifiziert werden. Die nachfolgenden Abschnitte wählen aus der Menge der zulässigen Algorithmen die jeweiligen Algorithmen für die einzelnen Einsatzszenarien aus.</p>
  <p id="polarion_129"> Die Referenzierung von Algorithmen in XML-Signaturen und XML-Verschlüsselungen erfolgt nicht wie in Zertifikaten oder Signaturen binärer Daten über OIDs sondern über URIs. Die URIs der Algorithmen dienen als eindeutige Identifier und nicht dazu, dass unter der jeweils angegebenen URI die Beschreibung zu finden ist.<br> </p>
  <p id="polarion_83" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">8</span>: Tab_KRYPT_008 Beispiele für solche Algorithmen-URIs </p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=18" style="width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 64%;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;"><span style="font-weight: bold;">Algorithmen Identifier</span><br> </span></th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 36%;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;"><span style="font-weight: bold;">Erläutert in</span><br> </span></th> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 64%;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;"><a href="http://www.w3.org/2001/04/xmlenc#aes256-cbc" target="_blank" class="descriptionLink">http://www.w3.org/2001/04/xmlenc#aes256-cbc</a><br> </span></td> 
     <td style="vertical-align: top;width: 36%;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[XMLEnc]<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 64%;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;"><a href="http://www.w3.org/2001/04/xmlenc#rsa-1_5" target="_blank" class="descriptionLink">http://www.w3.org/2001/04/xmlenc#rsa-1_5</a><br> </span></td> 
     <td style="vertical-align: top;width: 36%;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[XMLEnc]<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 64%;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;"><a href="http://www.w3.org/2001/04/xmlenc#sha256" target="_blank" class="descriptionLink">http://www.w3.org/2001/04/xmlenc#sha256</a><br> </span></td> 
     <td style="vertical-align: top;width: 36%;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[XMLDSig]<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 64%;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;"><a href="http://www.w3.org/2000/09/xmldsig#enveloped-signature" target="_blank" class="descriptionLink">http://www.w3.org/2000/09/xmldsig#enveloped-signature</a><br> </span></td> 
     <td style="vertical-align: top;width: 36%;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[XMLDSig]<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 64%;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;"><a href="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256" target="_blank" class="descriptionLink">http://www.w3.org/2001/04/xmldsig-more#rsa-sha256</a><br> </span></td> 
     <td style="vertical-align: top;width: 36%;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-4051] bzw. [RFC-6931]<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 64%;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;"><a href="http://www.w3.org/2001/10/xml-exc-c14n" target="_blank" class="descriptionLink">http://www.w3.org/2001/10/xml-exc-c14n#</a><br> </span></td> 
     <td style="vertical-align: top;width: 36%;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[XMLCan_V1.0]<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 64%;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;"><a href="http://www.w3.org/2009/xmlenc11#aes256-gcm" target="_blank" class="descriptionLink">http://www.w3.org/2009/xmlenc11#aes256-gcm</a><br> </span></td> 
     <td style="vertical-align: top;width: 36%;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[XMLEnc-1.1]<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 64%;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;"><a href="http://www.w3.org/2007/05/xmldsig-more#sha256-rsa-MGF1" target="_blank" class="descriptionLink">http://www.w3.org/2007/05/xmldsig-more#sha256-rsa-MGF1</a><br> </span></td> 
     <td style="vertical-align: top;width: 36%;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-6931]<br> </span></td> 
    </tr> 
   </tbody> 
  </table>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-7889">3.1.1 XML-Signaturen für nicht-qualifizierte Signaturen</h4>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-137586">
   <p><b>GS-A_4371-02</b></p>
   <p>Alle Produkttypen, die XML-Signaturen für nicht-qualifizierte Signaturen erzeugen oder prüfen, MÜSSEN die Algorithmen und Vorgaben der Tabelle Tab_KRYPT_009 erfüllen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_134"></p>
  <p id="polarion_89" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">9</span>: Tab_KRYPT_009 Algorithmen für die Erzeugung von nicht-qualifizierten elektronischen XML-Signaturen </p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=13" style="width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 93pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Signaturbestandteil</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 90pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Beschreibung</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 180pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Algorithmus</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 82pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Anmerkung</span><br> </th> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 93pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Signaturstandard</span><br> </td> 
     <td style="vertical-align: top;width: 90pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Signaturstandard</span><br> </td> 
     <td style="vertical-align: top;width: 180pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">ETSI TS 101 903 V1.4.2 (2010-12)</span><br> <span style="font-size: 10pt;line-height: 1.5;">Electronic Signatures and Infrastructures (ESI); XML Advanced Electronic Signatures (XAdES)</span><br> <span style="font-size: 10pt;line-height: 1.5;">[ETSI-XAdES]</span><br> </td> 
     <td style="vertical-align: top;width: 82pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Die Verwendung des Standards ist für die Signatur von XML-Dokumenten verpflichtend, die nicht über CMS [RFC-5652] signiert werden.</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 93pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">kryptographisches Signaturverfahren</span><br> </td> 
     <td style="vertical-align: top;width: 90pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Algorithmus für die Berechnung des Nachrichten-Digest (Hashwert des Dokuments) und die Signatur mit dem privaten Schlüssel</span><br> </td> 
     <td style="vertical-align: top;width: 180pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">RSASSA-PSS mit SHA-256</span><br> <span style="font-size: 10pt;line-height: 1.5;">bis Ende 2025&nbsp;<span id="polarion-comment:525"></span><br> <br> ECDSA mit SHA-256</span><br> bis Ende 2029+<br> <br> <span style="font-size: 10pt;line-height: 1.5;">(Hinweis: siehe Abschnitt 4.1)</span><br> </td> 
     <td style="vertical-align: top;width: 82pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Die Verwendung des Algorithmus ist verpflichtend.</span><br> <br> <span style="font-size: 10pt;line-height: 1.5;">Alle hier aufgeführten Signaturverfahren müssen von einer Signaturprüfenden Komponente überprüfbar sein.</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 93pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">DigestMethod</span><br> </td> 
     <td style="vertical-align: top;width: 90pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Methode zur Berechnung eines Digest der zu signierenden Bereiche</span><br> </td> 
     <td style="vertical-align: top;width: 180pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">SHA-256</span><br> <span style="font-size: 10pt;line-height: 1.5;">Die [XMLDSig] konforme Bezeichnung lautet:</span><br> <a href="http://www.w3.org/2001/04/xmlenc#sha256" target="_blank" class="descriptionLink">http://www.w3.org/2001/04/xmlenc#sha256</a><br> </td> 
     <td style="vertical-align: top;width: 82pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Die Verwendung des Algorithmus ist verpflichtend.</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 93pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Kryptographisches Token</span><br> </td> 
     <td style="vertical-align: top;width: 90pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Kryptographisches Token für die Signatur, bestehend aus einem privaten Schlüssel und einem zugehörigen X.509-Zertifikat</span><br> </td> 
     <td style="vertical-align: top;width: 180pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Identitäten gemäß einem der folgenden Abschnitte</span><br> <span style="font-size: 10pt;line-height: 1.5;">2.1.1.1</span><br> </td> 
     <td style="vertical-align: top;width: 82pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Die Auswahl des kryptographischen Tokens ist von dem jeweiligen Einsatzzweck abhängig.</span><br> </td> 
    </tr> 
   </tbody> 
  </table>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-7891">3.1.2 XML-Signaturen für qualifizierte elektronische Signaturen</h4>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-137588">
   <p><b>GS-A_4372-02</b></p>
   <p>Alle Produkttypen, die XML-Signaturen für qualifizierte elektronische Signaturen erzeugen oder prüfen, MÜSSEN die Vorgaben der Tabelle Tab_KRYPT_010 erfüllen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_138"></p>
  <p id="polarion_94" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">10</span>: Tab_KRYPT_010 Algorithmen für qualifizierte XML-Signaturen </p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=14" style="width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 93pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;"><span style="font-weight: bold;">Signaturbestandteil</span><br> </span></th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 88pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;"><span style="font-weight: bold;">Beschreibung</span><br> </span></th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 181pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;"><span style="font-weight: bold;">Algorithmus</span><br> </span></th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 85pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;"><span style="font-weight: bold;">Anmerkung</span><br> </span></th> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 93pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Signaturstandard<br> </span></td> 
     <td style="vertical-align: top;width: 88pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Signaturstandard<br> </span></td> 
     <td style="vertical-align: top;width: 181pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">ETSI TS 101 903 V1.4.2 (2010-12)<br> Electronic Signatures and Infrastructures (ESI); XML Advanced Electronic Signatures (XAdES)<br> [ETSI-XAdES]<br> </span></td> 
     <td style="vertical-align: top;width: 85pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Die Verwendung des Standards ist für die Signatur von XML-Dokumenten verpflichtend, die nicht über CMS [RFC-5652] signiert werden.<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 93pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">kryptographisches Signaturverfahren<br> </span></td> 
     <td style="vertical-align: top;width: 88pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Algorithmus für die Berechnung des Nachrichten-Digest (Hashwert des Dokuments) und die Signatur mit dem privaten Schlüssel<br> </span></td> 
     <td style="vertical-align: top;width: 181pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">RSASSA-PSS mit SHA256<br> bis gemäß [SOGIS-2020]&nbsp;<span id="polarion-comment:526"></span><br> <br> ECDSA mit SHA-256<br> bis gemäß [SOGIS-2020]<br> <br> (Hinweis: siehe Abschnitt 4.1)<br> </span></td> 
     <td style="vertical-align: top;width: 85pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Der Algorithmus muss für alle qualifizierten Signaturen verwendet werden.<br> <br> Alle hier aufgeführten Signaturverfahren müssen von einer Signaturprüfenden Komponente überprüfbar sein.<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 93pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">DigestMethod<br> </span></td> 
     <td style="vertical-align: top;width: 88pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Methode zur Berechnung eines Digest der zu signierenden Bereiche<br> </span></td> 
     <td style="vertical-align: top;width: 181pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">SHA-256<br> Die [XMLDSig] konforme Bezeichnung lautet:<br> <a href="http://www.w3.org/2001/04/xmlenc#sha256" target="_blank" class="descriptionLink">http://www.w3.org/2001/04/xmlenc#sha256</a><br> </span></td> 
     <td style="vertical-align: top;width: 85pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Der Algorithmus muss für alle qualifizierten Signaturen verwendet werden.<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 93pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Kryptographisches Token<br> </span></td> 
     <td style="vertical-align: top;width: 88pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Kryptographisches Token für die Signatur, bestehend aus einem privaten Schlüssel und einem zugehörigen X.509-Zertifikat<br> </span></td> 
     <td style="vertical-align: top;width: 181pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Identitäten gemäß dem folgenden Abschnitt<br> 2.1.1.2<br> </span></td> 
     <td style="vertical-align: top;width: 85pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Es darf nur eine Identität, die den Ansprüchen qualifizierter Signaturen entspricht, verwendet werden.<br> </span></td> 
    </tr> 
   </tbody> 
  </table>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-7893">3.1.3 Webservice Security Standard (WSS)</h4>
  <p id="polarion_141">Nicht relevant für den Wirkbetrieb der TI.</p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-7894">3.1.4 XML-Verschlüsselung – Symmetrisch</h4>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7895">
   <p><b>GS-A_4373</b></p>
   <p><p style="margin-left: 0px;"><span>Alle Produkttypen, die XML-Dokumente mittels [XMLEnc-1.1] verschlüsseln, MÜ</span><span>S</span><span>SEN die folgenden Vo</span><span>r</span><span>gaben umsetzen:</span></p>
    <ul>
     <li><p><span>Als symmetrische Block-Chiffre muss AES [FIPS-197] mit einer Schlüssellä</span><span>n</span><span>ge von 256 Bit im Galois/Counter Mode (GCM) gemäß [NIST-SP-800-38D] mit der Tag-Länge von 128 Bit verwe</span><span>n</span><span>det werden.</span></p></li>
     <li><p><span>Die IVs dürfen sich bei gleichem Schlüssel nicht wiederholen (vgl. [NIST-SP-800-38D#S.25] und [BSI-TR-02102-1#S. 24]). Der IV soll e</span><span>i</span><span>ne Bitlänge von 96 Bit besitzen, seine Länge muss mindestens 96 Bit sein. Es wird empfohlen den IV zufällig zu wä</span><span>h</span><span>len (vgl. [gemSpec_Krypt#GS-A_4367]).</span></p></li>
     <li><p><span>Hinweis: Im Normalfall ist davon auszugehen, dass für die Sicherung der I</span><span>n</span><span>tegrität und Authentizität der übertragenen Daten zudem noch eine Signatur der zu verschlüsselnden Daten notwe</span><span>n</span><span>dig ist.</span></p></li>
    </ul> <b>&lt;=</b></p>
  </div>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-7896">3.1.5 XML-Verschlüsselung – Hybrid</h4>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7897">
   <p><b>GS-A_4374</b></p>
   <p>Alle Produkttypen, die Dokumente mittels [XMLEnc-1.1] hybrid verschlüsseln, MÜSSEN das Dokument gemäß [gemSpec_Krypt#GS-A_4373] symmetrisch verschlüsseln, wobei der eingesetzte symmetrischer Schlüssel (jeweils) für eine spezifische Person oder Komponente asymmetrisch verschlüsselt wird.&nbsp;&nbsp;&nbsp;&nbsp;<br> (Hinweis: Analog zum Hinweis in [gemSpec_Krypt#GS-A_4373] gilt auch hier, dass im Normalfall für die Sicherung der Integrität und Authentizität der übertragenen Daten zudem noch eine Signatur dieser Daten notwendig ist.)<br> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-102227">
   <p><b>GS-A_4376-02</b></p>
   <p>Alle Produkttypen, die Dokumente mittels [XMLEnc-1.1] RSA-basiert hybrid ver- und entschlüsseln, MÜSSEN für den Schlüsseltransport den Algorithmus RSAES-OAEP gemäß [PKCS#1] verwenden. <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7900">3.2 Karten-verifizierbare Authentifizierung und Verschlüsselung</h3>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-7905">3.2.1 Card-to-Card-Authentisierung G2</h4>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7906">
   <p><b>GS-A_4379</b></p>
   <p><p style="margin-left: 0px;"><span>Alle Produkttypen, die die Card-to-Card-Authentisierung für Karten der Generation G2 durchführen, MÜSSEN dabei eine CV-Identität gemäß [gemSpec_Krypt#GS-A_4365] verwenden.</span><span style="font-weight: bolder;"> </span></p> <b>&lt;=</b></p>
  </div>
  <p id="polarion_157">Das Verfahren zur Durchführung der Card-to-Card-Authentisierung wird in [gemSpec_COS] spezifiziert.</p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-7907">3.2.2 Card-to-Server (C2S) Authentisierung und Trusted Channel G2</h4>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7908">
   <p><b>GS-A_4380</b></p>
   <p><p style="margin-left: 0px;"><span>Alle Produkttypen, die </span><span> eine</span><span> </span><span>Card-to-Server-Authentisierung für </span><span>Karten</span><span> </span><span>der Gener</span><span>a</span><span>tion G2 durchführen, MÜSSEN die fo</span><span>l</span><span>genden Vorgaben berücksichtigen:</span></p>
    <ul>
     <li><p><span>Die Authentisierung muss mit AES analog [EN-14890-1#8.8] erfo</span><span>l</span><span>gen</span><span>.</span></p></li>
     <li><p><span>Die Schlüsselvereinbarung muss analog zu [EN-14890-1#8.8.2] erfo</span><span>l</span><span>gen.</span></p></li>
    </ul> <b>&lt;=</b></p>
  </div>
  <p id="polarion_159">Das Verfahren zur Durchführung der Card-to-Server-Authentisierung wird in [gemSpec_COS] spezifiziert.</p>
  <p id="polarion_160">C2S-Authentisierung bzw. der Trusted-Channel wird zwischen der Karte und dem zugeordneten Management-System verwendet.</p>
  <p id="polarion_161">Der Algorithmus AES ist nach [BSI-TR-03116-1] in der TI bis Ende 2029+ (meint bis Ende des Betrachtungsraums der TR) zulässig.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-137589">
   <p><b>GS-A_4381-01</b></p>
   <p>Alle Produkttypen, die den Algorithmus AES nutzen, MÜSSEN die Schlüssellängen gemäß Tabelle Tab_KRYPT_012 nutzen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_119" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">11</span>: Tab_KRYPT_012 Algorithmen für Card-to-Server-Authentifizierung </p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=23" style="width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 197pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Algorithmen Typ</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 164pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Algorithmus</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 87pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Schlüssellänge</span><br> </th> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 197pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Authentifizierung und Verschlüsselung der Authentisierungsdaten</span><br> </td> 
     <td style="vertical-align: top;width: 164pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">AES im CBC-Modus</span><br> <span style="font-size: 10pt;line-height: 1.5;">(OID 2.16.840.1.101.3.4.1)</span><br> </td> 
     <td style="vertical-align: top;width: 87pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">128 Bit</span><br> <span style="font-size: 10pt;line-height: 1.5;">zulässig bis Ende 2029+<span id="polarion-comment:524"></span></span><br> </td> 
    </tr> 
   </tbody> 
  </table>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7911">3.3 Netzwerkprotokolle</h3>
  <p id="polarion_167">Im Gegensatz zu kryptographischen Verfahren für den Integritätsschutz oder die Vertraulichkeit von Daten, bei denen keine direkte Kommunikation zwischen dem Sender bzw. dem Erzeuger und dem Empfänger stattfindet, kann bei Netzwerkprotokollen eine Aushandlung des kryptographischen Algorithmus erfolgen. Das Ziel der nachfolgenden Festlegungen ist es daher, jeweils genau einen verpflichtend zu unterstützenden Algorithmus festzulegen, so dass eine Einigung zumindest auf diesen Algorithmus immer möglich ist. Zusätzlich können aber auch optionale Algorithmen festgelegt werden, auf die sich Sender und Empfänger ebenfalls im Zuge der Aushandlung einigen können. Es darf jedoch durch keine der Komponenten vorausgesetzt werden, dass der Gegenpart diese optionalen Algorithmen unterstützt.</p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-7912">3.3.1 IPsec-Kontext</h4>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-137591">
   <p><b>GS-A_4382-04</b></p>
   <p>Alle Produkttypen, die die Authentifizierung, den Schlüsselaustausch und die verschlüsselte Kommunikation im IPsec-Kontext durchführen, MÜSSEN die Schlüsselvereinbarung mittels IKEv2 [RFC-7296] gemäß den folgenden Vorgaben durchführen:<br> 
    <ul> 
     <li> Zur Authentisierung MUSS eine Identität mit einem X.509-Zertifikat gemäß [gemSpec_Krypt#GS-A_4360] verwendet werden.</li> 
    </ul> 
    <ul> 
     <li>Für „Hash und URL“ MUSS SHA-1 verwendet werden.<br> </li> 
     <li>Die Diffie-Hellman-Gruppe Gruppe 14 (definiert in [RFC-3526], verwendbar bis Ende 2025) MUSS für den Schlüsselaustausch unterstützt werden. Zusätzlich KÖNNEN Gruppen aus [BSI-TR-02102-3, Abschnitt 3.2.4, Tabelle 5], bei denen der Verwendungszeitraum ein „+“ enthält, verwendet werden.&nbsp;<br> </li> 
     <li>Der private DH-Exponent für den Schlüsselaustausch MUSS eine Länge von mindestens 256 Bit haben.</li> 
    </ul> 
    <ul> 
     <li>Die Authentisierung der ephemeren (EC)DH-Parameter erfolgt durch eine Signatur der Parameter durch den jeweiligen Protokollteilnehmer. Bei dieser Signatur MUSS SHA-256 als Hashfunktion verwendet werden. Es SOLL die Authentisierungsmethode „Digital Signature“ nach [RFC-7427] dabei verwendet werden.</li> 
    </ul> 
    <ul> 
     <li>Bei den symmetrische Verschlüsselungsalgorithmen MUSS AES mit 256 Bit Schlüssellänge im CBC-Modus unterstützt werden (sowohl für IKE-Nachrichten als auch später für die Verschlüsselung von ESP-Paketen). Es KÖNNEN weitere Verfahren nach [BSI-TR-02102-3, Abschnitt 3.2.1, Tabelle 2] bzw. [BSI-TR-02102-3, Abschnitt 3.3.1, Tabelle 7] verwendet werden.<br> </li> 
     <li>Für den Integritätsschutz (sowohl innerhalb von IKEv2 als auch anschließend für ESP-Pakete) MUSS HMAC mittels SHA-256 unterstützt werden. Es KÖNNEN weitere Verfahren nach [BSI-TR-02102-3, Abschnitt 3.2.3, Tabelle 4] bzw. [BSI-TR-02102-3, Abschnitt 3.3.1, Tabelle 8] verwendet werden, andere Verfahren dürfen nicht verwendet werden.<br> </li> 
     <li>Als PRF MUSS PRF_HMAC_SHA2_256 unterstützt werden. Es KÖNNEN weitere Verfahren nach [BSI-TR-02102-3, Abschnitt 3.2.2, Tabelle 3] verwendet werden, andere Verfahren dürfen nicht verwendet werden.<br> </li> 
     <li>Schlüsselaktualisierung: die IKE-Lifetime darf maximal 24*7 Stunden betragen (Reauthentication). Die IPsec-SA-Lifetime darf maximal 24 Stunden betragen (Rekeying). Der Initiator soll nach Möglichkeit vor Ablauf der Lifetime das Rekeying anstoßen. Ansonsten muss der Responder bei Ablauf der Lifetime das Rekeying von sich aus sicherstellen, bzw. falls dies nicht möglich ist, die Verbindung beenden.<br> </li> 
     <li>Für die Schlüsselberechnung muss Forward Secrecy [BSI-TR-02102-1, S.ix] (in [RFC-7296] „Perfect Forward Secrecy“ genannt) gewährleistet werden. Meint die Wiederverwendung von zuvor schon verwendeten (EC-)Diffie-Hellman-Schlüsseln ([RFC-7296, Abschnitt 2.12]) ist nicht erlaubt.</li> 
    </ul> <b>&lt;=</b></p>
  </div>
  <p id="polarion_169">&nbsp;Ziel ist es zum Zeitpunkt der IKE-SA-Reauthentication ausgeführte Anwendungsfälle nicht zu unterbrechen. Aktuell wird aufgrund von TIP1-A_4492 im Rahmen der Reauthentication dem Konnektor eine neue (i.d.R. andere) VPN-TI-IP-Adresse zugewiesen, was dazu führt, dass bestehende TCP-Verbindungen in die TI effektiv zerstört und laufende Anwendungsfälle unterbrochen werden. Perspektivisch wird die folgende Anforderung als MUSS-Anforderung in TIP1-A_4492 integriert.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7914">
   <p><b>GS-A_5547</b></p>
   <p>Der VPN-Zugangsdienst KANN nach einer Reauthentication (vgl. GS-A_4382-* Spiegelstrich „Schlüsselaktualisierung“) die gleiche VPN-IP-Adresse wie vor der Reauthentication vergeben. Die Reauthentication ist in Bezug auf TIP1-A_4492 nicht als „neue Verbindung/Neuaufbau des Tunnels“ zu betrachten.<br> <b>&lt;=</b></p>
  </div>
  <p id="polarion_177">Da noch nicht alle VPN-Zugangsdienste technisch in der Lage sind GS-A_5547 umzusetzen werden als Symptomlinderung die Gültigkeitsdauern der ausgehandelten Schlüssel erhöht, auch in Anbetracht, dass weitere Sicherheitsmaßnahmen (bspw. TIP1-A_5389) umgesetzt werden neben den klassischen Prüfungen, die im Rahmen einer Reauthentication durchgeführt werden.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7915">
   <p><b>GS-A_5548</b></p>
   <p>Der Konnektor MUSS die Konfiguration der Gültigkeitsdauern der IKE- bzw. IPsec-SAs auf (1) mindestens 90% und (2) kleiner als 100% der in GS-A_4382-* Spiegelstrich „Schlüsselaktualisierung“ aufgeführten Maximalwerte setzen.<br> <b>&lt;=</b></p>
  </div>
  <p id="polarion_179">Auszug Beispielkonfiguration /etc/ipsec.conf</p>
  <p id="polarion_181"> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;ikelifetime=161h</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;lifetime=23h</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;margintime = 20m</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;rekeyfuzz = 40%</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;keyexchange=ikev2</span> </p>
  <p id="polarion_15"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7916">
   <p><b>GS-A_5549</b></p>
   <p>Der VPN-Zugangsdienst MUSS die Konfiguration der Gültigkeitsdauern der IKE- bzw. IPsec-SAs auf die in GS-A_4382-* Spiegelstrich „Schlüsselaktualisierung“ aufgeführten Maximalwerte setzen.<br> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7917">
   <p><b>GS-A_5508</b></p>
   <p>Alle Produkttypen, die mittels IPsec Daten schützen, MÜSSEN die Reauthentication (vgl. [RFC-7296#2.8.3 „Reauthentication is done by […]“]) durchführen, indem die neue IKE-SA aufgebaut wird bevor die bestehende IKE-SA gelöscht wird. <br> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7918">
   <p><b>GS-A_4383</b></p>
   <p>Alle Produkttypen, die mittels IPsec-Daten schützen, MÜSSEN dies ausschließlich auf Grundlage der in GS-A_4382-* als zulässig aufgeführten Verfahren und Vorgaben tun. <br> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-98487">
   <p><b>A_14652</b></p>
   <p>Die Lebensdauer von asymmetrischen Schlüsseln für die IPsec-Verbindungen im SZZP-light sowie Sicherheitsgateway Bestandsnetze und somit die in einem Zertifikat angegebene Gültigkeitsdauer DARF NICHT&nbsp;5 Jahre überschreiten.<br> <b>&lt;=</b></p>
  </div>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-7919">3.3.2 TLS-Verbindungen</h4>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7920">
   <p><b>GS-A_4385</b></p>
   <p>Alle Produkttypen, die Übertragungen mittels TLS durchführen, MÜSSEN die TLS-Version 1.2 [RFC-5246] unterstützen.<br> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-100244">
   <p><b>A_18467</b></p>
   <p>Alle Produkttypen, die Übertragungen mittels TLS durchführen, KÖNNEN die TLS-Version 1.3 [RFC-8446] unterstützen, falls sie<br> 
    <ol> 
     <li>dabei nur nach [BSI-TR-02102-2] empfohlene Verbindungskonfigurationen (Handshake-Modi, (EC)DH-Gruppen, Signaturverfahren, Ciphersuiten etc.) verwenden, und&nbsp;</li> 
     <li>mindestens die Ciphersuite "TSL_AES_128_GCM_SHA256" dabei unterstützen.&nbsp;</li> 
    </ol> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-100240">
   <p><b>A_18464</b></p>
   <p>Alle Produkttypen, die Übertragungen mittels TLS durchführen, DÜRFEN NICHT die TLS-Version 1.1 [RFC-4346] unterstützen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7923">
   <p><b>GS-A_4387</b></p>
   <p>Alle Produkttypen, die Übertragungen mittels TLS durchführen, DÜRFEN NICHT die TLS-Version 1.0 unterstützen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7924">
   <p><b>GS-A_5035</b></p>
   <p>Alle Produkttypen, die Daten über Datenleitungen übertragen wollen, DÜRFEN NICHT das SSL-Protokoll unterstützen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_364">Bei TLS 1.1 oder älter ist im Rahmen des TLS-Verbindungsaufbaus die Verwendung von SHA-1 bei der Erstellung und Prüfung von Signaturen (TLS-Handshake) notwendig. Es gibt keine Möglichkeit der Aushandlung/Vereinbarung der Verwendung von kryptographisch höherwertigeren Hashfunktionen dafür. Dies wurde erst mit TLS 1.2 möglich. SHA-1 erbringt in Konstruktionen, die nur die kryptographische Einwegeigenschaft der Hashfunktion benötigen (bspw. bei der HMAC-Berechnung auf SHA-1-Basis) noch ein -- zwar nicht hochwertiges, aber immer noch -- vertretbares Sicherheitsniveau. Die allgemeine Kollisionsresistenz, so wie sie bei Signaturen notwendig ist, kann SHA-1 nicht mehr leisten. SHA-1 wurde in diesem Aspekt praktisch (i. S. v. nicht nur theoretisch) -- und öffentlichkeitswirksam demonstriert -- gebrochen. Aus diesem Grunde hat die IETF alle TLS Version unter 1.2 abgekündigt und bspw. alle Webbrowser-Hersteller haben die Unterstützung von TLS-Versionen unter 1.2 deaktiviert.</p>
  <p id="polarion_436">Einen lesenswerten Abriss bekannter Angriffe auf TLS findet man in [TLS-Attacks], vgl. auch [Breaking-TLS].</p>
  <p id="polarion_367">Analog zu IKE/IPsec und GS-A_4382-*&nbsp;(Spiegelstrich 5) wird deshalb folgend mit A_21275-* eine Verwendung von SHA-1 bei der Signaturerstellung und -prüfung im Kontext des TLS-Handshakes untersagt.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116454">
   <p><b>A_21275-01</b></p>
   <p>Alle Produkttypen, die Übertragungen mittels TLS durchführen, MÜSSEN sicherstellen, dass<br> 
    <ol> 
     <li>sie im Rahmen der Erstellung und Prüfung von digitalen Signaturen im Rahmen des TLS-Handshakes ausschließlich folgende kryptographisch geeignete Hashfunktionen verwenden:&nbsp;</li> 
     <ol> 
      <li><span style="font-size: 10pt;line-height: 1.5;">SHA-256, SHA-384, SHA-512 [FIPS-180-4]</span></li> 
      <li><span style="font-size: 10pt;line-height: 1.5;">SHA3-256, SHA3-384, SHA3-512 [FIPS-202]</span></li> 
     </ol> 
     <li><span style="font-size: 10pt;line-height: 1.5;">sie dabei mindestens SHA-256 unterstützen,</span></li> 
    </ol> <span style="font-size: 10pt;line-height: 1.5;">(Bitte die Umsetzungshinweise in Bezug auf die "signature_algorithms"-Extension in gemSpec_Krypt#A_21275-* beachten.)</span> <b>&lt;=</b></p>
  </div>
  <p id="polarion_368">Umsetzungshinweise zu A_21275-*:</p>
  <p id="polarion_370">Bei den Anwendungsfällen der TI-Anwendungen sind die Mehrzahl der TLS-Verbindungen einseitig authentisiert. D. h. beim TLS-Handshake signiert nur der TLS-Server dessen (EC)DH-Schlüssel. Bei der Initiierung der TLS-Verbindung sendet der TLS-Client in der "signature_algorithms"-Extension beim ClientHello. In der Extension werden alle vom Client unterstützen Hashfunktionen kodiert. Dort muss also nach A_21275-* mindestens SHA-256 enthalten sein. Bei TLS 1.2 wird von fast allen TLS-Bibliotheken ebenfalls SHA-1 angegeben, dieses Verhalten lässt sich im Normalfall nicht ohne Code-Änderungen in den Bibliotheken verändern -- dieses Verhalten widerspricht zunächst A_21275-*. Das bloße Aufführen von SHA-1 als grundsätzlich unterstützte Hashfunktion soll nicht als fehlerhaftes Verhalten gelten. Wichtig für die Umsetzung von A_21275-* sind die tatsächlich erstellten Signaturen und die Prüfung dieser Signaturen.</p>
  <p id="polarion_371">Informationen zu Algorithmen in der "signature_algorithms"-Extension findet man in [RFC-5246#7.4.1.4.1.] und [RFC-8446-4.2.3.],&nbsp;vgl. auch [RFC-9155].</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-134940">
   <p><b>GS-A_4384-01</b></p>
   <p>Alle Produkttypen, die Übertragungen mittels TLS durchführen, MÜSSEN die folgenden Vorgaben erfüllen:<br> 
    <ul> 
     <li>Zur Authentifizierung MUSS eine X.509-Identität gemäß [gemSpec_Krypt#GS-A_4359] verwendet werden.</li> 
     <li>Als Cipher-Suite MÜSSEN&nbsp;TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 und&nbsp;TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 unterstützt werden.</li> 
     <li>Beim ephemeren Elliptic-Curve-Diffie-Hellman-Schlüsselaustausch (vgl. "ECDHE" im Namen der Cipher-Suites)&nbsp;MÜSSEN die Kurven P-256 und P-384 [FIPS-186-4] unterstützt werden. Es SOLLEN&nbsp;die Kurven brainpoolP256r1 und brainpoolP384r1 (vgl. [RFC-5639] und [RFC-7027]) unterstützt werden.&nbsp;Andere Kurven als in GS-A_4384-* aufgeführt DÜRFEN NICHT verwendet werden.</li> 
     <li>Es KÖNNEN weitere&nbsp;Cipher-Suiten aus [TR-02102-2, Abschnitt 3.3.1 Tabelle 1] unterstützt werden.&nbsp;<br> </li> 
    </ul> <b>&lt;=</b></p>
  </div>
  <p id="polarion_437">Erläuterung zu GS-A_4384-*:</p>
  <p id="polarion_434">In einigen Konstellationen (ePA-FdV auf iOS-Geräten) ist die Verwendung von brainpool-Kurven nur schwer möglich. Dort bedeutet die SOLL-Bestimmung aus GS-A_4384-*, dass es zulässig ist auf die brainpool-Kurven-Unterstützung dort zu verzichten.&nbsp;</p>
  <p id="polarion_438">Hinweis: hinter den folgenden Identifier-n verbirgt sich kryptographisch gesehen jeweils die gleiche Kurve:</p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=439" style="width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">ansix9p256r1</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[ANSI-X9.62#L.6.4.3]</span><br> </th> 
    </tr> 
    <tr> 
     <td style="border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">ansip256r1</span><br> </td> 
     <td style="border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><a href="http://oid-info.com/get/1.2.840.10045.3.1.7" target="_blank" class="descriptionLink">http://oid-info.com/get/1.2.840.10045.3.1.7</a><br> </td> 
    </tr> 
    <tr> 
     <td style="border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">prime256v1</span><br> </td> 
     <td style="border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-3279],</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">openssl ecparam -list_curves</span><br> </td> 
    </tr> 
    <tr> 
     <td style="border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">secp256r1</span><br> </td> 
     <td style="border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-5480],</span> <a href="http://www.secg.org/collateral/sec2_final.pdf" target="_blank" class="descriptionLink">http://www.secg.org/collateral/sec2_final.pdf</a><br> </td> 
    </tr> 
    <tr> 
     <td style="border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">P-256&nbsp;</span><br> </td> 
     <td style="border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[FIPS186-4]</span><br> </td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_440">Analog P-384 [FIPS186-4]:</p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=441" style="width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">ansix9p384r1</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[ANSI-X9.62#L.6.5.2]</span><br> </th> 
    </tr> 
    <tr> 
     <td style="border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">ansip384r1</span><br> </td> 
     <td style="border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><a href="http://oid-info.com/get/1.3.132.0.34" target="_blank" class="descriptionLink">http://oid-info.com/get/1.3.132.0.34</a><br> </td> 
    </tr> 
    <tr> 
     <td style="border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">prime384v1</span><br> </td> 
     <td style="border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-3279],</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">openssl ecparam -list_curves</span><br> </td> 
    </tr> 
    <tr> 
     <td style="border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">secp384r1</span><br> </td> 
     <td style="border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-5480],</span> <a href="http://www.secg.org/collateral/sec2_final.pdf" target="_blank" class="descriptionLink">http://www.secg.org/collateral/sec2_final.pdf</a><br> </td> 
    </tr> 
    <tr> 
     <td style="border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">P-384&nbsp;</span><br> </td> 
     <td style="border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[FIPS186-4]</span><br> </td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_443"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7926">
   <p><b>GS-A_5541</b></p>
   <p>Alle Produkttypen, die das TLS-Protokoll als TLS-Klient zur Störungsampel oder zum Service-Monitoring verwenden, KÖNNEN <br> 
    <div style="margin-left: 40px;">
     (1) auf die explizite Prüfung, dass der TLS-Server die (EC)DH-Gruppe für den ephemeren (EC)DH-Schlüsselaustausch spezifikationskonform gewählt hat (vgl. GS-A_4384-* und A_17124-* Punkt 4), verzichten,
    </div>
    <div style="margin-left: 40px;">
     und
    </div>
    <div style="margin-left: 40px;"></div>
    <div style="margin-left: 40px;">
     (2) davon ausgehen, dass der TLS-Server die Auswahl der TLS-Verbindungsparameter (TLS-Version, TLS-Ciphersuite etc.) korrekt, i.S.v. spezifikationskonform, durchführt.
    </div>
    <div style="margin-left: 40px;"></div> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-102110">
   <p><b>GS-A_5580-01</b></p>
   <p>Alle Produkttypen, die das TLS-Protokoll als TLS-Klient für <span style="font-size: 10pt;line-height: 1.5;">Betriebsunterstützende Dienste (Service-Monitoring, Betriebsdaten-Erfassung etc.)</span> verwenden, MÜSSEN das&nbsp;vom Betriebsunterstützenden Dienst&nbsp;präsentierte&nbsp;Zertifikat prüfen. Für diese Prüfung MUSS entweder TUC_PKI_018 oder die vereinfachte Zertifikatsprüfung&nbsp;(GS-A_5581 „TUC &nbsp;vereinfachte &nbsp;Zertifikatsprüfung“ (Komponenten-PKI)) verwendet werden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-126024">
   <p><b>A_22430</b></p>
   <p>Alle Produkttypen, welche die Betriebsdatenerfassung im Internet nutzen, MÜSSEN prüfen, ob das von der Betriebsdatenerfassung an der Internetschnittstelle während des TLS-Verbindungsaufbaus präsentierte TLS-Serverzertifikat gültig ist (d. h. u. a. per Zertifikatsprüfung rückführbar auf ein CA-Zertifikat einer CA, die die "CA/Browser Forum Baseline Requirements for the Issuance and Management of Publicly-Trusted Certificates" (<a target="_top" href="https://cabforum.org/baseline-requirements-documents/">https://cabforum.org/baseline-requirements-documents/</a>) erfüllt) und für den erwarteten FQDN ausgestellt wurde. Bei negativen Prüfergebnis MUSS der TLS-Verbindungsaufbau zur Betriebsdatenerfassung abgelehnt werden. <b>&lt;=</b></p>
  </div>
  <p id="polarion_334">Bei&nbsp; bestimmten&nbsp; Produkttypen,&nbsp; bspw.&nbsp; TSPs,&nbsp; beschränkt&nbsp; sich&nbsp; die&nbsp; Prüfung&nbsp; von&nbsp; Zertifikaten beim TLS-Verbindungsaufbau in Bezug auf die TI ausschließlich auf die Prüfung des Zertifikats des Service Monitorings oder anderer betriebsunterstützender Dienste. Dafür ist der TUC_PKI_018 unangemessen leistungsstark und komplex. Deshalb wird folgend mit GS-A_5581 eine passgenauere Zertifikatsprüfung als Alternative definiert.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-74423">
   <p><b>GS-A_5581</b></p>
   <p>Alle &nbsp;Produkttypen, &nbsp;die &nbsp;eine &nbsp;Zertifikatsprüfung konform &nbsp;zu &nbsp;in &nbsp;dieser &nbsp;Anforderung &nbsp;definierten „TUC vereinfachte Zertifikatsprüfung“ durchführen wollen, erreichen dies indem sie folgende Vorgaben erfüllen. <br> (1) Es MUSS einen Prozess geben der authentisch und integer die Komponenten-CA-Zertifikate der TI regelmäßig (mindestens einmal pro Monat) ermittelt. Diese sind Basis für die folgenden Prüfschritte.&nbsp;<br> (2) Es MUSS geprüft werden, ob im vom TLS-Server präsentierten Zertifikat der korrekte&nbsp; (i.&nbsp; S.&nbsp; v.&nbsp; vom&nbsp; TLS-Client&nbsp; erwartete)&nbsp; FQDN&nbsp; enthalten&nbsp; ist&nbsp; (bspw.&nbsp; monitoring-update.stampel.telematik). <br> (3) Es MUSS geprüft werden, ob das präsentierte Zertifikat per Signaturprüfung rückführbar ist zu einem der CA-Zertifikate aus (1). <br> (4) Es MUSS geprüft werden, ob das präsentierte Zertifikat zeitlich gültig ist.<br> <br> Wenn einer der Prüfschritte aus (2) bis (4) fehlschlägt, MUSS der Verbindungsaufbau abgebrochen werden. &nbsp;<br> <br> Es gibt GS-A_5581 folgend in gemSpec_Krypt Anwendungshinweise. <b>&lt;=</b></p>
  </div>
  <p id="polarion_3">Als Hilfestellung: für die Umsetzung von GS-A_5581 Spiegelstrich (1) kann man bspw. folgende Maßnahmen wählen.</p>
  <p id="polarion_52">(a) Übergabe bei einem Vororttermin in der gematik,</p>
  <p id="polarion_55">(b) Regelmäßiger Download über https://download.tsl.ti-dienste.de/</p>
  <p id="polarion_58">(c)&nbsp; Verwendung&nbsp; einer&nbsp; dedizierten&nbsp; Software&nbsp; zum&nbsp; Download,&nbsp; Signaturprüfung&nbsp; und Auswertung&nbsp; der&nbsp; TI-TSL&nbsp; (es&nbsp; existiert&nbsp; dafür&nbsp; jeweils mindestens eine Open-Source-Lösung und eine kommerzielle Lösung)&nbsp;</p>
  <p id="polarion_63"> (d) oder andere Lösung, die die Integrität und Authentizität der Zertifikate sicherstellt.<br> </p>
  <p id="polarion_23"> Ziel ist es, dass für die Verbindung zur Störungsampel oder zum Service Monitoring auch einfach verfügbare und einfach verwendbare HTTPS-Clienten wie <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">wget</span> oder <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">curl</span> verwendet werden können.<br> </p>
  <p id="polarion_40">Unter der Annahme, dass</p>
  <p id="polarion_66">(a) im Verzeichnis /etc/TI-Komponenten-CAs die in GS-A_5581 Punkt (1) aufgeführten Zertifikate liegen und</p>
  <p id="polarion_69"> (b) die an die Störungsampel zu sendende Information (i. d. R. unsignierte XML-Daten) in der Datei SOAP_Daten liegen,<br> erfüllen folgende Aufrufe die Punkt (2)-(4) aus GS-A_5581.<br> I.<br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">wget --ca-directory=/etc/TI-Komponenten-CAs --post-file=SOAP_Daten&nbsp;https://monitoring-update.stampel.telematik:8443/I_Monitoring_Message</span><br> II.<br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">curl --capath /etc/TI-Komponenten-CAs –d SOAP_Daten https://monitoring-</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">update.stampel.telematik:8443/I_Monitoring_Message</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7927">
   <p><b>GS-A_5542</b></p>
   <p><p style="margin-left: 0px;"><span>Alle Produkttypen, die das TLS-Protokoll verwenden, MÜSSEN sicherstellen, dass alle von ihnen durchgeführten Verbindungsabbrüche (egal ob im noch laufenden TLS-Handshake oder in einer schon etablierten TLS-Verbindung) mit einer im TLS-Protokoll aufgeführten Fehlermeldung (fataler Alert) angekündigt werden, außer das TLS-Protokoll unte</span><span>rsagt dies explizi</span><span>t.</span><span> </span></p> <b>&lt;=</b></p>
  </div>
  <p id="polarion_210">Sicherheitsziel bei der Verwendung von TLS in der TI ist die Forward Secrecy [BSI-TR-02102-1, S. ix], was sich u. a. in den vorgegebenen Cipher-Suites (vgl. GS-A_4384-*&nbsp;und A_17124-*) widerspiegelt. Um dieses Ziel zu erreichen, muss sichergestellt werden, dass in regelmäßigen Abständen frisches Schlüsselmaterial über einen authentisierten Diffie-Hellman-Schlüsselaustausch gebildet wird, welches das alte Material ersetzt, wobei das alte Material sowohl im Klienten als auch im Server sicher gelöscht wird. Insbesondere bei der Nutzung von TLS-Resumption (vgl. [RFC-5246, S. 36] oder [RFC-5077]) kann die Dauer einer TLS-Session deutlich länger sein als die Lebensdauer der TCP-Verbindung innerhalb welcher der initiale Schlüsselaustausch stattgefunden hat. Aus diesem Grunde werden analog zu den IPsec-Vorgaben (vgl. [gemSpec_Krypt#GS-A_4383]) Vorgaben für die maximale Gültigkeitsdauer dieses Schlüsselmaterials gemacht (vgl. auch [SDH-2016]).</p>
  <p id="polarion_211"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7928">
   <p><b>GS-A_5322</b></p>
   <p>Alle Produkttypen, die Übertragungen mittels TLS durchführen, MÜSSEN u. a. folgende Vorgaben erfüllen:<br> 
    <ul> 
     <li>Falls der Produkttyp als <span style="font-style: italic;">Klient</span> oder als <span style="font-style: italic;">Server</span> im Rahmen von TLS an einer Session-Resumption mittels SessionID (vgl. [RFC-5246, Abschnitt 7.4.1.2]) teilnimmt, MUSS er sicherstellen, dass nach spätestens 24 Stunden das über den Diffie-Hellman-Schlüsselaustausch ausgehandelte Schlüsselmaterial und alles davon abgeleitete Schlüsselmaterial (vgl. [RFC-5246, Abschnitt 8.1 und 6.3]) bei ihm sicher gelöscht wird.<br> </li> 
     <li>Falls der Produkttyp als <span style="font-style: italic;">Klient</span> im Rahmen von TLS an einer Session-Resumption nach [RFC-5077] teilnimmt, MUSS er sicherstellen, dass nach spätestens 24 Stunden das über den Diffie-Hellman-Schlüsselaustausch ausgehandelte Schlüsselmaterial und alles davon abgeleitete Schlüsselmaterial (vgl. [RFC-5246, Abschnitt 8.1 und 6.3]) bei ihm sicher gelöscht wird. Damit verbundene SessionTickets MUSS er ebenfalls sicher löschen.<br> </li> 
     <li>Falls der Produkttyp als <span style="font-style: italic;">Server</span> im Rahmen von TLS an einer Session-Resumption nach [RFC-5077] teilnimmt, MUSS er sicherstellen, dass nach spätestens 24 Stunden das über den Diffie-Hellman-Schlüsselaustausch ausgehandelte Schlüsselmaterial und alles davon abgeleitete Schlüsselmaterial (vgl. [RFC-5246, Abschnitt 8.1 und 6.3]) bei ihm sicher gelöscht wird. Damit verbundene SessionTickets MUSS er, falls bei ihm vorhanden, sicher löschen. Das Schlüsselmaterial, dass bei der Erzeugung des SessionTickets (für die Sicherung von Vertraulichkeit und Authentizität der SessionTickets) verwendet wird, MUSS spätestens alle 48 Stunden gewechselt werden und das alte Material MUSS sicher gelöscht werden. Als kryptographische Verfahren zur Erzeugung/Sicherung der SessionTickets MÜSSEN ausschließlich nach [BSI-TR-03116-1] zulässige Verfahren verwendet werden und das Schlüsselmaterial muss die Entropieanforderungen gemäß [gemSpec_Krypt#GS-A_4368] erfüllen.<br> </li> 
     <li>Falls ein Produkttyp als <span style="font-style: italic;">Klient</span> oder <span style="font-style: italic;">Server</span> im Rahmen von TLS die Renegotiation unterstützt, so MUSS er dies ausschließlich nach [RFC-5746] tun. Ansonsten MUSS er die Renegotiation-Anfrage des Kommunikationspartners ablehnen.</li> 
    </ul> <b>&lt;=</b></p>
  </div>
  <p id="polarion_213">Aktuell gibt es in der TI keine Anwendungsfälle (Wechsel der kryptographischen Identität innerhalb einer TLS-Verbindung oder erzwungene Schlüssel-„Auffrischung“ der Sitzungsschlüssel), die eine Session-Renegotiation im Rahmen von TLS unmittelbar erforderlich machen. Lesenswert bez. des Themas Sicherheitsprobleme mit TLS-Session-Renegotiation ist [IR-2014, S.181ff] und allgemein [CM-2014].</p>
  <p id="polarion_214">Es hat sich gezeigt, dass es notwendig ist weitere Vorgaben zur TLS-Renegotiation für die Sicherstellung der Interoperabilität zwischen Komponenten und Diensten zu machen.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7929">
   <p><b>GS-A_5524</b></p>
   <p><p style="margin-left: 0px;"><span>Das eHealth-KT MUSS beim einen TLS-Verbindungsaufbau die TLS-Extension „r</span><span>e</span><span>negotiation_info“ gemäß [RFC-5746] senden, unabhängig davon ob das eHealth-KT TLS-Renegotiation unterstützt oder nicht unterstützt. Im weiteren TLS-Protokollverlauf MUSS das eHealth-KT eines der beiden folgenden Verhalten au</span><span>f</span><span>weisen:</span></p>
    <ol>
     <li><p><span>Entweder das eHealth-KT lehnt jede Renegotiation mit einem „no_renegotiation“-Alert ab, oder</span></p></li>
     <li><p><span>das eHealth-KT unterstützt die Renegotiation gemäß [RFC-5746], wobei ausschließlich „Secure Renegotiation“ durch das eHealth-KT akzeptiert werden (d.h., falls das „secure_renegotiation“-flag [RFC-5746#3.7] gleich FALSE ist, muss das KT die Renegotiation mit einem „no_renegotiation“-Alert ablehnen). </span></p></li>
    </ol> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7930">
   <p><b>GS-A_5525</b></p>
   <p><p style="margin-left: 0px;"><span>Der Konnektor MUSS den RFC 5746 (TLS-Renegotiation-Indication-Extension [RFC-5746]) unterstützen und nur „Secure Renegotiation“ erlauben und durchfü</span><span>h</span><span>ren.</span></p> <b>&lt;=</b></p>
  </div>
  <p id="polarion_217"> Für eine Java-Implementierung bedeutet dies, dass allowLegacyHelloMessages und allowUnsafeRenegotiation jeweils auf false gesetzt sind ("Modus Strict", <a href="http://www.oracle.com/technetwork/java/javase/overview/tlsreadme2-176330.html" target="_blank" class="descriptionLink">http://www.oracle.com/technetwork/java/javase/overview/tlsreadme2-176330.html</a>&nbsp;). </p>
  <p id="polarion_218"> Da der Angriff [Ray-2009], der zur Erstellung des [RFC-5746] führte, praktisch durchführbar war, wurde die Mehrzahl der existierenden TLS-Bibliotheken relativ zügig angepasst (Timeline in [IR-2014, S. 190, Abbildung 7.2]). (Vgl. die erste Spalte „Secure Renegotiation“ bei <a href="https://en.wikipedia.org/wiki/Comparison_of_TLS_implementations#Extensions" target="_blank" class="descriptionLink">https://en.wikipedia.org/wiki/Comparison_of_TLS_implementations#Extensions</a>&nbsp;) Um für den unwahrscheinlichen Fall, dass aktuell ein schon bestehender Fachdienst Probleme bei der Umsetzung der folgenden Anforderung hat, wurde diese als SOLL-Anforderung formuliert. Es ist geplant diese Anforderung zukünftig in eine MUSS-Anforderung zu ändern. </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7931">
   <p><b>GS-A_5526</b></p>
   <p><p style="margin-left: 0px;"><span>Alle Produkttypen, die das TLS-Protokoll verwenden, SOLLEN den RFC 5746 (TLS-Renegotiation-Indication-Extension [RFC-5746]) unterstützen. </span></p> <b>&lt;=</b></p>
  </div>
  <p id="polarion_220">Die folgende Anforderung hat den Zweck die Interoperabilität zwischen Konnektor und Intermediär sicherzustellen.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7932">
   <p><b>GS-A_5527</b></p>
   <p><p style="margin-left: 0px;"><span>Der Intermediär MUSS den RFC 5746 (TLS-Renegotiation-Indication-Extension [RFC-5746]) unterstützen und nur „Secure Renegotiation“ erlauben und durchfü</span><span>h</span><span>ren.</span></p> <b>&lt;=</b></p>
  </div>
  <p id="polarion_222"> Für eine verbesserte Interoperabilität zu bestimmten TLS-Implementierungen (bspw. SChannel, vgl. auch ( <a href="https://en.wikipedia.org/wiki/Comparison_of_TLS_implementations" target="_blank" class="descriptionLink">https://en.wikipedia.org/wiki/Comparison_of_TLS_implementations</a>&nbsp;bzw. <a href="https://www.ssllabs.com/ssltest/clients.html" target="_blank" class="descriptionLink">https://www.ssllabs.com/ssltest/clients.html</a>) sollen im Konnektor zusätzlich zu den Cipher-Suiten aus GS-A_4384-* weitere Cipher-Suiten unterstützt werden. Mit der mittelfristigen Anhebung des zu erreichenden Sicherheitsniveaus auf 120 Bit (vgl. [SOG-IS-2020] und [BSI-TR-03116-1]) werden die folgenden Cipher-Suiten mittelfristig verpflichtend. In diesem Kontext spielt die Performanz (3000 Bit Diffie-Hellman vs. 256 Bit Elliptic Curve Diffie-Hellman) bei Embedded-Geräten wie dem Konnektor eine wichtige Rolle. </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-134941">
   <p><b>GS-A_5345-01</b></p>
   <p>Der Konnektor MUSS für die TLS gesicherten Verbindungen neben den in [gemSpec_Krypt#GS-A_4384-*]<span id="polarion-comment:474"></span> aufgeführten Ciphersuiten folgende Vorgaben umsetzen:<br> <br> 
    <ol> 
     <li>Der Konnektor MUSS zusätzlich folgende Ciphersuiten unterstützen:<br> </li> 
    </ol> 
    <div style="margin-left: 2em;"> 
     <ul> 
      <li><span style="font-size: 10pt;line-height: 1.5;">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 (0xC0, 0x27)<span style="font-family: Arial, Helvetica, sans-serif;">,</span><br> </span></li> 
      <li><span style="font-size: 10pt;line-height: 1.5;">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 (0xC0, 0x28)<span style="font-family: Arial, Helvetica, sans-serif;">,</span><br> </span></li> 
      <li><span style="font-size: 10pt;line-height: 1.5;">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 (0xC0, 0x2f) <span style="font-family: Arial, Helvetica, sans-serif;">und</span><br> </span></li> 
      <li><span style="font-size: 10pt;line-height: 1.5;">TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 (0xC0, 0x30)<span style="font-family: Arial, Helvetica, sans-serif;">.</span><br> </span></li> 
     </ul> 
    </div> 
    <ol class="continue"> 
     <li>Der Konnektor KANN <span style="color: #000000;">weitere Ciphersuiten aus [TR-02102-2, Abschnitt 3.3.1 Tabelle 1] unterstützen.</span><br> </li> 
     <li><span style="color: #000000;">Falls Ciphersuiten aus Spiegelstrich (1) oder (2) unterstützt werden,</span><br> </li> 
     <ol> 
      <li><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;MÜSSEN bei dem ephemeren Elliptic-Curve-Diffie-Hellman-Schlüsselaustausch die Kurven P-256 und P-384 [FIPS-186-4] unterstützt werden,</span><br> </li> 
      <li><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;MÜSSEN die Kurven brainpoolP256r1 und brainpoolP384r1 (vgl. [RFC-5639] und [RFC-7027]) unterstützt werden.</span><br> </li> 
     </ol> 
    </ol> 
    <div style="margin-left: 40px;"> 
     <span style="color: #000000;">&nbsp;&nbsp; Andere Kurven SOLLEN NICHT verwendet werden.</span> 
    </div> 
    <ol class="continue"> 
     <li><span style="color: #000000;">Falls Ciphersuiten aus (1) oder (2) unterstützt werden, so MÜSSEN diese im CC-Zertifizierungsverfahren berücksichtigt werden.</span><br> </li> 
    </ol> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-137592">
   <p><b>A_23226-01</b></p>
   <p>Der Konnektor MUSS für die Unterstützung von alten eHealth-KT folgende TLS-Vorgaben ebenfalls unterstützen:<br> 
    <ul> 
     <li>Als Cipher Suite MUSS TLS_DHE_RSA_WITH_AES_128_CBC_SHA oder TLS_DHE_RSA_WITH_AES_256_CBC_SHA unterstützt werden.</li> 
     <li>Dabei MUSS für die Schlüsselaushandlung Gruppe 14 (definiert in [RFC-3526], verwendbar bis Ende 2025) verwendet werden.</li> 
     <li>Der private DH-Exponent für den Schlüsselaustausch MUSS eine Länge von mindestens 256 Bit haben.</li> 
    </ul> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-96934">
   <p><b>A_18183</b></p>
   <p>Falls ein Anbieter einer&nbsp;anderen Anwendung des Gesundheitswesens ohne Zugriff auf Dienste der TI in angeschlossenen Netzen des Gesundheitswesens&nbsp;(WANDA Basic)&nbsp;das TLS-Protokoll verwendet, so MUSS er dabei ausschließlich Ciphersuiten und Domainparameter (Schlüssellängen, Kurvenparameter etc.), die nach [TR-02102-2] empfohlen sind, verwenden. <b>&lt;=</b></p>
  </div>
  <p id="polarion_50">Erläuterung: Eine&nbsp;andere Anwendung des Gesundheitswesens ohne Zugriff auf Dienste der TI in angeschlossenen Netzen des Gesundheitswesens (WANDA Basic) muss beim TLS-basierten Nachrichtentransport durch die TI nach [TR-02102-2] sichere Cipher-Suiten und Domainparameter verwenden. Für solch eine Anwendung ist eine die Interoperabilität mit TI-Diensten sicherstellende Einschränkung der Cipher-Suiten und Domainparameter nach GS-A_4384-* und A_17124-* nicht notwendig, d. h. beide Anforderungen gelten nicht für solche Anwendungen, sondern A_18183 gilt.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-102142">
   <p><b>A_18986</b></p>
   <p>Alle Produkttypen, die Übertragungen mittels TLS durchführen, die nur innerhalb ihres Produkttypen verlaufen (bspw. ePA-Aktensystem interne TLS-Verbindungen zwischen dem Zugangsgateway und der Komponente Authentisierung), KÖNNEN für diese TLS-Verbindungen neben den in GS-A_4384-* und ggf. A_17124-* <span id="polarion-comment:477"></span>festgelegten TLS-Vorgaben ebenfalls alle weiteren in [TR-02102-2] empfohlenen TLS-Versionen und TLS-Ciphersuiten mit den jeweiligen in [TR-02102-2] dafür aufgeführten Domainparametern (Kurven, Schlüssellängen etc.) verwenden. <b>&lt;=</b></p>
  </div>
  <p id="polarion_192">Erläuterung: A_18986 ”befreit” Produkttypen-interne TLS-Verbindungen von der Beschränkung auf die Vorgaben von GS-A_4384-* und ggf. A_17124-* und erweitert diese Vorgaben auf die Gesamtheit der in [TR-02102-2] empfohlenen TLS-Konfigurationen.</p>
  <p id="polarion_39"> Hinweis: In Abschnitt "<span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-93951" data-option-id="longoutline"></span>&nbsp;" gibt es weitere TLS-Vorgaben. </p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-7936">3.3.3 DNSSEC-Kontext</h4>
  <p id="polarion_226">Hinweis: Die Verwendung von DNSSEC innerhalb der TI wird seit 2018 nicht mehr in den TI-Spezifikationen vorgeschrieben. DNSSEC wird in der TI von den meisten Komponenten und Fachdiensten nicht mehr verwendet. Die Unterstützung von DNSSEC in den DNS-Servern der TI wird nur noch für Legacy-Anwendungen weiterbetrieben. In der TI sind fast alle Kommunikationen über TLS und damit über die PKI der TI abgesichert.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7937">
   <p><b>GS-A_4388</b></p>
   <p><p style="margin-left: 0px;"><span>Alle Produkttypen, die DNSSEC verwenden, MÜSSEN die Algorithmen und Vorg</span><span>a</span><span>ben gemäß Tabelle Tab_KRYPT_017 erfüllen.</span></p> <b>&lt;=</b></p>
  </div>
  <p id="polarion_234"></p>
  <p id="polarion_197" style="text-align: left;" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">12</span>: Tab_KRYPT_017 Algorithmen für DNSSEC </p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=3" style="width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 302pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Algorithmen Typ</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 72pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Algorithmus</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 72pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Schlüssellänge</span><br> </th> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 302pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">TSIG – symmetrischer Schlüssel zur Absicherung der Transaktionskanäle zwischen zwei Name-Server-Instanzen bei Zonentransfers, Änderungsbenachrichtigungen, dynamischen Updates und rekursiven Queries.</span><br> </td> 
     <td style="vertical-align: top;width: 72pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">HMAC-SHA-256</span><br> </td> 
     <td style="vertical-align: top;width: 72pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">256 Bit</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 302pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">DNSSEC ZSK</span><br> <span style="font-size: 10pt;line-height: 1.5;">Asymmetrische Schlüssel zur Wahrung der Authentizität und Integrität von Zonendatenobjekten.</span><br> </td> 
     <td style="vertical-align: top;width: 72pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">RSA-SHA-256 [RFC-5702]</span><br> </td> 
     <td style="vertical-align: top;width: 72pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">2048 Bit</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 302pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">DNSSEC KSK</span><br> <span style="font-size: 10pt;line-height: 1.5;">Asymmetrische Schlüssel zur Wahrung der Authentizität und Integrität von Zonendatenobjekten.</span><br> </td> 
     <td style="vertical-align: top;width: 72pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">RSA-SHA-256</span><br> <span style="font-size: 10pt;line-height: 1.5;">[RFC-5702]</span><br> </td> 
     <td style="vertical-align: top;width: 72pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">2048 Bit</span><br> </td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_237"> <span style="font-style: italic;font-size: 10pt;line-height: 1.5;">Hinweis: Nach [RFC-5702] ist die Verwendung von SHA-256 [FIPS-180-4] möglich. Schlüssellängen von RSA zwischen 512 bis 4096 Bit sind seit den Anfängen von DNSSEC möglich. Bei TSIG ist nach [RFC-4635] auch SHA-256 verwendbar und bspw. von bind seit der Version 9.5 unterstützt.</span> </p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7938">3.4 Masterkey-Verfahren (informativ)</h3>
  <p id="polarion_238">Die gematik wurde aufgefordert, beispielhaft ein mögliches Ableitungsverfahren für einen versichertenindividuellen symmetrischen Schlüssel auf Grundlage eines Ableitungsschlüssels (Masterkey) aufzuführen. Ein Kartenherausgeber ist frei in der Wahl seines Ableitungsverfahrens. Jedoch müssen beim Einsatz eines Ableitungsverfahrens, um die Qualität der Ableitung zu garantieren, insbesondere folgende Punkte beachtet werden:</p>
  <ul id="polarion_239"> 
   <li>Der Ableitungsprozess muss unumkehrbar und nicht-vorhersehbar sein, um sicherzustellen, dass die Kompromittierung eines abgeleiteten Schlüssels nicht den Ableitungsschlüssel oder andere abgeleitete Schlüssel kompromittiert.</li> 
   <li>Bei einer Schlüsselableitung (im Sinne von [ISO-11770]) basiert die kryptographische Stärke der abgeleiteten Schlüssel auf der Ableitungsfunktion und der kryptographischen Stärke des geheimen Ableitungsschlüssels (insbesondere hier dessen Entropie). Die Entropie der abgeleiteten Schlüssel ist kleiner gleich der Entropie des geheimen Ableitungsschlüssels. Um die Entropie der abgeleiteten Schlüssel sicherzustellen, muss die Entropie des geheimen Ableitungsschlüssels (deutlich) größer sein als die zu erreichende Entropie der abgeleiteten Schlüssel.</li> 
   <li>Der Betreiber eines Schlüsseldienstes muss im Falle des Einsatzes einer Schlüsselableitung (nach [ISO-11770]) in seinem Sicherheitskonzept Maßnahmen für das Bekanntwerden von Schwächen des kryptographischen Verfahrens, welche die Grundlage der Schlüsselableitung ist, darlegen.</li> 
  </ul>
  <p id="polarion_240">Ein Kartenherausgeber hat auch die Freiheit, gar kein Ableitungsverfahren zu verwenden, sondern alle symmetrischen SK.CMS aller seiner Karten sicher in seinem RZ vorzuhalten.</p>
  <p id="polarion_241">Ziel des Masterkey-Verfahrens zur Ableitung eines versichertenindividuellen Schlüssels ist es, aus einem geheimen Masterkey und einem öffentlichen versichertenindividuellen Merkmal einen geheimen symmetrischen Schlüssel abzuleiten, der zur Absicherung der Verbindung zwischen CMS und Smartcard verwendet wird. Öffentlich bedeutet an dieser Stelle nicht, dass die Merkmale selbst nicht schützenswert sind, es soll jedoch ausdrücken, dass die Vertraulichkeit des versichertenindividuellen Schlüssels nicht von der Geheimhaltung dieser Merkmale abhängt. Die Vertraulichkeit der Daten muss durch die Geheimhaltung des Masterkeys gewährleistet sein. Das bedeutet, die Geheimhaltung anderer Daten als des Masterkeys darf für die Vertraulichkeit der Daten nicht notwendig sein. Die Durchführung dieses Verfahrens muss bei gleichen Eingangsparametern immer das gleiche Ergebnis generieren.</p>
  <p id="polarion_242">Für die Durchführung des Algorithmus wird neben dem Masterkey auch noch mindestens ein versichertenindividuelles Merkmal verwendet. Die Auswahl des Merkmals ist fachlich motiviert und wird daher in diesem Dokument nicht spezifiziert. Das in Tabelle 20 beispielhafte Verfahren besteht aus einer Kombination von AES-Verschlüsselung [FIPS-197] und Hashwert-Bildung. Die Schlüssel- bzw. Hashwert-Länge ergibt sich gemäß Tabelle 21.</p>
  <p id="polarion_131" class="polarion-rte-caption-paragraph"></p>
  <p id="polarion_135" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">13</span>: Tab_KRYPT_018 Ablauf zur Berechnung eines versichertenindividuellen Schlüssels </p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=4" style="width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 74pt;height: 4pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Reihenfolge</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 294pt;height: 4pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Beschreibung</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 172pt;height: 4pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Formale Darstellung</span><br> </th> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 74pt;height: 7pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">1</span><br> </td> 
     <td style="vertical-align: top;width: 294pt;height: 7pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Bildung eines Hashwertes über dem versichertenindividuellen Merkmal unter Verwendung eines statischen Padding-Verfahrens für den Fall, dass das versichertenindividuelle Merkmal in seiner Länge nicht der Blocklänge des Hash-Algorithmus entspricht.</span><br> <span style="font-size: 10pt;line-height: 1.5;">Im Ergebnis wird ein versichertenindividuelles Merkmal geeigneter Länge für den nächsten Schritt erzeugt.</span><br> </td> 
     <td style="vertical-align: top;width: 172pt;height: 7pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">HASH#1 =</span><br> <span style="font-size: 10pt;line-height: 1.5;">SHA-256(versichertenindividuelles Merkmal)</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 74pt;height: 7pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">2</span><br> </td> 
     <td style="vertical-align: top;width: 294pt;height: 7pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">AES-Verschlüsselung des Resultats mit dem Masterkey.</span><br> <span style="font-size: 10pt;line-height: 1.5;">Durch die Verschlüsselung an dieser Stelle ist sichergestellt, dass der versichertenindividuelle Schlüssel nur durch den Besitzer des geheimen Masterkeys erzeugt werden kann.</span><br> </td> 
     <td style="vertical-align: top;width: 172pt;height: 7pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">ENC#1 = AES-256(HASH#1)</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 74pt;height: 7pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">3</span><br> </td> 
     <td style="vertical-align: top;width: 294pt;height: 7pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Bildung eines Hashwertes über dem Ergebnis des vorherigen Verarbeitungsschritts.</span><br> <span style="font-size: 10pt;line-height: 1.5;">Dies stellt sicher, dass ein Schlüssel geeigneter Länge erzeugt wird.</span><br> </td> 
     <td style="vertical-align: top;width: 172pt;height: 7pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Versichertenindividueller Schlüssel =</span><br> <span style="font-size: 10pt;line-height: 1.5;">SHA-256(ENC#1)</span><br> </td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_259">In der nachfolgenden Tabelle werden Kürzel entsprechend der Definition aus Abschnitt 3.2.3 verwendet.</p>
  <p id="polarion_260"></p>
  <p id="polarion_137" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">14</span>: Tab_KRYPT_019 eingesetzte Algorithmen für die Ableitung eines versichertenindividuellen Schlüssels </p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=5" style="width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;height: 4pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Algorithmen Typ</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;height: 4pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Algorithmus</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;height: 4pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Unterverfahren</span><br> </th> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;height: 7pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Masterkey-Verfahren für die Generierung des versichertenindividuellen Schlüssel innerhalb eines CMS</span><br> </td> 
     <td style="vertical-align: top;height: 7pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">AES basiertes Verfahren gemäß vorheriger Definition</span><br> </td> 
     <td style="vertical-align: top;height: 7pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">AES-256</span><br> <span style="font-size: 10pt;line-height: 1.5;">SHA-256</span><br> <span style="font-size: 10pt;line-height: 1.5;">anwendbar bis Ende 2029+</span><br> </td> 
    </tr> 
   </tbody> 
  </table>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7939">3.5 Hybride Verschlüsselung binärer Daten</h3>
  <p id="polarion_263">Für die hybride Verschlüsselung werden die Daten zunächst symmetrisch mittels eines zufällig gewählten geheimen symmetrischen Schlüssels verschlüsselt. Der geheime Schlüssel wird im Anschluss asymmetrisch für jeden Empfänger separat verschlüsselt.</p>
  <p id="polarion_264"> <span style="font-style: italic;font-size: 10pt;line-height: 1.5;">Hinweis: unter binären Daten sind im gesamten Dokument beliebige Daten insbesondere beliebigen Typs (Text, HTML, PDF, JPG etc.) zu verstehen. Es gilt das Prinzip: das Spezielle vor dem Allgemeinen: gibt es weitere spezielle Vorgaben für bestimmte Datenformate, sind diese für die entsprechenden Daten verpflichtend (überschreiben oder ergänzen die allgemeinen Vorgaben).</span> </p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-7940">3.5.1 Symmetrischer Anteil der hybriden Verschlüsselung binärer Daten</h4>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7941">
   <p><b>GS-A_4389</b></p>
   <p><p style="margin-left: 0px;"><span>Produkttypen, die die hybride Verschlüsselung binärer Daten durchführen, MÜ</span><span>S</span><span>SEN für den symmetrischen Anteil der Verschlüsselung die folgenden Vorgaben berück</span><span>sic</span><span>h</span><span>tigen:</span></p>
    <ul>
     <li><p><span>Als symmetrische Block-Chiffre muss AES [FIPS-197] mit einer Schlüs</span><span>sellänge von 256 Bit im Galois/Counter Mode (GCM) g</span><span>e</span><span>mäß [NIST-SP-800-38D] mit der Tag-Länge von 128 Bit verwe</span><span>n</span><span>det werden.</span></p></li>
     <li><p><span>Die IVs dürfen sich bei gleichem Schlüssel nicht wiederholen (vgl. [NIST-SP-800-38D#S.25] und [BSI-TR-02102-1#S.24]). Der IV soll e</span><span>i</span><span>ne Bitlänge von 96 Bit besitzen, seine Länge muss mindestens 96 Bit sein. Es wird empfohlen den IV zufällig zu wä</span><span>h</span><span>len (vgl. [gem</span><span>Spec_Krypt#GS-A_4367]).</span></p></li>
     <li><p><span>Hinweis: Im Normalfall ist davon auszugehen, dass für die Sicherung der I</span><span>n</span><span>tegrität und Authentizität der zu verschlüsselnden Daten zudem noch eine Signatur dieser Daten notwe</span><span>n</span><span>dig ist.</span></p></li>
    </ul> <b>&lt;=</b></p>
  </div>
  <p id="polarion_266"> <span style="font-style: italic;font-size: 10pt;line-height: 1.5;">Hinweis: In [RFC-5084] findet man Informationen über die Verwendung von AES-GCM innerhalb von CMS [RFC-5652].</span> </p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-7942">3.5.2 Asymmetrischer Anteil der hybriden Verschlüsselung binärer Daten</h4>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7943">
   <p><b>GS-A_4390</b></p>
   <p>Produkttypen, die die hybride Verschlüsselung binärer Daten durchführen, MÜSSEN für den asymmetrischen Anteil der Verschlüsselung die folgenden Vorgaben berücksichtigen:<br> 
    <ul> 
     <li>Als asymmetrisches Verschlüsselungsverfahren&nbsp;MUSS RSAES-OAEP gemäß [PKCS#1, Kapitel 7.1] verwendet werden.<br> </li> 
     <li>Als Mask-Generation-Function für die Verwendung in RSAES-OAEP MUSS MGF 1 mit SHA-256 als Hash-Funktion gemäß [PKCS#1, Anhang B.2.1] verwendet werden.<br> </li> 
    </ul> <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7944">3.6 Symmetrische Verschlüsselung binärer Daten</h3>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7945">
   <p><b>GS-A_5016</b></p>
   <p><p style="margin-left: 0px;"><span>Produkttypen, die die symmetrische Verschlüsselung binärer Daten durchführen, MÜSSEN die folgenden Vorgaben berücksic</span><span>h</span><span>tigen:</span></p>
    <ul>
     <li><p><span>Als symmetrische Block-Chiffre muss AES [FIPS-197] mit einer Schlüssellä</span><span>n</span><span>ge von 256 Bit im Galois/Counter Mode (GCM) gemäß [NIST-SP-800-38D] mit der Tag-Länge von 128 Bit verwe</span><span>n</span><span>det werden.</span></p></li>
     <li><p><span>Die IVs dürfen sich bei gleichem Schlüssel nicht wiederholen (vgl. [NIST-SP-800-38D#S.25] und [BSI-TR-02102-1#S.24]). Der IV soll e</span><span>i</span><span>ne Bitlänge von 96 Bit besitzen, seine Länge muss mindestens 96 Bit sein. Es wird empfohlen den IV zufällig zu wä</span><span>h</span><span>len (vgl. [gem</span><span>Spec_Krypt#GS-A_4367]).</span></p></li>
     <li><p><span>Hinweis: Im Normalfall ist davon auszugehen, dass für die Sicherung der I</span><span>n</span><span>tegrität und Authentizität der übertragenen Daten zudem noch eine Signatur der zu verschlüsselnden Daten notwe</span><span>n</span><span>dig ist.</span></p></li>
    </ul> <b>&lt;=</b></p>
  </div>
  <p id="polarion_270"> <span style="font-style: italic;font-size: 10pt;line-height: 1.5;">Hinweis: In [RFC-5084] findet man Informationen über die Verwendung von AES-GCM innerhalb von CMS [RFC-5652].</span> </p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7946">3.7 Signatur binärer Inhaltsdaten (Dokumente)</h3>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-137594">
   <p><b>GS-A_5080-01</b></p>
   <p>Alle Produkttypen, die CMS-Signaturen [RFC-5652] von Inhaltsdaten (wie bspw. Textdokumenten ungleich PDF/A) erzeugen oder prüfen, MÜSSEN die Algorithmen und Vorgaben der Tabelle Tab_KRYPT_020 erfüllen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_273"></p>
  <p id="polarion_139" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">15</span>: Tab_KRYPT_020 Algorithmen für die Erzeugung und Prüfung von binären Daten im Kontext von Dokumentensignaturen </p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=26" style="width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 74pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Signaturbestandteil</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 109pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Beschreibung</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 180pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Algorithmus</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 78pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Anmerkung</span><br> </th> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 74pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Signaturstandard</span><br> </td> 
     <td style="vertical-align: top;width: 109pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Signaturstandard</span><br> </td> 
     <td style="vertical-align: top;width: 180pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">ETSI TS 101 733 V1.7.4 (2008-07)</span><br> <span style="font-size: 10pt;line-height: 1.5;">Electronic Signatures and Infrastructures (ESI); CMS Advanced Electronic Signatures (CAdES)</span><br> <span style="font-size: 10pt;line-height: 1.5;">[ETSI-CAdES]</span><br> </td> 
     <td style="vertical-align: top;width: 78pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Die Verwendung des Standards ist für die Signatur von Dokumenten verpflichtend die mittels CMS [RFC-5652] erzeugt werden.</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 74pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">kryptographisches Signaturverfahren</span><br> </td> 
     <td style="vertical-align: top;width: 109pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Algorithmus für die Berechnung des Nachrichten-Digest (Hashwert des Dokuments) und die Signatur mit dem privaten Schlüssel</span><br> </td> 
     <td style="vertical-align: top;width: 180pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: normal;font-size: 10pt;line-height: 1.5;">RSASSA-PSS mit SHA-256</span><br> <span style="font-size: 10pt;line-height: 1.5;">bis Ende 2025&nbsp;<span id="polarion-comment:527"></span><br> <br> ECDSA mit SHA-256<br> bis Ende 2029+</span><br> </td> 
     <td style="vertical-align: top;width: 78pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Die Verwendung einer dieser Algorithmen ist verpflichtend.</span><br> <br> <span style="font-size: 10pt;line-height: 1.5;">Alle hier aufgeführten Signaturverfahren müssen von einer Signaturprüfenden Komponente überprüfbar sein.</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 74pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">DigestMethod</span><br> </td> 
     <td style="vertical-align: top;width: 109pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Methode zur Berechnung eines Digest der zu signierenden Bereiche</span><br> </td> 
     <td style="vertical-align: top;width: 180pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">SHA-256</span><br> </td> 
     <td style="vertical-align: top;width: 78pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Die Verwendung des Algorithmus ist verpflichtend.</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 74pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Kryptographisches Token</span><br> </td> 
     <td style="vertical-align: top;width: 109pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Kryptographisches Token für die Signatur, bestehend aus einem privaten Schlüssel und einem zugehörigen X.509-Zertifikat</span><br> </td> 
     <td style="vertical-align: top;width: 180pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Identitäten gemäß einem der folgenden Abschnitte</span><br> <span style="font-size: 10pt;line-height: 1.5;">2.1.1.1</span><br> <span style="font-size: 10pt;line-height: 1.5;">2.1.1.2</span><br> </td> 
     <td style="vertical-align: top;width: 78pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Die Auswahl des kryptographischen Tokens ist von dem jeweiligen Einsatzzweck abhängig.</span><br> </td> 
    </tr> 
   </tbody> 
  </table>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7948">3.8 Signaturen innerhalb von PDF/A-Dokumenten</h3>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-137593">
   <p><b>GS-A_5081-01</b></p>
   <p>Alle Produkttypen, die in PDF/A-Dokumenten [PDF/A-2] Signaturen einbetten/erzeugen oder diese Signaturen prüfen, MÜSSEN die Algorithmen und Vorgaben der Tabelle Tab_KRYPT_021 erfüllen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_277"></p>
  <p id="polarion_154" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">16</span>: Tab_KRYPT_021 Algorithmen für die Erzeugung und Prüfung von PDF/A-Dokumentensignaturen </p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=27" style="width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 81pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Signaturbestandteil</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 102pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Beschreibung</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 180pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Algorithmus</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 78pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Anmerkung</span><br> </th> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 81pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Signaturstandard</span><br> </td> 
     <td style="vertical-align: top;width: 102pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Signaturstandard</span><br> </td> 
     <td style="vertical-align: top;width: 180pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">ETSI TS 102 778-3 V1.2.1,</span><br> <span style="font-size: 10pt;line-height: 1.5;">PDF Advanced Electronic Signature Profiles; Part 3: PAdES Enhanced – PAdES-BES and PAdES-EPES Profiles</span><br> <span style="font-size: 10pt;line-height: 1.5;">Technical Specification, 2010 [PAdES-3]</span><br> </td> 
     <td style="vertical-align: top;width: 78pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Die Verwendung des Standards ist für die Signatur von PDF/A [PDF/A-2] Dokumenten verpflichtend, die mittels eingebetteter Signaturen signiert werden.</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 81pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">kryptographisches Signaturverfahren</span><br> </td> 
     <td style="vertical-align: top;width: 102pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Algorithmus für die Berechnung des Nachrichten-Digest (Hashwert des Dokuments) und die Signatur mit dem privaten Schlüssel</span><br> </td> 
     <td style="vertical-align: top;width: 180pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: normal;font-size: 10pt;line-height: 1.5;">RSASSA-PSS mit SHA-256</span><br> <span style="font-size: 10pt;line-height: 1.5;">bis Ende 2025&nbsp;<span id="polarion-comment:528"></span><br> <br> ECDSA mit SHA-256<br> bis Ende 2029+</span><br> </td> 
     <td style="vertical-align: top;width: 78pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Die Verwendung einer dieser Algorithmen ist verpflichtend.</span><br> <br> <span style="font-size: 10pt;line-height: 1.5;">Alle hier aufgeführten Signaturverfahren müssen von einer Signaturprüfenden Komponente überprüfbar sein.</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 81pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">DigestMethod</span><br> </td> 
     <td style="vertical-align: top;width: 102pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Methode zur Berechnung eines Digest der zu signierenden Bereiche</span><br> </td> 
     <td style="vertical-align: top;width: 180pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: normal;font-size: 10pt;line-height: 1.5;">SHA-256</span><br> </td> 
     <td style="vertical-align: top;width: 78pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Die Verwendung des Algorithmus ist verpflichtend.</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 81pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Kryptographisches Token</span><br> </td> 
     <td style="vertical-align: top;width: 102pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Kryptographisches Token für die Signatur, bestehend aus einem privaten Schlüssel und einem zugehörigen X.509-Zertifikat</span><br> </td> 
     <td style="vertical-align: top;width: 180pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Identitäten gemäß einem der folgenden Abschnitte</span><br> <span style="font-size: 10pt;line-height: 1.5;">2.1.1.1</span><br> <span style="font-size: 10pt;line-height: 1.5;">2.1.1.2</span><br> </td> 
     <td style="vertical-align: top;width: 78pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Die Auswahl des kryptographischen Tokens ist von dem jeweiligen Einsatzzweck abhängig.</span><br> </td> 
    </tr> 
   </tbody> 
  </table>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7950">3.9 Kartenpersonalisierung</h3>
  <p id="polarion_280">Vgl. auch Abschnitt 2.4 (Schlüsselerzeugung).</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7951">
   <p><b>GS-A_4391</b></p>
   <p><p style="margin-left: 0px;"><span>Der Herausgeber der eGK MUSS sicherstellen, dass bei der Personalisierung der eGK die Daten bei der Übermittlung integritätsgeschützt werden. Für die Ab</span><span>sich</span><span>e</span><span>rung der Integrität ist in diesem Kontext der AES-256 CMAC nach [NIST-SP-800-38B] (vgl. [BSI-TR-03116-1#3.2.2, 4.5.2]) zu ve</span><span>r</span><span>wenden. </span></p><p style="margin-left: 0px;"><span>Die Länge des CMAC muss 128 Bit betragen.</span></p><p style="margin-left: 0px;"><span>Nach [NIST-SP-800-38B#S.13] sollen nicht mehr als 2</span><span><sup>48</sup></span><span> Nachrichtenblöcke (2</span><span><sup>22</sup></span><span> GByte) mit dem</span><span>selbe</span><span>n</span><span> Schlüssel verarbeitet werden. Nach [NIST-SP-800-38B#S.14] ist ein CMAC anfällig für Replay-Attacken, was bei der Anwendung des CMACs zu berücksichtigen ist.</span></p> <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7952">3.10 Bildung der pseudonymisierten Versichertenidentität</h3>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7953">
   <p><b>GS-A_4392</b></p>
   <p>Alle Produkttypen, die pseudonymisierte Versichertenidentitäten berechnen, MÜSSEN den Hash-Algorithmus SHA-256 [FIPS-180-4] verwenden. <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7954">3.11 Spezielle Anwendungen von Hashfunktionen</h3>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7955">
   <p><b>GS-A_4393</b></p>
   <p>Alle Produkttypen, die Fingerprints eines öffentlichen Schlüssels oder eines Zertifikates erstellen, MÜSSEN den Hash-Algorithmus SHA-256 [FIPS-180-4] dafür verwenden. <b>&lt;=</b></p>
  </div>
  <p id="polarion_284">Erläuterung:</p>
  <p id="polarion_285">Alle CAs und der TSL-Dienst müssen im Rahmen ihrer Prozesse öffentliche Schlüssel oder Zertifikate (bspw. auf Webseiten) veröffentlichen. Dabei wird auch jeweils der SHA-256 Hashwert mit veröffentlicht.</p>
  <p id="polarion_286">Hersteller einer gSMC-KT müssen den Hashwert des auf der Karte befindlichen Zertifikats in MF/DF.KT/EF.C.SMKT.AUT.R2048 entweder auf dem ID-1-Kartenkörper drucken (das ID-000-Modul ist dann herausbrechbar) oder ausgedruckt mitliefern. Der Konnektor muss den Hashwert des Zertifikats bei initialen Pairing mit dem KT berechnen und dem Administrator präsentieren.</p>
  <p id="polarion_287">Innerhalb der CertHash-Extension als Teil einer OCSP-Response wird vom TSP ein SHA-256 Hashwert des Zertifikats, über das eine Sperrinformation gegeben wird, mitgeliefert.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7956">
   <p><b>GS-A_5131</b></p>
   <p><p style="margin-left: 0px;"><span>Alle Produkttypen, die OCSP-Anfragen stellen oder beantworten, MÜSSEN bei der Erstellung und Verwendung der CertID-Struktur (vgl. [RFC-6960, Abschnitt 4.1.1] oder [RFC-2560, Abschnitt 4.1.1]) den Hash-Algorithmus SHA-1 [FIPS-180-4] ve</span><span>r</span><span>wenden.</span></p><p style="margin-left: 0px;"><span>Ein OCSP-Server KANN auch </span><span>zusätzlich </span><span>andere Hashfunktionen im Rahmen der CertID, die nach [BSI-TR-03116-1] zulässig sind, unterstützen.</span><span> </span></p> <b>&lt;=</b></p>
  </div>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-7957">3.11.1 Hashfunktionen und OCSP (informativ)</h4>
  <p id="polarion_290">Es hat sich gezeigt, dass zum folgenden Themenkomplex eine Erläuterung hilfreich ist.</p>
  <p id="polarion_291">Im Zusammenspiel OCSP-Anfrage und OCSP-Antwort werden an drei Stellen Hashfunktionen verwendet, die theoretisch alle paarweise verschieden sein können.</p>
  <p id="polarion_292"> <span style="font-weight: bold;">Erste Stelle:</span> Zunächst erzeugt ein OCSP-Client eine OCSP-Anfrage (vgl. [RFC-6960, Abschnitt 4.1.1] oder [RFC-2560, Abschnitt 4.1.1]). Dafür muss dieser u. a. eine CertID-Datenstruktur erzeugen: </p>
  <p id="polarion_293"> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp; CertID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;&nbsp;&nbsp;&nbsp; SEQUENCE {</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; hashAlgorithm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AlgorithmIdentifier,</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; issuerNameHash&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OCTET STRING, -- Hash of issuer's DN</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; issuerKeyHash&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OCTET STRING, -- Hash of issuer's public key</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; serialNumber&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CertificateSerialNumber }</span> </p>
  <p id="polarion_16">Bei der Wahl der Hashfunktion kann er sich nur darauf verlassen, dass der OCSP-Responder als Hashalgorithmus (vgl. „hashAlgorithm“-Datenfeld) SHA-1 [FIPS-180-4] unterstützt. Für den Anfragenden und den OCSP-Responder gilt dementsprechend GS-A_5131. Er muss SHA-1 für die CertID-Struktur verwenden. Ein OCSP-Responder, der zusätzlich weitere Hashfunktionen unterstützt, muss nichts zurückbauen – er darf auch so in der TI arbeiten.</p>
  <p id="polarion_300">Warum ist der Einsatz von SHA-1 an dieser Stelle kryptographisch gesehen ausreichend? Da (1) ein OCSP-Responder der TI nicht für beliebige CAs arbeitet (Wahl von DN und öffentlichen Schlüssel ist damit beschränkt) und (2) i. d. R. die CertHash-Extension Teil der OCSP-Antwort ist und innerhalb der CertHash-Extension in der TI eine kryptographisch hochwertige Hashfunktion verwendet wird, ist die Verwendung von SHA-1 hier aus Sicherheitssicht betrachtet unbedenklich. (Vgl. analoges Vorgehen BNetzA-OCSP-Responder für den qualifizierten Vertrauensraum.) Es ist also sichergestellt, dass zwischen OCSP-Client und -Responder keine (evtl. von einem Angreifer böswillig herbeigeführten) Unklarheiten darüber entstehen können über welches Zertifikat gerade gesprochen wird. Es geht bei GS-A_5131 vornehmlich um die Interoperabilität von OCSP-Client und OCSP-Responder.</p>
  <p id="polarion_301">Die optionale Signatur einer OCSP-Anfrage wird in der TI nicht verwendet, damit ist die dort verwendete Hashfunktion&nbsp;für die aktuelle Betrachtung irrelevant.</p>
  <p id="polarion_302"> <span style="font-weight: bold;">Zweite Stelle:</span> Für die Beantwortung der OCSP-Anfrage erzeugt der OCSP-Responder u. a. eine CertHash-Datenstruktur: </p>
  <p id="polarion_303" style="margin-left: 40px;"> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">id-commonpki-at-certHash OBJECT IDENTIFIER ::= {1 3 36 8 313}</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">CertHash ::= SEQUENCE {</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hashAlgorithm&nbsp;&nbsp; AlgorithmIdentifier,&nbsp; -- The identifier</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp; -- of the algorithm that has been used the hash value below.</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;certificateHash OCTET STRING }</span> </p>
  <p id="polarion_308">Hierfür muss eine kryptographisch hochwertige (nach [BSI-TR-03116-1] zulässige) Hashfunktion verwendet werden. Normativ ist an dieser Stelle: „GS-A_4393 Algorithmus bei der Erstellung von Hashwerten von Zertifikaten oder öffentlichen Schlüsseln“. Spätestens an dieser Stelle können OCSP-Client und OCSP-Server sich sicher sein, ob sie über das gleiche Zertifikat sprechen.</p>
  <p id="polarion_309"> <span style="font-weight: bold;">Dritte Stelle:</span> Die OCSP-Response muss am Ende vom OCSP-Responder signiert werden. Dafür ist die Vorgabe aus Tab_KRYPT_002 „Signatur der OCSP-Response“ normativ, welche über die für die jeweiligen Zertifikate geltenden Anforderungen (bspw. GS-A_4357-01) angezogen werden. </p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7958">3.12 kryptographische Vorgaben für die SAK des Konnektors</h3>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-113178">
   <p><b>GS-A_5071-01</b></p>
   <p>Die SAK des Konnektors MUSS bei der Prüfung von qualifizierten elektronischen Signaturen mindestens folgende Verfahren wie im Algorithmenkatalog [ALGCAT] benannt, unterstützen:<br>
    <ul>
     <li>RSA</li>
     <li style="list-style: none">
      <ul>
       <li>SHA-256, SHA-384, SHA-512 nach FIPS-180-4 (März 2012) [FIPS-180-4] (jeweils Abschnitt 6.2, 6.7, 6.5 und 6.4 ebenda),<br></li>
       <li>RSASSA-PSS nach PKCS#1 (PKCS#1 v2.1: RSA Cryptographic Standard, 14.06.2002) Abschnitt 8.1 und 9.1,<br></li>
       <li>RSASSA-PKCS1-v1_5 nach PKCS#1 (PKCS#1 v2.1: RSA Cryptographic Standard, 14.06.2002) Abschnitt 8.2 und 9.2,<br></li>
       <li>bei RSA muss ein Modulus zwischen 1976 bis 4096 Bit verwendbar sein,<br></li>
      </ul></li>
     <li>ECDSA</li>
     <li style="list-style: none">
      <ul>
       <li>SHA-256 nach FIPS-180-4 (März 2012) [FIPS-180-4] (Abschnitt 6.2),</li>
       <li>ECDSA basierend auf E(F_p) (vgl. Technische Richtlinie 03111, Version 2.0) auf der Kurve P256r1 [RFC-5639].<br></li>
      </ul></li>
    </ul> <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7960">3.13 Migration im PKI-Bereich</h3>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7961">
   <p><b>GS-A_5079</b></p>
   <p>Der Anbieter einer Schlüsselverwaltung MUSS neue Vorgaben zu Algorithmen und/oder Schlüssellängen der gematik nach einer vorgegebenen Übergangsfrist umsetzen. Nach Ablauf der Übergangsfrist MÜSSEN ausschließlich diese geänderten Parameter bei der Erzeugung von Zertifikaten verwendet werden.<span style="color: #0000FF;"> </span> <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7962">3.14 Spezielle Anwendungen von kryptographischen Signaturen</h3>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7963">
   <p><b>GS-A_5207</b></p>
   <p>Alle Produkttypen, die beim initialen Pairing zwischen Konnektor und eHealth-Kartenterminal<br> 
    <ol> 
     <li>die Signatur des Shared-Secret (ShS.AUT.KT vgl. [gemSpec_KT#2.5.2.1, 3.7.2.1]) erzeugen oder prüfen, und<br> </li> 
     <li>auf Basis von RSA die TLS-Verbindung betreiben, die für das aktuell durchzuführende Pairing notwendig ist,<br> </li> 
    </ol> MÜSSEN für die Signatur des Shared-Secret und dessen Signaturprüfung&nbsp;RSASSA-PSS [PKCS#1] verwenden.<br> <b>&lt;=</b></p>
  </div>
  <p id="polarion_147">Erläuterung: Beim initialen Pairing zwischen Konnektor und eHealth-Kartenterminal wird vom Konnektor ein 16 Byte langes Geheimnis erzeugt, das bei späteren Verbindungsaufbauten zwischen Konnektor und KT im Rahmen eines Challenge-Response-Verfahrens ([gemSpec_KT#3.7.2]) verwendet wird. Dieses Geheimnis wird von der gSMC-KT des KT beim initialen Pairing signiert. Die Signatur wird vom KT zum Konnektor transportiert und dort vom Konnektor geprüft.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7964">
   <p><b>GS-A_5208</b></p>
   <p>Der Konnektor MUSS an der Schnittstelle für die externe Authentisierung die Signaturverfahren RSASSA-PKCS1-v1_5 [PKCS#1] und RSASSA-PSS [PKCS#1] anbieten. <b>&lt;=</b></p>
  </div>
  <p id="polarion_317">Erläuterung: Der Konnektor erlaubt (bei entsprechender Berechtigung) die direkte Nutzung der privaten Schlüssel MF/ DF.ESIGN/ PrK.HP.AUT.* auf einem HBA oder MF/ DF.ESIGN/ PrK.HCI.AUT.* auf einer SMC-B durch ein Primärsystem. Dies wird fast immer für eine klientenseitige TLS-Authentisierung gegenüber einem TLS-Server (außerhalb der TI) verwendet. Dafür werden über die Schnittstelle RSASSA-PKCS1-v1_5-Signaturen von den entsprechenden Karten erzeugt und über den Konnektor an ein Primärsystem übergeben. Für unbenannte Anwendungen müssen auch RSASSA-PSS-Signaturen erzeugbar sein. Diese Signaturen sind nicht als Dokumentensignaturen verwendbar, der Verwendungszweck ist in den zu den privaten Schlüsseln gehörigen Zertifikaten kodiert (ExtendedKeyUsage: keyPurposeId = id-kp-clientAuth).</p>
  <p id="polarion_231"> Hinweis: GS-A_5208 ist nicht dem PTV4-Konnektor zugewiesen, sondern die erweiterte Anforderungen <span class="polarion-rte-link" data-type="crossReference" id="fake" data-custom-label="A_17209" data-item-id="ML-92911" data-option-id="custom"></span>&nbsp;. </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7965">
   <p><b>GS-A_5340</b></p>
   <p>Der TSL-Dienst MUSS für die Signatur der TSL das Signaturverfahren RSASSA-PSS [PKCS#1] verwenden mit dem XMLDSig-Identifier „http://www.w3.org/2007/05/xmldsig-more#sha256-rsa-MGF1“ nach [RFC-6931, Abschnitt „2.3.10 RSASSA-PSS Without Parameters“]. <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-92331">3.15 ePA-spezifische Vorgaben</h3>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-93948">3.15.1 Verbindung zur VAU</h4>
  <p id="polarion_142">Die "vertrauenswürdige Ausführungsumgebung"&nbsp;(VAU) wird in [gemSpec_Dokumentenverwaltung] eingeführt. Jedes ePA-Frontend des Versicherten (FdV) muss mit jeder beliebigen VAU (egal von welchem Anbieter ePA-Aktensystem) kommunizieren können. Deshalb ist es&nbsp;für die Interoperabilität notwendig, das Kommunikationsprotokoll zwischen beiden Kommunikationspartnern&nbsp;zu definieren und dessen Verwendung zu fordern.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-90038">
   <p><b>A_15546</b></p>
   <p>Das ePA-Frontend des Versicherten MUSS bei der Kommunikation mit der VAU das Kommunikationsprotokoll aus [gemSpec_Krypt#Abschnitt "Kommunikationsprotokoll zwischen VAU und ePA-Clients"] verwenden und dabei die Rolle Client einnehmen. Dabei MUSS es die CipherConfiguration "AES-256-GCM-BrainpoolP256r1-SHA-256" (vgl. Abschnitt 6) verwenden. Das ePA-Frontend des Versicherten MUSS nach spätestens 24 Stunden das Aushandeln eines neuen AES-Sitzungsschlüssels erzwingen. Es MUSS den abgelaufenen Sitzungsschlüssel bei sich sicher löschen.<br> <b>&lt;=</b></p>
  </div>
  <p id="polarion_87">Hinweis: ein ePA-Frontend des Versicherten ist nach A_15872 (bzw. A_15873-*) [gemSpec_ePA_FdV] verpflichtet, das Zertifikat des Kommunikationspartners (VAU) zu prüfen (Kontext: Prüfung Authentizität des empfangene ECDH-Schlüssels). Nach A_15873-* (vgl. auch A_15874-*) [gemSpec_ePA_FdV] muss dabei die TSL der TI Prüfungsgrundlage sein [gemSpec_ePA_FdV].</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-90039">
   <p><b>A_15549</b></p>
   <p>Ein Client einer VAU MUSS bei der Kommunikation mit der VAU das Kommunikationsprotokoll aus [gemSpec_Krypt#Abschnitt "Kommunikationsprotokoll zwischen VAU und ePA-Clients"] verwenden. Dabei MUSS es die CipherConfiguration "AES-256-GCM-BrainpoolP256r1-SHA-256" (vgl. Abschnitt 6) verwenden.<br> Der Client einer VAU MUSS nach spätestens 24 Stunden das Aushandeln eines neuen AES-Sitzungsschlüssels erzwingen.&nbsp;Er MUSS den abgelaufenen Sitzungsschlüssel bei sich sicher löschen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-90040">
   <p><b>A_15561</b></p>
   <p>Wenn der eingesetzte Konnektor AES-NI unterstützt und AES-NI dort aktiviert ist (vgl. [BSI-TR-03116-1#Abschnitt "4.7&nbsp; Hardware-Unterstützung AES (AES-NI)"]), MUSS der Konnektor für alle AES-Ausführungen die AES-NI verwenden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-90041">
   <p><b>A_15547</b></p>
   <p>Das ePA-Aktensystem MUSS sicherstellen, dass dessen VAU bei der Kommunikation mit dem ePA-Frontend des Versicherten oder dem FM ePA das Kommunikationsprotokoll aus [gemSpec_Krypt#Abschnitt "Kommunikationsprotokoll zwischen VAU und ePA-Clients"] verwendet und dabei die Rolle Server einnimmt.&nbsp; Dabei MUSS es die CipherConfiguration"AES-256-GCM-BrainpoolP256r1-SHA-256" (vgl. Abschnitt 6) verwenden.<br> Die VAU MUSS nach spätestens 24 Stunden das Aushandeln eines neuen AES-Sitzungsschlüssels erzwingen. Die VAU MUSS den abgelaufenen Sitzungsschlüssel und das ephemere EC-Schlüsselpaar, das im ECDH Grundlage der Schlüsselableitung für diesen Schlüssel war, sicher löschen.<br> Die VAU MUSS&nbsp;ein Zertifikat aus der Komponenten-PKI der TI besitzen (mit Rollenkennung-OID "oid_epa_vau"), das einen ECC-EE-Schlüssel der VAU bestätigt. Die VAU MUSS für die Erstellung der VAUServerHello-Nachricht mit dem zugehörigen privaten EE-Schlüssel signieren (Signatur der VAUHelloServerData). In der VAUHelloServer-Nachricht MUSS die VAU das Zertifikat aufführen und die dazugehörige OCSP-Response<span style="text-decoration: line-through;background-color: #FFFF99;"></span>.<br> <b>&lt;=</b></p>
  </div>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-93950">3.15.2 Vorgaben für ePA-Schlüssel und ePA-Chiffrate</h4>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-90044">
   <p><b>A_15705</b></p>
   <p>Ein Client eines ePA-Aktensystems MUSS sicherstellen, dass<br> 
    <ol> 
     <li>die von ihnen erzeugten Aktenschlüssel (RecordKey) und Kontextschlüssel (ContextKey) AES-Schlüssel [FIPS-197] mit 256 Bit Schlüssellänge sind,<br> </li> 
     <li>diese Schlüssel von ihnen ausschließlich mittels AES/GCM analog [gemSpec_Krypt#GS-A_4373] bzw.&nbsp;[gemSpec_Krypt#GS-A_4389] verwendet werden und<br> </li> 
     <li>sie die Arbeit mit Aktenschlüssel (RecordKey) und Kontextschlüssel (ContextKey), die nicht Spiegelstrich 1. erfüllen, ablehnen.</li> 
    </ol> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-95034">
   <p><b>A_18004</b></p>
   <p>Ein Client&nbsp;eines ePA-Aktensystems MUSS Folgendes sicherstellen. <br> 
    <ol>
     <li>Der bei der Verschlüsselung mittels AES/GCM verwendete IV MUSS immer zufällig erzeugt werden und dessen Länge MUSS stets 96 Bits (12 Byte) betragen.<br></li>
     <li>Ein Chiffrat (base64-dekodiert) MUSS immer die Struktur:<br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; 12 Byte IV + AES-GCM-Ciphertext + 16 Byte AuthTag (ICV)</span><br> aufweisen.<br></li>
    </ol> <b>&lt;=</b></p>
  </div>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-93949">3.15.3 ePA-Aktensysteminterne Schlüssel</h4>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-90045">
   <p><b>A_15745</b></p>
   <p>Ein ePA-Aktensystem MUSS sicherstellen, dass<br> 
    <ol> 
     <li>es einen betreiberspezifischen Schlüssel (BS) gibt,<br> </li> 
     <li>dieser Schlüssel ein AES-Schlüssel [FIPS-197] mit 256 Bit Schlüssellänge ist,<br> </li> 
     <li>dieser Schlüssel in einem mindestens nach FIPS-140-2 Level 3 zertifizierten HSM liegt und nur dort verwendet wird,<br> </li> 
     <li>dieser Schlüssel im Betrieb ausschließlich der VAU des entsprechenden ePA-Aktensystem zugänglich ist,<br> </li> 
     <li>dieser Schlüssel nur zur Schlüsselableitung nach einem in [gemSpec_Krypt#Abschnitt 2.4] zulässigen Verfahren verwendet wird,<br> </li> 
     <li>es eine Schlüsselableitung mit diesem betreiberspezifischen Schlüssel und einem aktenspezifischen Merkmal (bspw. der KVNR) gibt und daraus ein aktenspezifischer Schlüssel (ABS) abgeleitet wird,<br> </li> 
     <li>dieser aktenspezifische Schlüssel&nbsp;ein AES-Schlüssel [FIPS-197] mit 256 Bit Schlüssellänge ist,<br> </li> 
     <li>die verschlüsselten ePA-Daten einer Akte mit diesem aktenspezifischen Schlüssel verschlüsselt werden,<br> </li> 
     <li>die verschlüsselten ePA-Daten außerhalb der VAU niemals im Klartext (also ohne mittels des ABS verschlüsselt zu sein) liegen,<br> </li> 
     <li>dieser Schlüssel (ABS) ausschließlich mittels AES/GCM analog&nbsp;[gemSpec_Krypt#GS-A_4389] verwendet wird (der ABS wird durch Anfrage der VAU im HSM berechnet (Schlüsselableitung) und dann von dort an die VAU übermittelt, die AES/GCM-Operationen mit dem ABS finden in der VAU statt),<br> </li> 
     <li>dieser Schlüssel (ABS) im Betrieb ausschließlich der VAU des entsprechenden ePA-Aktensystem zugänglich ist.<br> </li> 
    </ol> <b>&lt;=</b></p>
  </div>
  <p id="polarion_126"> Erläuterung: Das zu erreichende Ziel ist, dass, wenn ein Angreifer (mit hohem Angriffspotential, im Sinne von CC) selbst unter (1) der (hypothetischen) Annahme, die ePA an sich wäre überhaupt nicht verschlüsselt (es würde gar kein Aktenschlüssel existieren etc.) und (2), er alles im ePA-Aktensystem außer der VAU (inkl. HSM mit dem betreiberspezifischen Schlüssel)&nbsp;sicherheitstechnisch <span style="font-size: 10pt;line-height: 1.5;">kompromittiert</span>&nbsp;hätte, der Angreifer immer noch nicht auf die Klartextdaten zugreifen könnte. </p>
  <p id="polarion_130">Hintergrund ist, dass es unter dem Hybrid-Modell der ePA-Architektur aus Zugriffskontrolle und Verschlüsselung bei Entzug einer Berechtigung einem nun nicht mehr berechtigten Nutzer kryptographisch theoretisch immer noch möglich ist, die Daten der Akten, auf die er vormals berechtigten Zugriff hatte, zu entschlüsseln (er bricht&nbsp;bspw. in das Rechenzentrum des Anbieters ePA-Aktensystem ein und stiehlt dort alle Festplatten). Durch den in einem HSM beschützten betreiberspezifischen Schlüssel ist dieser beschriebene Angriff nun unterbunden.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-90046">
   <p><b>A_15746</b></p>
   <p>Ein ePA-Aktensystem MUSS sicherstellen, dass&nbsp;für die Sicherstellung der Verfügbarkeit des betreiberspezifischen Schlüssels (vgl. A_15745) eine sicherheitstechnisch geeignete Sicherung des Schlüsselmaterials erzeugt und sicher verwahrt wird.<br> <br> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-90048">
   <p><b>A_16176</b></p>
   <p>Ein ePA-Aktensystem MUSS bei innerhalb des Aktensystems eingesetzten Schlüsselmaterial, das nicht aus der TI-PKI kommt (Signatur Authorisierungstoken etc.), folgende Vorgaben umsetzen:<br> 
    <ol> 
     <li>Alle verwendeten nicht-TI-Schlüssel MÜSSEN ein Sicherheitsniveau von 120 Bit ermöglichen (vgl. [gemSpec_Krypt#5 "Migration 120-Bit Sicherheitsniveau"]).</li> 
     <li>Alle nicht-TI-RSA-Schlüssel MÜSSEN eine Mindestschlüssellänge von 3000 Bit besitzen.</li> 
     <li>Alle nicht-TI-ECC-Schlüssel MÜSSEN auf einem folgenden der Domainparametern (Kurven) basieren:</li> 
     <ol> 
      <li>P-256 oder P-384 [FIPS-186-4],</li> 
      <li>brainpoolP256r1, brainpoolP384r1 oder brainpoolP512r1 [RFC-5639].</li> 
     </ol> 
    </ol> <b>&lt;=</b></p>
  </div>
  <p id="polarion_84">Erläuterung: Ziel von A_15751 und A_16176 ist es, den Umstellungsbedarf im Rahmen der ECC-Migration der TI und ihrer Anwendungen in der Phase 2 zu minimieren.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110792">
   <p><b>A_20519</b></p>
   <p>Ein ePA-Aktensystem MUSS sicherstellen, dass<br> 
    <ol> 
     <li>der betreiberspezifische Schlüssel (BS) (vgl. A_15745) mindestens alle 5 Jahre gewechselt wird,</li> 
     <li>nach Erzeugung eines neuen BS alle auf Grundlage des alten BS erzeugten Chiffrate umgeschlüsselt werden (neue Schlüsselableitung der aktenspezifischen Schlüssel (ABS) A_15745#6, Umschlüsselung der chiffrierten Aktendaten),</li> 
     <li>anschließend die alten Chiffrate und der alte BS sicher gelöscht werden, und</li> 
     <li>die Schritte 2. und 3. spätestens 4 Wochen nach Schlüsselwechsel des BS abgeschlossen sind.</li> 
    </ol> 
    <div style="margin-left: 35.4pt;"></div> <b>&lt;=</b></p>
  </div>
  <p id="polarion_194"> Hinweis: Der betreiberspezifische Schlüssel (BS) darf gemäß A_15745 ausschließlich der VAU des ePA-Aktensystems zugänglich sein. Daher muss die Umschlüsselung in der VAU stattfinden. Dabei ist *<span style="font-weight: bold;">keine</span>* Mitwirkung des Versicherten (oder eines von ihm berechtigten Nutzers) erforderlich. </p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-93951">3.15.4 ePA-spezifische TLS-Vorgaben</h4>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-90047">
   <p><b>A_15751</b></p>
   <p>Ein ePA-Aktensystem und ein ePA-Frontend des Versicherten MÜSSEN in Bezug auf die TLS-Verbindung zwischen ihnen 
    <ol>
     <li>folgende&nbsp;Ciphersuiten unterstützen</li>
     <li style="list-style: none">
      <ul>
       <li>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 (0xC0, 0x30),</li>
       <li>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 (0xC0, 0x2F),</li>
       <li>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 (0xC0, 0x2C),</li>
       <li>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 (0xC0, 0x2B).</li>
      </ul></li>
     <li>Sie KÖNNEN weitere&nbsp;Cipher-Suiten aus [TR-02102-2, Abschnitt 3.3.1 Tabelle 1] unterstützen.&nbsp;</li>
     <li>Bei dem ephemeren Elliptic-Curve-Diffie-Hellman-Schlüsselaustausch und bei der Signaturprüfung mittels ECDSA MÜSSEN die Kurven P-256 oder P-384 [FIPS-186-4] unterstützt werden. Daneben SOLLEN die Kurven brainpoolP256r1, brainpoolP384r1 oder brainpoolP512r1 (vgl. [RFC-5639] und [RFC-7027]) unterstützt werden. Andere Kurven SOLLEN NICHT verwendet werden (Hinweis: die Intention des letzten Satzes ist insbesondere, dass die Ordnung des Basispunktes in E(F_p) nicht zu klein werden darf).</li>
    </ol> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-90049">
   <p><b>A_15833</b></p>
   <p>Ein ePA-Frontend des Versicherten MUSS die TLS-Vorgaben in A_15751 bei allen seinen TLS-Verbindungen einhalten.<br> <b>&lt;=</b></p>
  </div>
  <p id="polarion_365">Es gibt ePA-Aktensysteme deren "Zugangsgateway des Versicherten" [gemSpec_Zugangsgateway_Vers] die Verwendung von TLS-Session-Resumption per Session-ID von einem ePA-FdV verlangen. Ebenfalls gibt es ePA-Aktensysteme deren Zugangsgateway des Versicherten die Verwendung von TLS-Session-Resumption per Session-Tickets von einem ePA-FdV verlangen. Nach einem TLS-Verbindungsende muss ein ePA-FdV eine TLS-Session-Resumption verwenden, ansonsten muss der Versicherte sich neu authentisieren (erneuter Login).</p>
  <p id="polarion_366">Ein ePA-FdV muss, um die beiden Anwendungsfälle (1) Aktensystemwechsel und (2) Versicherten-Vertreter über ein ePA-FdV eines anderen Aktensystemherstellers zu ermöglichen, beide Varianten der TLS-Session-Resumption unterstützen. Die meisten TLS-Bibliotheken unterstützen beide Varianten per Default.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116193">
   <p><b>A_21269</b></p>
   <p>Ein ePA-Frontend des Versicherten MUSS sowohl TLS-Session-Resumption per Session-ID als auch TLS-Session-Resumption per Session-Tickets unterstützen. Falls im ePA-FdV (Rolle TLS-Client) Session-Daten (Session-ID oder&nbsp;oder Session-Ticket -- jeweils&nbsp;inkl. kryptographischer Daten (Premaster-Secret etc.)) vorliegen, so MUSS das ePA-FdV bei einem erneuten TLS-Verbindungsaufbau zum Zugangsgateway des Versicherten (Rolle&nbsp;TLS-Server) diese Session-Daten im Rahmen des TLS-Verbindungsaufbaus mit Session-Resumption verwenden.<br> Ein ePA-FdV (Rolle TLS-Client) MUSS falls ein Zugangsgateway des Versicherten (Rolle TLS-Server) im Rahmen eines TLS-Handshakes ein TLS-Session-Tickets sendet und der TLS-Handshake erfolgreich war, dieses Session-Ticket inkl. der für eine spätere TLS-Session-Resumption notwendigen kryptographischen Parameter (Premaster-Secret etc.) lokal speichern.<br> Ein ePA-FdV (Rolle TLS-Client) MUSS falls ein Zugangsgateway des Versicherten (Rolle TLS-Server) im Rahmen eines TLS-Handshakes kein TLS-Session-Tickets sendet und der TLS-Handshake erfolgreich war, alle für eine spätere TLS-Session-Resumption per Session-ID notwendigen Daten lokal speichern.<br> <br> Ein ePA-FdV MUSS nach Ende der Aktensitzung (bspw. der Versicherte beendet die ePA-FdV-App) alle für eine TLS-Session-Resumption notwendigen Daten lokal löschen.<br> <b>&lt;=</b></p>
  </div>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-94642">3.15.5 Schlüsselableitungsfunktionalität ePA</h4>
  <p id="polarion_22">Zur Schlüsselableitung bei der&nbsp;Schlüsselableitungsfunktionalität ePA wird die&nbsp;HKDF nach [RFC-5869] auf Basis von SHA-256 verwendet. Diese Funktion wird auch als Grundlage der Schlüsselableitungen bei TLS Version 1.3 verwendet.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-94673">
   <p><b>A_17876</b></p>
   <p>Ein SGD ePA MUSS folgende Vorgaben durchsetzen:<br> 
    <ol> 
     <li>Als Ableitungsverfahren für die Schlüsselableitung der versichertenindividuellen Schlüssel MUSS das HKDF nach [RFC-5869] auf Basis von SHA-256 verwendet werden.<br> </li> 
     <li>Die Ableitungsschlüssel MÜSSEN eine Mindestentropie von 512 Bit besitzen.<br> </li> 
    </ol> <b>&lt;=</b></p>
  </div>
  <p id="polarion_164">Ein Client eines SGD (bspw. ein ePA-FdV) erhält über einen beidseitig authentisierten Ende-zu-Ende-verschlüsselten Kanal von jeweils zwei unabhängigen SGD AES-256-Bit-Schlüssel. Diese beiden Schlüssel nutzt der Client, um den Akten- und Kontextschlüssel des Versicherten im "Zwiebelschalenprinzip" zu ver- oder zu entschlüsseln.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-94669">
   <p><b>A_17872</b></p>
   <p>Ein Client eines SGD ePA MUSS bei der Ver- und Entschlüsselung der Akten- und Kontextschlüssel im Kontext Schlüsselableitungsfunktionalität ePA folgende Vorgaben umsetzen.<br> 
    <ol> 
     <li>Als symmetrische Block-Chiffre MUSS AES [FIPS-197] mit einer Schlüssellänge von 256 Bit im Galois/Counter Mode (GCM) gemäß [NIST-SP-800-38D] mit der Tag-Länge von 128 Bit verwendet werden.<br> </li> 
     <li>Der IV MUSS dabei zufällig erzeugt werden (vgl. [NIST-SP-800-38D#S.25] und [BSI-TR-02102-1#S.24]).<br> </li> 
     <li>Der IV MUSS eine Bitlänge von 96 Bit (12 Byte) besitzen.<br> </li> 
    </ol> <b>&lt;=</b></p>
  </div>
  <p id="polarion_166"> Für die Ende-zu-Ende-verschlüsselte Datenübertragung zwischen Client und SGD-HSM wird ECIES (vgl. [SEC1-2009#5.1 Elliptic Curve Integrated Encryption Scheme], [TR-02102-1#<span style="font-size: 10pt;line-height: 1.5;">3.3. </span>ECIES-Verschlüsselungsverfahren] und Abschnitt&nbsp;<span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-92597" data-option-id="longoutline"></span>&nbsp;) verwendet. Dabei besitzt der Empfänger einen elliptischen Kurvenpunkt (öffentlicher Schlüssel), dessen Authentizität der Sender prüfen kann. Dies wird erreicht, indem der Kurvenpunkt des Empfängers (entweder Client oder SGD-HSM)&nbsp;mittels der Langzeitidentität des Empfängers signiert ist. Der Sender erzeugt ein ephemeres ECDH-Schlüsselpaar. Mit diesem und dem Kurvenpunkt des Empfängers führt der Sender einen ECDH-Schlüsselaustausch durch. Aus dem berechneten ECDH-Geheimnis berechnet der Sender mittels einer HKDF auf Basis von SHA-256 einen AES-256-Bit-Schlüssel der im Galois/Counter-Mode (GCM) verwendet wird (Authenticated Encryption). Damit verschlüsselt der Sender den Klartext und erhält ein AES-GCM-Chiffrat. Der Sender sendet seinen erzeugten ephemeren Kurvenpunkt und das AES-GCM-Chiffrat an den Empfänger. Damit ist der Nachrichtentransport Ende-zu-Ende-verschlüsselt zwischen Sender und Empfänger, jedoch nur einseitig authentisiert. Die beidseitige Authentisierung wird über einen Authentisierungstoken, den das SGD-HSM für einen Client erzeugt, erreicht (vgl. [gemSpec_SGD_ePA#<span class="polarion-rte-link" data-type="polarion" id="fake" data-custom-label="Datenkanal zwischen Client und SGD (informativ)" data-url="/wiki/Spezifikation/gemSpec_SGD_ePA?selection=ML-94770"></span>]). Für das ECIES-Verfahren gilt der kryptographische Sicherheitsbeweis aus [ABR-1999]. </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-94670">
   <p><b>A_17873</b></p>
   <p>Ein SGD ePA MUSS sicherstellen, dass die zwei Schlüsselpaare (vgl. [gemSpec_SGD_ePA#<span class="polarion-rte-link" data-type="polarion" id="fake" data-custom-label="A_17910" data-url="/wiki/Spezifikation/gemSpec_SGD?selection=ML-94715"></span>&nbsp;(S4)&nbsp;]) für &nbsp;den ECIES-Nachrichtenempfang durch das SGD-HSM auf Basis der&nbsp;Kurvenparameter brainpoolP256r1 [RFC-5639] gewählt werden. Für die Authentisierung der öffentlichen ECIES-Schlüssels (Signatur mit [gemSpec_SGD_ePA#<span class="polarion-rte-link" data-type="polarion" id="fake" data-custom-label="A_17910" data-url="/wiki/Spezifikation/gemSpec_SGD?selection=ML-94715"></span>&nbsp;(S1)&nbsp;] und Kodierung nach [gemSpec_SGD_ePA#<span class="polarion-rte-link" data-type="polarion" id="fake" data-custom-label="A_17894" data-url="/wiki/Spezifikation/gemSpec_SGD_ePA?selection=ML-94692"></span>&nbsp;]) MUSS ECDSA [BSI-TR-03111] verwendet werden.<br> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-94671">
   <p><b>A_17874</b></p>
   <p>Ein Client eines SGD ePA MUSS für den Nachrichtenempfang mittels des ECIES-Verfahrens im Kontext der Schlüsselableitungsfunktionalität ePA bei den verwendeten ECC-Schlüsseln die Kurvenparameter brainpoolP256r1 [RFC-5639] verwenden. Für die Authentisierung des öffentlichen ECIES-Schlüssels des Clients (Signatur mit AUT-Identität des Nutzers des Clients gemäß [gemSpec_SGD_ePA#<span data-url="/wiki/Spezifikation/gemSpec_SGD_ePA?selection=ML-94701" data-custom-label="A_17901" id="fake" data-type="polarion" class="polarion-rte-link"></span>]) MUSS ECDSA [BSI-TR-03111] verwendet werden.<br> <b>&lt;=</b></p>
  </div>
  <p id="polarion_247"> In <span class="polarion-rte-link" data-type="crossReference" id="fake" data-custom-label="A_17873" data-item-id="ML-94670" data-option-id="custom"></span>&nbsp;und in&nbsp;<span class="polarion-rte-link" data-type="crossReference" id="fake" data-custom-label="A_17874" data-item-id="ML-94671" data-option-id="custom"></span>&nbsp;wird nicht aufgeführt, welche Hashfunktion im Rahmen der Signaturstellung und -prüfung zu verwenden ist. Dies wird mit folgender Anforderung nachgeholt. </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-108403">
   <p><b>A_19971</b></p>
   <p>Ein SGD ePA und ein Client eines SGD ePA MÜSSEN bei der Signaturerstellung und -prüfung im Kontext:<br> 
    <ol> 
     <li>Signaturerstellung mit [gemSpec_SGD_ePA#<span class="polarion-rte-link" data-type="polarion" id="fake" data-custom-label="A_17910" data-url="/wiki/Spezifikation/gemSpec_SGD?selection=ML-94715"></span>&nbsp;(S1)&nbsp;] und Kodierung nach [gemSpec_SGD_ePA#<span class="polarion-rte-link" data-type="polarion" id="fake" data-custom-label="A_17894" data-url="/wiki/Spezifikation/gemSpec_SGD_ePA?selection=ML-94692"></span>] (vgl. <span class="polarion-rte-link" data-type="crossReference" id="fake" data-custom-label="A_17873" data-item-id="ML-94670" data-option-id="custom"></span>), bzw. Prüfung dieser Signatur, und</li> 
     <li>Signaturerstellung für die Authentisierung der&nbsp;öffentlichen ECIES-Schlüssels des Clients (vgl.&nbsp;<span class="polarion-rte-link" data-type="crossReference" id="fake" data-custom-label="A_17874" data-item-id="ML-94671" data-option-id="custom"></span>), bzw. Prüfung dieser Signatur</li> 
    </ol> die Hashfunktion SHA-256 [FIPS-180-4] verwenden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-94672">
   <p><b>A_17875</b></p>
   <p>Ein SGD ePA und ein Client eines SGD ePA&nbsp;MÜSSEN folgende Vorgaben umsetzen.<br> 
    <ol>
     <li>Für den Ende-zu-Ende-verschlüsselten Datenaustausch zwischen SGD-Client und SGD-HSM MUSS das ECIES-Verfahren [SEC1-2009] verwendet werden.<br></li>
     <li>Der ECDH-Schlüsselaustausch innerhalb von ECIES zwischen SGD-Client und SGD-HSM MUSS nach [NIST-800-56-A#5.7.1.2] (Hinweis: ist fachlich identisch zu [SEC1-2009#3.3.1]) durchgeführt werden.<br></li>
     <li>Aus dem gemeinsamen ECDH-Geheimnis MUSS mit der&nbsp;HKDF nach [RFC-5869]&nbsp;auf Basis von SHA-256 &nbsp;ein AES-256-Bit-Schlüssel abgeleitet werden.<br></li>
     <li>Dieser Schlüssel (siehe Punkt 3) MUSS mittels AES-GCM und den fachlichen Vorgaben für AES-GCM aus&nbsp;<span data-option-id="custom" data-item-id="ML-94669" data-custom-label="A_17872" id="fake" data-type="crossReference" class="polarion-rte-link"></span>&nbsp; verwendet werden, um den symmetrisch Teil der ECIES-Verschlüsselung authentisiert zu ver- bzw. zu entschlüsseln.<br></li>
    </ol>Hinweis: die Kodierung der Chiffrate wird in [gemSpec_SGD_ePA] festgelegt.<br> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-96279">
   <p><b>A_18023</b></p>
   <p>Ein SGD ePA MUSS folgende Vorgaben umsetzen.<br> 
    <ol> 
     <li>Die Ableitungsschlüssel für die&nbsp;Erstellung der Authentisierungstoken [gemSpec_SGD_ePA#<span class="polarion-rte-link" data-type="polarion" id="fake" data-custom-label="A_17910" data-url="/wiki/Spezifikation/gemSpec_SGD_ePA?selection=ML-94715"></span>&nbsp; (S5)] MÜSSEN eine Mindestentropie von 256 Bit besitzen.<br> </li> 
     <li>Diese Ableitungsschlüssel MÜSSEN mit der HKDF nach [RFC-5869] auf Basis von SHA-256 verwendet werden.<br> </li> 
    </ol> <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-109241">3.16 E-Rezept-spezifische Vorgaben</h3>
  <p id="polarion_62">Der Fachdienst E-Rezept besitzt zwei HTTPS-Schnittstellen, eine in der TI und eine im Internet.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116459">
   <p><b>A_21332</b></p>
   <p>Ein E-Rezept-FD, ein Apothekenverzeichnis, ein E-Rezept-Client und ein IDP MÜSSEN in Bezug auf die TLS-Verbindung zwischen ihnen 
    <ol> 
     <li>folgende&nbsp;Ciphersuiten unterstützen</li> 
     <ul> 
      <li>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 (0xC0, 0x30),</li> 
      <li>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 (0xC0, 0x2F),</li> 
      <li>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 (0xC0, 0x2C),</li> 
      <li>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 (0xC0, 0x2B).</li> 
     </ul> 
     <li>Sie KÖNNEN weitere&nbsp;Cipher-Suiten aus [TR-02102-2, Abschnitt 3.3.1 Tabelle 1] unterstützen.&nbsp;</li> 
     <li>Bei dem ephemeren Elliptic-Curve-Diffie-Hellman-Schlüsselaustausch und bei der Signaturprüfung mittels ECDSA MÜSSEN die Kurven P-256 oder P-384 [FIPS-186-4] unterstützt werden. Daneben SOLLEN die Kurven brainpoolP256r1, brainpoolP384r1 oder brainpoolP512r1 (vgl. [RFC-5639] und [RFC-7027]) unterstützt werden. Andere Kurven SOLLEN NICHT verwendet werden (Hinweis: die Intention des letzten Satzes ist insbesondere, dass die Ordnung des Basispunktes in E(F_p) nicht zu klein werden darf).</li> 
    </ol> <b>&lt;=</b></p>
  </div>
  <p id="polarion_121">Ähnlich wie bei der Anwendung ePA endet die TLS-Verbindung am E-Rezept-FD an der Webschnittstelle (Eingangspunkt). Ziel ist es die Code-Komplexität innerhalb der VAU so gering wie möglich zu halten (Trusted Computing Base), um eine ausreichende Sicherheitsanalyse des VAU-Programmcodes überhaupt erst möglich zu machen. Dafür werden die Probleme des TLS-Handlings, der Lastverteilung und des DoS-Schutzes auf Applikationsebene außerhalb der VAU an den Webschnittstellen des Fachdienstes E-Rezept bearbeitet. So kann sich der Programmcode in der VAU auf seine zentrale Aufgabe des Zugriffsschutzes der über die VAU einstellbaren und abholbaren E-Rezepte fokussieren.</p>
  <p id="polarion_278"> Um die Verbindungsstrecke zwischen Webschnittstelle und E-Rezept-VAU in Bezug auf Vertraulichkeit zu schützen, wird eine Verschlüsselung auf Anwendungsebene eingeführt. Bei ePA ist dies das VAU-Protokoll. Beim E-Rezept kann aufgrund der andersartigen Anwendungslogik in der E-Rezept-VAU ein einfacheres Sicherungsverfahren verwendet werden. Dieses ist in Abschnitt&nbsp;<span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-109239" data-option-id="longoutline"></span>&nbsp;normativ definiert.&nbsp; </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-128549">
   <p><b>A_22698</b></p>
   <p>Der Fachdienst E-Rezept MUSS folgende Punkte sicherstellen.<br> 
    <ol>
     <li>Die VAU MUSS einen mindestens 120-Bit-Entropie-haltigen Pseudonymisierungsschlüssel erzeugen und zur Verwendung durch die VAU vorhalten.</li>
     <li>Dieser Pseudonymisierungsschlüssel MUSS ausschließlich durch die VAU verwendbar sein (Backups durch den Betreiber, welche durch ein Mehr-Augen-Prinzip geschützt werden, sind zulässig).</li>
     <li>Dieser Pseudonymisierungsschlüssel MUSS halbjährlich automatisch durch die VAU neu erzeugt (gewechselt) werden.</li>
     <li>Die VAU MUSS im Falle, dass der Nutzer eine LEI ist, die Telematik-ID des Nutzers ermitteln und dann mittels der HKDF nach [RFC-5869] auf Basis von SHA-256, dem geheimen Pseudonymisierungsschlüssel und der Telematik-ID ein 256 Bit langes LEI-Pseudonym erzeugen (d. h., Ausgabelänge der HKDF ist also 256 Bit (32 Byte), IKM (vgl. [RFC-5869) = PS, info (vgl. [RFC-5869]) = Telematik-ID, salt (vgl. [RFC-5869] = „“ (leere Zeichenkette)).</li>
     <li>Die VAU MUSS das in (4) erzeuge LEI-Pseudonym zusammen&nbsp; mit den weiteren, für die Rohdatenlieferung definierten, Informationen an den äußeren E-Rezept-FD (!= VAU) weiter geben.</li>
    </ol> <b>&lt;=</b></p>
  </div>
  <p id="polarion_2"> Erläuterung zu A_22698-*:<br> Der Pseudonymisierungsschlüssel kann auch nur in Software vorliegen – muss also nicht zwangsweise in einem HSM vorliegen.<br> Für die Unterstützung von betrieblichen Prozessen soll dem E-Rezept-Projekt ein Überblick über die Anzahl der aktuell im Feld befindlichen Primärsystem-Versionen zur Verfügung gestellt werden. Der E-Rezept-FD übermittelt die Pseudonyme als Teil der Rohdatenlieferung an die gematik. </p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-107285">3.17 KOM-LE-spezifische Vorgaben</h3>
  <p id="polarion_158"> Bei KOM-LE werden E-Mail-Anhänge&nbsp;<span style="font-size: 10pt;line-height: 1.5;">, deren Gesamtgröße 15 MiB überschreitet, separat symmetrisch verschlüsselt und das Chiffrat auf dem "Fachdienst Download-Server (KAS)" abgelegt.&nbsp;</span>Das Chiffrat erhält eine ID, die aus dem Hashwert des Chiffrats gebildet wird. Dabei ist die in&nbsp;<span class="polarion-rte-link" data-type="crossReference" id="fake" data-custom-label="A_19644" data-item-id="ML-107287" data-option-id="custom"></span>&nbsp;festgelegte Hashfunktion zu verwenden. Der verwendete symmetrische Schlüssel und die Hashwert-Referenz sind dann Teil des Klartextes der verschlüsselten E-Mail-Nachricht (KOM-LE). Die Chiffrate auf dem&nbsp;Download-Server (KAS) werden automatisch nach einer bestimmten im FD festgelegten Zeit gelöscht. </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107287">
   <p><b>A_19644</b></p>
   <p>Ein KOM-LE-Client und der Fachdienst Download-Server (KAS) MÜSSEN bei der Erzeugung und Verwendung von Hashwert-Referenzen für Anhänge - die auf dem Fachdienst Download-Server (KAS) abgelegt werden - &nbsp;die Hashfunktion SHA-256 [FIPS-180-4] verwenden. <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-137117">3.18 HMAC-Sicherung der Prüfziffer VSDM</h3>
  <p id="polarion_228"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-136451">
   <p><b>A_23460</b></p>
   <p>Ein Betreiber eines VSDM-Dienstes MUSS den HMAC-Sicherungsschlüssel für die kryptographische Sicherung der VSDM-Prüfziffern zufällig mit einer Länge von 256 Bit&nbsp; (= 32 Byte) und einer Mindestentropie von 120 Bit erzeugen. <b>&lt;=</b></p>
  </div>
  <p id="polarion_230">Hinweis: es gelten die Anforderungen aus Abschnitt "2.2 Zufallszahlengeneratoren" (Güte der Zufallsquellen) auch für die VSDM-Betreiber (Anbietersteckbrief).</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-136452">
   <p><b>A_23461</b></p>
   <p>Ein Betreiber eines VSDM-Dienstes MUSS die HMAC-Sicherung der VSDM-Prüfziffern das HMAC-Verfahren aus [RFC-2104] mit der Hashfunktion SHA-256 (also nicht wie im RFC beschrieben mittels SHA-1) verwenden. Für das dabei zu verwendende geheime Schlüsselmaterial gilt A_23460-*. <b>&lt;=</b></p>
  </div>
  <p id="polarion_374">Beispiel:</p>
  <p id="polarion_441"> Wenn der geheime HMAC-Schlüssel (hexdump) <span style="font-size: 10pt;line-height: 1.5;">3a8e0064436bf2dbe7ca41ec6f1ed60beec083bc4100633281eb397cb294391c ist, so ist der HMAC-SHA-256-Wert gemäß A_23461-* auf die leere Bytefolge folgende Bitfolge (hexdump)&nbsp;<span style="font-size: 11pt;line-height: 1.5;">4c0a04f65d498113a5df2ab388d99d2c0bc6224a662b1ce529342745e7af414a&nbsp;<span id="polarion-comment:518"></span></span></span> </p>
  <p id="polarion_458"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-136454">
   <p><b>A_23463</b></p>
   <p>Ein Betreiber eines VSDM-Dienstes MUSS den HMAC-Sicherungsschlüssel mittels des ECIES-Verfahrens [SEC1-2009] für den Export an den E-Rezept-FD verschlüsseln und dabei folgende Vorgaben umsetzen <br> 
    <ol> 
     <li>Er MUSS ein ephemeres ECDH-Schlüsselpaar erzeugen und mit diesem und dem VAU-Schlüssel aus A_20160-* ein ECDH gemäß [NIST-800-56-A] durchführen. Das somit erzeugte gemeinsame Geheimnis ist Grundlage für die folgende Schlüsselableitung.</li> 
     <li>Als Schlüsselableitungsfunktion MUSS er die HKDF nach [RFC-5869] auf Basis von SHA-256 verwenden.</li> 
     <li>Dabei MUSS er den Ableitungsvektor "ecies-vau-transport" verwenden, d. h. in der Formulierung von [RFC-5869] info="ecies-vau-transport" .</li> 
     <li>Er MUSS mit dieser Schlüsselableitung einen AES-128-Bit Content-Encryption-Key für die Verwendung von AES/GCM ableiten.</li> 
     <li>Er MUSS für Verschlüsselung mittels AES/GCM einen 96 Bit langen IV zufällig erzeugen.</li> 
     <li>Er MUSS mit dem CEK und dem IV mittels AES/GCM p verschlüsseln, wobei dabei ein 128 Bit langer Authentication-Tag zu verwenden ist.</li> 
     <li>Er MUSS das Ergebnis wie folgt kodieren: chr(0x01) || &lt;32 Byte X-Koordinate von öffentlichen Schlüssel aus (a) &gt; || &lt;32 Byte Y-Koordinate&gt; || &lt;12 Byte IV&gt; || &lt;AES-GCM-Chiffrat&gt; || &lt;16 Byte AuthenticationTag&gt; (vgl. auch Tab_KRYPT_ERP und folgende die Beispielverschlüsselung).<br> Die Koordinaten sind (wie üblich) vorne mit chr(0) zu padden solange bis sie eine Kodierungslänge von 32 Byte erreichen.</li> 
    </ol> <b>&lt;=</b></p>
  </div>
  <p id="polarion_446">Beispiel:</p>
  <p id="polarion_448">Sei folgendes Zertifikat ein Beispiel-E-Rezept-VAU-Verschlüsselungszertifikat:</p>
  <p id="polarion_449"> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">-----BEGIN CERTIFICATE-----<br> MIICWzCCAgKgAwIBAgIUYVkTweOLq4G7U28Gwwb3tAghcW8wCgYIKoZIzj0EAwIw<br> gYIxCzAJBgNVBAYTAkRFMQ8wDQYDVQQIDAZCZXJsaW4xDzANBgNVBAcMBkJlcmxp<br> bjEQMA4GA1UECgwHZ2VtYXRpazEQMA4GA1UECwwHZ2VtYXRpazEtMCsGA1UEAwwk<br> RS1SZXplcHQtVkFVIEJlaXNwaWVsaW1wbGVtZW50aWVydW5nMB4XDTIyMTAwNDIx<br> NTg1OFoXDTIzMTAwNDIxNTg1OFowgYIxCzAJBgNVBAYTAkRFMQ8wDQYDVQQIDAZC<br> ZXJsaW4xDzANBgNVBAcMBkJlcmxpbjEQMA4GA1UECgwHZ2VtYXRpazEQMA4GA1UE<br> CwwHZ2VtYXRpazEtMCsGA1UEAwwkRS1SZXplcHQtVkFVIEJlaXNwaWVsaW1wbGVt<br> ZW50aWVydW5nMFowFAYHKoZIzj0CAQYJKyQDAwIIAQEHA0IABB1wleU9eglD8Q7j<br> 7HuTVyG7KJIRoJ6Rt1x8+GHvb3xeht3f5RPeETi+py3tLK5RWhFeGOIKmnydoBxJ<br> mK6VcmijUzBRMB0GA1UdDgQWBBTyOvu1E6xmEMu/6KIhI/kQJYw9CTAfBgNVHSME<br> GDAWgBTyOvu1E6xmEMu/6KIhI/kQJYw9CTAPBgNVHRMBAf8EBTADAQH/MAoGCCqG<br> SM49BAMCA0cAMEQCIGgWYuADP/Aulq0/QIzJDkCgqAXlVvmr92UPbfcRClvNAiAc<br> w8VE8xBtMx9g5sLK/HiDCsrQ9TNZjwpb5rb1t4ozgg==<br> -----END CERTIFICATE-----</span><br> </p>
  <p id="polarion_450">und folgendes der dazugehörige private Schlüssel:</p>
  <p id="polarion_451"> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">-----BEGIN EC PARAMETERS-----<br> BgkrJAMDAggBAQc=<br> -----END EC PARAMETERS-----<br> -----BEGIN EC PRIVATE KEY-----<br> MHgCAQEEII1+MNpxZfd+cPjE1Z5DCHCnuGCQt5MA6U55yuaxoB8CoAsGCSskAwMC<br> CAEBB6FEA0IABB1wleU9eglD8Q7j7HuTVyG7KJIRoJ6Rt1x8+GHvb3xeht3f5RPe<br> ETi+py3tLK5RWhFeGOIKmnydoBxJmK6Vcmg=<br> -----END EC PRIVATE KEY-----</span><br> </p>
  <p id="polarion_452">Weiterhin sei folgendes der zu verschlüsselnde HMAC-Schlüssel (hexdump)</p>
  <p id="polarion_453"> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">3a8e0064436bf2dbe7ca41ec6f1ed60beec083bc4100633281eb397cb294391c</span> </p>
  <p id="polarion_454">Dann ist folgendes der Hexdump eines Chiffrats nach A_23463</p>
  <p id="polarion_455"> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">019dec56554203624c214ac5321c798b78281d3fff4a0a4e187319ebebeba2ace40fe71913c6e02998cd3cd6f8268a0daf9f40eb1561541de9868d46eb913e3f3157d5ed6bd9d4aef792d473be5fa2868dbcd228e5a603afdae2c69fc459e656513cff835934de5e2f159b772ebbd21d6dfef2a4960ad829b968fc974b</span> </p>
  <p id="polarion_456"></p>
  <p id="polarion_457">Die gematik stellt Beispiel-Code für die Erzeugung eines Export-Pakets bereit.</p>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-7966">4 Umsetzungsprobleme mit der TR-03116-1</h2>
  <p id="polarion_322">Das u. a. durch die TR-03116-1 [BSI-TR-03116-1] angestrebte Sicherheitsniveau soll persönliche medizinische Daten effektiv schützen. Dazu lehnt sie sich an die sehr starken kryptographischen Vorgaben für die qualifizierte elektronische Signatur [SOG-IS-2020] an. Einige Formate (bspw. XMLDSig) oder Implementierungen (bspw. Standard-Java-Bibliotheken) können einige Vorgaben von Hause aus nicht erfüllen.</p>
  <p id="polarion_323">Dieses Kapitel weist auf Umsetzungsprobleme hin (ehemals Kapitel 3.3 aus dem Kryptographiekonzept des Basis-Rollouts).</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7967">4.1 XMLDSig und PKCS1-v2.1</h3>
  <p id="polarion_324">Mit [XMLDSig] allein ist aktuell keine Nutzung von RSASSA-PSS [PKCS#1] möglich.</p>
  <p id="polarion_325">Aus diesem Grund hat die gematik entschieden für die Signatur nach [XMLDSig] zusätzliche Identifier für RSASSA-PSS aus [RFC-6931] innerhalb der TI zu verwenden, welche auf der Lösung aus [XMLDSig-RSA-PSS] basieren. Der RFC-6931 [RFC-6931] ist die Aktualisierung von [RFC-4051]. Die in Abschnitt „2.3.9 RSASSA-PSS With Parameters“ und „2.3.10 RSASSA-PSS Without Parameters“ aufgeführten Identifier für RSASS-PSS-Signaturen müssen innerhalb von XMLDSig für solche Signaturen verwendet werden.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-7968">
   <p><b>GS-A_5091</b></p>
   <p>Produkttypen, die RSASSA-PSS-Signaturen [PKCS#1] innerhalb von XMLDSig erstellen oder prüfen, MÜSSEN die Identifier aus [RFC-6931] Abschnitt „2.3.9 RSASSA-PSS With Parameters“ und „2.3.10 RSASSA-PSS Without Parameters“ für die Kodierung dieser Signaturen verwenden.<span style="color: #0000FF;"> </span> <br> <b>&lt;=</b></p>
  </div>
  <p id="polarion_75">Ein Beispiel aus [RFC-6931] Abschnitt „2.3.10 RSASSA-PSS Without Parameters“:</p>
  <p id="polarion_328"> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&lt;SignatureMethod</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp; Algorithm=</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp; "http://www.w3.org/2007/05/xmldsig-more#sha256-rsa-MGF1"</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp; /&gt;</span> </p>
  <p id="polarion_333">Vgl. [gemSpec_COS, (N003.000)]: Die Hashfunktion, auf der die Mask-generation-function basiert, ist SHA-256 [FIPS-180-4]. Die Länge des salt ist gleich der Ausgabelänge eben jener Hashfunktion (= 256 Bit).</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7969">4.2 XMLEnc: Die Nutzung von RSAES-OAEP und AES-GCM</h3>
  <p id="polarion_335">Bei der Verschlüsselung mittels XMLEnc [XMLEnc] gibt es zwei Probleme in Bezug auf fehlende Identifier für kryptographische Verfahren, die in Abstimmung mit dem BSI für den Einsatz in der TI notwendig sind.</p>
  <ul id="polarion_336"> 
   <li>Für die symmetrische Verschlüsselung mittels AES-GCM ([FIPS-197], [NIST-SP-800-38D]) gibt es keine Algorithmen-Identifier innerhalb von [XMLEnc]. Solche gibt es in [XMLEnc-1.1, Abschnitt 5.2.4].</li> 
   <li>Für die Kodierung von RSA-OAEP-Chiffraten innerhalb von [XMLEnc] fehlt in [XMLEnc] ein Identifier für RSAES-OAEP mit der MGF1 basierend auf SHA-256 (vgl. auch Kapitel 5.10 „MGF Mask Generation Function“ in [gemSpec_COS]). Einen solchen Identifier(„http://www.w3.org/2009/xmlenc11#mgf1sha256“) gibt es in XMLEnc Version 1.1 [XMLEnc-1.1, Abschnitt 5.5.2]. </li> 
  </ul>
  <p id="polarion_337">Aus diesem Grund hat die gematik entschieden für die XML-Verschlüsselung die Vorgaben aus [XMLEnc-1.1] zu verwenden.</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7970">4.3 XML Signature Wrapping und XML Encryption Wrapping</h3>
  <p id="polarion_338">Komplexität ist der natürliche Feind von Sicherheit. Die unter dem Sammelbegriff XML betitelten Formate und Protokolle sind sehr flexibel und leistungsfähig, aber auch sehr komplex. Noch dazu sind Sicherheitsmechanismen in diesem Bereich zum Teil nachträglich beigefügt worden und sind damit oft weniger leistungsfähig als im CMS-Bereich. XML-Daten effektiv zu schützen ist aktives Forschungsthema [XMLEnc-CM], [XSpRES]. Öfter als in anderen Bereichen werden neue Schwachstellen bekannt [BreakingXMLEnc], [XSW-Attack].</p>
  <p id="polarion_339">Aus diesem Grunde wird bei einer Sicherheitsevaluierung gesondert auf derartige Angriffe geachtet. Die gematik beobachtet neue Entwicklungen im Bereich der XML-Sicherheit und leitet falls notwendig Maßnahmen ein.</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7971">4.4 Güte von Zufallszahlen</h3>
  <p id="polarion_340">Nach dem Kerckhoffs'schen Prinzip von 1883 [Ker-1883] darf die Sicherungsleistung von kryptographischen Verfahren alleinig auf der Geheimhaltung der geheimen oder privaten Schlüssel beruhen. Geheimhaltung inkludiert insbesondere, dass sie nicht erraten werden können. Wenn bei einer Schlüsselerzeugung zu wenig Entropie vorhanden ist, kann die Geheimhaltung nicht gewährleistet werden. Die kryptographischen Verfahren, welche mit diesen Schlüsseln dann arbeiten, können die von ihnen verlangten Sicherheitsleistungen nicht mehr erbringen. Aus diesem Grunde verlangt [BSI-TR-03116-1] eine Mindestgüte der Zufallszahlerzeugung u. a. bei einer Schlüsselerzeugung. Die Basis für die Beurteilung der Güte stellt [AIS-20] und [AIS-31] dar.</p>
  <p id="polarion_341">Aktuell sind nicht alle Produkte in der TI bez. dieser Mindestgüte bewertet worden. Davon sind Smartcards nicht betroffen, da diese eine Sicherheitsevaluierung/-zertifizierung durchlaufen haben, bei der die Güte der Zufallszahlenerzeugung positiv beurteilt wurde. Probleme bereiten insbesondere&nbsp;&nbsp;HSMs.</p>
  <p id="polarion_342">Neben einer möglichen Common-Criteria-Zertifizierung dieser Produkte, bei der analog zu den Smartcards die Güte geprüfte wird, gibt es weitere mögliche Lösungen:</p>
  <ol id="polarion_343"> 
   <li>gesonderte Prüfung der Güte nach [AIS-20] und [AIS-31] ohne komplette Common-Criteria-Zertifizierung,</li> 
   <li>Herstellererklärung über die Güte (wie sie bspw. aktuell bei der Kartenproduktion üblich ist).</li> 
  </ol>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-7972">5 Migration 120-Bit-Sicherheitsniveau</h2>
  <p id="polarion_346"> Das „Sicherheitsniveau eines kryptographischen Verfahrens“ ist definiert als der Logarithmus zur Basis 2 der Anzahl der „Rechenschritte“ die notwendig sind um ein kryptographisches Verfahren mit hoher Wahrscheinlichkeit zu brechen. Was als „Rechenschritt“ definiert ist, ist vom Verfahren abhängig. Das Sicherheitsniveau wird in Bit angegeben. Beispielsweise nimmt man aktuell an, dass für das Brechen einer AES-Chiffre mit 128 Bit Schlüssellänge rund 2<sup>126,4</sup> Rechenschritte, die der Durchführung einer AES-Verschlüsselung (eines 128-Bit Eingabeblocks) entsprechen, im Mittel notwendig sind. Somit erreicht eine AES-128-Bit-Verschlüsselung maximal ein Sicherheitsniveau von ca. 126,4 Bit. Eine RSA-2048-Bit-Verschlüsselung erreicht ein Sicherheitsniveau von ca. 100 Bit. </p>
  <p id="polarion_347"> Für die TI ist ab Ende 2025 ein Sicherheitsniveau von mindestens 120 Bit für alle kryptographischen Verfahren zu erreichen.<span id="polarion-comment:519"></span> Daher ist bis dahin eine Migration aller Komponenten und Dienste notwendig, die kryptographische Verfahren mit Schlüssellängen bez. Domainparametern verwenden, die nur ein Sicherheitsniveau von unter 120 Bit erreichen können. </p>
  <p id="polarion_348">Aufgrund der höheren Performanz, insbesondere in Chipkarten und Embedded-Geräten, wird nicht auf RSA-3072-Bit sondern auf ECDSA mit 256-Bit-Schlüsseln migriert.</p>
  <p id="polarion_204"> Es gibt Produkttypen, die kryptographische Verfahren so einsetzen, dass diese keine direkten Wechselwirkungen bei anderen Produkttypen besitzen. Beispielsweise werden von einem ePA-Aktensystem Autorisierungstoken (inkl. Signatur) erzeugt und diese werden von einem ePA-FdV oder als FM ePA als opakes Objekt behandelt.&nbsp;Dabei kann weiterhin RSA verwendet werden, solange die dabei verwendeten Schlüsselgrößen mindestens 3000 Bit betragen (Sicherheitsniveau 120-Bit erzielen) (<span class="polarion-rte-link" data-type="crossReference" id="fake" data-custom-label="A_16176" data-item-id="ML-90048" data-option-id="custom"></span>&nbsp;). Ggf. ist es empfehlenswert dennoch auf ECC-basierte Verfahren zu migrieren (schnellere Ausführungsgeschwindigkeit, geringere Signaturgröße). </p>
  <p id="polarion_349"> Die Migration erfolgt schrittweise und Komponenten und Dienste werden zusätzlich mit Schlüsselmaterial und Zertifikaten auf Basis von ECDSA auf der Kurve brainpoolP256r1 ausgestattet werden. Es gibt bis maximal Ende 2025 <span id="polarion-comment:531"></span>(vgl. Abschnitt 2.1.1.1) einen Parallelbetrieb in der TI. </p>
  <p id="polarion_144">Nachdem die X.509-Root der TI (Produkttyp „gematik Root-CA“), die TSPs der TI und die Objektsysteme der Chipkarten um ECC-Unterstützung für X.509-Identitäten erweitert wurden, erfolgt die schrittweise und parallele Unterstützung dieser Identitäten nun in weiteren Produkttypen bzw. Fachanwendungen.</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7973">5.1 PKI-Begriff Schlüsselgeneration</h3>
  <p id="polarion_351">In [gemKPT_PKI_TIP#3.2] wird der Begriff der Schlüsselgeneration eingeführt. Eine CA signiert Zertifikate im abstrahierten Sinne mit „ihrem Signaturschlüssel“. Dieser Schlüssel wird regelmäßig neu erzeugt und solange Verfahren und Schlüssellänge bzw. Domainparameter gleichbleiben, handelt es sich um eine neue Schlüsselversion. Kryptographisch betrachtet wurde der neue Signaturschlüssel zufällig (vgl. GS-A_4368) erzeugt, ist also kryptographisch unabhängig vom alten Signaturschlüssel, und die CA arbeitet mit mehreren kryptographischen Schlüsseln.</p>
  <p id="polarion_352"> Beispiel: im Fall der X.509-Root der TI (vgl. Abschnitt 5.2) wird ihr Signaturschlüssel im Regelfall alle zwei Jahre neu erzeugt (vgl. GEM.RCA1 und GEM.RCA2, <a href="https://download.tsl.ti-dienste.de/" target="_blank" class="descriptionLink">https://download.tsl.ti-dienste.de/</a>&nbsp;). Der Signaturschlüssel liegt hier in zwei Versionen vor. Beide Schlüssel kommen aus der Schlüsselgeneration „RSA“. </p>
  <p id="polarion_353">Für die Migration muss ein Signaturschlüssel in der X.509-Root der TI erzeugt werden, der aus der Schlüsselgeneration „ECDSA“ stammt. Für ihn gelten die Vorgaben aus [gemSpec_Krypt#GS-A_4357-01, Schlüsselgeneration „ECDSA“].</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7974">5.2 X.509-Root der TI</h3>
  <p id="polarion_354">Die X.509-Root der TI (Produkttyp: gematik Root-CA) ermöglicht es über eine klassische PKI-Baumstruktur die meisten Zertifikate der TI zu prüfen. Für zukünftige Anwendungen, die nur mit erhöhten Kosten das leistungsstarke, aber auch deutlich komplexere TSL-Modell auswerten können, ist sie eine Infrastrukturleistung der TI, so wie auch die CVC-Root.</p>
  <p id="polarion_355">Die X.509-Root muss für die Migration ECDSA-basierte Zertifikate für TSPs ausstellen können. Aufgrund von [gemSpec_PKI#GS-A_5511] muss die X.509-Root der TI neben dem Signaturschlüssel für die Schlüsselgeneration „RSA“ auch einen Signaturschlüssel für die Schlüsselgeneration „ECDSA“ gemäß GS-A_4357-01 (brainpoolP256r1) erzeugen, und diesen verwenden können.</p>
  <p id="polarion_356">Als Hilfestellung wird im Folgenden ein X.509-Root-TI-Zertifikat betrachtet. Gemäß GS-A_4357-01 muss der öffentliche ECDSA-Schlüssel der Schlüsselgeneration „ECDSA“ auf der Kurve brainpoolP256r1 liegen. Sei</p>
  <p id="polarion_357"> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">d=SHA-256(„gemSpec_Krypt-Beispiel X.509-Root-TI ECDSA-Schluessel“)</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">=0x62e50dca4da29b0b10ead635a20b51fb1ec281d11f90cde8b5a9d92371ae8052</span> </p>
  <p id="polarion_358">Dieses d wird als Ganzzahl (Little-Endian) interpretiert und dies sei der für das Beispiel maßgebliche private Schlüssel. Damit ergibt sich folgender öffentlicher Punkt auf der Kurve brainpoolP256r1:</p>
  <p id="polarion_359"> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">(0x377434509adcbb827f74acd7adf0ce72aa28ddc53be3f15ea8023a9b0722c09d,</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">0x5364a99686c02092bbf9efde9878847b90f09d90b7ac4193553820258a58dfd5)</span> </p>
  <p id="polarion_360">Folgend ist die ASN.1-DER-Kodierung des Schlüssels, so wie sie sich später auch im Zertifikat befindet, aufgeführt:</p>
  <p id="polarion_361"> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">MFowFAYHKoZIzj0CAQYJKyQDAwIIAQEHA0IABDd0NFCa3LuCf3Ss163wznKqKN3FO+PxXqgCOpsH</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">IsCdU2SplobAIJK7+e/emHiEe5DwnZC3rEGTVTggJYpY39U=</span> </p>
  <p id="polarion_362"> <br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp;</span> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;0&nbsp;&nbsp;90: SEQUENCE {</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;2&nbsp;&nbsp;20:&nbsp;&nbsp; SEQUENCE {</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;4&nbsp;&nbsp; 7:&nbsp;&nbsp;&nbsp;&nbsp; OBJECT IDENTIFIER ecPublicKey (1 2 840 10045 2 1)</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;13&nbsp;&nbsp; 9:&nbsp;&nbsp;&nbsp;&nbsp; OBJECT IDENTIFIER brainpoolP256r1 (1 3 36 3 3 2 8 1 1 7)</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp; }</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">24&nbsp;&nbsp;66:&nbsp;&nbsp; BIT STRING</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp; 04 37 74 34 50 9A DC BB 82 7F 74 AC D7 AD F0 CE</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp; 72 AA 28 DD C5 3B E3 F1 5E A8 02 3A 9B 07 22 C0</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp; 9D 53 64 A9 96 86 C0 20 92 BB F9 EF DE 98 78 84</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp; 7B 90 F0 9D 90 B7 AC 41 93 55 38 20 25 8A 58 DF</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp; D5</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp; }</span> </p>
  <p id="polarion_375">Das selbstsignierte Beispiel-Root-Zertifikat im PEM-Format:</p>
  <p id="polarion_376"> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">-----BEGIN CERTIFICATE-----</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">MIICajCCAg+gAwIBAgIBATAKBggqhkjOPQQDAjBtMQswCQYDVQQGEwJERTEVMBMG</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">A1UECgwMZ2VtYXRpayBHbWJIMTQwMgYDVQQLDCtaZW50cmFsZSBSb290LUNBIGRl</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">ciBUZWxlbWF0aWtpbmZyYXN0cnVrdHVyMREwDwYDVQQDDAhHRU0uUkNBMzAeFw0x</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">NjEyMDkwODQxNTZaFw0yNjEyMDcwODQxNTZaMG0xCzAJBgNVBAYTAkRFMRUwEwYD</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">VQQKDAxnZW1hdGlrIEdtYkgxNDAyBgNVBAsMK1plbnRyYWxlIFJvb3QtQ0EgZGVy</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">IFRlbGVtYXRpa2luZnJhc3RydWt0dXIxETAPBgNVBAMMCEdFTS5SQ0EzMFowFAYH</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">KoZIzj0CAQYJKyQDAwIIAQEHA0IABDd0NFCa3LuCf3Ss163wznKqKN3FO+PxXqgC</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">OpsHIsCdU2SplobAIJK7+e/emHiEe5DwnZC3rEGTVTggJYpY39WjgZ4wgZswHQYD</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">VR0OBBYEFBERSneTkJZDKt3uLzjddI870TMmMEIGCCsGAQUFBwEBBDYwNDAyBggr</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">BgEFBQcwAYYmaHR0cDovL29jc3Aucm9vdC1jYS50aS1kaWVuc3RlLmRlL29jc3Aw</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">DwYDVR0TAQH/BAUwAwEB/zAOBgNVHQ8BAf8EBAMCAQYwFQYDVR0gBA4wDDAKBggq</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">ghQATASBIzAKBggqhkjOPQQDAgNJADBGAiEApQ6qGHTx97IsdzgoWH9/W32yt4rk</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">udUis0xxGZ48YOUCIQCTQ4puol5YYIAZYk74mfid3JBOvMBV/XgPV2WpS/99yg==</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">-----END CERTIFICATE-----</span> </p>
  <p id="polarion_391">Relativ am Anfang des Zertifikats befindet sich die OID gemäß GS-A_4357-01</p>
  <p id="polarion_393"> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">16&nbsp;&nbsp;10:&nbsp;&nbsp; SEQUENCE {</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">18&nbsp;&nbsp; 8:&nbsp;&nbsp;&nbsp;&nbsp; OBJECT IDENTIFIER ecdsaWithSHA256 (1 2 840 10045 4 3 2)</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp; }</span> </p>
  <p id="polarion_396">Ab Offset 280 befindet sich der schon o. g. öffentlicher Schlüssel:</p>
  <p id="polarion_397"> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">282&nbsp;&nbsp;90:&nbsp;&nbsp; SEQUENCE {</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">284&nbsp;&nbsp;20:&nbsp;&nbsp;&nbsp;&nbsp; SEQUENCE {</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">286&nbsp;&nbsp; 7:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OBJECT IDENTIFIER ecPublicKey (1 2 840 10045 2 1)</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">295&nbsp;&nbsp; 9:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OBJECT IDENTIFIER brainpoolP256r1 (1 3 36 3 3 2 8 1 1 7)</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">306&nbsp;&nbsp;66:&nbsp;&nbsp;&nbsp;&nbsp; BIT STRING</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 04 37 74 34 50 9A DC BB 82 7F 74 AC D7 AD F0 CE</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 72 AA 28 DD C5 3B E3 F1 5E A8 02 3A 9B 07 22 C0</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 9D 53 64 A9 96 86 C0 20 92 BB F9 EF DE 98 78 84</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 7B 90 F0 9D 90 B7 AC 41 93 55 38 20 25 8A 58 DF</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; D5</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp; }</span> </p>
  <p id="polarion_409">Und am Ende des Zertifikats befindet sich die ECDSA-Signatur:</p>
  <p id="polarion_410"> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">535&nbsp;&nbsp;10:&nbsp;&nbsp; SEQUENCE {</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">537&nbsp;&nbsp; 8:&nbsp;&nbsp;&nbsp;&nbsp; OBJECT IDENTIFIER ecdsaWithSHA256 (1 2 840 10045 4 3 2)</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp; }</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">547&nbsp;&nbsp;73:&nbsp;&nbsp; BIT STRING, encapsulates {</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">550&nbsp;&nbsp;70:&nbsp;&nbsp;&nbsp;&nbsp; SEQUENCE {</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">552&nbsp;&nbsp;33:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INTEGER</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 00 A5 0E AA 18 74 F1 F7 B2 2C 77 38 28 58 7F 7F</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5B 7D B2 B7 8A E4 B9 D5 22 B3 4C 71 19 9E 3C 60</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; E5</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">587&nbsp;&nbsp;33:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INTEGER</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 00 93 43 8A 6E A2 5E 58 60 80 19 62 4E F8 99 F8</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 9D DC 90 4E BC C0 55 FD 78 0F 57 65 A9 4B FF 7D</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CA</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp; }</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp; }</span> </p>
  <p id="polarion_427">Wenn das oben aufgeführte Zertifikat sich in der Datei "root.pem" befindet, so kann man bspw. mittels</p>
  <p id="polarion_428" style="margin-left: 40px;"> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">openssl verify -check_ss_sig root.pem</span> </p>
  <p id="polarion_429">die Signatur überprüfen und erhält als Ausgabe:</p>
  <p id="polarion_430" style="margin-left: 40px;"> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">root.pem: C = DE, O = gematik GmbH, OU = Zentrale Root-CA der</span> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">Telematikinfrastruktur, CN = GEM.RCA3</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">error 18 at 0 depth lookup:self signed certificate</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">OK</span> </p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-92596">5.3 TSL-Dienst und ECDSA-basierte TSL allgemein</h3>
  <p id="polarion_205"> Durch die ECC-Migration dürfen bereits produktiv betriebene Komponenten und Dienste in ihrer Verfügbarkeit nicht gefährdet werden. Aus diesem Grunde wird es eine zweite TSL "TSL(ECC-RSA)" geben. Diese wird mittels ECDSA (brainpoolP256r1) signiert sein und RSA- und ECDSA-basierte CA-Zertifikate enthalten. Bis zum Abschluss der ECC-Migration wird es zwei TSL in der TI geben: die seit Beginn des Online-Betriebs der TI bestehende RSA-basierte "TSL(RSA)" und die ECDSA-basierte "TSL(ECC-RSA). Die beiden TSL sind technisch unabhängig voneinander (Kontext Sequenznummern etc.). Dementsprechend wird es in Bezug auf die ECC-Migration keinen Vertrauensankerwechsel im Sinne von [ETSI_TS_102_231_v3.1.2] geben. Die Vertrauensbeziehung zwischen den beiden durch die zwei TSL beschriebenen Vertrauensräumen&nbsp; wird über den klassischen Mechanismus der Cross-Zertifizierung realisiert. Die RSA-basierte X.509-TSL-Signer-CA wird ein X.509-Cross-Zertifikat "für" die ECDSA-basierte&nbsp;X.509-TSL-Signer-CA der TI ausstellen (vgl.<span class="polarion-rte-link" data-type="polarion" id="fake" data-custom-label="[gemSpec_PKI#A1_7689]" data-url="/wiki/Spezifikation/gemSpec_PKI?selection=ML-94209"></span>&nbsp;) und vice versa. </p>
  <p id="polarion_198"> Analog zur VL der BNetzA wird es die Möglichkeit geben vom Downloadpunkt des TSL-Dienstes "TSL(ECC-RSA)" einen Hashwert der aktuellen TSL zu erhalten und damit für das Prüfen der Aktualität der lokal gespeicherten TSL nicht immer die gesamte TSL vom Downloadpunkt neu laden zu müssen (vgl. <span class="polarion-rte-link" data-type="polarion" id="fake" data-custom-label="[gemSpec_TSL#A_17682]" data-url="/wiki/Spezifikation/gemSpec_TSL?selection=ML-94203"></span>&nbsp;). </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-92906">
   <p><b>A_17205</b></p>
   <p>Alle Produkttypen, die die TSL(ECC-RSA) signieren oder prüfen, MÜSSEN dafür das Signaturverfahren ECDSA [BSI-TR-03111] auf Basis der Domainparameter brainpoolP256r1 verwenden mit dem XMLDSig-Identifier „ <a class="descriptionLink" target="_blank" href="http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha256">http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha256</a>“ [XMLDSig]. Als Hashfunktion (Messagedigest) MUSS SHA-256 [FIPS-180-4] verwendet werden.<br> <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-92829">5.4 ECC-Unterstützung bei TLS</h3>
  <p id="polarion_206">Das TLS-Protokoll unterstützt die Verwendung von RSA- und ECC-basierten Cipher-Suiten.</p>
  <p id="polarion_180">Als Beispiel soll sich ein Konnektor mit ECC-Unterstützung mit einem "alten" eHealth-Kartenterminal (das also nur GS-A_4359 und nicht A_17124-* kennt) verbinden. Beim Verbindungsaufbau (TLS-ClientHello) gibt der TLS-Client (Konnektor) eine geordnete Liste von unterstützenden Cipher-Suiten an. Der TLS-Server (eHealth-KT) untersucht diese Liste von vorn nach hinten und wählt die erste auch von ihm unterstützte Cipher-Suite. Somit gilt:</p>
  <ol id="polarion_173"> 
   <li>Ein TLS-Client kann durch die von ihm gewählte Reihenfolge in der Liste der Cipher-Suiten angeben, welche Cipher-Suite der Client präferiert (bspw. ECC-basierte Cipher-Suiten).</li> 
   <li>Ein&nbsp; TLS-Client und ein TLS-Server können unterschiedliche Fähigkeiten besitzen (ECC-Unterstützung Ja/Nein). Solange sie eine gemeinsame Schnittmenge besitzen (in unserem Fall RSA-basierte Cipher-Suiten), können sie miteinander eine TLS-Verbindung aufbauen. </li> 
  </ol>
  <p id="polarion_182">Ein TLS-Verbindungsaufbau eines Konnektors mit ECC-Unterstützung unterscheidet sich inhaltlich nur durch 4 zusätzliche Bytes (c02bc02c, vgl. GS-A_5354-* und A_23226-*) von einem TLS-Verbindungsaufbau&nbsp;ohne ECC-Unterstützung.</p>
  <p id="polarion_184">Verbindet sich beispielsweise ein "alter" Konnektor im Rahmen von VSDM mit einem Intermediär mit Option "ECC-Migration", wählt der Intermediär nach GS-A_4384-* eine RSA-basierte Cipher-Suite. Der Verbindungsaufbau kommt zu Stande und der Konnektor wird quasi nie erfahren, dass der Intermediär ebenfalls ECC-basierte Cipher-Suiten unterstützt. Erst wenn der Konnektor per Firmware-Upgrade sozusagen mit der Option "ECC-Migration" ausgestattet wird, muss er u. a. A_17124-* Spiegelstrich&nbsp;3 umsetzen. Danach wird der Intermediär nach A_17124-* Spiegelstrich 4 die erste ECC-basierte Cipher-Suite&nbsp;bei einem TLS-Verbindungsaufbau auswählen.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-134942">
   <p><b>A_17124-01</b></p>
   <p>Alle Produkttypen, die Übertragungen mittels TLS durchführen, MÜSSEN die folgenden Vorgaben erfüllen:<br> 
    <ol> 
     <li>Zur Authentifizierung MUSS eine X.509-Identität gemäß [gemSpec_Krypt#GS-A_4359] verwendet werden.<br> </li> 
     <li>Als Ciphersuiten MÜSSEN TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 (0xC0,0x2B)&nbsp;und&nbsp; TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 (0xC0,0x2C)&nbsp;unterstützt werden.<br> </li> 
     <li>Falls der Produkttyp in der Rolle als TLS-Client agiert, so MUSS er die eben genannten Ciphersuiten gegenüber evtl. ebenfalls von ihm unterstützen RSA-basierte Ciphersuiten (vgl. GS-A_4384-*)<span id="polarion-comment:479"></span> bevorzugen (in der Liste "cipher_suites" beim ClientHello vorne an stellen, vgl.&nbsp; [RFC-5246#7.4.1.2 Client Hello]).&nbsp;<br> </li> 
     <li>&nbsp;Beim ephemeren Elliptic-Curve-Diffie-Hellman-Schlüsselaustausch (vgl. "ECDHE" im Namen der Cipher-Suites)&nbsp;MÜSSEN die Kurven P-256 und P-384 [FIPS-186-4] unterstützt werden. Es SOLLEN&nbsp;die Kurven brainpoolP256r1 und brainpoolP384r1 (vgl. [RFC-5639] und [RFC-7027]) unterstützt werden.&nbsp;Andere Kurven als in A_17124-* aufgeführt DÜRFEN NICHT verwendet werden.</li> 
    </ol> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-94320">
   <p><b>A_17775</b></p>
   <p>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta content="HTML Tidy for Java (vers. 26 Sep 2004), see www.w3.org" name="generator"><title></title><p><span>Alle Produkttypen, die Übertragungen mittels TLS durchführen und in der Rolle TLS-Server agieren, SOLLEN die Reihenfolge der Ciphersuiten in der&nbsp;Liste "cipher_suites" aus dem TLS-ClientHello bei der Auswahl der Ciphersuite befolgen.</span></p> <b>&lt;=</b></p>
  </div>
  <p id="polarion_187">Die meisten&nbsp;Software-Pakete oder TLS-zentrierten Hardware-Lösungen (TLS-Terminatoren etc.) unterstützen die (wie oft formuliert) "Honorierung" der Reihenfolge aus der Liste "cipher_suites", aber nicht alle. Deshalb und weil die Honorierung wichtig aber nicht absolut notwendig ist, wurde A_17775 als SOLL-Anforderung formuliert.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-93497">
   <p><b>A_17322</b></p>
   <p>Alle Produkttypen, die Übertragungen mittels TLS durchführen, MÜSSEN sicherstellen, dass sie nur (durch andere Anforderungen) zugelassene TLS-Ciphersuiten bzw. TLS-Versionen anbieten bzw. verwenden. <br> <b>&lt;=</b></p>
  </div>
  <p id="polarion_223">Hinweis: Im Rahmen der Zulassungstests und der CC-Evaluierung wurde dies (A_17322) stets so umgesetzt. Mit A_17322 soll dieses Vorgehen explizit auch auf Spezifikationsebene ausgesprochen und transparent gemacht werden.</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-92704">5.5 ECC-Unterstützung bei IPsec</h3>
  <p id="polarion_186">Das IKE-Protokoll [RFC-7296] wird verwendet um Schlüsselmaterial auszuhandeln für die folgende Verschlüsselung und Integritätssicherung der über IPsec geschützten IP-Pakete. Auszuhandeln bedeutet, dass ein (elliptische Kurven) Diffie-Hellman -Schlüsselaustausch durchgeführt wird. Im Gegensatz zum TLS-Protokoll Version 1.2 trägt schon die erste Protokollnachricht des Initiators (IKE_SA_INIT) einen (EC)DH-Schlüssel, evtl. aus einer kryptographischen Gruppe, die der Responder nicht unterstützt. Im Gegensatz zu TLS Version 1.3 kann dabei genau nur ein (EC)DH-Schlüssel übertragen werden, nicht eine Auswahl von Schlüsseln aus verschiedenen Gruppen. Der Initiator (Konnektor) kann im Normalfall nicht wissen, ob der Responder (VPN-Konzentrator) einen ECC-basierten DH-Schlüsselaustausch unterstützt.&nbsp;Der Initiator versucht es einfach und beginnt die IKE-Schlüsselaushandlung mit folgender Nachricht</p>
  <p id="polarion_193"> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Initiator&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Responder</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp;-------------------------------------------</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp;HDR, SAi1, KEi, Ni&nbsp; --&gt;</span><br> </p>
  <p id="polarion_196">[RFC-7296]. In KEi ist der ephemere ECDH-Schlüssel auf Grundlage der Domainparameter brainpoolP256r1 enthalten. Falls der Responder diese Domainparameter (ECC-Kurve) nicht unterstützt, antwortet der Responder mit einer&nbsp;INVALID_KE_PAYLOAD-Nachricht, in der eine vom Responder unterstützte und präferierte kryptographische Gruppe angegeben ist [RFC-7296#Abschnitt 1.2]. Somit kommt es bei einem initialen Verbindungsaufbau zwischen einen "neuen" Konnektor und einem "alten" VPN-Zugangsdienst zu einem zusätzlichen "roundtrip", was akzeptiert wird, weil dies die Schlüsselaushandlung und damit den folgenden Verbindungsfall im Normalfall nur unwesentlich verzögert. Ein "neuer" Konnektor, der ggf. solch eine INVALID_KE_PAYLOAD-Nachricht erhält, wird dann auf die Vorgaben GS-A_4382-* "zurückfallen".</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125231">
   <p><b>A_22342</b></p>
   <p>Solange ein Konnektor nur mit einem RSA-Zertifikat am VPN-Zugangsdienst registriert ist, KANN der Konnektor den IKE-Verbindungsaufbau gemäß der Vorgaben aus GS-A_4382-* durchführen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-133472">
   <p><b>A_22343-01</b></p>
   <p>Sobald der Konnektor mit einem ECC-Zertifikat am VPN-Zugangsdienst registriert ist, MUSS er den nächsten regulären Verbindungsaufbau zum VPN-Konzentrator gemäß der Vorgaben aus A_17125 durchführen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-92912">
   <p><b>A_17210</b></p>
   <p>Ein Konnektor MUSS, falls beim IKE-Verbindungsaufbau klar wird, dass der IKE-Responder (VPN-Konzentrator, VPN-Zugangsdienst) (noch) keine ECC-Verfahren unterstützt (INVALID_KE_PAYLOAD-Nachricht), auf die Vorgaben aus GS-A_4382-* "zurückfallen".<br> <b>&lt;=</b></p>
  </div>
  <p id="polarion_225">Analog zum TLS-Protokoll wählt der Responder die Cipher-Suite und ein "alter" Konnektor kann nicht erkennen, dass es sich evtl. um einen "neuen" VPN-Zugangsdienst handelt.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-92705">
   <p><b>A_17125</b></p>
   <p>Alle Produkttypen, die die Authentifizierung, den Schlüsselaustausch und die verschlüsselte Kommunikation im IPsec-Kontext durchführen, MÜSSEN die Schlüsselvereinbarung mittels IKEv2 [RFC-7296] gemäß den folgenden Vorgaben durchführen:<br> 
    <ol>
     <li>Zur Authentisierung MUSS eine Identität mit einem X.509-Zertifikat gemäß [gemSpec_Krypt#GS-A_4360] Schlüsselgeneration "ECDSA" verwendet werden.<br></li>
     <li>Für „Hash und URL“ MUSS <span style="font-size: 10pt;line-height: 1.5;">SHA-1(vgl. [RFC-7296#3.6])</span> verwendet werden.&nbsp;<br></li>
     <li>Für den Schlüsselaustausch MUSS ein ephemer ECDH verwendet werden. Dabei MUSS die Kurve brainpoolP256r1 [RFC-6954] unterstützt werden. Es KÖNNEN die Kurven brainpoolP384r1, brainpoolP512r1 [RFC-6954] und ECP Gruppen 19, 20 und 21 [RFC-5903] unterstützt werden.<br></li>
     <li>Als Verschlüsselungsverfahren im Rahmen von IKE MUSS&nbsp;AEAD_AES_128_GCM und&nbsp;AEAD_AES_256_GCM [RFC-5282] unterstützt werden (IANA.-Nr. 20) (Hinweis verpflichtend Unterstützung nach [RFC-5282#3.2]). Es MÜSSEN zudem AEAD_AES_128_GCM_12 und AEAD_AES_256_GCM_12 (IANA-Nr. 19) unterstützt werden. Es KÖNNEN weitere Verfahren nach [TR-02021-3#3.2.1 Tabelle 2] unterstützt werden.<br></li>
     <li>Als PRF für die Schlüsselerzeugung MUSS PRF_HMAC_SHA2_256 (IANA-Nr. 5) [RFC-4868] unterstützt werden.&nbsp;Es KÖNNEN weitere Verfahren nach [TR-02021-3#3.2.2 Tabelle 3] unterstützt werden.<br></li>
     <li>Als Authentisierungsverfahren MUSS ECDSA-256 als Basis von brainpoolP256r1 (IANA-Nr. 14) [RFC-7427] unterstützt werden. Es KÖNNEN weitere Verfahren nach [TR-02021-3#3.2.5 Tabelle 6] unterstützt werden.<br></li>
     <li>Für die Verschlüsselung der ESP-Pakete MUSS AES-GCM mit 16 Byte großem ICV (IANA-Nr. 20) und AES-GCM mit 12 Byte großem ICV (IANA-Nr. 19) [RFC-4106] jeweils mit 128 und 256 Bit Schlüssellänge unterstützt werden.<br> Es KÖNNEN weitere Verfahren nach [TR-02021-3#3.3.1 Tabelle 7] unterstützt werden.<br></li>
     <li>Falls weitere Verfahren nach [TR-02021-3#3.3.1 Tabelle 7] unterstützt werden, so MUSS mindestens ein Verfahren zum Integritätsschutz der ESP-Pakete aus&nbsp;[TR-02021-3#3.3.2 Tabelle 8]&nbsp;unterstützt werden. (Hinweis: bei den verpflichtend zu unterstützenden AEAD-Verfahren aus Spiegelstrich 7 ist ein zusätzlicher Integritätsschutz by-design nicht notwendig.)<br></li>
    </ol> <b>&lt;=</b></p>
  </div>
  <p id="polarion_199">Hinweis:</p>
  <p id="polarion_201"> "strongSwan" unterstützt diese Algorithmen, vgl.&nbsp;<a href="https://wiki.strongswan.org/projects/strongswan/wiki/IKEv2CipherSuites" target="_blank" class="descriptionLink">https://wiki.strongswan.org/projects/strongswan/wiki/IKEv2CipherSuites</a>&nbsp; </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-92706">
   <p><b>A_17126</b></p>
   <p>Alle Produkttypen, die mittels IPsec-Daten schützen, MÜSSEN dies ausschließlich auf Grundlage der in <span class="polarion-rte-link" data-type="crossReference" id="fake" data-custom-label="A_17125" data-item-id="ML-92705" data-option-id="custom"></span>&nbsp; (und ggf. GS-A_4382-* vgl. diesbezüglich A_17210) als zulässig aufgeführten Verfahren und Vorgaben tun.<br> <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-92907">5.6 ECDSA-Signaturen</h3>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-93561">5.6.1 ECDSA-Signaturen im XML-Format</h4>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-92908">
   <p><b>A_17206</b></p>
   <p>Alle Produkttypen, die XML-Signaturen auf Basis eines ECC-Schlüssels erzeugen oder prüfen, MÜSSEN dafür das Signaturverfahren ECDSA [BSI-TR-03111] auf Basis der Domainparameter brainpoolP256r1 verwenden. Sie MÜSSEN dabei den XMLDSig-Identifier „ <a class="descriptionLink" target="_blank" href="http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha256">http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha256</a>“ [XMLDSig verwenden. Als Hashfunktion (Messagedigest) MÜSSEN sie SHA-256 [FIPS-180-4] verwenden. <br> <b>&lt;=</b></p>
  </div>
  <p id="polarion_253"> Die Anforderung <span class="polarion-rte-link" data-type="crossReference" id="fake" data-custom-label="A_17206" data-item-id="ML-92908" data-option-id="custom"></span>&nbsp; gilt für allgemeine XML-Datensignaturen, also auch für Tokensignaturen etc. <span class="polarion-rte-link" data-type="crossReference" id="fake" data-custom-label="A_17360" data-item-id="ML-93560" data-option-id="custom"></span>&nbsp; fordert für die Interoperablität bei der Prüfbarkeit von Dokumentensignaturen die Verwendung des interoperablen Containerformats nach [ETSI-XAdES]. </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-93560">
   <p><b>A_17360</b></p>
   <p>Alle Produkttypen, die XML-Signaturen von Dokumenten auf Basis eines ECC-Schlüssels erzeugen oder prüfen, MÜSSEN dabei die Vorgaben aus A_17206 umsetzen und die Signatur nach [ETSI-XAdES] (interoperables Container-Format) bei der Erzeugung kodieren bzw. bei der Prüfung auswerten.<br> <b>&lt;=</b></p>
  </div>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-93562">5.6.2 ECDSA-Signaturen im CMS-Format</h4>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-92909">
   <p><b>A_17207</b></p>
   <p>Alle Produkttypen, die (nicht-XML-)Signaturen von Daten auf Basis eines ECC-Schlüssels erzeugen oder prüfen, MÜSSEN dafür das Signaturverfahren ECDSA [BSI-TR-03111] auf Basis der Domainparameter brainpoolP256r1&nbsp;verwenden (vgl. [RFC-5753] und [RFC-6090]).&nbsp;Als Hashfunktion (Messagedigest) MÜSSEN sie SHA-256 [FIPS-180-4] verwenden. <br> <b>&lt;=</b></p>
  </div>
  <p id="polarion_254">Die Anforderung A_17207 gilt für allgemeine (nicht-XML-)Datensignaturen, also auch für Tokensignaturen etc. A_17359 fordert für die Interoperabilität bei der Prüfbarkeit von Dokumentensignaturen die Verwendung des interoperablen Containerformats nach [ETSI-CAdES].</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-93559">
   <p><b>A_17359</b></p>
   <p>Alle Produkttypen, die (nicht-XML-)Signaturen von Dokumenten auf Basis eines ECC-Schlüssels erzeugen oder prüfen, MÜSSEN dabei die Vorgaben aus A_17207 umsetzen und die Signatur nach [ETSI-CAdES] (interoperables Container-Format) bei der Erzeugung kodieren bzw. bei der Prüfung auswerten.<br> <b>&lt;=</b></p>
  </div>
  <p id="polarion_216">Hinweis: Signaturen in PDF/A-Dokumenten werden mittels CMS kodiert.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-92910">
   <p><b>A_17208</b></p>
   <p>Alle Produkttypen, die (nicht-XML-)Signaturen auf Basis eines ECC-Schlüssels erzeugen oder prüfen, MÜSSEN dafür das Signaturverfahren ECDSA [BSI-TR-03111] auf Basis der Domainparameter brainpoolP256r1 nach [PAdES-3] und [PDF/A-2] verwenden.&nbsp;Als Hashfunktion (Messagedigest) MÜSSEN sie SHA-256 [FIPS-180-4] verwenden.<br> <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-92597">5.7 ECIES</h3>
  <p id="polarion_221">In der TI wird für die ECC-basierte Ver- und Entschlüsselung das "Elliptic Curve Integrated Encryption Scheme (ECIES)" verwendet. Es ist das einzige ECC-basierte, von den Chipkarten der TI unterstützte, Verschlüsselungsverfahren. Das ECIES ist ein hybrides Verfahren basierend auf [ABR-1999]. Es besteht&nbsp;aus einem asymmetrischen Teil (elliptic curve diffie hellman) und einen symmetrischen Teil (Verschlüsselungsverfahren und MAC-Verfahren). Weiterhin ist eine Schlüsselableitungsfunktion für das Verfahren notwendig.&nbsp;In [gemSpec_COS#6.8.2.3 Asymmetrische Entschlüsselung mittels ELC] wird definiert, welche Varianten dieser drei notwendigen Verfahren eine Chipkarte der TI unterstützt (ECDH [BSI-TR-03111#4.3.1 Key Agreement Algorithm], HKDF mittels SHA-256 und einem Zähler nach X9.63&nbsp;[BSI-TR-03110-3#A.2.3.2], AES-256-CBC und CMAC). Da im Normalfall immer für eine Identität, die Chipkarten-basiert ist, verschlüsselt wird, muss ein Sender genau diese Verfahren einsetzen. Ansonsten kann die Chipkarte das Chiffrat nicht entschlüsseln, auch wenn die Chipkarte den prinzipiell richtigen privaten Schlüssel in sich trägt.</p>
  <p id="polarion_289">Da man das gesamte Chiffrat für eine Entschlüsselung auf einmal an die Karte (innerhalb einer APDU) senden muss, kann man nur etwas weniger als 8KiB entschlüsseln (bzw. 64KiB bei extended APDUs, die jedoch nicht alle Kartenterminal unterstützen), obwohl das ECIES-Verfahren an für sich die Ver- und Entschlüsselung praktisch beliebig großer Datenmengen unterstützt. Auch wäre es aus Nutzersicht in Bezug auf die Performanz nicht akzeptabel, schon allein moderat große verschlüsselte Dokumente komplett zu einer Karte für eine Entschlüsselung zu transportieren (mehr als 18 Minuten würde dies für ein 10 MiB großes Dokument benötigen). Deswegen wird für die TI hier eine zusätzliche Metaebene&nbsp;eingeführt und normativ gefordert. Analog zu einer Verschlüsselung mittels RSAES-OAEP muss ein Sender einen Transportschlüssel zufällig erzeugen. Ein solcher Transportschlüssel, ist dann aus Sicht der Chipkarte der zu ver- oder entschlüsselnde Klartext. Der aus Nutzersicht eigentliche Klartext (Dokumente) wird nie an die Karte gesendet. Die Karte entschlüsselt den verschlüsselten Transportschlüssel und übergibt ihn anschließend an den Kartennutzer. Dieser kann mit dem Transportschlüssel nun das Dokument unabhängig von der Chipkarte entschlüsseln. Bei RSAES-OAEP wird der Transportschlüssel als Content-Encryption-Key (CEK) bezeichnet. Im hier vorliegenden Fall bei ECIES kann diese Bezeichnung zu Missverständnissen führen. Mittels ECIES wird über ein ECDH und folgender Schlüsselableitung ein Verschlüsselungsschlüssel erzeugt. Diesen kann man auch als CEK bezeichnen, weswegen im Folgenden immer nur vom Transportschlüssel gesprochen wird.</p>
  <p id="polarion_248">Da eine solche Metaebene für eine ECIES-Chiffrat-Kodierung unüblich ist (weil ohne TI-Chipkarteneinsatz unnötig), ist die Kodierung der Chiffrate mittels CMS oder XMLEnc nichttrivial und wird daher im Interesse der zu erzielenden Interoperabilität in diesem Abschnitt ausführlicher dargestellt.</p>
  <p id="polarion_219">Für die symmetrische Verschlüsselung der Nutzerdaten (Dokumente etc.) wird zufällig ein Transportschlüssel erzeugt. Für diesen gelten die Vorgaben aus GS-A_4389 (symmetrische Verschlüsselung) und GS-A_4368 (Schlüsselerzeugung). Der Transportschlüssel wird dann unkodiert ("is just the \"value\" of the content-encryption key" [RFC-5652#6.4]) zur Verschlüsselung an das ECIES-Verfahren übergeben. Bei der ECIES-Verschlüsselung müssen dann die Parameter so gewählt werden, dass eine Chipkarte der TI diese unterstützt, d. h. nach&nbsp;[gemSpec_COS#6.8.2.3 Asymmetrische Entschlüsselung mittels ELC].</p>
  <p id="polarion_189">Das erhaltene ECIES-Chiffrat muss dann als eine ASN.1-Struktur kodiert werden, die genau dem Aufbau entspricht, den man benötigt um eine Entschlüsselung mittels einer Chipkarte der TI durchzuführen (vgl. [gemSpec_COS#(N085.068) Spiegelstrich 7).</p>
  <p id="polarion_155" style="text-align: center;" class="polarion-rte-caption-paragraph"> <img src="attachments/14-screenshot-20190207-095314.png" style="width: 500px;height: 172px;"> </p>
  <p id="polarion_163" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">2</span>: ASN.1-Kodierung des Chiffrats was den Transportschlüssel enthält </p>
  <p id="polarion_297">Beispiel:</p>
  <p id="polarion_304"> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">poGOBgkrJAMDAggBAQd/SUOGQQRouC6tM2TQQ+RP3pptgdAaDF8Te7IVCkUBe2H+PJSLK4W/BXIX</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">kndiBwEfftd5wk4pjzCdC2j1q14/CIWcW89nhjEC7G47UAu2ZqmbIhxstkXV3UI2UUek/qwBwtb2</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">6aUild+5kkTZXf5674OKHSdj6IFwjggvhYt9b/CTsA==</span><br> <br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">$ dumpasn1 a.bin</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; 0 142: [6] {</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; 3&nbsp; &nbsp;9:&nbsp; &nbsp;OBJECT IDENTIFIER brainpoolP256r1 (1 3 36 3 3 2 8 1 1 7)</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp;14&nbsp; 67:&nbsp; &nbsp;[APPLICATION 73] {</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp;17&nbsp; 65:&nbsp; &nbsp; &nbsp;[6]</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; &nbsp; &nbsp; &nbsp;04 68 B8 2E AD 33 64 D0 43 E4 4F DE 9A 6D 81 D0</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; &nbsp; &nbsp; &nbsp;1A 0C 5F 13 7B B2 15 0A 45 01 7B 61 FE 3C 94 8B</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; &nbsp; &nbsp; &nbsp;2B 85 BF 05 72 17 92 77 62 07 01 1F 7E D7 79 C2</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; &nbsp; &nbsp; &nbsp;4E 29 8F 30 9D 0B 68 F5 AB 5E 3F 08 85 9C 5B CF</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; &nbsp; &nbsp; &nbsp;67</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; &nbsp; &nbsp;}</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp;84&nbsp; 49:&nbsp; &nbsp;[6]</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; &nbsp; &nbsp;02 EC 6E 3B 50 0B B6 66 A9 9B 22 1C 6C B6 45 D5</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; &nbsp; &nbsp;DD 42 36 51 47 A4 FE AC 01 C2 D6 F6 E9 A5 22 95</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; &nbsp; &nbsp;DF B9 92 44 D9 5D FE 7A EF 83 8A 1D 27 63 E8 81</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; &nbsp; &nbsp;70</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">135&nbsp; &nbsp;8:&nbsp; &nbsp;[14] 2F 85 8B 7D 6F F0 93 B0</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; &nbsp;}</span><br> Diese Datenstruktur soll konzeptionell so behandelt werden, wie ein RSA-OAEP-Chiffrat eines CEK. Es ist jedoch die hiermit neu definierte OID oid_ti_ecies_transport_encryption [gemSpec_OID] zu verwenden. </p>
  <p id="polarion_306"></p>
  <p id="polarion_227">Ein Beispiel aus [gemSpec_SMIME-KOMLE] dient als Vorlage für die Darstellung der zu verwendenden Kodierung mittels CMS (S/MIME):</p>
  <p id="polarion_244"> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ContentInfo</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">.contentType:</span> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">1.2.840.113549.1.9.16.1.23 (id</span><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">-ct-authEnvelopedData)</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">..AuthEnvelopedData</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">...version: 0</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">...recipientInfos</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">....RecipientInfo</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">.....ktri</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">......version: 0</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">......rid</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">.......issuerAndSerialNumber</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">........issuer</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">........[... weitere Kindelemente ...]</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">........SerialNumber: 123456789</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">.......keyEncryptionAlgorithm</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">........oid_ti_ecies_transport_encryption</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">.......encryptedKey: [ ...&nbsp;ASN.1-Struktur (Tupel (PO, C, T)&nbsp;in kartenkompatibler ASN.1-Binärverpackung) ... ]</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">....RecipientInfo</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">.....ktriversion: 0</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">......rid</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">.......issuerAndSerialNumber</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">........issuer</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">........[... weitere Kindelemente ...]</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">........SerialNumber: 314159265</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">.......keyEncryptionAlgorithm</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">........OID TI-ECIES-TransportEncryption</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">.......encryptedKey: [ ...&nbsp;ASN.1-Struktur (Tupel (PO, C, T)&nbsp;in kartenkompatibler ASN.1-Binärverpackung) ... ]</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">...authEncryptedContentInfo</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">....contentType:</span> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">1.2.840.113549.1.7.1</span> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">(id-data)</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">....contentEncryptionAlgorithm:</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">.....algorithm: 2.16.840.1.101.3.4.1.46 (id-aes256-gcm)</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">......parameters:</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">.......aes-nonce: [... IV ...]</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">.......</span><span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">aes-ICVlen</span><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">: [... ICVLen ... ]</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">....encryptedContent: [...]</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">...mac: [...]</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">...unauthAttrs</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">....Attribute (id-recipientEmails)</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">.....attrType: komle-recipient-emails</span> </p>
  <p id="polarion_245"> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">und so weiter ...</span> </p>
  <p id="polarion_326">Für die Kodierung von TI-ECIES-Chiffraten innerhalb von XML wird hiermit der neue Identifier "http://gematik.de/ecies/2019" definiert. Für die XML-Kodierung ist eine Kodierung analog der folgenden Struktur zu verwenden.</p>
  <p id="polarion_246"> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&lt;xenc:EncryptedData</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; xmlns:xenc="http://www.w3.org/2001/04/xmlenc#"</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; xmlns:ds="http://www.w3.org/2000/09/xmldsig#"</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; xmlns:dsig11="http://www.w3.org/2009/xmldsig11#"</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; xmlns:xenc11="http://www.w3.org/2009/xmlenc11#"</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; Type="http://www.w3.org/2001/04/xmlenc#"&gt;</span><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;background-color: #FFFF99;"><br> </span><span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp; &lt;xenc:EncryptionMethod Algorithm="http://www.w3.org/2009/xmlenc11#aes256-gcm" /&gt;</span> </p>
  <p id="polarion_73"> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&lt;!-- Damit ist len(IV)=12 Byte und TagLen=16 Byte, vgl. [XMLEnc#5.2.4 AES-GCM] --&gt;&nbsp;</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &lt;ds:KeyInfo&gt;</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; &lt;xenc:EncryptedKey&gt;</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; &lt;!-- Hybridschlüssel für einen Empfänger, für weitere Empfänger gäbe es jeweils ein weiteres EncryptedKey-Element --&gt;</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; &nbsp; &lt;xenc:EncryptionMethod Algorithm="http://gematik.de/ecies/2019" /&gt;</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; &nbsp; &lt;!-- Die Version des speziellen ECIES --&gt;</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; &nbsp; &lt;ds:KeyInfo&gt;&nbsp;</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;"> &nbsp; &nbsp; &nbsp; &nbsp; &lt;ds:X509Data&gt;</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &lt;ds:X509Certificate&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;!-- Base64-kodiertes X.509-Zertifikat (DER) des Empfängers --&gt;</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &lt;/ds:X509Certificate&gt;&nbsp;</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;/ds:X509Data&gt;</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; &nbsp; &lt;/ds:KeyInfo&gt;</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; &nbsp; &lt;xenc:CipherData&gt;</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;xenc:CipherValue&gt;</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&lt;!-- Base64-kodierte ASN.1-Struktur (Tupel (PO, C, T)&nbsp;in kartenkompatibler ASN.1-Binärverpackung) --&gt;</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;/xenc:CipherValue&gt;</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; &nbsp; &lt;/xenc:CipherData&gt;</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; &lt;/xenc:EncryptedKey&gt;</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &lt;/ds:KeyInfo&gt;&nbsp; &nbsp;</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &lt;xenc:CipherData&gt;</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; &lt;xenc:CipherValue&gt;</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&lt;!--</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Base64-kodiertes symmetrisch mittels AES-256-GCM verschlüsseltes Dokument&nbsp;</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">(IV || ciphertext || Tag) mit len(IV)=12 Byte und len(Tag)=16 Byte,</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">vgl. [XMLEnc#5.2.4 AES-GCM]</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">--&gt;</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &nbsp; &lt;/xenc:CipherValue&gt;</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp; &lt;/xenc:CipherData&gt;&nbsp;</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&lt;/xenc:EncryptedData&gt;</span><br> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-92933">
   <p><b>A_17220</b></p>
   <p>Alle Produkttypen, die binäre Daten (also nicht XML-Daten) ECC-basiert verschlüsseln (im Folgenden als Nutzerdaten bezeichnet) und diese mittels CMS [RFC-5626] kodieren, MÜSSEN folgende Vorgaben umsetzen.<br> 
    <ol>
     <li>Zunächst MUSS ein 256-Bit AES-Schlüssel zufällig erzeugt werden (vgl.&nbsp;GS-A_4368),<br> Dieser Schlüssel wird im Folgenden als Transportschlüssel bezeichnet (vgl. Erklärung in Abschnitt [gemSpec_Krypt#<span data-option-id="longoutline" data-item-id="ML-92597" id="fake" data-type="crossReference" class="polarion-rte-link"></span>]).<br></li>
     <li>Mit diesem Transportschlüssel MÜSSEN die Nutzerdaten mittels AES-GCM und den Vorgaben aus GS-A_4389 verschlüsselt werden.<br></li>
     <li>Der Transportschlüssel MUSS unkodiert mit den in [gemSpec_COS#6.8.1.4 ELC Verschlüsselung] aufgeführten Vorgaben mittels ECIES verschlüsselt werden (siehe Erklärung in [gemSpec_Krypt#ECIES]). Das damit entstehende Chiffrat wird im Folgenden als Transport-Chiffrat bezeichnet.<br></li>
     <li>Das Transport-Chiffrat MUSS wie in&nbsp;[gemSpec_Krypt#<span data-option-id="longoutline" data-item-id="ML-92597" id="fake" data-type="crossReference" class="polarion-rte-link"></span>] beschrieben in eine ASN.1-Struktur (Tupel (PO, C, T)&nbsp;in kartenkompatibler ASN.1-Binärverpackung kodiert werden.<br></li>
     <li>Diese Kodierung MUSS in eine keyEncryptionAlgorithm-Datenstruktur mit der OID oid_ti_ecies_transport_encryption [gemSpec_OID] eingebracht werden.<br></li>
     <li>Die restliche Kodierung des mittels AES-GCM erzeugten Chiffrats der Nutzerdaten MUSS wie in CMS üblich [RFC-5626] [RFC-5084] erfolgen (vgl. Darstellung in &nbsp;[gemSpec_Krypt#<span data-option-id="longoutline" data-item-id="ML-92597" id="fake" data-type="crossReference" class="polarion-rte-link"></span>]).<br></li>
    </ol> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110890">
   <p><b>A_17221-01</b></p>
   <p>Alle Produkttypen, die XML-Dokumente mittels [XMLEnc-1.1] und ECC-basierte verschlüsseln, MÜSSEN die Vorgaben aus A_17220 Spiegelstrich 1 bis 3 umsetzen. Weiter MÜSSEN sie folgende Vorgaben umsetzen:<br> 
    <ol>
     <li>Das Transport-Chiffrat MUSS wie in&nbsp;[gemSpec_Krypt#<span data-option-id="longoutline" data-item-id="ML-92597" id="fake" data-type="crossReference" class="polarion-rte-link"></span>] beschrieben in eine ASN.1-Struktur (Tupel (PO, C, T)&nbsp;in kartenkompatibler ASN.1-Binärverpackung kodiert werden.<br></li>
     <li>Diese ASN.1-Binärverpackung MUSS Base64-kodiert werden und so kodiert in eine XML-Datenstruktur, so wie sie in [gemSpec_Krypt#<span data-option-id="longoutline" data-item-id="ML-92597" id="fake" data-type="crossReference" class="polarion-rte-link"></span>] beschrieben ist, eingebracht werden (Hinweis: man beachte ohne "<span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">RecipientKeyInfo"</span> Tags).<br></li>
     <li>Die mittels AES-GCM verschlüsselten Nutzerdaten MÜSSEN ebenfalls Base64-kodiert in die eben erzeugte XML-Datenstruktur gemäß [gemSpec_Krypt#<span data-option-id="longoutline" data-item-id="ML-92597" id="fake" data-type="crossReference" class="polarion-rte-link"></span>] eingebracht werden.</li>
    </ol> <b>&lt;=</b></p>
  </div>
  <p id="polarion_372">Im Interesse der Interoperabilität stellt die gematik auf Anfrage Testvektoren (Beispiel-Chiffrate mit Klartext) zur Verfügung.</p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-93738">5.7.1 ECIES und authentisierte Broadcast-Encryption</h4>
  <p id="polarion_258">In [SEC1-2009#5.2] und in [RFC-5753#4] wird auf ein potentielles Problem hingewiesen, dass insbesondere bei der Verwendung eines static-static-ECDH innerhalb von ECIES auftreten kann (also Sender und Empfänger verwenden ihre Langzeit-Identität "static-static"). Verallgemeinert formuliert, handelt es sich um das Problem der authentisierten Broadcast-Verschlüsselung. Ein Sender möchte an mehrere Empfänger "gleichzeitig" den gleichen Klartext verschlüsselt senden (vgl. auch [RFC-4082#1]). Bei TI-ECIES-TransportEncryption [gemSpec_Krypt#ECIES] wird der Transportschlüssel jeweils für jeden Empfänger mittels ECIES verschlüsselt. Jeder Empfänger kennt nun diesen zwischen dem Sender und allen Empfängern geteilten Schlüssel (Transportschlüssel) und kann jetzt (aus kryptographischer Sicht) den Klartext beliebig verändern, ohne dass dies bei einer Entschlüsselung auffällt. Die "authenticated Encryption" via AES-GCM (Transportschlüssel) kann hier also nicht die von ihr evtl. angenommene Sicherheitsleistung erbringen.&nbsp;</p>
  <p id="polarion_236">Wenn also bspw. bei KOM-LE eine Nachricht an mehrere Empfänger (eingetragen im CC-Feld) versendet werden soll, so muss an dieser Stelle zusätzlich die Authentizität der versendeten Nachricht gesichert werden. Bei KOM-LE erfolgt dies über die verpflichtende Signatur der Nachricht mit Hilfe der SMC-B (OSIG-Schlüsselmaterial). Es ist davon auszugehen, dass andere Anwendungen, die an mehrere Empfänger Nachrichten/Daten "gleichzeitig" versenden, ebenfalls zusätzliche Maßnahmen ergreifen müssen.</p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-94026">5.7.2 ECIES und mobKT</h4>
  <p id="polarion_255"> Ein "Mobiles Kartenterminal" [gemSpec_MobKT] ist so etwas wie ein Tablet mit zwei Chipkartenslots. Es ermöglicht einem LE außerhalb seiner Praxisräumlichkeiten (also insbesondere ohne Konnektor und stationäres eHealth-Karterterminal), auf Daten eines Versicherten auf dessen eGK zuzugreifen. Das Mobile Kartenterminal muss die dabei ausgelesenen versichertenspezifischen Daten verschlüsselt lokal im Gerät ablegen. Wenn das Mobile Kartenterminal verloren geht, sind damit diese Daten geschützt. Sie&nbsp;können erst mit Hilfe des gesteckten und freigeschaltenen HBA des LE wieder entschlüsselt (genutzt) werden, bspw. zur Übertragung ins Primärsystem. Für die Verschlüsselung muss nach Ende 2025 <span id="polarion-comment:529"></span>ECIES und nicht mehr RSA-OAEP verwendet werden. Es gelten dafür fachlich quasi die gleichen Vorgaben wie in A_17220, nur gibt es keine Notwendigkeit in Bezug auf die Kodierung des Chiffrats interoperabel&nbsp; sein zu müssen. Denn nur das spezifische Mobile Kartenterminal selbst muss die Daten ver- und entschlüsseln können im Sinne von "die Kodierung der Chiffrate auswerten können". Deshalb gibt es nachfolgend eine Spezialisierung von A_17220 für das Mobile Kartenterminal. </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-94025">
   <p><b>A_17575</b></p>
   <p>Ein Mobiles Kartenterminal MUSS folgende Vorgaben umsetzen. <br> 
    <ol>
     <li>Für die Verschlüsselung der Versichertendaten MUSS&nbsp;ein 256-Bit AES-Schlüssel zufällig erzeugt werden (vgl.&nbsp;GS-A_4368). Dieser Schlüssel wird im Folgenden als Transportschlüssel bezeichnet.<br></li>
     <li>Mit diesem Transportschlüssel MÜSSEN die Versichertendaten mit AES-GCM und den Vorgaben aus GS-A_4389 verschlüsselt werden.<br></li>
     <li>Der Transportschlüssel MUSS mit den in [gemSpec_COS#6.8.1.4 ELC Verschlüsselung] aufgeführten Vorgaben mittels ECIES verschlüsselt werden (siehe Erklärung in [gemSpec_Krypt#<span data-option-id="longoutline" data-item-id="ML-92597" id="fake" data-type="crossReference" class="polarion-rte-link"></span>] und [gemSpec_Krypt#Hinweis zu A_17575]).<br></li>
     <li>Falls auf dem gesteckten HBA ein ECC-basiertes ENC-Zertifikat vorhanden ist, so MUSS ECIES für die Ver- und Entschlüsselung des Transportschlüssels verwendet werden, anstatt von RSA-OAEP. Falls noch kein ECIES-verschlüsselter Transportschlüssel im Mobilen Kartenterminal vorliegt, sondern ein&nbsp;RSA-OAEP-verschlüsselter Transportschlüssel, so MUSS dieser Transportschlüssel zusätzlich mittels ECIES und dem ECC-ENC-Schlüssel des HBAs des LE verschlüsselt werden.<br></li>
    </ol> <b>&lt;=</b></p>
  </div>
  <p id="polarion_256"> Hinweis zu A_17575:<br> In einem HBA steht die Schnittstelle [gemSpec_COS#6.8.1.4 ELC Verschlüsselung] für die Verschlüsselung des Transportschlüssels zur Verfügung. Dass der Transportschlüssel verschlüsselt werden muss, wird nur sehr selten als Anwendungsfall vorkommen. Die Entschlüsselung - notwendiger Weise mit und durch den HBA - jedoch häufig. </p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-92595">5.8 ECC-Migration eHealth-KT</h3>
  <p id="polarion_140"> Mit A_17089-01<span id="polarion-comment:487"></span> und A_17090-01<span id="polarion-comment:488"></span> (vgl. Abschnitt 3.3.2) wird vom eHealth-Kartenterminal die Unterstützung der mit der Kartengeneration 2.1 (vgl. [gemSpec_gSMC-KT_ObjSys_G2.1]) hinzugekommenen ECDSA-basierten Identität bereitgestellt. </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-134944">
   <p><b>A_17089-01</b></p>
   <p>Ein eHealth-Kartenterminal MUSS prüfen, ob die in ihm gesteckte SMC-KT für die TLS-Verbindung zum Konnektor eine RSA-basierte Identität (AUT) und/oder eine ECDSA-basierte Identität besitzt (vgl. [gemSpec_gSMC-KT_ObjSys_G2.1], bspw. jeweils EFs mit ShortFileIdentifier 1 und 4 prüfen).<br> Falls eine RSA-basierte Identität dort vorhanden ist, so MUSS das eHealth-Kartenterminal folgende TLS-folgende Vorgaben erfüllen: <br> 
    <ol> 
     <li>Als Cipher-Suite MÜSSEN&nbsp;<span style="font-size: 10pt;line-height: 1.5;">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 und&nbsp;TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 unterstützt werden.</span> <span style="font-size: 10pt;line-height: 1.5;">
       <div style="margin-left: 40px;"></div></span></li> 
     <li><span style="font-size: 10pt;line-height: 1.5;">Beim ephemeren Elliptic-Curve-Diffie-Hellman-Schlüsselaustausch (vgl. "ECDHE" im Namen der Cipher-Suites)&nbsp;</span>MÜSSEN die Kurven P-256 und P-384 [FIPS-186-4] unterstützt werden. Es SOLLEN&nbsp;die Kurven brainpoolP256r1 und brainpoolP384r1 (vgl. [RFC-5639] und [RFC-7027]) unterstützt werden.&nbsp;Andere Kurven als in A_17089-* aufgeführt DÜRFEN NICHT verwendet werden.<br> <span style="font-size: 10pt;line-height: 1.5;">
       <div style="margin-left: 40px;"></div> 
       <div style="margin-left: 40px;"> 
       </div> </span></li> 
     <li><span style="font-size: 10pt;line-height: 1.5;">Es KÖNNEN weitere&nbsp;Cipher-Suiten aus [TR-02102-2, Abschnitt 3.3.1 Tabelle 1] unterstützen.</span><br> </li> 
    </ol> Falls eine ECDSA-basierte Identität vorhanden ist, so MUSS das eHealth-Kartenterminal zusätzlich folgende Vorgaben erfüllen:<br> 
    <ol> 
     <li> Als Ciphersuiten MÜSSEN TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 (0xC0,0x2B)&nbsp;und&nbsp; TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 (0xC0,0x2C)&nbsp;unterstützt werden.</li> 
     <li><span style="font-size: 10pt;line-height: 1.5;">Beim ephemeren Elliptic-Curve-Diffie-Hellman-Schlüsselaustausch (vgl. "ECDHE" im Namen der Cipher-Suites)&nbsp;</span>MÜSSEN die Kurven P-256 und P-384 [FIPS-186-4] unterstützt werden. Es SOLLEN&nbsp;die Kurven brainpoolP256r1 und brainpoolP384r1 (vgl. [RFC-5639] und [RFC-7027]) unterstützt werden.&nbsp;Andere Kurven als in GS-A_17089-* aufgeführt DÜRFEN NICHT verwendet werden.</li> 
    </ol> Dies bedeutet, falls beide Identitäten auf der SMC-KT vorhanden sind (wie bei [gemSpec_gSMC-KT_ObjSys_G2.1]), so MÜSSEN alle vier oben genannten Ciphersuiten unterstützt werden.<br> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-126197">
   <p><b>A_17090-01</b></p>
   <p>Ein eHealth-Kartenterminal MUSS in Bezug auf das verwendete Signaturverfahren beim initialen Pairing zwischen Konnektor und eHealth-Kartenterminal folgende Vorgaben umsetzen:<br> 
    <ol>
     <li>Falls für die aktuelle TLS-Verbindung mit dem Konnektor eine RSA-basierte Ciphersuite verwendet wird, so MUSS für die Signatur des Shared-Secret (ShS.AUT.KT vgl. [gemSpec_KT#2.5.2.1, 3.7.2.1]) RSASSA-PSS [PKCS#1] und SHA-256 verwendet werden. (Hinweis: die Parameter für RSASSA-PSS wie MGF oder Salt-Länge sind durch die SMC-KT eindeutig und fest vorgegeben und werden deshalb hier nicht aufgeführt.)<br></li>
     <li>Falls für die aktuelle TLS-Verbindung mit dem Konnektor eine ECDSA-basierte Ciphersuite verwendet wird, so MUSS für die Signatur des Shared-Secret ECDSA [BSI-TR-03111] und SHA-256 verwendet werden (Hinweis: die zu verwendenden Domainparameter (Kurve etc.) sind durch die SMC-KT eindeutig und fest vorgegeben).&nbsp;Für die Kodierung der ECC-Parameter in der Signatur MUSS die plain-Kodierung nach <span style="font-size: 10pt;line-height: 1.5;">[TR-03111#5.2.1]</span> verwendet werden.<br></li>
    </ol> <b>&lt;=</b></p>
  </div>
  <p id="polarion_419"> Hinweis: Das in A_17090-01<span id="polarion-comment:493"></span> geforderte Verhalten lässt sich bei OpenSSL leicht mit SSL_get_current_cipher() umsetzen. </p>
  <p id="polarion_203">Ein&nbsp;eHealth-Kartenterminal muss beim TLS-Verbindungsaufbau, der vom Konnektor initiiert wird, dessen TLS-Client-Zertifikat prüfen. Dafür muss ein&nbsp;eHealth-Kartenterminal alle "CA-Zertifikate der relevanten TSP speichern"&nbsp;[gemSpec_KT#TIP1-A_3255]. Um diesen kritischen Punkt, jedoch noch einmal zu unterstreichen:</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-92826">
   <p><b>A_17183</b></p>
   <p>Das eHealth-Kartenterminal MUSS bei der Umsetzung von [gemSpec_KT#TIP1-A_3255] sowohl RSA-basierte CA-Zertifikate der Komponenten-PKI als auch ECC-basierte CA-Zertifikate (TSL(ECC-RSA))&nbsp;der Komponten-PKI speichern.<br> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-126198">
   <p><b>A_22458</b></p>
   <p>Der Konnektor MUSS beim TLS-Verbindungsaufbau (TLS-Handshake) zu einem eHealth-Kartenterminal ausschließlich Ciphersuiten mit solchen Authentisierungsalgorithmen (entweder RSA oder ECDSA)&nbsp;anbieten, die zum Algorithmus des gespeicherten KT-Zertifikats passen, wenn zu diesem Kartenterminal bereits Pairinginformationen (Shared Secret in Kombination mit dem Zertifikat des Kartenterminals) gespeichert sind. <b>&lt;=</b></p>
  </div>
  <p id="polarion_418">Konnektoren speichern die Pairinginformationen zu den mit ihnen gepairten Kartenterminals als Tupel {Kartenterminal-Zertifikat; Shared Secret}, wobei das beim Pairing vom Kartenterminal genutzte Zertifikat gespeichert wird. Wird später (bspw. durch ein Software-Update des Kartenterminals, welches die Nutzung von ECDSA Identitäten ermöglicht) ein anderes Zertifikat vom Kartenterminal beim TLS-Handshake präsentiert (also bspw. eine ECDSA Identität statt der zuvor genutzten RSA-Identität), passt dies für den Konnektor nicht zur vorhandenen Pairinginformation. Der Verbindungsaufbau scheitert somit, bis ein neues Pairing vorgenommen wird (bei dem dann das ECDSA-Zertifikat vom Kartenterminal verwendet wird). Dieses Verhalten muss vermieden werden, da dies einen massenhaften Ausfall von Kartenterminals durch ein Software-Update der Terminals hervorrufen kann. Daher darf der Konnektor nur solche Cipher-Suiten anbieten, die auch zum für das betroffene Kartenterminal gespeicherte Zertifikat passen.</p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-127120">5.8.1 Interoperabilität zwischen eHealth-KT und Konnektor</h4>
  <p id="polarion_48">Zur Sicherstellung der Interoperabilität zwischen Health-KT und Konnektor werden folgende Festlegungen getroffen. Bei den folgend aufgeführten Themen hatte es bezüglich der Interoperabilität Probleme gegeben.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-126169">
   <p><b>A_22451</b></p>
   <p>Falls die ClientHello-Nachricht keine der gemäß [gemSpec_Krypt#A_17089-01] zu unterstützenden Cipher-Suiten enthält, dann MUSS das eHealth-Kartenterminal die ClientHello-Nachricht mit einem "handshake_failure" beantworten, siehe [RFC-5426#7.4.1.2]. <b>&lt;=</b></p>
  </div>
  <p id="polarion_146">Hinweise zum Thema Renegotiation:</p>
  <p id="polarion_382">Hinweis 1: Gemäß GS-A_5525 unterstützt der Konnektor "renegotiation". Daraus folgt, dass er diese Fähigkeit in der ClientHello- Nachricht entweder durch eine "renegotiation_info" extension anzeigt, oder durch ein TLS_EMPTY_RENEGOTIATION_INFO_SCSV (siehe [RFC-5746#3.4, §1, erster Punkt]).</p>
  <p id="polarion_420">Hinweis 2: Gemäß [RFC-5246#7.4.1.3 letzter §] ist es einem Server nur dann erlaubt in der ServerHello-Nachricht eine "renegotiation_info" extension zu schicken, wenn die ClientHello-Nachricht Informationen zu "renegotiation" enthält. Gemäß dem vorstehenden Hinweis ist das beim TLS-Handshake zwischen Konnektor und eHealth-KT stets der Fall.</p>
  <p id="polarion_421">Hinweis 3: Die gematik legt nicht fest, wie sich ein eHealth-KT zu verhalten hat, wenn die ClientHello-Nachricht weder eine "renegotiation_info" extension, noch ein TLS_EMPTY_RENEGOTIATION_INFO_SCSV enthält.</p>
  <p id="polarion_426">Hinweis 4: Es gilt für das eHealth-KT GS-A_5524-*, womit sichergestellt ist, dass ein eHealth-KT keine unsichere TLS-Renegotiation durchführt.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-126174">
   <p><b>A_22453</b></p>
   <p>Von den gemäß [gemSpec_Krypt#A_17089-01]<span id="polarion-comment:490"></span> zu unterstützenden Cipher-Suiten wählt das eHealth-Kartenterminal eine aus, vergleiche [RFC-5426#7.4.1.3]. Falls das eHealth-Kartenterminal eine Cipher-Suite aus [gemSpec_Krypt#A_17089-01]<span id="polarion-comment:491"></span> in der Form<br> 
    <ol> 
     <li>TLS_DHE_RSA... (also RSA) auswählt, dann MUSS es eine RSA-basierte Identität zur Authentisierung im Kontext des TLS-Protokols verwenden.</li> 
     <li>TLS_ECDHE_ECDSA... (also ECDSA) auswählt, dann MUSS es eine ECDSA-basierte Identität zur Authentisierung im Kontext des TLS-Protokols verwenden.</li> 
    </ol> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-126173">
   <p><b>A_22454</b></p>
   <p>Das eHealth-Kartenterminal MUSS eine CertificateRequest-Nachricht schicken, für die folgendes gilt:<br> 
    <ol> 
     <li>Die Struktur CertificateRequest gemäß [RFC-5246#7.4.4] MUSS im Abschnitt certificate_types genau ein Element vom Typ ClientCertificateType enthalten.</li> 
     <li>Falls das eHealth-Kartenterminal in der ServerHello-Nachricht eine Cipher-Suite aus [gemSpec_Krypt#A_17089-01]<span id="polarion-comment:492"></span> in der Form</li> 
     <ol> 
      <li>TLS_DHE_RSA... (also RSA) anzeigt, dann MUSS als ClientCertificateType "rsa_sign" gewählt werden, siehe [RFC-5246#7.4.4].</li> 
      <li>TLS_ECDHE_ECDSA... (also ECDSA) anzeigt, dann MUSS als ClientCertificateType "ecdsa_sign" gewählt werden, siehe [RFC-8422#5.5].<br> </li> 
     </ol> 
    </ol> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-126176">
   <p><b>A_22455</b></p>
   <p>Bezüglich der ClientCertificate-Nachricht (siehe [RFC-5246#7.4.6]) gilt für das eHealth-Kartenterminal folgendes Verhalten:<br> 
    <ol> 
     <li>Falls der Client keine ClientCertificate-Nachricht schickt, dann MUSS der TLS-Handshake mit einem "failure alert" abgebrochen werden.</li> 
     <li>Der TLS-Handshake MUSS fortgesetzt werden, selbst wenn die "certificate_list"</li> 
     <ol> 
      <li>leer ist (also kein Element enthält), oder</li> 
      <li>kein End-Entity-Zertifikat daraus erfolgreich extrahiert und erfolgreich gegen eine im eHealth-Kartenterminal gespeicherte CA geprüft werden konnte, oder</li> 
      <li>ein End-Entity-Zertifikat unpassenden Typs enthält (beispielsweise RSA-PublicKey statt ECDSA-PublicKey).</li> 
     </ol> 
    </ol> <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-92604">5.9 ECC-Migration Konnektor</h3>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-108707|project=Mainline_OPB1|layout_workitem_type=leafRequirement|layout_content_type=section|serverPath=https://polarion.int.gematik.de">
   <p><b>A_17094-01</b></p>
   <p>Der Konnektor MUSS zusätzlich zu den RSA-basierten TLS-Ciphersuiten (vgl. GS-A_4385 und GS-A_5345-01)<span id="polarion-comment:511"></span> die TLS-Ciphersuiten<br> 
    <ol>
     <li>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 und&nbsp;<br></li>
     <li>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384<br></li>
    </ol>unterstützen. Dabei MÜSSEN bei dem ephemeren Elliptic-Curve-Diffie-Hellman-Schlüsselaustausch die Kurven P-256 und P-384 [FIPS-186-4] und die Kurven brainpoolP256r1 und brainpoolP384r1 (vgl. [RFC-5639] und [RFC-7027]) unterstützt werden.&nbsp;&nbsp; Andere Kurven SOLLEN NICHT verwendet werden.<br>Falls der Konnektor in der Rolle TLS-Client agiert, so MUSS er die eben genannten Ciphersuiten gegenüber RSA-basierten Ciphersuiten (vgl. GS-A_4384-*)<span id="polarion-comment:480"></span> bevorzugen (in der Liste "cipher_suites" beim ClientHello vorne an stellen, vgl.&nbsp; [RFC-5256#7.4.1.2 Client Hello]).<br> <b>&lt;=</b></p>
  </div>
  <p id="polarion_383">Hinweis: für den Konnektor gelten die IPsec-Anforderungen A_17125 und A_17126.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-92911">
   <p><b>A_17209</b></p>
   <p>Der Konnektor MUSS an der Schnittstelle für die externe Authentisierung die&nbsp;Signaturverfahren RSASSA-PKCS1-v1_5 [PKCS#1], RSASSA-PSS [PKCS#1]&nbsp;&nbsp;und ECDSA [BSI-TR-03111] anbieten. <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-92708">5.10 Verschiedene Produkttypen und ECC-Migration (informativ)</h3>
  <p id="polarion_165"> Dem VPN-Zugangsdienst sind die IPsec-Anforderungen&nbsp;<span class="polarion-rte-link" data-type="crossReference" id="fake" data-custom-label="A_17125" data-item-id="ML-92705" data-option-id="custom"></span>&nbsp;und <span class="polarion-rte-link" data-type="crossReference" id="fake" data-custom-label="A_17126" data-item-id="ML-92706" data-option-id="custom"></span>&nbsp; zugewiesen, ebenso A_17205. Im Rahmen der Registrierung bei einem VPN-Zugangsdienst wird vom Konnektor eine Signatur mittels einer SMC-B erzeugt. Diese muss der&nbsp;VPN-Zugangsdienst (Registierungsserver) prüfen können, dafür gilt für diesen&nbsp;A_17206. </p>
  <p id="polarion_78"> Für die Produkttypen, die bei der Anwendung VSDM verwendet werden, ist die ECC-RSA-TSL-Auswertung &nbsp;<span class="polarion-rte-link" data-type="crossReference" id="fake" data-custom-label="A_17205" data-item-id="ML-92906" data-option-id="custom"></span>&nbsp;und die ECC-Unterstützung bei TLS A_17124-*&nbsp;relevant. </p>
  <p id="polarion_188"> Fachanwendungsspezifische Anpassungen aufgrund der ECC-Migration befinden sich in den jeweiligen Spezifikationen (bspw. <span class="polarion-rte-link" data-type="polarion" id="fake" data-custom-label="[gemSpec_CM_KOMLE#A_17464]" data-url="/wiki/Spezifikation/gemSpec_CM_KOMLE?selection=ML-93849"></span>). </p>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-92333">6 Kommunikationsprotokoll zwischen ePA-VAU und ePA-Clients</h2>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-92332">6.1 Motivation</h3>
  <p id="polarion_92"> Die Architekturentscheidung, dass auf der Verbindungsstrecke zwischen&nbsp;einem ePA-Frontend eines Versicherten (Client) bzw. eines FM ePA (Client) und einer VAU (Server) immer HTTP über ein Gateway als Kommunikationsprotokoll verwendet wird, hat Vorteile. Ein Nachteil ist, dass damit keine direkte TLS-Verbindung zwischen Client und Server möglich ist. Der TLS-Kanal terminiert am Gateway. Um die "letzten Meile" zwischen Gateway und VAU innerhalb des ePA-Aktensystems nicht ungeschützt zu lassen, wird das "VAU-Protokoll" eingeführt und verwendet. Es wird nicht der Weg gewählt HTTP über TLS über HTTP über TLS zu tunneln. Stattdessen wird das folgende&nbsp;Protokoll eingeführt als eine leichtgewichtige Sicherungsschicht zwischen einer VAU (Server) und einem ePA-Frontend eines Versicherten (Client) bzw. eines FM ePA (Client). Der Server und der Client besitzen jeweils eine kryptographische Langzeitidentität. Diese sind Grundlage für einen beidseitig authentisierten ephemeren ECDH. Aus dem gemeinsamen ECDH-Geheimnis werden mittels einer HKDF zwei AES-Schlüssel abgeleitet <span style="font-size: 10pt;line-height: 1.5;">(vgl. A_16943-*)</span>. Per AES-GCM werden nach dem Schlüsselaustausch alle ausgetauschten Nutzerdaten kryptographisch gesichert. Es gibt einen Nachrichtenzähler der vor Replay-Attacken schützt. </p>
  <p id="polarion_95"> Die gematik stellt eine Beispielimplementierung bereit (<a href="https://fachportal.gematik.de/service/entwicklung/" target="_top" class="descriptionLink">https://fachportal.gematik.de/service/entwicklung/</a>&nbsp;). </p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-92334">6.2 Übersicht</h3>
  <p id="polarion_97">Es gibt bei der Kommunikation, die das Protokoll steuert, zwei aktive und einen passiven Teilnehmer. Der Client initiiert die Kommunikation per HTTP-POST-Request. Der Server antwortet als HTTP-Server auf diesen Request mit einer HTTP-Response. Das Gateway leitet die Daten weiter und erscheint unsichtbar. Das Gateway erzwingt die Verwendung des HTTP-Protokolls.</p>
  <p id="polarion_109">Das Kommunikationsprotokoll hat als Hauptaufgabe die zwischen Client und Server (VAU) auszutauschenden Nutzerdaten vor dem Gateway in Bezug auf Vertraulichkeit, Authentizität, Integrität (inkl. Verhinderung von Replay-Attacken) zu schützen. Das Protokoll bietet (absichtlich) keinen Schutz der HTTP-Header-Informationen. Es ist bei der ePA-Architektur sichergestellt, dass eine Änderung der HTTP-Header-Informationen keine negativen Auswirkungen auf die Vertraulichkeit, Integrität und Authentizität der Nutzerdaten hat. Hinweis zum besseren Verständnis: Zwischen Gateway und Client besteht immer eine TLS-Verbindung, so dass nur das Gateway bzw. nur ein Angreifer im Aktensystem selbst die Header-Informationen ändern könnte.</p>
  <p id="polarion_111">Ein Designziel ist es, den Verbindungsaufbau möglichst "menschenlesbar" zu gestalten und so die Implementierung und die Fehlersuche (u. a. auch im Betrieb) zu erleichtern. So sind die meisten Nachrichten einfache, menschenlesbare JSON-Objekte. Die im Protokoll definierten Fehlermeldungen (VAUServerError-Nachricht) haben den Hauptzweck, die manuelle Fehleranalyse zu erleichtern. Das VAU-Protokoll ist relativ einfach, so dass ein Client oder ein Server bei Auftreten eines Fehlers selten etwas anderes tun kann, als die Protokollabarbeitung abzubrechen (und als Client einen neuen Protokolldurchlauf zu initiieren). Dies bedeutet: die Art der aufgetretenen Fehlernachricht ist für den Client i. d. R. irrelevant, weil die Handlungsoptionen sehr begrenzt sind. Erst bei der manuellen Fehleranalyse werden die differenzierten Fehlermeldungen hilfreich.</p>
  <p id="polarion_113">Viele Nachrichten und Datenfelder ähneln fachlich Bestandteilen aus dem TLS-Protokoll und werden absichtlich anders benannt, um Verwechselungen zu vermeiden.</p>
  <p id="polarion_115">Das Protokoll bietet die Möglichkeit, zukünftig verschiedene CipherConfiguration (im TLS-Protokoll entspricht dies den TLS-Cipher-Suiten) zu unterstützen; aktuell gibt es genau eine ("AES-256-GCM-BrainpoolP256r1-SHA-256").</p>
  <p id="polarion_136">Der Ablauf der Schlüsselaushandlung des VAU-Protokolls ist im folgenden Ablaufdiagramm dargestellt.</p>
  <p id="polarion_172" style="text-align: center;" class="polarion-rte-caption-paragraph"> <img src="attachments/11-screenshot-20181211-153655.png" style="width: 582px;height: 277px;"> </p>
  <p id="polarion_190" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">3</span>: Übersicht über das VAU-Protokoll </p>
  <p id="polarion_120">Da die Werte des ephemeren öffentlichen ECDH-Schlüssels des jeweiligen anderen Kommunikationspartners in die eigene Signatur eingehen, können sowohl Client und Server bei der Signaturprüfung sicherstellen, dass die Schlüsselaushandlung frisch ist (vgl. [Boyd-Mathuria-2003#Abschnitt "1.5 Freshness"]).&nbsp;</p>
  <p id="polarion_143">Aus dem gemeinsamen ECDH-Geheimnis wird ein AES-Schlüssel abgeleitet und damit die weitere Kommunikation mittels AES-GCM in Bezug auf Vertraulichkeit und Integrität geschützt. Der dabei explizit mitgelieferte Nachrichtenzähler schützt vor Replay-Attacken.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-90062">
   <p><b>A_16884</b></p>
   <p>Es gibt genau zwei Nachrichtenarten: (1) Nachrichten zur Schlüsselaushandlung (VAUClientHello, VAUServerHello, VAUClientSigFin und VAUServerFin) und Fehlermeldungsübermittlung (VAUServerError) und (2) Nachrichten, die kryptographisch geschützte Nutzerdaten transportieren.<br> Typ-(1)-Nachrichten MÜSSEN vom Client und vom Server jeweils per HTTP mit dem Content-Type 'application/json' übermittelt werden und Typ-(2)-Nachrichten mit dem Content-Type 'application/octet-stream'. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-92431">
   <p><b>A_17074</b></p>
   <p>Ein Client oder ein Server MUSS zusätzliche (i. S. v. ihm unbekannte) Datenfelder (Key-Value-Paare) in JSON-Objekten (Typ-(1)-Nachrichten und "Data"-Feldern darin) im Rahmen des VAU-Protokolls ignorieren. <b>&lt;=</b></p>
  </div>
  <p id="polarion_345">Die in den Anforderungen angegebenen Reihenfolgen von Attribute-Value-Pairs innerhalb der JSON Objekte sind als Beispiele zu verstehen und nicht in ihrer Reihenfolge normativ. Es gilt der JSON Standard&nbsp;[ecma-262].</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-92440">
   <p><b>A_17081</b></p>
   <p>Ein Client und ein Server MUSS für die Signatur im Rahmen des VAU-Protokolls (VAUServerHello- und VAUClientSigFin-Nachrichten) Schlüsselmaterial verwenden, dass dediziert für die Entity-Authentication vorgesehen ist (AUT-Schlüsselmaterial (einer eGK, einer SMC-B etc.) oder privates Schlüsselmaterial der VAU-Server-Identität (Rollenprofil "oid_epa_vau")). <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-92336">6.3 VAUClientHello-Nachricht</h3>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-102745">
   <p><b>A_16883-01</b></p>
   <p>Der Client MUSS die Kommunikation mittels einer&nbsp;VAUClientHello-Nachricht initiieren. Dafür erzeugt er zunächst eine&nbsp;VAUClientHelloData-Datenstruktur der Form<br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">{</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"DataType" : "VAUClientHelloData",</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"CipherConfiguration" : [ "AES-256-GCM-BrainpoolP256r1-SHA-256" ],</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"PublicKey"&nbsp; : "...Base64-kodierter-ECC-Schlüssel(DER)...",<br> "AuthorizationAssertion" : "Authorizaton Assertion (Base64-kodiert)",<br> "CertificateHash" : "...Base64-kodierter SHA-256 Hashwert des Client-X.509-Zertifikats"</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">}</span><br> Der Client MUSS im Rahmen der Schlüsselaushandlung ein ECDH-Schlüsselpaar basierend auf der Kurve BrainpoolP256r1&nbsp;[RFC-5639] erzeugen. Er MUSS im "PublicKey"-Feld den öffentlichen Punkt des ephemeren ECDH-Schlüsselpaares&nbsp; Base64-kodiert&nbsp;gemäß [TR-03111#5.1.1 X9.62 Format] eintragen. Im ”AuthorizationAssertion”-Feld MUSS der Client die Base64-kodierte Authorization-Assertion gemäß A_15592-03 <span id="polarion-comment:509"></span>eintragen. Der Client MUSS im ”CertificateHash”-Feld den Base64-kodierten Hashwert seines Client-Zertifikats (AUT- oder AUT_alt-Zertifikat) eintragen (Der Hashwert wird vom kompletten DER-kodierten X.509-Zertifikat inkl. äußerer Zertifikatssignatur erzeugt. Der SHA-256 Hashwert (d. h. 256-Bit = 32 Byte) wird anschließend Base64-kodiert. Diese Kodierung wird als Wert bei ”CertificateHash” eingetragen.).<br> <br> <span style="font-size: 10pt;line-height: 1.5;">Beispiel:</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">{</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"DataType" : "VAUClientHelloData",</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"CipherConfiguration": [&nbsp;"AES-256-GCM-BrainpoolP256r1-SHA-256" ],</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"PublicKey" : "MFowFAYHKoZIzj0CAQYJKyQDAwIIAQEHA0IABDY8OMZlrJpLUdgnm8gHbevpFjemkL8IxMXohQlw3VHePf+T1lW+P0nW9VpnU1SxwCkjY1PU6HGTT+3wawKvRIE=",<br> "AuthorizationAssertion" : ".......",<br> "CertificateHash" : "wu72yzp4KdtcWV/vJUcKW14UL+FIJyWcwgETbxwDK+4="</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">}<br> </span> <br> <span style="font-size: 10pt;line-height: 1.5;">Hinweis: Der öffentliche Schlüssel im Beispiel hat nach der Base64-Dekodierung folgende ASN.1-Datenstruktur:</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp; 0&nbsp; 90: SEQUENCE {</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp; 2&nbsp; 20:&nbsp; &nbsp;SEQUENCE {</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp; 4&nbsp; &nbsp;7:&nbsp; &nbsp; &nbsp;OBJECT IDENTIFIER ecPublicKey (1 2 840 10045 2 1)</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;13&nbsp; &nbsp;9:&nbsp; &nbsp; &nbsp;OBJECT IDENTIFIER brainpoolP256r1 (1 3 36 3 3 2 8 1 1 7)</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; &nbsp; &nbsp;}</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp;24&nbsp; 66:&nbsp; &nbsp;BIT STRING</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; &nbsp; &nbsp;04 36 3C 38 C6 65 AC 9A 4B 51 D8 27 9B C8 07 6D</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; &nbsp; &nbsp;EB E9 16 37 A6 90 BF 08 C4 C5 E8 85 09 70 DD 51</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; &nbsp; &nbsp;DE 3D FF 93 D6 55 BE 3F 49 D6 F5 5A 67 53 54 B1</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; &nbsp; &nbsp;C0 29 23 63 53 D4 E8 71 93 4F ED F0 6B 02 AF 44</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; &nbsp; &nbsp;81</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp; &nbsp; &nbsp; &nbsp;:&nbsp; &nbsp;}</span><br> <br> Der Client MUSS diese Datenstruktur Base64-kodieren und vom Ergebnis einen&nbsp;SHA-256-Hashwert bilden, den er später mit dem im VAUServerHello aufgeführten Wert&nbsp;vergleichen muss. In das Datenfeld "Data" in der folgenden&nbsp;VAUClientHello-Nachricht MUSS er die Base64-kodierte VAUClientHelloData-Daten eintragen.<br> <br> <span style="font-size: 10pt;line-height: 1.5;">Die VAUClientHello-Nachricht hat folgenden Aufbau:</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">{&nbsp;</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"MessageType" : "VAUClientHello",</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"Data"&nbsp; &nbsp; &nbsp; &nbsp; : "...Base64-kodierte-VAUClientHelloData..."</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">}</span><br> <br> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-90067">
   <p><b>A_16897</b></p>
   <p>Der Client MUSS die VAUClientHello-Nachricht per HTTP mit dem Content-Type 'application/json' an den Server senden. <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-92337">6.4 VAUServerHello-Nachricht</h3>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-90069">
   <p><b>A_16898</b></p>
   <p>Der Server MUSS beim Empfang der VAUClientHello-Nachricht einen SHA-256-Hashwert der Daten im Data-Feld (zunächst keine Base64-Dekodierung durchführen) erzeugen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-109363">
   <p><b>A_16901-02</b></p>
   <p>Der Server MUSS auf die VAUClientHello-Nachricht mit einer VAUServerHello-Nachricht, folgender Form, antworten<br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">{&nbsp;</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"MessageType" : "VAUServerHello",</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"Data"&nbsp; &nbsp; &nbsp; &nbsp; : "...Base64-kodierte-Daten...",</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"Signature"&nbsp; &nbsp;: "...Base64-kodierte-ECDSA-Signatur...",</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"Certificate"&nbsp;: "...Base64-kodiertes-Signaturzertifikat...",</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"OCSPResponse" : "...Base64-kodierte-OCSP-Response-für-dieses-Zertifikat..."<br> </span> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">}</span><br> <br> Die ECDSA-Signatur MUSS nach [TR-03111#5.2.2. X9.62 Format] ("ecdsa-with-Sha256") kodiert sein.<br> In den Daten von "Data" MUSS der Server in die Base64-kodierte VAUServerHelloData-Datenstruktur der folgenden Form eintragen.&nbsp;Der Server MUSS im "CertificateHash"-Feld den Base64-kodierten SHA-256 Hashwert des Server-X.509-Zertifikats eintragen. (Der Hashwert wird vom kompletten DER-kodierten X.509-Zertifikat inkl. äußerer Zertifikatssignatur erzeugt. Der SHA-256 Hashwert (d. h. 256-Bit = 32 Byte) wird anschließend Base64-kodiert. Diese Kodierung wird als Wert bei ”CertificateHash” eingetragen.)<br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">{</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"DataType" : "VAUServerHelloData",</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"CipherConfiguration" : [ "AES-256-GCM-BrainpoolP256r1-SHA-256" ],</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"VAUClientHelloDataHash" :&nbsp; "...SHA-256-Hashwert-des-erhaltenen-Data-Felds-in-VAUClientHello...",</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"PublicKey"&nbsp; : "...Base64-kodierter-ECC-Schlüssel(DER)...",<br> "CertificateHash" : "...Base64-kodierter SHA-256 Hashwert des Server-X.509-Zertifikats"</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">}</span><br> Der Server MUSS im "PublicKey"-Feld den öffentlichen Punkt seines ephemeren ECDH-Schlüsselpaares Base64-kodiert&nbsp;gemäß [TR-03111#5.1.1 X9.62 Format] eintragen.<br> <br> Der Server MUSS im Feld "VAUClientHelloDataHash" den Base64-kodierten SHA-256-Hashwert der empfangenen VAUClientHelloData (ohne Base64-Dekodierung) eintragen (vgl. <span class="polarion-rte-link" data-type="crossReference" id="fake" data-custom-label="A_16898" data-item-id="ML-90069" data-option-id="custom"></span>).&nbsp;<br> <br> Der Server MUSS die in der Datenstruktur (VAUServerHello) angegebene Signatur erzeugen (über den Base64-kodieren Wert im "Data"-Feld). Im "Certificate"-Feld MUSS er das für eine Signaturprüfung notwendige EE-Zertifikat eintragen und im "OCSPResponse"-Feld die OCSP-Response, die nicht älter als 24 Stunden sein darf, für dieses EE-Zertifikat.<br> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-90074">
   <p><b>A_16902</b></p>
   <p>Der Server MUSS auf eine VAUClientHello-Nachricht mit einer VAUServerHello-Nachricht antworten. Der Server MUSS die VAUServerHello-Nachricht per HTTP mit dem Content-Type 'application/json' an den Client senden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-90073">
   <p><b>A_16903</b></p>
   <p>Der Client MUSS beim Empfang der VAUServerHello-Nachricht den Hashwert "VAUClientHelloDataHash" (vgl. A_16901-*)<span id="polarion-comment:510"></span> mit dem vom ihm (Client) vor dem Versand der VAUClientHello-Nachricht (vgl. A_16883-01)<span id="polarion-comment:512"></span> errechneten Wert vergleichen. Sind die beiden Werte verschieden, so MUSS der Client den Protokollablauf abbrechen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-102747">
   <p><b>A_16941-01</b></p>
   <p>Der Client MUSS die Signatur der Daten von "Data" prüfen (bitgenau den Datenwert von "Data" nehmen, ohne&nbsp;eine Base64-Dekodierung) der "Data"-Daten vorzunehmen. Der Client MUSS dafür den Signaturschlüssel des Servers auf Authentizität und Integrität prüfen. (Hinweis: in einem Client wird die TSL der TI als Prüfgrundlage für die Prüfung von TI-Zertifikaten verwendet.) Falls die Signaturprüfung kein positives Ergebnis erbringt, so MUSS der Client den Protokollablauf abbrechen (vgl. A_16849).<br> Der Client MUSS prüfen, ob der im VAUServerHelloData-&gt;CertificateHash aufgeführter Hashwert mit dem Hashwert des Server-Zertifikats im VAUServerHello-&gt;Certificate-Feld übereinstimmt (vgl. Erzeugung des Hashwerts in A_16901-*). Falls nein, so MUSS der Client den Protokollablauf abbrechen (vgl. <span class="polarion-rte-link" data-type="crossReference" id="fake" data-custom-label="A_16849" data-item-id="ML-90091" data-option-id="custom"></span>). <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-134975">
   <p><b>A_23273</b></p>
   <p>Der Client MUSS bei der Signaturprüfung der VAUServerHelloData die im "OCSPResponse"-Feld enthaltene OCSP-Response verwenden, wenn diese nicht älter als 24 Stunden ist.<br> Dabei MUSS geprüft werden:&nbsp;Systemzeit - 24h &lt;= producedAt. (Eine zusätzliche Auswertung von nextUpdate SOLL NICHT erfolgen.)<br> Andernfalls MUSS der Client eine frische OCSP-Response einholen. <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-92338">6.5 Schlüsselableitung</h3>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-102751">
   <p><b>A_16852-01</b></p>
   <p>Der Client und auch der Server MÜSSEN jeweils für sich prüfen, ob der empfangene ephemere öffentliche elliptische Kurvenpunkt der Gegenseite auch auf der von ihnen verwendeten Kurve (BrainpoolP256r1) liegt.<br> Falls nein, MÜSSEN sie jeweils den Protokollablauf abbrechen. Falls der Server derjenige ist, der in diesem Fall abbricht, MUSS der zuvor an den Client eine VAUServerError-Nachricht mit der Fehlermeldung "invalid curve (ECDH)" senden. <br> Falls ja, MÜSSEN beide einen ECDH nach [NIST-800-56-A] durchführen. Das dabei erzeugte gemeinsame Geheimnis ist folgend Grundlage von drei Schlüsselableitungen (vgl. <span data-option-id="custom" data-item-id="ML-102752" data-custom-label="A_16943-01" id="fake" data-type="crossReference" class="polarion-rte-link"></span>&nbsp;). <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-102752">
   <p><b>A_16943-01</b></p>
   <p>Für die Schlüsselableitung MÜSSEN Client und Server die HKDF nach [RFC-5869]&nbsp;auf Basis von SHA-256 verwenden.<br> <span style="font-size: 10pt;line-height: 1.5;">Das ”Input Keying Material” (IKM) [RFC-5869] ist das in <span data-option-id="custom" data-item-id="ML-102751" data-custom-label="A_16852-01" id="fake" data-type="crossReference" class="polarion-rte-link"></span>&nbsp;erzeugte gemeinsame ECDH-Geheimnis zwischen Server und Client.<br> Die erste Schlüsselableitung hat den Ableitungsvektor ”KeyID” (”info” Parameter aus [RFC-5869] ist dann also ”KeyID”) und erzeugt einen 256 Bit langen Schlüsselidentifier.<br> Die zweite Schlüsselableitung mit dem Ableitungsvektor ”AES-256-GCM-Key-Client-to-Server” erzeugt den 256-Bit AES-Schlüssel für die Verwendung innerhalb von AES-256-GCM für Nachrichten, die der Client für den Server verschlüsselt.<br> Die dritte Schlüsselableitung mit dem Ableitungsvektor ” AES-256-GCM-Key-Server-to-Client” erzeugt den 256-Bit AES-Schlüssel für die Verwendung innerhalb von AES-256-GCM für Nachrichten, die der Server für den Client verschlüsselt.</span> <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-92422">6.6 VAUClientSigFin-Nachricht</h3>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-109364">
   <p><b>A_17070-02</b></p>
   <p>Der Client MUSS auf eine VAUServerHello-Nachricht mit einer wie folgt definierten VAUClientSigFin-Nachricht antworten.<br> Die VAUClientSigFin-Nachricht hat folgenden Aufbau:<br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">{&nbsp;</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"MessageType"&nbsp; &nbsp; : "VAUClientSigFin",</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"VAUClientHelloDataHash" :&nbsp;"...SHA-256-Hashwert-der-Base64-kodierten-VAUClientHelloData...",</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"VAUServerHelloDataHash" :&nbsp;"...SHA-256-Hashwert-der-erhaltenen-Base64-kodierten-VAUServerHelloData...",&nbsp;</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"Signature" : "...Base64-kodierte-Signatur...",</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"Certificate" : "...Base64-kodiertes-Signaturzertifikat...",</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"OCSPResponse" : "...Base64-kodierte-OCSP-Response-für-dieses-Zertifikat...",</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"FinishedData" : "...Base64-kodierte-verschlüsselte-Finished-Daten ..."</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">}</span><br> <br> Im "VAUClientHelloDataHash"-Feld MUSS der Client den Base64-kodieren Hashwert seiner Base64-kodierten VAUClientHelloData eintragen.<br> Im "VAUServerHelloDataHash"-Feld MUSS der Client&nbsp;den Base64-kodieren Hashwert der&nbsp;empfangenen Base64-kodierten VAUServerHelloData eintragen.<br> Die folgende Signatur MUSS der Client über die beiden konkatenierten Base64-kodierten Zeichenketten (Inhalt vom "VAUClientHelloDataHash"-Feld || Inhalt vom "VAUClientServerDataHash"-Feld) bilden.<br> <br> Eine ECDSA-Signatur im "Signature"-Feld MUSS nach [TR-03111#5.2.2. X9.62 Format] ("ecdsa-with-Sha256") kodiert sein.<br> <span style="font-size: 10pt;line-height: 1.5;">Diese so kodierte Signatur wird Base64-kodiert und als Wert im "Signature"-Feld eingetragen.<br> Eine RSASSA-PSS-Signatur MUSS nach [RFC-8017] (PKCS#1) kodiert werden. Diese so kodierte Signatur wird Base64-kodiert und als Wert im "Signature"-Feld eingetragen.<br> (Verständnishinweis: Eine G2-Karte kann in Bezug auf AUT-Schlüssel nur RSA-Signaturen erzeugen. Eine G2.x-Karte kann und MUSS im Kontext VAU-Protokoll ECDSA-Signaturen erzeugen.)<br> </span> <br> Der Client MUSS im "Certificate"-Feld das für die Prüfung der Signatur notwendige X.509-EE-Zertifikat Base64-kodiert eintragen.<br> <br> Er SOLL für dieses Zertifikat im "OCSPResponse"-Feld die OCSP-Response, die nicht älter als 24 Stunden sein darf, eintragen.<br> <span style="font-size: 10pt;line-height: 1.5;">Falls ihm keine OCSP-Response zur Verfügung steht, so MUSS er im OCSPResponse-Feld den Leerstring als Wert eintragen ("OCSPResponse" : "").<br> </span> <br> Der Client MUSS für die Berechnung des "FinishedData"-Feldes zunächst folgende Zeichenkette bilden<br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">"VAUClientSigFin" ||</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">unkodierter Hashwert aus&nbsp;"VAUClientHelloDataHash" ||</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">unkodierter Hashwert aus &nbsp;"VAUServerHelloDataHash"</span><br> Diese Zeichenkette MUSS 15+32+32=79 Bytes lang sein. Der Client MUSS diese Zeichenkette mittels AES-GCM (vgl. <span class="polarion-rte-link" data-type="crossReference" id="fake" data-custom-label="A_16943-01" data-item-id="ML-102752" data-option-id="custom"></span>) verschlüsseln und dabei folgende Zeichenkette bilden<br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">256-Bit KeyID || 96-Bit Nonce (IV)&nbsp;mit Ciphertext und 128 Bit Authentication-Tag</span><br> Diese Zeichenkette MUSS er Base64-kodieren und das Ergebnis als Wert des&nbsp;"FinishedData"-Feld eintragen.<br> <b>&lt;=</b></p>
  </div>
  <p id="polarion_305">Hinweis: Obwohl innerhalb einer der VAUServerHelloData der Wert VAUClientHelloDataHash enthalten ist und damit auch in die Berechnung von VAUServerHelloDataHash mit einfließt, wird der Wert VAUClientHelloDataHash explizit in VAUClientSigFin aufgeführt. Ziel ist es möglichst direkt Transparenz über die bestätigten Daten zu schaffen.</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-92425">
   <p><b>A_17071</b></p>
   <p>Der Client MUSS auf eine VAUServerHello-Nachricht mit einer VAUClientSigFin-Nachricht antworten. Der Client MUSS die VAUClientSigFin-Nachricht per HTTP mit dem Content-Type 'application/json' an den Server senden. <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-92421">6.7 VAUServerFin-Nachricht</h3>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-102749">
   <p><b>A_17072-01</b></p>
   <p>Der Server MUSS beim Empfang der VAUClientSigFin-Nachricht prüfen,<br> 
    <ol> 
     <li>ob die darin enthaltene Signatur gültig ist,&nbsp;</li> 
     <li><span style="font-size: 10pt;line-height: 1.5;">ob der Hashwert des Client-Zertifikats aus dem ”Certificate”-Feld gleich dem Hashwert aus dem ClientHelloData-&gt;CertificateHash-Feld ist (vgl. Erzeugung des Hashwerts in <span class="polarion-rte-link" data-type="crossReference" id="fake" data-custom-label="A_16883-01" data-item-id="ML-102745" data-option-id="custom"></span>), und</span></li> 
     <li>ob der Wert im "FinishedData"-Feld der nach&nbsp;<span class="polarion-rte-link" data-type="crossReference" id="fake" data-custom-label="A_17070-02" data-item-id="ML-109364" data-option-id="custom"></span>&nbsp;zu erwartenden Wert entspricht.</li> 
    </ol> <span style="font-size: 10pt;line-height: 1.5;">Falls eine der Prüfungen 1 bis 3 ein nicht-positives Prüfergebnis liefert, so MUSS der Server mit einer VAUServerError-Nachricht antworten und die weitere Protokolldurchführung abbrechen. Wobei er folgende Fehlermeldung pro Prüfung verwenden MUSS:<br> </span> 
    <ol> 
     <li><span style="font-size: 10pt;line-height: 1.5;">-&gt; "Signature from VAUClientSigFin invalid"</span></li> 
     <li><span style="font-size: 10pt;line-height: 1.5;">-&gt; "Client Certificate inconsistent", und</span></li> 
     <li><span style="font-size: 10pt;line-height: 1.5;">-&gt; "VAUClientSigFin invalid".</span></li> 
    </ol> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-90070">
   <p><b>A_16899</b></p>
   <p>Der Server MUSS eine wie folgt aufgebaute VAUServerFin-Nachricht erzeugen.<br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">{&nbsp;</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"MessageType"&nbsp; &nbsp; : "VAUServerFin",</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"FinishedData" : "...Base64-kodierte-verschlüsselte-Finished-Daten..."</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">}</span><br> Der Server MUSS für die Berechnung des "FinishedData"-Feldes zunächst folgende Zeichenkette bilden<br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"VAUServerFin" ||</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">unkodierter Hashwert aus&nbsp;"VAUClientHelloDataHash" ||</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">unkodierter Hashwert aus "VAUServerHelloDataHash"</span><br> Diese Zeichenkette MUSS 12+32+32=76 Bytes lang sein. Der Server MUSS diese Zeichenkette mittels AES-GCM (vgl.&nbsp;<span class="polarion-rte-link" data-type="crossReference" id="fake" data-custom-label="A_16943-01" data-item-id="ML-102752" data-option-id="custom"></span>) verschlüsseln und dabei folgende Zeichenkette bilden<br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">256-Bit KeyID || 96-Bit Nonce (IV)&nbsp;mit Ciphertext und 128 Bit Authentication-Tag</span><br> Diese Zeichenkette MUSS er Base64-kodieren und das Ergebnis als Wert des&nbsp;"FinishedData"-Feld eintragen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-92427">
   <p><b>A_17073</b></p>
   <p>Der Server MUSS nach dem Erhalt einer VAUClientSigFin-Nachricht mit einer VAUServerFin-Nachricht antworten. Der Server MUSS die VAUServerFin-Nachricht per HTTP mit dem Content-Type 'application/json' an den Client senden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-92454">
   <p><b>A_17084</b></p>
   <p>Der Client MUSS beim Empfang der VAUServerFin-Nachricht prüfen, ob der Wert im "FinishedData"-Feld der nach A_16899 zu erwartenden Wert entspricht. Falls nein, so MUSS der Client den weiteren Protokollablauf abbrechen (vgl. A_16849). <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-92339">6.8 Nutzerdatentransport</h3>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110893">
   <p><b>A_16945-02</b></p>
   <p>Wie bei der Schlüsselaushandlung MUSS der Client mittels HTTP-POST-Request die nun verschlüsselte Kommunikation initiieren. <br>Der Client MUSS einen unsigned 64-Bit-Nachrichtenzähler führen, die er bei jeder abgeschickten Nachricht um zwei erhöhen MUSS. <br> <br>Er bildet die Datenstruktur "P1" mit<br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp;P1=Version (ein Byte mit dem Wert 0x01) ||&nbsp;<br> &nbsp; &nbsp; Nachrichtenzähler (unsigned 64-Bit im Big-Endian-Format) ||&nbsp;<br> &nbsp; &nbsp; Anzahl der Bytes der folgenden zusätzlichen HTTP-<br> Header-Informationen (unsigned 32-Bit im Big-Endian-Format) ||&nbsp;<br> &nbsp; &nbsp; zusätzliche HTTP-Header-Informationen ||&nbsp;<br> &nbsp; &nbsp; Plaintext&nbsp;<br></span> wobei „Plaintext“ die zu übertragende Nutzlast (bspw. SOAP-Request) bezeichnet.&nbsp;<br> <br> Wenn die Anzahl der Bytes der folgenden zusätzlichen HTTP-Header-Informationen mit 0 (also 0x00000000) angegeben wird, so gibt es keine folgenden zusätzlichen HTTP-Header-Informationen, d. h. es folgen direkt die Plaintext-Bytes.&nbsp;<br> <br> Der Nachrichtenzähler MUSS initial mit 1 starten. <br> <span style="font-size: 10pt;line-height: 1.5;">Der Client MUSS zunächst einen IV wie folgt erzeugen:<br></span> 
    <ol>
     <li><span style="font-size: 10pt;line-height: 1.5;">Sei a ein zufällig erzeugtes 32-Bitfeld.</span></li>
     <li><span style="font-size: 10pt;line-height: 1.5;">Sei IV=a (32 Bit) || Nachrichtenzähler (unsigned 64-Bit im Big-Endian-Format).</span></li>
    </ol><span style="font-size: 10pt;line-height: 1.5;">Damit ist der IV 96-Bit lang. Unter Verwendung dieses IV und des zweiten aus <span data-option-id="custom" data-item-id="ML-102752" data-custom-label="A_16943-01" id="fake" data-type="crossReference" class="polarion-rte-link"></span>&nbsp;abgeleiteten Schlüssel (Client-to-Server-Schlüssel) wird P1 verschlüsselt.&nbsp;</span>Der Client berechnet so den "Ciphertext".<br> Die vom Client nun an den Server zu übermittelnde Datenstruktur MUSS folgende Form besitzen.<br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp;256-Bit KeyID || 96-Bit IV mit Ciphertext und 128 Bit Authentication-Tag<br></span> <br> Diese Nachricht MUSS der Client per HTTP-POST-Request mit Content-Type 'application/octet-stream' ohne weitere Kodierungen versenden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110894">
   <p><b>A_16952-02</b></p>
   <p>Der Server erkennt aus der KeyID, welchen AES-Schlüssel er für die Entschlüsselung verwenden muss (vgl. A_16943-* <span style="font-size: 10pt;line-height: 1.5;">zweiter abgeleiteter Schlüssel (Client-to-Server-Schlüssel)</span>). <br>Falls ihm die KeyID unbekannt ist, so MUSS er mit einer VAUServerError-Nachricht mit der Fehlermeldung "KeyID XXX not found" antworten, wobei er XXX durch die empfangene KeyID in Hexadezimalform ersetzen MUSS.<br>Falls bei der Entschlüsselung ein Fehler auftritt (bspw. Authentication-Tag passt nicht zur Nachricht), MUSS der Server mit einer VAUServerError-Nachricht mit der Fehlermeldung "AES-GCM decryption error." antworten.<br> <br>Falls die Entschlüsselung erfolgreich war, MUSS der Server&nbsp;<span style="font-size: 10pt;line-height: 1.5;">den Klartext gemäß der Struktur von P1 aus A_16945-*&nbsp;&nbsp;interpretieren.<br></span> <br> <span style="font-size: 10pt;line-height: 1.5;">Falls die Version in P1 ungleich 0x01 ist, so MUSS der Server (1) eine VAUServerError-Nachricht gemäß A_16851-* mit der Fehlermeldung ”invalid protocoll version” senden und gemäß A_16849&nbsp;die Protokollausführung abbrechen.<br><br> Sei mit ”Server-Zählerwert” der letzte vom Server für den Nachrichtenversand verwendete Zählerwert bezeichnet. Initial (d. h. es wurde innerhalb eines Protokollablaufs noch nie eine Nachricht vom Server versendet) MUSS dieser Server-Zählerwert gleich 0 sein.<br> Der Server MUSS prüfen, ob der Zählerwert im Klartext größer als der ”Server-Zählerwert” ist. Falls nein, so MUSS der Server (1) eine VAUServerError-Nachricht gemäß A_16851-* mit der Fehlermeldung ”invalid counter value” senden und (2) gemäß A_16849 die Protokollausführung abbrechen.<br> Der Server MUSS den ”Server-Zählerwert” auf Zählerwert + 1 setzen.<br> Falls es dabei zu einem Zählerüberlauf kommt, so MUSS der Server (1) eine VAUServerError-Nachricht gemäß A_16851-* mit der Fehlermeldung ”message counter overflow” senden und (2) gemäß A_16849 die Protokollausführung abbrechen.<br> Der Server MUSS zusätzliche HTTP-Header-Informationen analog zu A_16945-* interpretieren und verwenden. Falls dies nicht möglich ist (bspw. Längenwert ist größer als eigentliche Nachrichtengröße), so MUSS der Server (1) eine VAUServerError-Nachricht gemäß A_16851-* mit der Fehlermeldung ”HTTP additional header length error” senden und (2) gemäß A_16849 die Protokollausführung abbrechen.</span><br> <br>Der Server erzeugt zunächst die Datenstruktur "P2" mit<br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp;P2 = <span style="font-size: 10pt;line-height: 1.5;">Version (ein Byte mit dem Wert 0x01) ||&nbsp;</span><br> &nbsp; &nbsp; &nbsp; Server-Zählerwert (unsigned 64-Bit, big-endian-format) ||<br> &nbsp; &nbsp; &nbsp; Anzahl der Bytes der folgenden zusätzlichen HTTP-Header-Informationen (unsigned 32-Bit im Big-Endian-Format) ||&nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;zusätzliche HTTP-Header-Informationen ||&nbsp;<br> &nbsp; &nbsp; &nbsp; Klartext-Antwort des Servers</span><br> <br>Der Server MUSS P2 mit AES-256-GCM verschlüsseln. Dafür MUSS der Server zufällig eine 96-Bit-großen IV wie folgt erzeugen:<br> 
    <ol>
     <li>Sei <span style="font-size: 10pt;line-height: 1.5;">a ein zufällig erzeugtes 32-Bitfeld.</span></li>
     <li><span style="font-size: 10pt;line-height: 1.5;">Sei IV=a (32 Bit) || Server-Nachrichtenzähler (unsigned 64-Bit im Big-Endian-Format).</span></li>
    </ol><span style="font-size: 10pt;line-height: 1.5;">Damit ist der IV 96-Bit lang. Unter Verwendung dieses IV und des dritten aus A_16943-*&nbsp;abgeleiteten Schlüssel (Server-to-Client-Schlüssel) MUSS der Server P2 verschlüsseln.</span><br> <br> Die zu übermittelnde Datenstruktur MUSS folgende Form besitzen<br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp;256-Bit KeyID || 96-Bit IV mit Ciphertext und 128 Bit Authentication-Tag</span><br> <br>Diese Datenstruktur MUSS der Server per HTTP-Response mit Content-Type 'application/octet-stream' ohne weitere Kodierungen versenden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110898">
   <p><b>A_16957-01</b></p>
   <p>Beim Empfang der Antwort (vgl. A_16952-*) MUSS der Client folgende Vorgaben durchsetzen.<br> Falls 
    <ol>
     <li><span style="color: #000000;">er die KeyID nicht kennt,<br></span></li>
     <li><span style="color: #000000;">die Entschlüsselung fehlschlägt (bspw. Authentication-Tag passt nicht zur Nachricht), oder<br></span></li>
     <li><span style="color: #000000;">der 64-Bit Zählerwert ungleich 1 plus dem Zählerwert ist, den der Client für den Request verwendet hat,<br></span></li>
    </ol><span style="color: #000000;">so MUSS der Client die Nachricht verwerfen und die weitere Protokollausführung mittels des empfangenen KeyID abbrechen.<br><br> Anderen falls (alles ok, kein Abbruch) MUSS der Client den mit der KeyID verbundenen Zählerwert um eins erhöhen. D. h., Nachrichten vom Client an den Server haben immer einen ungeraden Zählerwert.</span> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-90085">
   <p><b>A_16958</b></p>
   <p>Der Client KANN jeder Zeit eine neue Schlüsselaushandlung (VAUClientHello etc.) initiieren. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-92423">
   <p><b>A_17069</b></p>
   <p>Der Client MUSS, falls so viele Nachrichten ausgetauscht werden, dass für den unsigned 64-Bit-Nachrichtenzähler ein arithmetischer Überlauf droht, eine neue Schlüsselaushandlung initiieren (VAUClientHello etc.). <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-92340">6.9 VAUServerError-Nachricht</h3>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-109365">
   <p><b>A_16851-01</b></p>
   <p>Der Server MUSS folgende Vorgaben umsetzen:<br> In verschiedenen im Protokoll beschriebenen Fehlerfällen sendet der Server eine VAUServerError-Nachricht an den Client.<br> Für die eigentliche Fehlerübermittlung MUSS folgende Datenstruktur erzeugt:<br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">{</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">"DataType" : "VAUServerErrorData",</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">"Data"&nbsp; &nbsp; &nbsp;: "...Fehlermeldung...",&nbsp;</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">"Time"&nbsp; &nbsp; &nbsp;: "...aktuelle-Zeit-in-der-VAU..."</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">}</span><br> Die Zeit im "Time"-Feld MUSS im Format nach ISO-8601 kodiert werden (Beispiel: "2018-11-22T10:00:00.123456").<br> Diese Datenstruktur MUSS der Server Base64-kodieren und in der folgenden Nachricht im Datenfeld "Data" einbetten.<br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">{</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">"MessageType" : "VAUServerError",</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">"Data" : "...Base64-kodierte-VAUServerErrorData..",</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"Signature" : "...Base64-kodierte-ECDSA-Signatur...",</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"Certificate" : "...Base64-kodiertes-Signaturzertifikat...",</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">"OCSPResponse" : "...Base64-kodierte-OCSP-Response-für-dieses-Zertifikat..."</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">}</span><br> <br> Die ECDSA-Signatur im "Signature"-Feld MUSS nach [TR-03111#5.2.2. X9.62 Format] ("ecdsa-with-Sha256") kodiert sein.<br> Im "Certificate"-Feld MUSS der Server, das verwendete Signaturzertifikat aufführen, und im "OCSPResponse"-Feld eine OCSP-Response für diese Zertifikat, welche nicht älter als 24 Stunden ist. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-90071">
   <p><b>A_16900</b></p>
   <p>Erhält der Client eine VAUServerError-Nachricht (vgl. A_16851-01), MUSS er die Signatur prüfen. Falls die Prüfung positiv ist, so MUSS er die Protolldurchführung abbrechen (vgl. A_16849). <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-134989">
   <p><b>A_23282</b></p>
   <p>Clients und Server im VAU-Protokoll-Sinne MÜSSEN bei der Signaturerzeugung und -Prüfung beachten, dass die Signaturen der Nachrichten des VAU-Protokoll (wie in A_16851-* definiert) über die Base64-kodierten Daten erfolgt. Dies gilt für alle Protokoll-Nachrichten im VAU-Protokoll -- stets werden die Base64-kodierten Daten des "Data"-Felds signiert. <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-92341">6.10 Abbrechen des Protokollablaufs</h3>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-90091">
   <p><b>A_16849</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Wenn ein Client oder ein Server den Protokollablauf nach Protokollbeschreibung abbrechen muss, dann MUSS dieser die eventuell aktuell vorhandene KeyID aus seiner Datenbasis löschen und die damit verbundenen Schlüssel sicher löschen.</span><span style="font-size: 11pt;color: #172B4D;background-color: #FFFF99;line-height: 1.5;"><br> </span> <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-100241">6.11 VAU-Kanal und MTOM/XOP</h3>
  <p id="polarion_93" class="MsoNormal"> <span style="font-size: 10pt;line-height: 1.5;">Nachdem die Etablierung des VAU-Kanals abgeschlossen ist, kommuniziert ein VAU-Client (bspw. ein ePA-FdV) mit der VAU bspw. um einen großen verschlüsselten Arztbrief der Akte hinzuzufügen. Dabei ist es für die Performanz (also auch für die Nutzerakzeptanz) günstig, größere Daten mittels der „SOAP Message Transmission Optimization Mechanism (MTOM)“/</span> „<span style="font-size: 10pt;line-height: 1.5;">XML-binary Optimized Packaging (XOP)“-Kodierung zu transportieren. MTOM/XOP ist die nach W3C empfohlene Methode, um über HTTP/SOAP größere binäre Daten zu transportieren. Dabei werden die Binärdaten nicht Base64- innerhalb einer XML-Datenstruktur kodiert, sondern beim HTTP/SOAP-Request (bzw. bei der -Response) über eine MIME-Multipart-Kodierung innerhalb von HTTP. Dabei werden innerhalb der SOAP-Nachricht die Binärdaten über eine ID (&lt;xop:Include href=“cid:Beispiel-ID1“/&gt;) referenziert und innerhalb des HTTP-Request bzw. der HTTP-Response über die „Content-ID“ (vgl. das folgende Beispiel) und eine MIME-Kodierung binär kodiert. Dies führt zur Reduktion Datengröße der zu übertragenden Daten von rund 27,5%.</span> </p>
  <p id="polarion_124" class="MsoNormal"> <span style="font-size: 10pt;line-height: 1.5;">Beispiel:</span> </p>
  <p id="polarion_145" class="MsoNormal"> <span style="font-size: 10pt;line-height: 1.5;">Ohne MTOM/XOP:</span> </p>
  <p id="polarion_148" style="margin-left: 35.4pt;" class="MsoNormal"> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">POST /URL1 HTTP/1.1<br> Content-Type: application/soap+xml; charset=UTF-8<br> Content-Transfer-Encoding: binary<br> Content-Length: …<br> &nbsp;<br> &lt;SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/"&gt;<br> &nbsp; &lt;SOAP-ENV:Header /&gt;<br> &nbsp; &lt;SOAP-ENV:Body&gt;<br> &nbsp;&nbsp;&nbsp; &lt;ns1:uploadFileRequest xmlns:ns1="urn:example:Upload"&gt;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;ns1:name&gt;Test-Bild.png&lt;/ns1:name&gt;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;ns1:content&gt; … Hier kommen in Base64 kodierte Daten … &lt;/ns1:content&gt;<br> &nbsp;&nbsp;&nbsp; &lt;/ns1:uploadFileRequest&gt;<br> &nbsp; &lt;/SOAP-ENV:Body&gt;<br> &lt;/SOAP-ENV:Envelope&gt;</span> </p>
  <p id="polarion_150" style="margin-left: 35.4pt;" class="MsoNormal"> <span style="font-size: 10pt;line-height: 1.5;">&nbsp;</span> </p>
  <p id="polarion_151" class="MsoNormal"> <span style="font-size: 10pt;color: #000000;line-height: 1.5;">Mit MTOM/XOP:</span> </p>
  <p id="polarion_152" style="margin-left: 35.45pt;" class="MsoNormal"> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;line-height: 1.5;">POST /URL1 HTTP/1.1<br> Content-Type: Multipart/Related; boundary="----=_Part_1_1234----"; type="application/xop+xml"; start="Eintrag-1"; start-info=“application/soap+xml“; charset=UTF-8<br> Content-Transfer-Encoding: binary</span><span style="color: #000000;"><span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;"><br> Content-Length: …<br> &nbsp;<br> ----=_Part_1_1234----<br> Content-Type: application/xop+xml; type=“application/soap+xml“; charset=“UTF-8“<br> Content-Transfer-Encoding: 8bit<br> Content-ID: Eintrag-1<br> &nbsp;<br> &lt;s11:Envelope xmlns:s11='http://schemas.xmlsoap.org/soap/envelope/' xmlns:xmime='http://www.w3.org/2005/05/xmlmime'&gt;<br> &nbsp;&lt;s11:Body&gt;<br> &nbsp; &lt;m:data xmlns:m='http://example.org/stuff'&gt;<br> &nbsp; &lt;m:photo xmime:contentType='image/jpeg'&gt;<br> &nbsp;&nbsp; &lt;xop:Include xmlns:xop='http://www.w3.org/2004/08/xop/include'<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; href='cid:Bild-1'/&gt;<br> &lt;/m:photo&gt;<br> &lt;/m:data&gt;<br> &nbsp;&lt;/s11:Body&gt;<br> &lt;/s11:Envelope&gt;<br> &nbsp;<br> ----=_Part_1_1234----<br> Content-Type: image/jpeg<br> Content-Transfer-Encoding: binary<br> Content-ID: Bild-1<br> &nbsp;<br> … hier kommen die binären Daten …<br> ----=_Part_1_1234----<br> </span><span style="font-size: 10pt;line-height: 1.5;">&nbsp;</span></span> </p>
  <p id="polarion_153" class="MsoNormal"> <span style="font-size: 10pt;line-height: 1.5;">Für die Dekodierung einer solchen MIME-Multipart-Kodierung ist es sehr hilfreich (und ggf. notwendig) als Empfänger den vom Sender intendierten (vollständigen) „Content-Type“ aus dem HTTP-Request-Header bzw. dem HTTP-Response-Header zu kennen. Dieser wird jedoch durch das VAU-Protokoll überschrieben (vgl. A_16945-* und A_16952-*). Um die u. a. nach [gemSpec_FM_ePA#A_16220-*]<span id="polarion-comment:494"></span> und [gemSpec_ePA_FdV#A_16222-*]<span id="polarion-comment:495"></span> geforderte Verwendung von MTOM/XOP zu unterstützen, wird der originär intendierte Content-Type, der im „start“-Feld ggf. vertrauliche Daten enthalten kann, innerhalb der „zusätzlichen HTTP-Header-Informationen“ (vgl. A_16945-* und A_16952-*) mitgeliefert.</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110897">
   <p><b>A_18465-01</b></p>
   <p>Wenn ein VAU-Client oder ein VAU-Server Übertragungen mittels MTOM/XOP durchführen, so MÜSSEN sie die durch MTOM/XOP erzeugten „Content-Type“-Informationen (vgl. [gemSpec_Krypt#6.11 VAU-Kanal und MTOM/XOP]) innerhalb ihrer Nachricht als „zusätzliche HTTP-Header-Informationen“ gemäß A_16945-* und A_16952-* aufführen. <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-110895">6.12 Zusätzliche HTTP-Header-Informationen</h3>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110899">
   <p><b>A_20549</b></p>
   <p>Ein VAU-Client oder ein VAU-Server MÜSSEN in den „zusätzliche HTTP-Header-Informationen“ gemäß A_16945-* und A_16952-*, die ursprünglich intendierten Content-Type HTTP-Header-Variable einbringen. D. h. Ein Kommunikationspartner erstellt einen HTTP-Request oder eine HTTP-Response. Diese hat eine "ursprünglich intendierten Content-Type", bspw. "application/soap+xml; charset=utf-8". Diese MUSS dann bei der Verschlüsselung der Nachricht mittels des VAU-Protokolls in die "zusätzlichen HTTP-Header-Informationen" eingetragen werden. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110896">
   <p><b>A_18466-01</b></p>
   <p>Wenn ein VAU-Client oder ein VAU-Server Übertragungen durchführen und in den empfangenen Nachrichten sind „zusätzliche HTTP-Header-Informationen“ gemäß A_16945-* und A_16952-*, so MÜSSEN sie diese auswerten (Hinweis: insbesondere „Content-Type“-Informationen (vgl. [gemSpec_Krypt#6.11 VAU-Kanal und MTOM/XOP]).<br> <br>Dabei "überschreiben" diese zusätzlichen HTTP-Header-Information HTTP-Header-Variablen im "äußeren" HTTP-Request (insbesondere "Content-Type") bei der Interpretation der Informationen aus dem Request. <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-123510">6.13 Tracing in Nichtproduktivumgebungen</h3>
  <p id="polarion_373">Für die Fehlersuche -- insbesondere bei IOP-Problemen zwischen Produkten verschiedener Hersteller in einer fortgeschrittenen Entwicklungsphase -- hat es sich als notwendig erwiesen, dass ein Fehlersuchender den Klartext der Kommunikation zwischen ePA-Client und VAU-Instanz mitlesen kann. Vgl. [gemSpec_Aktensystem#5.8. Tracing in Nichtproduktivumgebungen].</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-122266">
   <p><b>A_21888</b></p>
   <p>Ein Client im VAU-Protokoll MUSS in einer Nichtproduktivumgebung von A_16883-* abweichen in dem er sein ephemeres ECDH-Schlüsselpaar nicht zufällig erzeugt, sondern folgendes ECDH-Schlüsselpaar (auf der Kurve BrainpoolP256r1) für jeden VAU-Protokollverbindungsaufbau verwendet:<br> 
    <ul>
     <li>privater Schlüssel: d=0x78ece94904fc6bf9900cced4c5af4dcd4fbebc585b2054b636cc3f76333bdee</li>
     <li>öffentlicher Schlüssel:&nbsp;x=0x21fafedc8ba1ef5477995a28a9794f86355df305f1f58afc88f87e91c664353a y=0x27803e3dcf670bd305f3b923f915bfe119389d869c3565828c89bd422231f9f4</li>
    </ul> <b>&lt;=</b></p>
  </div>
  <p id="polarion_388">Hinweis-1: SHA-256("gemSpec_Krypt: privater VAUClient-ECDH-Schluessel fuer Nichtproduktivumgebungen nach A_21888-*") ist als hexdump kodiert gleich&nbsp;078ece94904fc6bf9900cced4c5af4dcd4fbebc585b2054b636cc3f76333bdee</p>
  <p id="polarion_389">Hinweis-2:</p>
  <p id="polarion_390">Folgend ist der private Schlüssel aus A_21888-* als PKCS8-Container PEM-kodiert aufgeführt:</p>
  <p id="polarion_392"> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">-----BEGIN PRIVATE KEY-----<br> MIGIAgEAMBQGByqGSM49AgEGCSskAwMCCAEBBwRtMGsCAQEEIAeOzpSQT8a/mQDM<br> 7Uxa9NzU++vFhbIFS2Nsw/djM73uoUQDQgAEIfr+3Iuh71R3mVooqXlPhjVd8wXx<br> 9Yr8iPh+kcZkNTongD49z2cL0wXzuSP5Fb/hGTidhpw1ZYKMib1CIjH59A==<br> -----END PRIVATE KEY-----</span> </p>
  <p id="polarion_385"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-122881">
   <p><b>A_21977</b></p>
   <p>Ein Client im VAU-Protokoll KANN in einer Nichtproduktivumgebung die Umsetzung von A_21888-* durch einen Nutzer (FdV) oder Administrator (Konnektor etc.) konfigurierbar machen, d. h. das Verhalten des Clients zwischen zufälliger Schlüsselerzeugung und festen Schlüssel aus A_21888-* per Konfiguration veränderlich machen. <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-122267">
   <p><b>A_21889</b></p>
   <p>Ein Server im VAU-Protokoll MUSS genau in der Produktivumgebung (PU) bei einem VAU-Handshake den Client-ECDH-Schlüssel aus A_21888-* ablehnen. D. h. er muss falls ein Client im VAUClientHello den öffentlichen Schlüssel aus A_21888-* präsentiert, den Handshake mit einem VAUServerError gemäß A_16851-* abbrechen. <b>&lt;=</b></p>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-126984">6.14 Optionale PQC-Erweiterung (informativ)</h3>
  <p id="polarion_387"> In diesem Abschnitt wird eine optionale Protokollerweiterung des VAU-Protokolls für ePA dargestellt, die sich aktuell in der gematik in der Evaluierung befindet. Kryptographisch gesehen entspricht sie dem PQC-Vorgehen bei TLS aus [TLS-CC-2021]. Mehr Information über PQC findet man in Abschnitt "<span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-126985" data-option-id="longoutline"></span>". </p>
  <p id="polarion_394">Ein Client initiiert mit einer VAUClientHello-Nachricht den VAU-Protokoll-Handshake (Schlüsselvereinbarung). Möchte er zusätzlich zum klassischen ephemeren ECDH-Schlüsselaustausch ein PQC-Verfahren anwenden und die beiden gemeinsam mit dem VAU-Server dabei erzeugten Geheimnisse in die Schlüsselableitung für die symmetrischen Sitzungsschlüssel einfließen lassen, so führt er im Handshake einen Verfahrensidentifikator inkl. dazugehörigen öffentlichen Schlüssel eines der unten aufgeführten PQC-Verfahren mit an.</p>
  <p id="polarion_395">In [liboqs] sind die Referenzimplementierungen der Round-3-Kandidaten der NIST-PQC-Standardisierung [NIST-PQC] enthalten. Ebenfalls sind dort folgende Identifier definiert, die den Definitionen aus den Round-3-Kandidaten entsprechen:</p>
  <p id="polarion_398">Key encapsulation mechanisms (KEM):</p>
  <ul id="polarion_399"> 
   <li>BIKE: BIKE-L1, BIKE-L3</li> 
   <li>Classic McEliece: Classic-McEliece-348864, Classic-McEliece-348864f, Classic-McEliece-460896, Classic-McEliece-460896f, Classic-McEliece-6688128, Classic-McEliece-6688128f, Classic-McEliece-6960119, Classic-McEliece-6960119f, Classic-McEliece-8192128, Classic-McEliece-8192128f</li> 
   <li>FrodoKEM: FrodoKEM-640-AES, FrodoKEM-640-SHAKE, FrodoKEM-976-AES, FrodoKEM-976-SHAKE, FrodoKEM-1344-AES, FrodoKEM-1344-SHAKE</li> 
   <li>HQC: HQC-128, HQC-192, HQC-256</li> 
   <li>Kyber: Kyber512, Kyber512-90s, Kyber768, Kyber768-90s, Kyber1024, Kyber1024-90s</li> 
   <li>NTRU: NTRU-HPS-2048-509, NTRU-HPS-2048-677, NTRU-HPS-4096-821, NTRU-HPS-4096-1229, NTRU-HRSS-701, NTRU-HRSS-1373</li> 
   <li>NTRU-Prime: ntrulpr653, ntrulpr761, ntrulpr857, ntrulpr1277, sntrup653, sntrup761, sntrup857, sntrup1277</li> 
   <li>SABER: LightSaber-KEM, Saber-KEM, FireSaber-KEM&nbsp;<span id="polarion-comment:530"></span></li> 
  </ul>
  <p id="polarion_400">Im VAUClientHelloData&nbsp;führt der Client zusätzlich auf:</p>
  <p id="polarion_401" style="margin-left: 40px;">"PQC.PublicKey" : [ "...Verfahrensidentifikator...", "...base64-kodierter-Public-Key-des-PQC-KEM-Verfahrens..."]</p>
  <p id="polarion_402">"Verfahrensidentifikator" steht für einen der o. g. KEM-Identifier. In [liboqs] ist jeweils für jedes Verfahren eine "KeyGen"-Funktion definiert. Diese erzeugt zufällig ein Schlüsselpaar und gibt als Ergebnis u. a. den öffentlichen Schlüssel aus. Dieser wird so wie er aus der Referenzimplementierung kommt, per base64-Kodierung kodiert im Feld "base64-kodierter-Public-Key-des-PQC-KEM-Verfahrens" eingetragen.</p>
  <p id="polarion_403">Der Server akzeptiert optionale Attribute in den JSON-Nachrichten des VAU-Handshakes auf Grund von A_17074-*. Wenn er das Verfahren ebenfalls unterstützt, dann fügt er den öffentlichen Teil des Ergbnisses der Encaps(öffentlicher Schlüssel des Clients)-Funktion im VAUServerHelloData wie folgt base64-kodiert auf:</p>
  <p id="polarion_404" style="margin-left: 40px;">"PQC.Encaps" : "... base64-kodierter-öffentlicher-Teil-von-Encaps(öffentlicher Schlüssel des Clients) ..."</p>
  <p id="polarion_405">Beim Aufruf von Encaps(öffentlicher Schlüssel des Clients) wird als Ergebnis der Funktion ein öffentlicher Teil und ein geheimer Schlüssel K als Ergebnis berechnet. Der VAU-Server fügt bei der Schlüsselableitung der symmetrischen Sitzungsschlüssel (vgl. A_16943-*) neben dem gemeinsamen ECDH-Geheimnisse noch "Verfahrensidentifikator" || K als Eingabe für die HKDF hinzu (IKM= gemeinsames ECDH-Geheimnis || Verfahrensidentifikator || K). Damit hängen die abgeleiteten Sitzungsschlüssel sowohl vom ECDH-Geheimnis als auch vom geheimen Schlüssel K, also vom PQC-KEM, ab.</p>
  <p id="polarion_406">Bei Erhalt der VAUServerHello-Nachricht im VAU-Client, führt der VAU-Client die Funktion Decaps(s, decodierter öffentlicher Encaps-Wert) aus, wobei s der private Client-PQC-Schlüssel aus der Schlüsselpaarerzeugung für PublicKeyPQC ist (vgl. KeyGen-Funktion). Als Ergebnis erhält er K. Damit kann er genau wie der VAU-Server die Schlüsselableitung der&nbsp;symmetrischen Sitzungsschlüssel (vgl. A_16943-*) durchführen&nbsp;(IKM= gemeinsames ECDH-Geheimnis || Verfahren-ID || K).&nbsp;</p>
  <p id="polarion_407">Sollte der Client bei Erhalt der VAUServerHello-Nachricht kein "Encaps"-Datenfeld im VAUServerHelloData-Teil vorfinden, so unterstützt der VAU-Server das Verfahren nicht. Dem VAU-Client steht es dann frei, den Verbindungsaufbau ohne PQC-Verfahren weiter durchzuführen, den Verbindungsaufbau abzubrechen oder den Verbindungsaufbau neu zu beginnen.</p>
  <p id="polarion_408"> Wenn die Schlüsselableitung bei beiden Kommunikationspartnern erfolgreich durchgeführt werden konnte -- d. h., der VAU-Protokoll-Handshake konnte erfolgreich abgeschlossen werden, dann verläuft der Protokollablauf wie in Abschnitt <span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-92339" data-option-id="shortoutline"></span>ff definiert wie üblich weiter. </p>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-109239">7 Kommunikationsprotokoll zwischen E-Rezept-VAU und E-Rezept-Clients</h2>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-109240">7.1 Übersicht (informativ)</h3>
  <p id="polarion_191"> Ähnlich wie bei der Anwendung ePA besitzt der Fachdienst E-Rezept zwei HTTP-Schnittstellen. Die dabei vom Nutzer (Client) aufgebaute TLS-Verbindung endet an einer dieser HTTPS-Schnittstellen. Die E-Rezept-VAU liegt hinter den Webschnittstellen. Um die Verbindungsstrecke zwischen HTTPS-Schnittstellen und E-Rezept-VAU zu schützen, verschlüsselt und kodiert der Client seine HTTP-Requests (als innere Requests bezeichnet) auf die im Abschnitt <span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-109242" data-option-id="shortoutline"></span>&nbsp;definierte Weise. Diese so erzeugten HTTP-Requests (äußere Requests) sendet der Client per HTTPS an eine der Webschnittstellen des E-Rezept-Dienstes. Dabei ist für die Schnittstelle ein regelmäßig wechselndes Nutzerpseudonym im äußeren HTTP-Request sichtbar. Dieses unterstützt den Fachdienst E-Rezept bei der Lastverteilung und beim DoS-Schutz auf Applikationsebene. Von der Webschnittstelle erhält die E-Rezept-VAU die verschlüsselten Requests, entschlüsselt und verarbeitet diese. Als Antwort erzeugt die&nbsp;E-Rezept-VAU einen für den Client verschlüsselte HTTP-Response. Den Schlüssel dafür hat der Client für die VAU ephemer erzeugt und dieser Schlüssel ist Teil des verschlüsselten Requests. Die Webschnittstelle empfängt das Chiffrat von der VAU und gibt dieses als Antwort auf den HTTP-Request an den Client zurück. </p>
  <p id="polarion_233">Ablauf:</p>
  <ol id="polarion_243"> 
   <li>Der Client erfragt initial das X.509-Zertifikat der VAU (A_20160-*).<span id="polarion-comment:496"></span> Je nachdem, ob die X.509-Root der TI oder die TSL als Prüfbasis verwendet wird, erfolgt die Abfrage des VAU-X.509-Zertifikats spezifisch (entweder A_21216 oder A_21218). Im&nbsp;Zertifikat ist der öffentliche Verschlüsselungsschlüssel der E-Rezept-VAU enthalten. Dieses Zertifikat kommt aus der Komponenten-PKI der TI und ist&nbsp;langlebig, d. h. der Client kann dieses Zertifikat (inkl. Schlüssel) für folgende Verschlüsselungen lokal vorhalten.</li> 
   <li>Der Client erzeugt einen HTTP-Request mit Request-Body und Request-Header als Datenstrukturen (= innerer HTTP-Request) (A_20161-*).<span id="polarion-comment:501"></span></li> 
   <li>Der Client verschlüsselt diesen Request mit dem&nbsp;Verschlüsselungsschlüssel der E-Rezept-VAU. Im Chiffrat ist ein Authentisierungstoken des Nutzers enthalten, eine zufällig gewählte Request-ID, ein vom Client ephemer erzeugter symmetrischer Antwortschlüssel und der am Anfang erzeugte&nbsp;HTTP-Request als Datenstrom (A_20161-*).<span id="polarion-comment:502"></span></li> 
   <li>Der Client erzeugt einen neuen (äußeren) HTTP-Request und überträgt darin das Chiffrat an eine HTTPS-Schnittstelle des Fachdienstes&nbsp;E-Rezept. Dabei gibt der Client ggf. das schon aus einer vorherigen Response des Fachdienstes E-Rezept mitgeteilte Nutzerpseudonym (A_20161-*)<span id="polarion-comment:503"></span> mit.</li> 
   <li>Die Webschnittstelle nimmt den Request entgegen und trifft eine Routing-Entscheidung oder eine Priorisierungsentscheidung im Lastfall. Anschließend leitet sie den Request an die VAU weiter (A_20162).</li> 
   <li>Die VAU entschlüsselt den Request und verarbeitet ihn. Die Antwort wird inkl. der Request-ID mit dem vom&nbsp;Nutzer erzeugten Antwortschlüssel verschlüsselt und an die Webschnittstelle gesendet.</li> 
   <li>Die Webschnittstelle antwortet gegenüber dem Client mit diesem Chiffrat auf den HTTP-Request.</li> 
   <li>Der Client entschlüsselt das Chiffrat und prüft die Request-ID in der entschlüsselten Antwort.</li> 
  </ol>
  <p id="polarion_250">Das Protokoll ist statuslos. Zwischen verschiedenen VAU-Instanzen (bspw. VAU-Instanzen in unterschiedlichen Brandabschnitten eines Rechenzentrum) müssen keine Session-Schlüssel oder ähnliches synchronisiert werden.</p>
  <p id="polarion_252">Die Struktur der inneren HTTP-Request ist so einfach, dass davon auszugehen ist, dass in der VAU-Instanz keine umfangreichen Webserver oder HTTP-Bibliotheken notwendig sind. Ziel der E-Rezept-VAU ist es die Code-Komplexität (Trusted Computing Base, TCB) so weit es nur irgendwie geht minimal zu halten.</p>
  <p id="polarion_195" style="text-align: center;"> <img src="attachments/diagram_20200513-2121.21159.mxg.png" style="max-width: 750px;" data-lastmodified="2020-05-14T01:01:39.847+02:00"> </p>
  <p id="polarion_261" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">4</span>: Sicherungsschichten beim Datentransport zwischen E-Rezept-Client und E-Rezept-VAU<br> </p>
  <p id="polarion_274">Die gematik stellt eine Beispielimplementierung bereit.</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-109242">7.2 Definition</h3>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-114468">7.2.1 E-Rezept-VAU-Identität</h4>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-114528">
   <p><b>A_20160-01</b></p>
   <p>Der Fachdienst E-Rezept MUSS folgende Punkte sicherstellen.<br> 
    <ol>
     <li>Die VAU MUSS ein EE-X.509-Zertifikat aus der Komponenten-PKI der TI besitzen<br> (mit Rollenkennung-OID "oid_erp-vau"), das einen ECC-EE-Schlüssel der VAU bestätigt.&nbsp;</li>
     <li>Die VAU MUSS die Vertraulichkeit des privaten Schlüssels für diese Zertifikat sicherstellen.</li>
     <li>Die notwendige Sicherung (Backup) und Verteilung dieses privaten Schlüssels MUSS ausschließlich im Mehr-Augen-Prinzip und mit geeigneten Maßnahmen zur Wahrung der Vertraulichkeit des Schlüssels geschehen.</li>
     <li>Der Fachdienst E-Rezept MUSS das VAU-Zertifikat in seinen Webschnittstellen unter dem Pfad <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/VAUCertificate</span> (einer URL) durch Clients abrufbar machen. Dieses Zertifikat MUSS DER-kodiert sein.</li>
     <li>Der Fachdienst E-Rezept MUSS&nbsp;eine maximal 12 Stunden alte OCSP-Response für das VAU-Zertifikat in seinen Webschnittstellen unter dem Pfad <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/VAUCertificateOCSPResponse</span> für Clients abrufbar machen.</li>
    </ol> <b>&lt;=</b></p>
  </div>
  <p id="polarion_257"> Hinweis: Unter "/VAUCertificateOCSPResponse" erhält ein Client (einfacher GET-Request) eine korrekte OCSP-Response für das VAU-Zertifikat (A_20160-*, Punkt 1). Dies ist analog wie OCSP-Stapling bei TLS zu sehen, nur auf einer höheren OSI-Schicht. Der FD stellt korrekte OCSP-Responses zur Verfügung damit nicht jeder Client selbst den OCSP-Responder fragen muss. Diese Funktionalität hat nichts mit der OCSP-Proxy-Funktionalität zu tun wie sie bspw. beim Zugangsgateway des Versicherten bei ePA angeboten wird. Der FD fragt bspw. stündlich selbst den OCSP-Status für sein VAU-Zertifikat ab, prüft die Antwort und stellt sie unter "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/VAUCertificateOCSPResponse"</span>&nbsp;Clients zur Verfügung. </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-113191">
   <p><b>A_20967</b></p>
   <p>Der Fachdienst E-Rezept MUSS folgende Punkte sicherstellen.<br> 
    <ol> 
     <li> Die Erstellung, Sicherung und Wiederherstellung von nicht-flüchtigen (nicht kurzzeitig gültigen) Schlüsseln (A_20160-* Punkt 2-3, Masterkey für die Verschlüsselung der E-Rezept in der VAU etc.) MUSS im Mehr-Augen-Prinzip erfolgen bei dem mindestens ein gematik-Mitarbeiter beteiligt ist.</li> 
     <li>Die Administration des/der HSM der VAU MUSS ebenfalls&nbsp;im Mehr-Augen-Prinzip erfolgen bei dem mindestens ein gematik-Mitarbeiter beteiligt ist.</li> 
    </ol> Die oben genannten Punkten MÜSSEN durch das/die HSM der VAU technisch durchgesetzt werden (Rechtekonzept). <b>&lt;=</b></p>
  </div>
  <p id="polarion_331">Hinweis: A_20967 beschreibt ein analoges Vorgehen wie es bei den SGD(1,2) üblich ist. Der Betreiber des FD besitzt für bestimmte Rollenauthentisierungen für die HSM Authentisierungschipkarten inkl. PIN, die gematik ebenfalls. Nur bei gleichzeitiger Authentisierung beider Beteiligter erlauben die HSM bestimmte Aktionen/Funktionalitäten.</p>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-114467">7.2.2 Client-seitige Prüfung der E-Rezept-VAU-Identität</h4>
  <p id="polarion_88"> Bevor ein E-Rezept-Client die&nbsp;E-Rezept-VAU-Identität für die Verschlüsselung seiner Request (vgl.&nbsp;<span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-114466" data-option-id="longoutline"></span>&nbsp;) verwendet muss der Client deren X.509-Zertifikat prüfen ([gemSpec_eRp_FdV#A_19739], [gemILF_PS_eRP#A_20769]). </p>
  <p id="polarion_350"> Ein E-Rezept-Client auf einen Praxisverwaltungssystem (PVS) oder einen Apothekenverwaltungssystem (AVS) muss die TSL als Prüfbasis für solch eine Prüfung verwenden [gemILF_PS_eRP#A_20764].<br> Da ein E-Rezept-FdV nur zwei TI-Zertifikate prüfen muss, wird im FdV die technisch deutlich einfachere Zertifikatsprüfung auf Basis der TI-X.509-Root verwendet [gemSpec_eRp_FdV#A_20032-*], und nicht die Prüfung über die TSL wie im Client eines PVS oder AVS [gemILF_PS_eRP#A_20764]. Beide Prüfwege sind sicherheitstechnisch äquivalent. </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-114473">
   <p><b>A_21216</b></p>
   <p>Ein E-Rezept-Client, der nicht das E-Rezept-FdV ist,&nbsp;MUSS das VAU-Zertifikat vom E-Rezept-FD beziehen (vgl. A_20160-*, URL /VAUCertificate) und ebenfalls für dieses Zertifikat die OCSP-Reponse für dieses Zertifikat beziehen (vgl. A_20160-*, URL /VAUCertificateOCSPResponse). Er MUSS das Zertifikat mittels <span style="font-family: Arial, Helvetica;">TUC_PKI_018</span> (OCSP-Graceperiod=12h, PolicyList={oid_erp-vau}) prüfen und dabei die vom FD bezogene OCSP-Response verwenden. <b>&lt;=</b></p>
  </div>
  <p id="polarion_209"> Der E-Rezept-FD muss für die Zertifikatsprüfung im E-Rezept-FdV eine (außer für die Verfügbarkeit) sicherheitsunkritische Unterstützungsleistung erbringen und dafür folgend benannte Zertifikate zum Download anbieten.&nbsp;<br> Zunächst erfolgen mit Tab_KRYPT_ERP_Zertifikatsliste und Tab_KRYPT_ERP_Algorithmus_FD_Zertifikatsliste_erstellen zwei Hilfsdefinitionen. <br> </p>
  <p id="polarion_212" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">17</span>: Tab_KRYPT_ERP_Zertifikatsliste Definition Datenstruktur Zertifikatsliste </p>
  <table id="polarion_wiki macro name=table;params=header=no|bold=0|width=100%|uid=213" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 81.2px;height: 18px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">{<br> &nbsp; &nbsp;"add_roots" : [ "base64-kodiertes-Root-Cross-Zertifikat-1", ... ],<br> &nbsp; &nbsp;"ca_certs"&nbsp; : [ "base64-kodiertes-Komponenten-CA-Zertifikat-1", ... ],<br> &nbsp; &nbsp;"ee_certs"&nbsp; : [ "base64-kodiertes-EE-Zertifikat-1-aus-einer-Komponenten-CA", ... ]<br> }</span></td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_229" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">18</span>: Tab_KRYPT_ERP_Algorithmus_FD_Zertifikatsliste_erstellen </p>
  <table id="polarion_wiki macro name=table;params=header=no|bold=0|width=100%|uid=230" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <td style="width: 81.2px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-family: Arial, Helvetica;">(1)<br> Als Startpunkt muss eine Datenstruktur nach "Tab_KRYPT_ERP_Zertifikatsliste" (ein Associative-Array) erzeugt werden, bei dem die Array-Elemente jeweils leer sind:<br> { "add_roots" : [], "ca_certs" : [], "ee_certs" : []}<br> (2)<br> Im Array "ee_certs" wird das E-Rezept-VAU-Zertifikat (vgl. A_20160-*) base64-kodiert hinzugefügt werden.<br> (3) <br> Im Array "ee_certs" werden alle IDP-Signatur-Zertifikate (oid_idpd [gemSpec_OID]) die dem FD bekannt sind base64-kodiert am Ende angefügt.<br> Die gematik teilt dem E-Rezept-FD regelmäßig die aktuelle vollständige Liste mit.<br> (4)<br> Im Array "ca_certs" werden alle Komponenten-CA-Zertifikat base64-kodiert eingetragen, die die Zertifikate aus "ee_certs" bestätigt haben. Hinweis: Diese Komponenten-CA-Zertifikate findet man in der TSL und ebenfalls auf <a href="https://download.tsl.ti-dienste.de/SUB-CA/" target="_top" class="descriptionLink">https://download.tsl.ti-dienste.de/SUB-CA/</a>&nbsp;<br> (5) <br> Falls es in "ca_certs" CA-Zertifikate gibt die nicht per Signaturprüfung auf den Root-Schlüssel vom RCA3 rückführbar sind, werden nacheinander die chronologisch auf einander folgenden base64-kodierten Root-Cross-Zertifikate (RCA3-&gt;RCA4, ... RCA(x)-&gt;RCA(x+1)) am Ende des Arrays "add_roots" angefügt, solange bis alle CA-Zertifikate über einen der Root-Schlüssel prüfbar sind, d. h. per Signaturprüfung auf einen Root-Schlüssel im Array rückführbar sind. Hinweis: dieses Cross-Zertifikate findet man auf&nbsp;<a href="https://download.tsl.ti-dienste.de/ROOT-CA/" target="_top" class="descriptionLink">https://download.tsl.ti-dienste.de/ROOT-CA/</a>&nbsp; <br> </span></td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_332"> Hinweis: zum produktiven Start des E-Rezept-FD enthält das Array "ee_certs" drei Elemente (<span style="font-size: 10pt;line-height: 1.5;">Zertifikat des VAU-Protokolls, Signaturzertifikat des Discovery-Dokumentes, Signaturzertifikat des ID_Token</span>), das Array "ca_certs" ein Element und das Array "add_roots" null Elemente. </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-114474">
   <p><b>A_21217</b></p>
   <p>Ein E-Rezept-FD MUSS<br> 
    <ol> 
     <li>nachdem die E-Rezept-VAU-Identität (vgl. A_20160-*) erzeugt wurde mittels des Algorithmus aus Tab_KRYPT_ERP_FD_Zertifikatsliste_erstellen die Datenstruktur analog zu&nbsp;Tab_KRYPT_ERP_Zertifikatsliste erstellen.</li> 
     <li>diese erzeugte Zertifikatsliste auf seiner Webschnittstelle (HTTPS) über die URL /CertList (GET-Methode, Reponse-Content-Type 'application/json') verfügbar machen.</li> 
     <li>die Zertifikatsliste mittels des Algorithmus aus Tab_KRYPT_ERP_FD_Zertifikatsliste_erstellen aktualisieren wenn (1) die E-Rezept-VAU-Identität aktualisiert wurde (Schlüsselwechsel der VAU etc.) oder (2) die gematik neue IDP-Zertifikate über die Liste E-Rezept-Clients bekannt machen möchte. Im Fall (2) meldet die gematik dies an den FD.</li> 
     <li>an seiner Webschnittstelle (HTTPS) über die URL /OCSPList&nbsp;(GET-Methode, Reponse-Content-Type 'application/json') ein Array mit den base64-kodierten OCSP-Responses für die alle Zertifikate aus dem Array "ee_certs". Diese OCSP-Response-Liste muss der FD mindestens alle 11 Stunden mit "frischen" OCSP-Responses für die Zertifikate aus dem Array "ee_certs" aktualisieren.</li> 
    </ol> <b>&lt;=</b></p>
  </div>
  <p id="polarion_425"></p>
  <p id="polarion_215" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">19</span>: Tab_KRYPT_ERP_FdV_Truststore_aktualisieren </p>
  <table id="polarion_wiki macro name=table;params=header=no|bold=0|width=100%|uid=216" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <td style="width: 81.2px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-family: Arial, Helvetica;">(1)<br> Alle Zertifikate im Truststore müssen gelöscht werden mit Ausnahme von RCA3.<br> Der Truststore besitzt, wie in A_21218 definiert, Prüfschlüssel/Zertifikate in vier Kategorien (A) Root-Schlüssel, (B) CA-Zertifikate, (C) E-Rezept-VAU-Zertifikat, (D) IDP-Zertifikat(e).<br> (2) <br> Falls die Zertifikatsliste im Array "add_roots" nichtleer ist, so wird das erste Cross-Zertifikat im Array auf Basis von RCA3 per Signaturprüfung geprüft. Ebenfalls wird geprüft, ob der bestätigte CommonName dem Muster "GEM.RCA" + Zahl entspricht. Falls beide Prüfungen mit positiven Prüfergebnis erfolgen konnten, so wird das Zertifikat in Kategorie (A) des Truststores aufgenommen. Weitere Zertifikate im Array werden analog mit dem jeweils vorherigen Cross-Zertifikat per Signaturprüfung und CommonName-Prüfung geprüft und bei positiven Prüfergebnissen in Kategorie (A) des Truststores aufgenommen.<br> (3)<br> Für jedes Zertifikat im Array "ca_certs" wird überprüft, ob es zeitlich gültig ist, ob es per Signaturprüfung auf einen Root-Schlüssel aus (A) rückführbar ist und ob der bestätigte CommonName dem Muster "GEM.KOMP-CA" + Zahl entspricht. Wenn alle drei Prüfungen ein positives Prüfergebnis liefern, so wird das Zertifikat in Kategorie (B) des Truststores aufgenommen.<br> (4) <br> Für jedes Zertifikat im Array "ee_certs" wird überprüft ob es&nbsp;zeitlich gültig ist und ob es per Signaturprüfung auf einen CA-Schlüssel aus (B) rückführbar ist. Wenn nicht beide Prüfungen ein positives Prüfergebnis liefern, so wird das Zertifikat verworfen.<br> Anderen falls wird geprüft, ob das Zertifikat eine OID mit dem Wert oid_erp-vau [gemSpec_OID] enthält. Dann wird es im Truststore bei Kategorie (C) eingefügt. Falls das Zertifikat eine&nbsp;OID mit dem Wert oid_idpd [gemSpec_OID] enthält. Dann wird es im Truststore bei Kategorie (D) eingefügt.</span></td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_431" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">20</span>: Tab_KRYPT_ERP_OCSP_Liste Definition Datenstruktur OCSPList </p>
  <table id="polarion_wiki macro name=table;params=header=no|bold=0|width=100%|uid=432" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <td style="width: 81.2px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">{<br> &nbsp; &nbsp;"OCSP Responses":&nbsp;[ "base64-kodiertes-OCSP-Responce-EE-Zertifikat-1", ... ]<br> }<br> </span></td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_433"></p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-114492">
   <p><b>A_21218</b></p>
   <p>Das E-Rezept-FdV MUSS die RCA3 (das Zertifikat der Version 3 der X.509-Root der TI) als Vertrauensanker im Programm-Code bzw. mit dem Programm-Code fest assoziiert enthalten und als Basis für die Prüfung von TI-Zertifikat verwenden.<br> Das FdV MUSS einen TI-Zertifikate-Truststore enthalten und pflegen, wie folgend definiert.<br> <br> Der Truststore MUSS Prüfschlüssel/Zertifikat aufgeteilt in folgende vier Kategorien enthalten: (A) Root-Schlüssel, (B) CA-Zertifikate, (C) E-Rezept-VAU-Zertifikat, (D) IDP-Zertifikat(e). Initial kann dieser Truststore nur RCA3 enthalten oder die Zertifikate die mittels Tab_KRYPT_ERP_FD_Zertifikatsliste_erstellen ermittelt werden. <br> Falls im Truststore keine Zertifikate für Kategorie (C) und (D) vorliegen, so MUSS das&nbsp;FdV den Truststore aktualisieren indem es über den FD (URL /CertList) die Zertifikatsliste lädt und diese mittels des Algorithmus Tab_KRYPT_ERP_FdV_Truststore_aktualisieren prüft und ggf. in den Truststore lädt.<br> Das E-Rezept-FdV MUSS über den FD (URL /OCSPList) OCSP-Responses für die Zertifikate (C) und (D) beziehen, wenn aktuell keine OCSP-Responses für diese Zertifikate im FdV vorliegen, die jünger als 12 Stunden sind.<br> Falls in der OCSP-Liste OCSP-Responses enthalten sind die zu keinem der Zertifikate (C) und (D) passen, so MUSS das FdV den Truststore aktualisieren (s. o.).<br> Zertifikate aus (C) und (D) MÜSSEN OCSP-Responses, die jünger als 12 Stunden sind besitzen, damit diese Zertifikate in fachliche Use-Cases im FdV verwendet werden können.<br> <br> Die OCSP-Responder-Zertifikate MÜSSEN per Signaturprüfung auf ein Zertifikat der Kategorie (B) rückführbar sein, ansonsten MÜSSEN die entsprechenden OCSP-Responses verworfen werden.<br> <br> Das FdV MUSS bei der Prüfung der TI-Zertifikate in fachlichen Use-Cases im FdV, prüfen ob das Zertifikat im oben beschriebenen Truststore enthalten ist und eine gültige OCSP-Response enthält die jünger als 12 Stunden ist. Falls dies nicht so ist, so ist das Ergebnis der Prüfung des TI-Zertifikats FAIL.<br> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-114506">
   <p><b>A_21222</b></p>
   <p>Ein E-Rezept-Client MUSS bevor er TI-X.509-Zertifikate in fachlichen Abläufen (bspw. VAU-Kanal) verwendet, diese Zertifikate prüfen (vgl. A_21216 und A_21218). <b>&lt;=</b></p>
  </div>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-114466">7.2.3 E-Rezept-VAU-Request und -Response</h4>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111982">
   <p><b>A_20161-01</b></p>
   <p>Ein E-Rezept-Client MUSS, falls ihm noch kein gültiges E-Rezept-VAU-Zertifikat vorliegt, ein solches nach den fachlichen Vorgaben von A_20160-*<span id="polarion-comment:497"></span> beziehen (<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/VAUCertificate</span><span style="font-family: Arial, Helvetica;">).<br> Ein E-Rezept-Client MUSS sicherstellen, dass gültige Sperrinformation (OCSP-Response mit Sperrstatus "good") für das Zertifikat vorliegen, die maximal 12 Stunden alt sind. Liegen diese nicht vor so MUSS der Client ein Verbindungsaufbau auf VAU-Protokoll-Ebene ablehnen/unterbinden.<br> <br> Ein E-Rezept-Client MUSS bei der Request-Erstellung folgende Schritte durchführen.</span><br> 
    <ol> 
     <li>Er erzeugt einen HTTP-Request, den er an die VAU senden möchte, als Datenstruktur (vgl. Beispiele nach dieser Anforderung).</li> 
     <li>Er erzeugt zufällig eine 128-Bit lange hexadezimalkodierte Request-ID (also 32 Zeichen, Buchstaben a-f kleingeschrieben).</li> 
     <li>Er erzeugt zufällig einen 128-Bit AES-Schlüssel (im Weiteren auch Antwortschlüssel genannt), den er hexadezimal kodiert (also 32 Zeichen, Buchstaben a-f kleingeschrieben).</li> 
     <li>Er MUSS die Request-ID und den AES-Schlüssel für jeden HTTP-Request an die VAU zufällig neu erzeugen.</li> 
     <li>Er erzeugt die folgende Zeichenkette p mit<br> p="1" + " " + JWT-Authentisierungstoken + " " + Request-ID + " " + AES-Schlüssel + " " + Datenstruktur aus Schritt 1.</li> 
     <li>Die Zeichenkette p MUSS mittels des ECIES-Verfahrens [SEC1-2009] und mit folgenden Vorgaben verschlüsselt werden:</li> 
     <ol> 
      <li>Er MUSS ein ephemeres ECDH-Schlüsselpaar erzeugen und mit diesem und dem VAU-Schlüssel aus A_20160-* ein ECDH gemäß [NIST-800-56-A] durchgeführen. Das somit erzeugte gemeinsame Geheimnis ist Grundlage für die folgende Schlüsselableitung.</li> 
      <li>Als Schlüsselableitungsfunktion MUSS er die HKDF nach [RFC-5869] auf Basis von SHA-256 verwenden.</li> 
      <li>Dabei MUSS er den Ableitungsvektor "ecies-vau-transport" verwenden, d. h. in der Fomulierung von [RFC-5869] info="ecies-vau-transport" .</li> 
      <li>Er MUSS mit dieser Schlüsselableitung einen AES-128-Bit Content-Encryption-Key für die Verwendung von AES/GCM ableiten.</li> 
      <li>Er MUSS für Verschlüsselung mittels AES/GCM einen 96 Bit langen IV zufällig erzeugen.</li> 
      <li>Er MUSS mit dem CEK und dem IV mittels AES/GCM p verschlüsseln, wobei dabei ein 128 Bit langer Authentication-Tag zu verwenden ist.</li> 
      <li>Er MUSS das Ergebnis wie folgt kodieren: chr(0x01) || &lt;32 Byte X-Koordinate von öffentlichen Schlüssel aus (a) &gt; || &lt;32 Byte Y-Koordinate&gt; || &lt;12 Byte IV&gt; || &lt;AES-GCM-Chiffrat&gt; || &lt;16 Byte AuthenticationTag&gt; (vgl. auch Tab_KRYPT_ERP und folgende die Beispielverschlüsselung).<br> Die Koordinaten sind (wie üblich) vorne mit chr(0) zu padden solange bis sie eine Kodierungslänge von 32 Byte erreichen.</li> 
     </ol> 
     <li>Er erzeugt einen HTTPS-Request an den FD mit der POST-Methode und dem Pfad <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/VAU/&lt;Nutzerpseudonym&gt;[/optional-beliebiger-weiterer-URL-Pfadteil]</span> mit dem Content-Type '<span style="font-size: 10pt;line-height: 1.5;">application/octet-stream' und sendet diesen an die Webschnittstelle des FD.<br> "Nutzerpseudonym" MUSS eine ggf. aus der&nbsp;vorherigen (zeitlich letzten) Antwort des FD dem Nutzer übergebene URL-sichere&nbsp;Zeichenkette sein (bspw. ein 128 Byte langer Hexadezimal-Kode).<br> Falls dem Client kein Nutzerpseudonym vorliegt so MUSS er "0" als Nutzerpseudonym verwenden.</span></li> 
    </ol> <b>&lt;=</b></p>
  </div>
  <p id="polarion_294"></p>
  <p id="polarion_295" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">21</span>: Tab_KRYPT_ERP Kodierung des Chiffrats aus A_20161-* </p>
  <table id="polarion_wiki macro name=table;params=bold=1|width=100%|uid=296" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Offset</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Länge in Bytes</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Erläuterung</th> 
    </tr> 
    <tr> 
     <td style="font-weight: bold;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: normal;">0</span></td> 
     <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">1</td> 
     <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Versionsfeld</td> 
    </tr> 
    <tr> 
     <td style="height: 12px;border: 1px solid #CCCCCC;padding: 5px;">1</td> 
     <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">32</td> 
     <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">X-Koordinate öffentlicher ephemer Sender-ECDH-Schlüssel</td> 
    </tr> 
    <tr> 
     <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">33</td> 
     <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">32</td> 
     <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Y-Koordinate öffentlicher ephemer Sender-ECDH-Schlüssel&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">65</td> 
     <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">12</td> 
     <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">IV zufällig pro Nachricht zu erzeugen (A_20161-* Punkt e)</td> 
    </tr> 
    <tr> 
     <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">77</td> 
     <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gleich Länge des Plaintextes (= LP)</td> 
     <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">"eigentliche" AES-GCM-Chiffrat</td> 
    </tr> 
    <tr> 
     <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">77 + LP</td> 
     <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">16</td> 
     <td style="height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">128 Bit langer Authentication-Tag</td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_298"></p>
  <p id="polarion_307">Hinweise zu A_20161-*:</p>
  <ol id="polarion_310"> 
   <li>Beispiel für eine hexadezimalkodierte Request-ID nach A_20161-* (2): "<span style="font-size: 10pt;line-height: 1.5;"><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">32b6594cc29bb54a14cb2a8e09558817</span>"</span></li> 
   <li><span style="font-size: 10pt;line-height: 1.5;">Beispiel für einen 128-Bit-AES-Schlüssel nach A_20161-* (3): "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">a576daad8096fc52987250a8e7eb9bd3</span>"</span></li> 
   <li><span style="font-size: 10pt;line-height: 1.5;">Aus kryptographischer Sicht könnte ein Client den Antwort-AES-Schlüssel (A_20161-* Punkt (3)) auch für weitere Requests verwenden. Dies würde jedoch erzwingen, dass es im Client eine komplexere Überwachung des Lebenslaufs des Schlüssels gibt (Wann wurde er erzeugt,&nbsp; d. h. wann muss er gewechselt werden etc.). Um dies zu verhindern und die Implementierung im Client einfacher zu halten, gibt es A_20161-* Punkt (4).</span></li> 
  </ol>
  <p id="polarion_312"> <span style="font-size: 10pt;line-height: 1.5;">Beispielverschlüsselung (Testvektor):</span> </p>
  <p id="polarion_313"> <span style="font-size: 10pt;line-height: 1.5;">Der Langzeit-VAU-Schlüssel nach A_20160-* sei folgender:<br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">x=0x8634212830dad457ca05305e6687134166b9c21a65ffebf555f4e75dfb048888&nbsp;<br> y=0x66e4b6843624cbda43c97ea89968bc41fd53576f82c03efa7d601b9facac2b29</span><br> </span> </p>
  <p id="polarion_314">Die zu Verschlüsselnde Nachricht sei "Hallo Test" (10 Zeichen).</p>
  <p id="polarion_86"> Der Client erzeugt zufällig den privaten ECC-Schlüssel <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">d=<span style="font-size: 10pt;line-height: 1.5;">5bbba34d47502bd588ed680dfa2309ca375eb7a35ddbbd67cc7f8b6b687a1c1d</span></span> </p>
  <p id="polarion_315"> Damit ist dessen öffentlicher ephemerer ECDH-Schlüssel:<br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">x=0x754e548941e5cd073fed6d734578a484be9f0bbfa1b6fa3168ed7ffb22878f0f&nbsp;<br> y=0x9aef9bbd932a020d8828367bd080a3e72b36c41ee40c87253f9b1b0beb8371bf&nbsp;</span><br> </p>
  <p id="polarion_316"> Nach ECDH ergibt sich damit folgendes gemeinsames Geheimnis:<br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">9656c2b4b3da81d0385f6a1ee60e93b91828fd90231c923d53ce7bbbcd58ceaa</span> </p>
  <p id="polarion_318"> <span style="font-size: 10pt;line-height: 1.5;">Nach Schlüsselableitung (info="ecies-vau-transport") erhält der Client folgende CEK:<br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">23977ba552a21363916af9b5147c83d4</span></span> </p>
  <p id="polarion_319"> <span style="font-size: 10pt;line-height: 1.5;"><span style="font-family: Arial, Helvetica;">Der Client erzeugt zufällig einen 12 Byte großen IV:</span><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;"><br> 257db4604af8ae0dfced37ce</span></span> </p>
  <p id="polarion_320">Die AES/GCM-Chiffre berechet aus der Nachricht, dem CEK und dem IV folgendes Chiffrat:</p>
  <p id="polarion_321"> <span style="font-size: 10pt;line-height: 1.5;"><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">86c2b491c7a8309e750b</span> und folgenden 16 Byte großen Authentication Tag&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">4e6e307219863938c204dfe85502ee0a</span></span> </p>
  <p id="polarion_327"></p>
  <p id="polarion_329"> <span style="font-size: 10pt;font-family: Arial, Helvetica;line-height: 1.5;">Das Gesamt-Chiffrat vollständig kodiert ist damit (ohne Leerzeichen, als Hexdump)</span> </p>
  <p id="polarion_296"> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">01 754e548941e5cd073fed6d734578a484be9f0bbfa1b6fa3168ed7ffb22878f0f 9aef9bbd932a020d8828367bd080a3e72b36c41ee40c87253f9b1b0beb8371bf 257db4604af8ae0dfced37ce 86c2b491c7a8309e750b 4e6e307219863938c204dfe85502ee0a</span> </p>
  <p id="polarion_330"></p>
  <p id="polarion_311">In der Webschnittstelle muss ein CMAC-Schlüssel für die Bildung der Nutzerpseudonyme vorliegen (A_20162-*). Dieser Schlüssel wird regelmäßig gewechselt (A_20162-*) und er kann in der Webschnittstelle als normales Datenobjekt (also nicht innerhalb des HSMs) vorliegen (Schutzbedarf bezüglich Vertraulichkeit: mittel).</p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-109254">
   <p><b>A_20162</b></p>
   <p>Der Fachdienst E-Rezept MUSS an seinen Webschnittstellen folgendes sicherstellen:<br> 
    <ol> 
     <li>Er MUSS unter dem Pfad <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">/VAU/&lt;Nutzerpseudonym&gt;[/optional-beliebiger-weiterer-URL-Pfadteil]</span> (der URL) mit dem Content-Type '<span style="font-size: 10pt;line-height: 1.5;">application/octet-stream'&nbsp;</span>HTTPS-Requests entgegennehmen (nach dem Nutzerpseudonym kann u. Um. ein "/" und anschließend weitere Pfadangaben vom Client angegeben werden, vgl. Beispiele unten).</li> 
     <li>Er MUSS in der Webschnittstelle über einen AES-CMAC 128 Bit Schlüssel verfügen, der mindestens alle 10 Tage zufällig neu erzeugt wird. Dieser Schlüssel MUSS als reiner Software-Schlüssel (nicht in einem HSM) in der Webschnittstelle vorliegen.</li> 
     <li>Er MUSS das Nutzerpseudonym (NP) auf Integrität (CMAC) prüfen (vgl. Schritt 8). Ist die Integrität nicht gegeben, so MUSS er anstatt des übergebenen NP "0" als Wert verwenden.</li> 
     <li>Er MUSS anhand des NP eine Lastverteilung innerhalb des FD und eine NP-zentrierte&nbsp;Lastbeschränkung durchführen.<br> Im Lastszenario MÜSSEN Requests mit NP "0" mindestens 10 mal geringer priorisiert werden, als Requests mit gültigem NP.</li> 
     <li>Er muss den Request zur Abarbeitung an einen geeigneten Verarbeitungskontext der VAU übergeben.</li> 
     <li>Die VAU-Instanz muss eine verschlüsselte Antwort (vgl.&nbsp; A_20163) erzeugen und an die Schnittstelle senden.</li> 
     <li>In der Antwort der VAU-Instanz MUSS die VAU das Prenutzerpseudonym (PNP, vgl.&nbsp; A_20163) als Teil der Antwort der VAU auf den Nutzer-Request an die Webschnittstelle übergeben.</li> 
     <li>Er MUSS mittels des CMAC-Schlüssels (vgl.&nbsp; Schritt 2) den 128-Bit-lange CMAC-Wert des PNP erzeugen und diesen hexadezimal kodieren (= CMAC). Die Zeichenkette "&lt;PNP&gt;" + "-" + "&lt;CMAC&gt;" sei das NP.</li> 
     <li>Als Antwort MUSS&nbsp; die Schnittstelle eine HTTP-Response senden mit dem Content-Type '<span style="font-size: 10pt;line-height: 1.5;">application/octet-stream', der Antwort der VAU-Instanz als Bytestrom (Octet-Stream) und im HTTP-Response-Header MUSS 'Userpseudonym: &lt;NP&gt;" enthalten sein.</span></li> 
    </ol> <b>&lt;=</b></p>
  </div>
  <p id="polarion_283">Beispiele für mögliche Pfade die nach A_20162 von einem Client erzeugt werden könnten:</p>
  <p id="polarion_288"> /VAU/0<br> /VAU/0/Task/create<br> /VAU/<span style="font-size: 10pt;line-height: 1.5;">270810c79748768a9b0aefbf52c8d72be7ad5e0d2d328d9bb70dbf58623fc7ae</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-109255">
   <p><b>A_20163</b></p>
   <p>Die E-Rezept-VAU MUSS das Folgende sicherstellen und im Falle eines Fehlschlagens die Abarbeitung des Requests mit einer entsprechenden Fehlermeldung an die sie aufrufende Webschnittstelle abbrechen.<br> 
    <ol> 
     <li>Die E-Rezept-VAU MUSS einen&nbsp;verschlüsselten Nutzer-Request von der Webschnittstelle entgegennehmen.</li> 
     <li>Die E-Rezept-VAU MUSS einen verschlüsselten Nutzer-Request nach den kryptographischen Vorgaben aus A_20161-*<span id="polarion-comment:507"></span> und mit dem privaten Schlüssel aus A_20160-*<span id="polarion-comment:498"></span> versuchen zu entschlüsseln. </li> 
     <li>Die E-Rezept-VAU MUSS den erhaltenden Klartext p auf den Strukturaufbau aus A_20160-*<span id="polarion-comment:499"></span> prüfen.</li> 
     <li>Die E-Rezept-VAU MUSS das JWT-Authentisierungstoken auf Gültigkeit prüfen.</li> 
     <li>Die E-Rezept-VAU MUSS den in p kodieren HTTP-Request abarbeiten.</li> 
     <li>Die E-Rezept-VAU MUSS einen 128-Bit-AES-CMAC-Schlüssel zufällig erzeugen und mindestens alle 10 Tage wechseln.</li> 
     <li>Die E-Rezept-VAU MUSS aus dem "sub"-Feld-Wert mittels des CMAC-Schlüssels den 128 Bit langen CMAC-Wert berechnen und hexadezimal kodieren (32 Byte lang). Dies sei das Prenutzerpseudonym (PNP).</li> 
     <li>Die Antwort "a" auf den HTTP-Request aus p MUSS wie folgt kodiert werden:<br> a="1"&nbsp; + " " + Request-ID-aus-p + " " + Response-Header-und-Body.</li> 
     <li>Die E-Rezept-VAU MUSS a mittels des 128-Bit langen AES-Schlüssels aus p und AES/GCM (96 Bit zufällig erzeugter IV, 128 Authentication Tag) verschlüsseln und erhält c'.</li> 
     <li>Die E-Rezept-VAU MUSS c' und das PNP an die Webschnittstelle als Antwort übergeben.</li> 
    </ol> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-109355">
   <p><b>A_20174</b></p>
   <p>Ein E-Rezept-Client MUSS bei der Response-Auswertung (vgl. vorgehenden Client-Request aus A_20161-*)<span id="polarion-comment:508"></span> folgende Schritte durchführen.&nbsp;Dabei MUSS der Client bei Fehlschlagens im Folgenden aufgeführten Prüfungen die Analyse der Response abbrechen, und er MUSS die Request-ID und den AES-Antwortschlüssel sicher löschen.<br> 
    <ol> 
     <li>Er MUSS prüfen, ob der Content-Type der Response '<span style="font-size: 10pt;line-height: 1.5;">application/octet-stream' ist.</span></li> 
     <li><span style="font-size: 10pt;line-height: 1.5;">Wenn im Response-Header die Variable "Userpseudonym" vorhanden ist, so MUSS er den Wert von "Userpseudonym" als NP für den nächsten Request an die VAU verwenden. (Der Client MUSS einen ggf. vorhandenen alten Wert des NP im Client überschrieben.)</span></li> 
     <li><span style="font-size: 10pt;line-height: 1.5;">Er MUSS das Antwort-Chiffrat mit den Vorgaben aus A_20163 (9) und dem AES-Antwort entschlüsseln und prüfen ob die Entschlüsselung erfolgreich möglich war.</span></li> 
     <li><span style="font-size: 10pt;line-height: 1.5;">Er MUSS prüfen, ob die Struktur des erhaltenen Klartextes p der Struktur aus A_20163 (8) entspricht.</span></li> 
     <li><span style="font-size: 10pt;line-height: 1.5;">Er MUSS&nbsp; prüfen, ob die Request-ID in p der Request-ID aus dem Client-Request entspricht (Gleichheit prüfen).</span></li> 
     <li><span style="font-size: 10pt;line-height: 1.5;">Er MUSS das dritte Feld-Element in p ("Response-Header-und-Body") als HTTP-Antwort der E-Rezept-VAU in fachlich weiter verarbeiten.</span></li> 
    </ol> <b>&lt;=</b></p>
  </div>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-109356">
   <p><b>A_20175</b></p>
   <p>Ein E-Rezept-Client MUSS das im Request verwendete Nutzerpseudonym (NP) in Software speichern (kein HSM/TPM/SE) und das NP ausschließlich für seinen Einsatzzweck der E-Rezept-VAU-Kommunikation verwenden. Insbesondere MUSS der Client die Vertraulichkeit des NP wahren (bspw. nicht unnötig in Protokolleinträgen und Fehlermeldungen aufführen). <b>&lt;=</b></p>
  </div>
  <p id="polarion_207">Der Fachdienst E-Rezept besitzt eine REST-Schnittstelle, d. h. Fehler werden mittels HTTP-Status/Fehler-Codes signalisiert. Die in der folgenden Tabelle (Tab_KRYPT_VAUERR) aufgeführten Fehler kann ein E-Rezept-Client in Bezug auf die in diesem Abschnitt definierte kryptographische Sicherung zwischen Client und VAU treffen.</p>
  <p id="polarion_299" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">22</span>: Tab_KRYPT_VAUERR Auftretende Fehler bei auf Anwendungsschicht kryptographisch gesicherten VAU-Kommunikation (E-Rezept) </p>
  <table id="polarion_wiki macro name=table;params=bold=1|width=100%|uid=300" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;padding: 5px;">Fehlerfall</th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;padding: 5px;">HTTP-Response-Code der E-Rezept</th> 
    </tr> 
    <tr> 
     <td style="font-weight: bold;text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: normal;">JWT-Client-Token ungültig</span></td> 
     <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;padding: 5px;">403 Forbidden</td> 
    </tr> 
    <tr> 
     <td style="font-weight: bold;text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: normal;">Entschlüsselung des Chiffrats des äußeren Requests schlug fehl</span></td> 
     <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;padding: 5px;">400 Bad Request</td> 
    </tr> 
    <tr> 
     <td style="font-weight: bold;text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: normal;">Strukturaufbau des Klartextes aus A_20160-* <span id="polarion-comment:500"></span>ist falsch</span></td> 
     <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;padding: 5px;">400 Bad Request</td> 
    </tr> 
   </tbody> 
  </table>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-114469">7.2.4 Zufallsquelle für Clients</h4>
  <p id="polarion_202"> Zur Auffrischung des Entropie-Pools des Clients kann der Client von verschiedenen Diensten der TI Zufall ausreichender Güte (vgl. <span style="font-size: 10pt;line-height: 1.5;">GS-A_4367) beziehen. Der FD-E-Rezept ist dafür&nbsp;eine Quelle von mehreren. Ein Client muss verschiedene unabhängige Quellen abfragen und die Zufallsdaten kryptographisch geeignet (bspw. über den Fortuna-PRNG-Algorithmus) zusammenführen.</span> </p>
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-114470">
   <p><b>A_21215</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der Fachdienst E-Rezept MUSS an seiner Webschnittstelle (HTTPS) unter der URL /Random (GET-Methode) 128 Byte Zufallsdaten hexadezimalkodiert (Lower-Case -- [0-9a-f]) einen Client zur Verfügung stellen. Bei jedem Request MÜSSEN die Zufallsdaten neu erzeugt werden. Die Response MUSS den Content-Type application/json besitzen.<br> Teil einer Beispiel-Response:<br> <br> </span><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Content-length: 258&nbsp;<br> Content-type: application/json&nbsp;<br> Date: Tue,01 Dec 2020 12:46:18 GMT&nbsp;<br> Server: nginx/1.14.0 (Ubuntu)<br> <br> "a5dc9d13ee2e76ddd9b75e9c28421fc4b5a9a131751a3dad1203f8d1b149366ef938163d43718f31fe5464e05f236ba62588cea48ff8cdb9f77abe52a03a389f8a2573127c7062974238714e457399cfc9fcd7eeb656c2cfd3bf50fb1d74b4cd5c73607283533f423760c2e38a3fd646602ef244d4dbdb332c8f696b5e07ef51"</span><br> <b>&lt;=</b></p>
  </div>
  <p id="polarion_208">Um die Anforderung umzusetzen ist es im Normalfall ausreichend /dev/urandom als Zufallsquelle auf einen Linux-Server zu verwenden.</p>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-126985">8 Post-Quanten-Kryptographie (informativ)</h2>
  <p id="polarion_412">Wie in [BSI-PQC-2020] dargestellt, erscheint es mit Blick auf dem aktuellen Stand von Wissenschaft und Technik als sehr unwahrscheinlich, dass aktuell Quanten-Computer in ausreichender Leistungsstärke verfügbar sind, die der asymmetrischen Kryptographie -- so wie sie aktuell in der TI eingesetzt wird -- gefährlich werden könnten.</p>
  <p id="polarion_413" class="MsoNormal">Dies bedeutet, dass insbesondere Authentisierungsvorgänge, die im "Jetzt" mit klassischen asymmetrischen kryptographischen Verfahren mit ausreichend großen Schlüssellängen durchgeführt werden (vgl. [SOG-IS-2020] und [BSI-TR-03116-1]), nicht in Frage stehen.</p>
  <p id="polarion_414" class="MsoNormal">Schwieriger wird es mit der Verschlüsselung mit klassischen asymmetrischen Verfahren bei denen Chiffrate erzeugt werden, die ein Angreifer sammeln kann, und durch deren Entschlüsselung zu einer Zeit in der Zukunft, bei der solche Quanten-Computer verfügbar sind, dann Schaden entstehen kann.</p>
  <p id="polarion_415" class="MsoNormal">Dort erscheint es ratsam auf hybride Lösungen zu migriren. D. h., etablierte kryptographische asymmetrische Verfahren und post-quantum-sichere asymmetrische kryptographische Verfahren werden in einer Weise kombiniert, dass wenn genau nur eines der beiden Verfahren gebrochen wird, die Sicherheit (Vertraulichkeit und Integrität) der verschlüsselten Daten nicht gefährdet ist.</p>
  <p id="polarion_416" class="MsoNormal"> Aktuell gibt es diesbezüglich verschiedene Forschungsaktivitäten und Vorschläge für eine entsprechende hybride Protokoll-Erweiterungen von kryptographischen Protokollen wie TLS, IKE oder SSH [TLS-CC-2021], [ENISA-PQC-2021#6.1]. Die gematik beobachtet intensiv die laufenden Forschungs- und Evaluierungsaktivitäten [NIST-PQC] die voraussichtlich 2023/24 <span id="polarion-comment:532"></span>einen geeigneten Stand erreichen werden. Bei TI-spezifischen Protokollen (VAU-Protokoll, SGD-Protokoll) evaluiert die gematik aktuell PQC-Protokollerweiterungen die kryptographisch denen bei TLS [TLS-CC-2021] entsprechen (vgl. Abschnitt "<span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-126984" data-option-id="longoutline"></span>"). </p>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-94999">9 Erläuterungen (informativ)</h2>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-94998">9.1 Prüfung auf angreifbare (schwache) Schlüssel</h3>
  <p id="polarion_162"> Im Folgerelease wird es in diesem Abschnitt Hinweise für die Anforderungen aus Abschnitt <span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-94319" data-option-id="shortoutline"></span>&nbsp;geben. </p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-95000">9.2 RSA-Schlüssel in X.509-Zertifikaten</h3>
  <p id="polarion_90"> In anderen, nicht-TI Public-Key-Infrastrukturen werden öffentliche Schlüssel bei einer&nbsp;Zertifikatsantragsstellung immer mittels ihrem korrespondieren privaten Schlüssel signiert (vgl. Certificate Signing Request [RFC-2986], proof of posession). Dort kann der TSP sich nach einer erfolgreichen Signaturprüfung sicher sein, dass er aus Kodierungssicht den "richtigen" Schlüssel in den Händen hält, weil ansonsten die Signaturprüfung mit praktischer Sicherheit fehlschlägt. Missverständnisse aufgrund von "falscher" Byte-Order oder verschiedener Kodierung sind somit praktisch (Falsch-Positiv-Rate &lt; 2<sup>-100</sup>) ausgeschlossen. In der PKI der TI werden mehr als 95 % aller Zertifikatserstellungen ohne eine Signatur mittels der jeweiligen privaten Schlüssel durchgeführt. Ein TSP der TI kann damit bei RSA-Schlüsseln – aus den Schlüsselwerten an sich – im Regelfall nicht sicher erkennen, ob eine Fehlkodierung (Missverständnis zwischen Zertifikatsantragssteller und TSP) aufgetreten ist. Es gibt effiziente Möglichkeiten solche Fehlkodierungen zu erkennen. Den Einsatz solcher Möglichkeiten möchte die gematik befördern und gibt mit&nbsp; <span class="polarion-rte-link" data-type="crossReference" id="fake" data-custom-label="A_17092" data-item-id="ML-92601" data-option-id="custom"></span>&nbsp;und <span class="polarion-rte-link" data-type="crossReference" id="fake" data-custom-label="A_17093" data-item-id="ML-92602" data-option-id="custom"></span> zwei Verfahren als KANN-Anforderungen an.&nbsp; </p>
  <p id="polarion_249">Die Untersuchungen aus [MK-2016] und [ROCA-2017] zeigen, dass es hilfreich ist sich mit den konkreten Werten der RSA-Schlüssel zu beschäftigen. Die folgenden Verfahren nutzen Struktureigenschaften von RSA-Schlüsseln, die nicht-RSA-Schlüssel im Normalfall nicht vorweisen.&nbsp;</p>
  <p id="polarion_251"> <span style="text-decoration: underline;">keine kleinen Primteiler:</span> </p>
  <p id="polarion_262">Der Modulus eines RSA-Schlüssels muss aus genau zwei (oder wenigen [RFC-8017]) "großen" Primfaktoren bestehen. Falls der vom TSP angetroffene Wert durch eine vom TSP vorgegebene Primzahl teilbar ist, so ist der RSA-Schlüssel ungeeignet. Falls dieser Primteiler deutlich kleiner als 2^1023 ist, so kann es sich nicht um einen korrekten RSA-Schlüssel handeln.</p>
  <p id="polarion_265">Wird ein Modulus unabsichtlich von einem Sender falsch kodiert, so ist der dadurch entstehende Wert statistisch über alle möglichen Fehlkodierungen betrachtet im Normalfall mit der Wahrscheinlichkeit von 1/2 durch zwei teilbar, mit der Wahrscheinlichkeit von 1/3 durch 3 teilbar, mit einer Wahrscheinlichkeit von 1/5 durch 5 teilbar usw. Falls man nun den Modulus durch die ersten Primzahlen kleiner als 100 (25 Primzahlen) versucht zu teilen (was effizient möglich ist) und eine Teilbarkeit ausschließen kann, so kann man eine unabsichtliche Fehlkodierung mit einer hohen Wahrscheinlichkeit erkennen.</p>
  <p id="polarion_267">In der gematik wurden mehr als eine Billion (10^12) RSA-Schlüssel zufällig erzeugt und verschiedene Fehlkodierungen dieser Schlüssel auf Primteiler kleiner 100 untersucht. Es wurden dabei folgende Erkennungsraten festgestellt.</p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=202" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 243.344px;height: 37.3438px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">Art der Fehlkodierung</span><br> </th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 335.344px;height: 37.3438px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">Erkennungsrate in Prozent&nbsp;</span><br> <span style="font-size: 10pt;line-height: 1.5;">(auf zwei Nachkommastellen gerundet)</span><br> </th> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 243.344px;height: 18.3438px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">Byte-Order falsch (vertauscht)</span><br> </td> 
     <td style="text-align: left;vertical-align: top;width: 335.344px;height: 18.3438px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">76,03 %</span><br> </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 243.344px;height: 18.3438px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">Off-by-One (left shift)</span><br> </td> 
     <td style="text-align: left;vertical-align: top;width: 335.344px;height: 18.3438px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">100 %</span><br> </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 243.344px;height: 18.3438px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">Off-by-One (right shift)</span><br> </td> 
     <td style="text-align: left;vertical-align: top;width: 335.344px;height: 18.3438px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">88,07 %</span><br> </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 243.344px;height: 18.3438px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">Base64-kodiert anstatt Binär</span><br> </td> 
     <td style="text-align: left;vertical-align: top;width: 335.344px;height: 18.3438px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">87,60 %</span><br> </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 243.344px;height: 18.3438px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">Base58-kodiert anstatt Binär</span><br> </td> 
     <td style="text-align: left;vertical-align: top;width: 335.344px;height: 18.3438px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">88,01 %</span><br> </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 243.344px;height: 18.3438px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">Hex-kodiert anstatt Binär</span><br> </td> 
     <td style="text-align: left;vertical-align: top;width: 335.344px;height: 18.3438px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">87,91 %</span><br> </td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_269">Man muss davon ausgehen, dass die entsprechende Fehlkodierung nicht nur bei einem einzigen RSA-Schlüssel, sondern bei allen RSA-Schlüsseln eines Personalisierungsauftrags auftritt. Somit nähert sich die Erkennungsrate exponentiell 100&nbsp;% an. Beispiel: bei einer Erkennungsrate von 75 % für eine bestimmte Art der Fehlkodierung (vgl. Tabelle) erhält man bei 1000 RSA-Schlüsseln in Gesamtheit eine Erkennungsrate von mehr als 1-1,15*10^-125, also nahe 1.</p>
  <p id="polarion_271"> <span style="text-decoration: underline;">öffentlicher Exponent ist prim:</span> </p>
  <p id="polarion_272">Sei e der öffentliche Exponent und n der Modulus eines RSA-Schlüssels. Bei der Wahl von e ist es notwendig, dass dieser relativ prim zu phi(n) ist. Um die Schlüsselerzeugung zu vereinfachen (und zu beschleunigen), wählen jedoch faktisch alle kryptographischen Softwarebibliotheken, Chipkarten und HSMs e prim. Wenn also dem TSP ein e vorliegt, das nicht prim ist, so kann er davon ausgehen, dass ein Fehler vorliegt.</p>
  <p id="polarion_132"> Diese Überlegungen führen zu den Tests in&nbsp;<span class="polarion-rte-link" data-type="crossReference" id="fake" data-custom-label="A_17092" data-item-id="ML-92601" data-option-id="custom"></span>&nbsp;. Diese Tests haben eine Falsch-Positiv-Rate von 0 und benötigen weniger als 7 Mikrosekunden pro RSA-Schlüssel. </p>
  <p id="polarion_156"> <span style="text-decoration: underline;">Entropie&nbsp;der Schlüsselkodierung:</span> </p>
  <p id="polarion_168">Der Modulus eines RSA-Schlüssels muss aus genau zwei (oder wenigen [RFC-8017]) "großen" zufällig gewählten Primfaktoren bestehen. Diese zufällige Wahl hat zur Folge, dass die Entropie der kodierten Schlüsselwerte eine hohe Entropie im Sinne von notwendigen Bits pro Byte besitzt. Eine Fehlkodierung wird evtl. weniger Entropie (Bits pro Byte) besitzen, weil sie, wie die base64-Kodierung, bestimmte Bits immer auf 0 setzt. In [NIST-SP-800-22] werden verschiedene Tests spezifiziert, um die "Zufälligkeit" einer Zeichenfolge zu bestimmen. Diese Tests zielen auf größere Datengrößen (Längen der Zeichenfolge) ab und sind nur teilweise dafür geeignet die Kodierung von 256 Byte langen RSA-Moduli zu bewerten. Anstatt diese Tests als Basis zu verwenden, wird im Folgenden die klassische Berechnung der Shannon-Entropie vieler RSA-Moduli in unterschiedlichen Kodierungsformen betrachtet. Von einer Zeichenkette X wird mittels&nbsp;</p>
  <p id="polarion_170"> <img src="attachments/17-screenshot-20190224-173507.png" style="width: 180px;height: 74px;"> </p>
  <p id="polarion_171"> die Entropie im Sinne von notwendigen Bits pro Byte des kodierten Schlüsselwertes berechnet. Dabei ist X die Kodierung (Bytefolge) des Schlüssels und p<sub>i</sub> die relative Häufigkeit von Byte i (wobei nach Konvention in dem Kontext gilt: log(0)=0). </p>
  <p id="polarion_178"> Unter <a href="https://rosettacode.org/wiki/Entropy" target="_blank" class="descriptionLink">https://rosettacode.org/wiki/Entropy</a>&nbsp;findet man Implementierung dieser Entropie-Berechnungsfunktion in 78 Programmiersprachen.&nbsp; </p>
  <p id="polarion_235">Die gematik verwendet folgende C-Implementierung:</p>
  <p id="polarion_268"> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">double entropy(char *S, int len) {</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp; &nbsp; &nbsp; &nbsp; int table[256]={0};</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp; &nbsp; &nbsp; &nbsp; int i;</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp; &nbsp; &nbsp; &nbsp; double H=0;</span><br> <br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp; &nbsp; &nbsp; &nbsp; for(i=0; i&lt;len; i++) {</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; table[(unsigned char)S[i]]++;</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp; &nbsp; &nbsp; &nbsp; }</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp; &nbsp; &nbsp; &nbsp; for(i=0; i&lt;256; i++) {</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (table[i]&gt;0) {</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; H-= (double) table[i]/len*log2( (double) table[i]/len);</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp; &nbsp; &nbsp; &nbsp; }</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">&nbsp; &nbsp; &nbsp; &nbsp; return H;</span><br> <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">}</span> </p>
  <p id="polarion_276">In der gematik wurden mehr als eine Billion (10^12) RSA-Schlüssel zufällig erzeugt und verschiedene Fehlkodierungen auf ihre Entropie (notwendigen Bits pro Byte in der Kodierung) untersucht.</p>
  <p id="polarion_279">Ein Histogramm eines Beispiel-Testlaufs mit mehr als eine Billion (10^12) RSA-Schlüsseln:</p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=203" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 289.344px;height: 19.3438px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">8&nbsp; &nbsp; &gt;=H(X)&gt;7,455</span><br> </th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 289.344px;height: 19.3438px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">3396</span><br> </th> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 289.344px;height: 19.3438px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">7,455&gt;=H(X)&gt;7,2135</span><br> </td> 
     <td style="text-align: left;vertical-align: top;width: 289.344px;height: 19.3438px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">234195871140</span><br> </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 289.344px;height: 19.3438px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">7,2135&gt;=H(X)&gt;6,9715</span><br> </td> 
     <td style="text-align: left;vertical-align: top;width: 289.344px;height: 19.3438px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">765693789112</span><br> </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 289.344px;height: 19.3438px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">6,9715&gt;=H(X)&gt;6,7295</span><br> </td> 
     <td style="text-align: left;vertical-align: top;width: 289.344px;height: 19.3438px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">112336352</span><br> </td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_281">Es wurde kein Schlüssel gefunden, dessen korrekte Kodierung eine Entropie kleiner als 6,7295 besitzt.</p>
  <p id="polarion_282">Ein Histogramm eines Beispiel-Testlaufs mit mehr 10 Milliarden (1*10^10) Schlüsseln (diese wurden jeweils in unterschiedlichen Kodierungsvarianten kodiert und danach wurde die entropy()-Funktion auf die Kodierung angewendet):</p>
  <table id="polarion_wiki macro name=table;params=header=no|width=100%|uid=204" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 173.344px;height: 197.344px;border: 1px solid #CCCCCC;padding: 5px;">korrekt&nbsp;kodiert (s. o.)<br> <br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">7.40 49808</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">7.30 97418682</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">7.20 3351624284</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">7.10 6095663118</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">7.00 1210930726</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">6.90 43696816</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">6.80 256390</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">6.70 176</span><br> </td> 
     <td style="text-align: left;vertical-align: top;width: 146.344px;height: 197.344px;border: 1px solid #CCCCCC;padding: 5px;">Base64-kodiert<br> <br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">5.90 9981660</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">5.80 6902282798</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">5.70 3861576302</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">5.60 25792616</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">5.50 6624</span><br> </td> 
     <td style="text-align: left;vertical-align: top;width: 146.344px;height: 197.344px;border: 1px solid #CCCCCC;padding: 5px;">Base58-kodiert<br> <br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">5.80 11220</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">5.70 4102181822</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">5.60 6615817484</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">5.50 81606244</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">5.40 23230</span><br> </td> 
     <td style="text-align: left;vertical-align: top;width: 240.344px;height: 197.344px;border: 1px solid #CCCCCC;padding: 5px;">als Hexadezimal-Zahl kodiert<br> <br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">3.90 10758804076</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">3.80 40835572</span><br> <span style="font-size: 9pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">3.70 352</span><br> </td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_275"> Diese Überlegungen bezüglich der Entropie der RSA-Schlüsselkodierung führen zu dem Test in&nbsp;<span class="polarion-rte-link" data-type="crossReference" id="fake" data-custom-label="A_17093" data-item-id="ML-92602" data-option-id="custom"></span>. Dieser Test hat eine Falsch-Positiv-Rate von weniger als 2^-40 und benötigen weniger als 7 Mikrosekunden pro RSA-Schlüssel.&nbsp; </p>
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-7977">10 Anhang – Verzeichnisse</h2>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7978">10.1 Abkürzungen</h3>
  <table id="polarion_wiki macro name=table;params=width=100%|padding=2px|uid=1" style="width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 72pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;"><span style="font-weight: bold;">Kürzel</span><br> </span></th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 372pt;height: 15pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;"><span style="font-weight: bold;">Erläuterung</span><br> </span></th> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">C2C<br> </span></td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">Card to Card<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">C2S<br> </span></td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">Card to Server<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">CEK<br> </span></td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">Content Encryption Key<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">CA<br> </span></td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">Certificate Authority<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">CBC<br> </span></td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">Cipher Block Chaining<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">DNS<br> </span></td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">Domain Name System<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">DNSSEC<br> </span></td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">Domain Name System Security Extensions<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">DRNG<br> </span></td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">Deterministic Random Number Generator<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">eGK<br> </span></td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">elektronische Gesundheitskarte<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">HKDF<br> </span></td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">HMAC-based Extract-and-Expand Key Derivation Function<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">HMAC<br> </span></td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">Hash-based Message Authentication Code<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">IV<br> </span></td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">Initialization Vector (Initialisierungsvektor) bspw. bei AES-GCM<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">ICV<br> </span></td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">Integrity Check Value, Authentisierungswert (MAC) bei AES-GCM<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">KDF<br> </span></td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">Key Derivation Function (Schlüsselableitungsfunktion)<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">MAC<br> </span></td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">Message Authentication Code<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">OCSP<br> </span></td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">Online Certificate Status Protocol<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">OID<br> </span></td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">Object Identifier<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">OSI<br> </span></td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">Open Systems Interconnection<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">SAK<br> </span></td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">Signaturanwendungskomponente<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">SGD<br> </span></td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">Schlüsselgenerierungsdienst<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;">SE</td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;">Secure Element</td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">SM<br> </span></td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">Service Monitoring<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;">TCB</td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;">Trusted Computing Base</td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">TI<br> </span></td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">Telematikinfrastruktur<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">TLS<br> </span></td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">Transport Layer Security<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;">TPM</td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;">Trusted Plattform Module</td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">TSIG<br> </span></td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">Transaction Signature<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">URI<br> </span></td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">Uniform Resource Identifier<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">VAU<br> </span></td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;"><span style="font-size: 10pt;line-height: 1.5;">vertrauenswürdige Ausführungsumgebung, vgl. [gemSpec_Dokumentenverwaltung]<br> </span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 72pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;">WANDA Basic</td> 
     <td style="vertical-align: top;width: 372pt;height: 16pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 2pt;">Weitere Anwendungen für den Datenaustausch ohne Nutzung der TI oder derer kryptografischen Identitäten&nbsp;&nbsp;</td> 
    </tr> 
   </tbody> 
  </table>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7979">10.2 Glossar</h3>
  <p id="polarion_439">Das Glossar wird als eigenständiges Dokument, vgl. [gemGlossar] zur Verfügung gestellt.</p>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-7980">10.3 Abbildungsverzeichnis</h3>
  <div data-sequence="Abbildung" id="polarion_wiki macro name=tof;params=uid=1"></div>
  <div id="toc_container">
   <p class="toc_title"><h1></h1></p>
   <li><a href="#polarion_81">Abbildung 1: Verwendung von Algorithmen nach Zonen und OSI-Schicht</a></li>
   <li><a href="#polarion_163">Abbildung 2: ASN.1-Kodierung des Chiffrats was den Transportschlüssel enthält</a></li>
   <li><a href="#polarion_190">Abbildung 3: Übersicht über das VAU-Protokoll</a></li>
   <li><a href="#polarion_261">Abbildung 4: Sicherungsschichten beim Datentransport zwischen E-Rezept-Client und E-Rezept-VAU</a></li>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-34052">10.4 Tabellenverzeichnis</h3>
  <div data-sequence="Tabelle" id="polarion_wiki macro name=tof;params=uid=2"></div>
  <div id="toc_container">
   <p class="toc_title"><h1></h1></p>
   <li><a href="#polarion_49">Tabelle 1: Tab_KRYPT_001 Übersicht über Arten von X.509-Identitäten</a></li>
   <li><a href="#polarion_54">Tabelle 2: Tab_KRYPT_002 Algorithmen für X.509-Identitäten zur Erstellung nicht-qualifizierter Signaturen für die Schlüsselgeneration „RSA“</a></li>
   <li><a href="#polarion_57">Tabelle 3: Tab_KRYPT_002a Algorithmen für X.509-Identitäten zur Erstellung nicht-qualifizierter Signaturen für die Schlüsselgeneration „ECDSA“</a></li>
   <li><a href="#polarion_65">Tabelle 4: Tab_KRYPT_003 Algorithmen für X.509-Identitäten zur Erstellung qualifizierter elektronischer Signaturen für die Schlüsselgeneration „RSA“</a></li>
   <li><a href="#polarion_68">Tabelle 5: Tab_KRYPT_003a Algorithmen für X.509-Identitäten zur Erstellung qualifizierter Signaturen für die Schlüsselgeneration „ECDSA“</a></li>
   <li><a href="#polarion_76">Tabelle 6: Tab_KRYPT_006 Algorithmen für CV-Zertifikate</a></li>
   <li><a href="#polarion_77">Tabelle 7: Tab_KRYPT_007 Algorithmen für CV-CA-Zertifikate</a></li>
   <li><a href="#polarion_83">Tabelle 8: Tab_KRYPT_008 Beispiele für solche Algorithmen-URIs</a></li>
   <li><a href="#polarion_89">Tabelle 9: Tab_KRYPT_009 Algorithmen für die Erzeugung von nicht-qualifizierten elektronischen XML-Signaturen</a></li>
   <li><a href="#polarion_94">Tabelle 10: Tab_KRYPT_010 Algorithmen für qualifizierte XML-Signaturen</a></li>
   <li><a href="#polarion_119">Tabelle 11: Tab_KRYPT_012 Algorithmen für Card-to-Server-Authentifizierung</a></li>
   <li><a href="#polarion_197">Tabelle 12: Tab_KRYPT_017 Algorithmen für DNSSEC</a></li>
   <li><a href="#polarion_135">Tabelle 13: Tab_KRYPT_018 Ablauf zur Berechnung eines versichertenindividuellen Schlüssels</a></li>
   <li><a href="#polarion_137">Tabelle 14: Tab_KRYPT_019 eingesetzte Algorithmen für die Ableitung eines versichertenindividuellen Schlüssels</a></li>
   <li><a href="#polarion_139">Tabelle 15: Tab_KRYPT_020 Algorithmen für die Erzeugung und Prüfung von binären Daten im Kontext von Dokumentensignaturen</a></li>
   <li><a href="#polarion_154">Tabelle 16: Tab_KRYPT_021 Algorithmen für die Erzeugung und Prüfung von PDF/A-Dokumentensignaturen</a></li>
   <li><a href="#polarion_212">Tabelle 17: Tab_KRYPT_ERP_Zertifikatsliste Definition Datenstruktur Zertifikatsliste</a></li>
   <li><a href="#polarion_229">Tabelle 18: Tab_KRYPT_ERP_Algorithmus_FD_Zertifikatsliste_erstellen</a></li>
   <li><a href="#polarion_215">Tabelle 19: Tab_KRYPT_ERP_FdV_Truststore_aktualisieren</a></li>
   <li><a href="#polarion_431">Tabelle 20: Tab_KRYPT_ERP_OCSP_Liste Definition Datenstruktur OCSPList</a></li>
   <li><a href="#polarion_295">Tabelle 21: Tab_KRYPT_ERP Kodierung des Chiffrats aus A_20161-*</a></li>
   <li><a href="#polarion_299">Tabelle 22: Tab_KRYPT_VAUERR Auftretende Fehler bei auf Anwendungsschicht kryptographisch gesicherten VAU-Kommunikation (E-Rezept)</a></li>
  </div>
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-34053">10.5 Referenzierte Dokumente</h3>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-7981">10.5.1 Dokumente der gematik</h4>
  <p id="polarion_442"> Die nachfolgende Tabelle enthält die Bezeichnung der in dem vorliegenden Dokument referenzierten Dokumente der gematik zur Telematikinfrastruktur. Der mit der vorliegenden Version korrelierende Entwicklungsstand dieser Konzepte und Spezifikationen wird pro Release in einer Dokumentenlandkarte definiert; Version und Stand der referenzierten Dokumente sind daher in der nachfolgenden Tabelle nicht aufgeführt. Deren zu diesem Dokument jeweils gültige Versionsnummer entnehmen Sie der aktuellen, von der gematik veröffentlichten Dokumentenlandkarte, in der die vorliegende Version aufgeführt wird.<br> </p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=29" style="width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 140pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">[Quelle]</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 306pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Herausgeber: Titel</span><br> </th> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 140pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[gemGlossar]</span><br> </td> 
     <td style="vertical-align: top;width: 306pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">gematik: Glossar der Telematikinfrastruktur</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 140pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[gemSpec_COS]</span><br> </td> 
     <td style="vertical-align: top;width: 306pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">gematik: Spezifikation des Card Operating System (COS)</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 140pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[gemSpec_Dokumentenverwaltung]</span><br> </td> 
     <td style="vertical-align: top;width: 306pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">gematik: Spezifikation ePA-Dokumentenverwaltung</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 140pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[gemSpec_DS_Anbieter]</span><br> </td> 
     <td style="vertical-align: top;width: 306pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Spezifikation Datenschutz- und Sicherheitsanforderungen der TI an Anbieter</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 140pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[gemSpec_eGK_ObjSys]</span><br> </td> 
     <td style="vertical-align: top;width: 306pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">gematik: Die Spezifikation der elektronischen Gesundheitskarte (eGK) – Objektsystem</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 140pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[gemSpec_KT]</span><br> </td> 
     <td style="vertical-align: top;width: 306pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">gematik: Spezifikation eHealth-Kartenterminal</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 140pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[gemSpec_MobKT]</span><br> </td> 
     <td style="vertical-align: top;width: 306pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">gematik: Spezifikation Mobiles Kartenterminal</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 140pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[gemSpec_SGD_ePA]</span><br> </td> 
     <td style="vertical-align: top;width: 306pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">gematik: Spezifikation Schlüsselkommentierungsdienst ePA</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 140pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[gemSpec_SST_FD_VSDM]</span><br> </td> 
     <td style="vertical-align: top;width: 306pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">gematik: Schnittstellenspezifikation Fachdienste (UFS/VSDD/CMS)</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 140pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">[gemSpec_Zugangsgateway_Vers]</td> 
     <td style="vertical-align: top;width: 306pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">gematik: Spezifikation Zugangsgateway des Versicherten ePA</td> 
    </tr> 
   </tbody> 
  </table>
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-7982">10.5.2 Weitere Dokumente</h4>
  <p id="polarion_445"></p>
  <table id="polarion_wiki macro name=table;params=width=100%|uid=17" style="width: 100%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">[Quelle]</span><br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">Herausgeber (Erscheinungsdatum): Titel</span><br> </th> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[ABR-1999]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">DHIES: An Encryption Scheme Based on the Diffie–Hellman Problem</span><br> <span style="font-size: 10pt;color: #222222;line-height: 1.5;">Abdalla, Michel and Bellare, Mihir and Rogaway, Phillip, 1999</span><br> <a href="http://web.cs.ucdavis.edu/~rogaway/papers/dhies.pdf" target="_blank" class="descriptionLink">http://web.cs.ucdavis.edu/~rogaway/papers/dhies.pdf</a><span style="font-size: 10pt;line-height: 1.5;">&nbsp;</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[AIS-20-1999]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">W. Schindler: Functionality Classes and Evaluation Methodology for</span><br> <span style="font-size: 10pt;line-height: 1.5;">Deterministic Random Number Generators. Version 1.0, 02.12.1999,</span><br> <span style="font-size: 10pt;line-height: 1.5;">ehemalige mathematisch technische Anlage zur AIS20,</span><br> <span style="font-size: 10pt;line-height: 1.5;"><a href="https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Zertifierung /Interpretation/AIS20_Functionality_Classes_Evaluation_Methodology_ DRNG.pdf?__blob=publicationFile" target="_top" class="descriptionLink">https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Zertifierung /Interpretation/AIS20_Functionality_Classes_Evaluation_Methodology_ DRNG.pdf?__blob=publicationFile</a></span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[AIS-20]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">AIS 20: Funktionalitätsklassen und Evaluationsmethodologie für</span><br> <span style="font-size: 10pt;line-height: 1.5;">deterministische Zufallszahlengeneratoren, Version 3, 15.05.2013,</span><br> <span style="font-size: 10pt;line-height: 1.5;"><a href="https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Zertifierung/Interpretation /AIS_20_pdf.pdf?__blob=publicationFile" target="_top" class="descriptionLink">https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Zertifierung/Interpretation /AIS_20_pdf.pdf?__blob=publicationFile</a></span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[AIS-31]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">AIS 31: Funktionalitätsklassen und Evaluationsmethodologie für</span><br> <span style="font-size: 10pt;line-height: 1.5;">physikalische Zufallszahlengeneratoren, Version 3, 15.05.2013,</span><br> <span style="font-size: 10pt;line-height: 1.5;"><a href="http://www.bsi.bund.de/SharedDocs/Downloads/DE/BS/Zertifierung/Interpretationen/ AIS_31_pdf.pdf?__blob=publicationFile" target="_top" class="descriptionLink">http://www.bsi.bund.de/SharedDocs/Downloads/DE/BS/Zertifierung/Interpretationen/ AIS_31_pdf.pdf?__blob=publicationFile</a></span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[ALGCAT]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Bekanntmachung zur elektronischen Signatur nach dem Signaturgesetz</span><br> <span style="font-size: 10pt;line-height: 1.5;">und der Signaturverordnung (Übersicht über geeignete Algorithmen),</span><br> <span style="font-size: 10pt;line-height: 1.5;">Bundesnetzagentur für Elektrizität, Gas, Telekommunikation, Post und</span><br> <span style="font-size: 10pt;line-height: 1.5;">Eisenbahnen, vom 30.12.2016 (auch online verfügbar:</span><br> <a href="https://www.bundesanzeiger.de" target="_blank" class="descriptionLink">https://www.bundesanzeiger.de</a> <span style="font-size: 10pt;line-height: 1.5;">mit dem Suchbegriff</span><br> <span style="font-size: 10pt;line-height: 1.5;">„BAnz AT 30.12.2016 B5“)</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[ANSI-X9.31]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">National Institute of Standards and Technology, NIST-Recommended</span><br> <span style="font-size: 10pt;line-height: 1.5;">Random Number Generator Based on ANSI X9.31 Appendix A.2.4 Using</span><br> <span style="font-size: 10pt;line-height: 1.5;">the 3-Key Triple DES and AES Algorithms, January 31, 2005.&nbsp;&nbsp;&nbsp;&nbsp;</span><br> <a href="http://csrc.nist.gov/groups/STM/cavp/documents/rng/931rngext.pdf" target="_blank" class="descriptionLink">http://csrc.nist.gov/groups/STM/cavp/documents/rng/931rngext.pdf</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[ANSI-X9.62]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">ANSI X9.62:2005</span><br> <span style="font-size: 10pt;line-height: 1.5;">Public Key Cryptography for the Financial Services Industry, The Elliptic</span><br> <span style="font-size: 10pt;line-height: 1.5;">Curve Digital Signature Algorithm (ECDSA)</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[ANSI-X9.63]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">American National Standard for Financial Services X9.63–2001</span><br> <span style="font-size: 10pt;line-height: 1.5;">Public Key Cryptography for the Financial Services Industry</span><br> <span style="font-size: 10pt;line-height: 1.5;">Key Agreement and Key Transport Using Elliptic Curve Cryptography</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[Boyd-Mathuria-2003]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Protocols for Authentication and Key Establishment, Colin Boyd and Anish Mathuria, 2003</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[BrainPool]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">ECC Brainpool Standard Curves and Curve Generation v. 1.0 19.10.2005</span><br> <a href="http://www.teletrust.de/fileadmin/files/oid/oid_ECC-Brainpool-Standard-curves-V1.pdf" target="_blank" class="descriptionLink">http://www.teletrust.de/fileadmin/files/oid/oid_ECC-Brainpool-Standard-curves-V1.pdf</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[Breaking-TLS]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Lucky Thirteen: Breaking the TLS and DTLS Record Protocols</span><br> <span style="font-size: 10pt;line-height: 1.5;">Nadhem J. AlFardan and Kenneth G. Paterson</span><br> <span style="font-size: 10pt;line-height: 1.5;">Information Security Group, Royal Holloway, University of London,</span><br> <span style="font-size: 10pt;line-height: 1.5;">Egham, Surrey TW20 0EX, UK, 6th February 2013</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[BreakingXMLEnc]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">How to Break XML Encryption, Tibor Jager, Juraj Somorovsky, 2011</span><br> <span style="font-size: 10pt;line-height: 1.5;"><a href="http://www.nds.rub.de/media/nds/veroeffentlichungen/2011/10/22/HowToBreakXMLenc.pdf" target="_top" class="descriptionLink">http://www.nds.rub.de/media/nds/veroeffentlichungen/2011/10/22/HowToBreakXMLenc.pdf</a></span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">[BSI-PQC-2020]</td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">Migration zu Post-Quanten-Kryptografie, Handlungsempfehlungen des BSI,<br> Stand: August 2020,&nbsp;<a href="https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Krypto/Post-Quanten-Kryptografie.pdf?__blob=publicationFile&amp;v=2" target="_top" class="descriptionLink">https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Krypto/Post-Quanten-Kryptografie.pdf?__blob=publicationFile&amp;v=2</a>&nbsp;<br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[BSI-TR-02102-1]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">BSI TR-02102-1 Technische Richtlinie „Kryptographische Verfahren:</span><br> <span style="font-size: 10pt;line-height: 1.5;">Empfehlungen und Schlüssellängen“</span><br> <span style="font-size: 10pt;line-height: 1.5;">Version 2023-01</span><br> <a href="https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Publikationen/TechnischeRichtlinien/TR02102/BSI-TR-02102.html" target="_top" class="descriptionLink">https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Publikationen/TechnischeRichtlinien/TR02102/BSI-TR-02102.html</a>&nbsp;<br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[BSI-TR-02102-2]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">BSI TR-02102-2 Technische Richtlinie „Kryptographische Verfahren:</span><br> <span style="font-size: 10pt;line-height: 1.5;">Empfehlungen und Schlüssellängen, Teil 2 – Verwendung von Transport Layer Security (TLS), Version 2023-01</span><br> <a href="https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Publikationen/TechnischeRichtlinien/TR02102/BSI-TR-02102-2.html" target="_top" class="descriptionLink">https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Publikationen/TechnischeRichtlinien/TR02102/BSI-TR-02102-2.html</a>&nbsp;<br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[BSI-TR-02102-3]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">BSI TR-02102-3 Technische Richtlinie „Kryptographische Verfahren:</span><br> <span style="font-size: 10pt;line-height: 1.5;">Empfehlungen und Schlüssellängen, Teil 3 – Verwendung von Internet</span><br> <span style="font-size: 10pt;line-height: 1.5;">Protocol Security (IPsec) und Internet Key Exchange (IKEv2)“</span><br> <span style="font-size: 10pt;line-height: 1.5;">Version 2023-01</span><br> <a href="https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Publikationen/TechnischeRichtlinien/TR02102/BSI-TR-02102-3.html" target="_top" class="descriptionLink">https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Publikationen/TechnischeRichtlinien/TR02102/BSI-TR-02102-3.html</a>&nbsp;<br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[BSI-TR-03111]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Technical Guideline BSI TR-03111</span><br> <span style="font-size: 10pt;line-height: 1.5;">Elliptic Curve Cryptography, Version 2.10, Date: 2018-06-01</span><br> <span style="font-size: 10pt;line-height: 1.5;"><a href="https://www.bsi.bund.de/DE/Themen/Unternehmen-und-Organisationen/Standards-und-Zertifizierung/Technische-Richtlinien/TR-nach-Thema-sortiert/tr03111/TR-03111_node.html" target="_top" class="descriptionLink">https://www.bsi.bund.de/DE/Themen/Unternehmen-und-Organisationen/Standards-und-Zertifizierung/Technische-Richtlinien/TR-nach-Thema-sortiert/tr03111/TR-03111_node.html</a>&nbsp;</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[BSI-TR-03116-1]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Technische Richtlinie BSI TR-03116-1 Kryptographische Vorgaben für</span><br> <span style="font-size: 10pt;line-height: 1.5;">Projekte der Bundesregierung, Version: 3.20,</span><br> <span style="font-size: 10pt;line-height: 1.5;">Fassung September 2018, 21.09.2018&nbsp;<a href="https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Publikationen/TechnischeRichtlinien/TR03116/BSI-TR-03116.html" target="_top" class="descriptionLink">https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Publikationen/TechnischeRichtlinien/TR03116/BSI-TR-03116.html</a>&nbsp;</span>&nbsp;<br> <br> Die Technische Richtlinie befindet sich aktuell in der Überarbeitung. <span style="font-size: 10pt;line-height: 1.5;">Sobald die Überarbeitung der TR-03116-1 erfolgt ist, wird die Referenz auf die neue Version der TR-03116-1 hier aktualisiert.</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[CM-2014]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">20 Years of SSL/TLS Research, An Analysis of the Internet’s Security</span><br> <span style="font-size: 10pt;line-height: 1.5;">Foundation, Christopher Meyer, 9. February 2014</span><br> <a href="http://www-brs.ub.ruhr-uni-bochum.de/netahtml/HSS/Diss/MeyerChristopher/diss.pdf" target="_blank" class="descriptionLink">http://www-brs.ub.ruhr-uni-bochum.de/netahtml/HSS/Diss/MeyerChristopher/diss.pdf</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[eIDAS]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Verordnung (EU) Nr. 910/2014 des europäischen Parlaments und des</span><br> <span style="font-size: 10pt;line-height: 1.5;">Rates vom 23. Juli 2014 über elektronische Identifizierung und</span><br> <span style="font-size: 10pt;line-height: 1.5;">Vertrauensdienste für elektronische Transaktionen im Binnenmarkt</span><br> <span style="font-size: 10pt;line-height: 1.5;">und zur Aufhebung der Richtlinie 1999/93/EG</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">[ecma-262]</td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">JSON Standard&nbsp;<a href="https://www.ecma-international.org/publications/standards/Ecma-262.htm&nbsp;" target="_top" class="descriptionLink">https://www.ecma-international.org/publications/standards/Ecma-262.htm&nbsp;</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[EN-14890-1]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">DIN EN 14890-1:2008</span><br> <span style="font-size: 10pt;line-height: 1.5;">Application Interface for smart cards used as Secure Signature</span><br> <span style="font-size: 10pt;line-height: 1.5;">Creation Devices - Part 1: Basic services</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">[ENISA-PQC-2021]</td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Post-Quantum Cryptography: Current state and quantum mitigation,&nbsp;European Union Agency for Cybersecurity (ENISA), May 2021,&nbsp;</span><a href="https://www.enisa.europa.eu/publications/post-quantum-cryptography-current-state-and-quantum-mitigation" target="_top" class="descriptionLink">https://www.enisa.europa.eu/publications/post-quantum-cryptography-current-state-and-quantum-mitigation</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;height: 31pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[ETSI-CAdES]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;height: 31pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">ETSI TS 101 733 V1.7.4 (2008-07), Electronic Signatures and</span><br> <span style="font-size: 10pt;line-height: 1.5;">Infrastructures (ESI); CMS Advanced Electronic Signatures (CAdES)</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[ETSI_TS_102_231_v3.1.2]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">ETSI (Dezember 2009): ETSI Technical Specification TS 102 231 (‘Provision of harmonized Trust Service Provider (TSP) status information’) – Version 3.1.2</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[ETSI-XAdES]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">ETSI TS 101 903 V1.4.2 (2010-12), Electronic Signatures and</span><br> <span style="font-size: 10pt;line-height: 1.5;">Infrastructures (ESI); XML Advanced Electronic Signatures (XAdES)</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[FIPS-180-4]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Federal Information, Processing Standards Publication 180-4,</span><br> <span style="font-size: 10pt;line-height: 1.5;">Secure Hash Standard (SHS), March 2012</span><br> <a href="http://csrc.nist.gov/publications/fips/fips180-4/fips180-4.pdf" target="_blank" class="descriptionLink">http://csrc.nist.gov/publications/fips/fips180-4/fips180-4.pdf</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[FIPS-186-2+CN1]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">FIPS 186-2 - National Institute of Standards and Technology,</span><br> <span style="text-decoration: underline;font-size: 10pt;line-height: 1.5;">Digital Signature Standard (DSS)</span><span style="font-size: 10pt;line-height: 1.5;">, Federal Information Processing</span><br> <span style="font-size: 10pt;line-height: 1.5;">Standards Publication 186-2, January 27, 2000 – Appendix 3.1</span><br> <span style="font-size: 10pt;line-height: 1.5;">unter der Beachtung des Change Notice 1, vom 5. Oktober 2001</span><br> <a href="http://csrc.nist.gov/publications/fips/archive/fips186-2/fips186-2-change1.pdf" target="_blank" class="descriptionLink">http://csrc.nist.gov/publications/fips/archive/fips186-2/fips186-2-change1.pdf</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[FIPS-197]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Federal Information Processing Standards Publication 197,</span><br> <span style="font-size: 10pt;line-height: 1.5;">(FIPS–197), November 26, 2001, Announcing the</span><br> <span style="font-size: 10pt;line-height: 1.5;">ADVANCED ENCRYPTION STANDARD (AES)</span><br> <a href="http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf" target="_blank" class="descriptionLink">http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">[<span style="font-size: 10pt;line-height: 1.5;">FIPS-202]</span></td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">NIST, FIPS PUB 202, SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions, 2015, <a href="http://nvlpubs.nist.gov/nistpubs/fips/NIST.FIPS.202.pdf" target="_top" class="descriptionLink">http://nvlpubs.nist.gov/nistpubs/fips/NIST.FIPS.202.pdf</a>&nbsp;</span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[IR-2014]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Bulletproof SSL and TLS: Understanding and deploying SSL/TLS</span><br> <span style="font-size: 10pt;line-height: 1.5;">and PKI to secure servers and web applications, Ivan Ristić, 2014</span><br> <a href="https://www.feistyduck.com/books/bulletproof-ssl-and-tls/" target="_blank" class="descriptionLink">https://www.feistyduck.com/books/bulletproof-ssl-and-tls/</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[ISO-11770]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">ISO/IEC 11770: 1996, Information technology – Security techniques –</span><br> <span style="font-size: 10pt;line-height: 1.5;">Key management, Part 3: Mechanisms using asymmetric techniques</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[Ker-1883]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Auguste Kerckhoffs, "La cryptographie militaire", Journal des sciences</span><br> <span style="font-size: 10pt;line-height: 1.5;">militaires, vol. IX, Seite 5–83, Jan. 1883, Seite 161–191, Feb. 1883.</span><br> <span style="font-size: 10pt;line-height: 1.5;">siehe auch</span> <a href="http://www.petitcolas.net/fabien/kerckhoffs/" target="_blank" class="descriptionLink">http://www.petitcolas.net/fabien/kerckhoffs/</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[KS-2011]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">W. Killmann, W. Schindler, „A proposal for: Functionality classes for</span><br> <span style="font-size: 10pt;line-height: 1.5;">random number generators“, Version 2.0, September 2011</span><br> <span style="font-size: 10pt;line-height: 1.5;"><a href="https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Zertifierung/Interpretation /AIS31_Functionality_classes_for_random_numder_generators.pdf?__ blpb=publicationFile" target="_top" class="descriptionLink">https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Zertifierung/Interpretation /AIS31_Functionality_classes_for_random_numder_generators.pdf?__ blpb=publicationFile</a></span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[MK-2016]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">The Million-Key Question – Investigating the Origins of RSA Public Keys,</span><br> <span style="font-size: 10pt;line-height: 1.5;">Petr Svenda, Matus Nemec, Peter Sekan, Rudolf Kvasnovsky, David Formanek, David Komarek, Vashek Matyas,&nbsp;</span><br> <span style="font-size: 10pt;line-height: 1.5;">The 25th USENIX Security Symposium (UsenixSec'2016)</span><br> <a href="https://crocs.fi.muni.cz/public/papers/usenix2016" target="_blank" class="descriptionLink">https://crocs.fi.muni.cz/public/papers/usenix2016</a><span style="font-size: 10pt;line-height: 1.5;">&nbsp;</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">[NIST-PQC]</td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Post-Quantum Cryptography,&nbsp;National Institute of Standards and Technology (NIST),&nbsp;</span><br> <a href="https://csrc.nist.gov/projects/post-quantum-cryptography" target="_top" class="descriptionLink">https://csrc.nist.gov/projects/post-quantum-cryptography</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[NIST-SP-800-22]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">A. Ruskin et al., A Statistical Test Suite for Random and Pseudorandom Number Generators for Cryptographic Applications, SP 800-22 Rev. 1a , 2010</span><br> <a href="https://csrc.nist.gov/publications/detail/sp/800-22/rev-1a/final" target="_blank" class="descriptionLink">https://csrc.nist.gov/publications/detail/sp/800-22/rev-1a/final</a><span style="font-size: 10pt;line-height: 1.5;">&nbsp;</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[NIST-SP-800-38A]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">NIST Special Publication 800-38A,</span><br> <span style="font-size: 10pt;line-height: 1.5;">Recommendation for Block, Cipher Modes of Operation, Methods and</span><br> <span style="font-size: 10pt;line-height: 1.5;">Techniques, Morris Dworkin, December 2001 Edition,</span><br> <a href="http://csrc.nist.gov/publications/nistpubs/800-38a/sp800-38a.pdf" target="_blank" class="descriptionLink">http://csrc.nist.gov/publications/nistpubs/800-38a/sp800-38a.pdf</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[NIST-SP-800-38B]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">NIST Special Publication 800-38B,</span><br> <span style="font-size: 10pt;line-height: 1.5;">Recommendation for Block Cipher Modes of Operation: The CMAC</span><br> <span style="font-size: 10pt;line-height: 1.5;">Mode for Authentication, Morris Dworkin, May 2005 Edition,</span><br> <a href="http://csrc.nist.gov/publications/nistpubs/800-38B/SP_800-38B.pdf" target="_blank" class="descriptionLink">http://csrc.nist.gov/publications/nistpubs/800-38B/SP_800-38B.pdf</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[NIST-SP-800-38D]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">NIST Special Publication 800-38D,</span><br> <span style="font-size: 10pt;line-height: 1.5;">Recommendation for Block Cipher Modes of Operation: Galois/Counter</span><br> <span style="font-size: 10pt;line-height: 1.5;">Mode (GCM) and GMAC, Morris Dworkin, November, 2007</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[NIST-SP-800-56-A]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">NIST Special Publication 800-56A</span><br> <span style="font-size: 10pt;line-height: 1.5;">Recommendation for Pair-Wise Key Establishment Schemes Using</span><br> <span style="font-size: 10pt;line-height: 1.5;">Discrete Logarithm Cryptography,&nbsp;&nbsp;</span><br> <span style="font-size: 10pt;line-height: 1.5;">April 2018</span><br> <a href="https://csrc.nist.gov/publications/detail/sp/800-56a/rev-3/final" target="_blank" class="descriptionLink">https://csrc.nist.gov/publications/detail/sp/800-56a/rev-3/final</a><span style="font-size: 10pt;line-height: 1.5;">&nbsp;</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[NIST-SP-800-56-B]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">NIST Special Publication 800-56B</span><br> <span style="font-size: 10pt;line-height: 1.5;">Recommendation for Pair-Wise&nbsp;Key Establishment Schemes Using Integer Factorization Cryptography, August 2009</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[NIST-SP-800-56C]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">NIST Special Publication 800-56C</span><br> <span style="font-size: 10pt;line-height: 1.5;">Recommendation for Key Derivation through Extraction-then-Expansion,</span><br> <span style="font-size: 10pt;line-height: 1.5;">November 2011</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[NIST-SP-800-108]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">NIST Special Publication 800-108</span><br> <span style="font-size: 10pt;line-height: 1.5;">Recommendation for Key Derivation Using Pseudorandom Functions,</span><br> <span style="font-size: 10pt;line-height: 1.5;">October 2009</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[NK-PP]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Common Criteria Schutzprofil (Protection Profile)</span><br> <span style="font-size: 10pt;line-height: 1.5;">Schutzprofil 1:&nbsp; Anforderungen an den Netzkonnektor, BSI-CC-PP-0097</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[Oorschot-Wiener-</span><br> <span style="font-size: 10pt;line-height: 1.5;">1996]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">On Diffie-Hellman Key Agreement with Short Exponents, Paul C. van Oorschot, Michael J Weiner, Eurocrypt’ 96</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[Padding-Oracle-</span><br> <span style="font-size: 10pt;line-height: 1.5;">2005]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Padding Oracle Attacks on CBC-mode Encryption with Secret and</span><br> <span style="font-size: 10pt;line-height: 1.5;">Random IVs</span><br> <span style="font-size: 10pt;line-height: 1.5;">Arnold K. L. Yau, Kenneth G. Paterson and Chris J. Mitchell, FSE 2005</span><br> <a href="http://www.isg.rhul.ac.uk/~kp/secretIV.pdf" target="_blank" class="descriptionLink">http://www.isg.rhul.ac.uk/~kp/secretIV.pdf</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[PAdES-3]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">ETSI TS 102 778-3 V1.2.1,</span><br> <span style="font-size: 10pt;line-height: 1.5;">PDF Advanced Electronic Signature Profiles; Part 3: PAdES Enhanced –</span><br> <span style="font-size: 10pt;line-height: 1.5;">PAdES-BES and PAdES-EPES Profiles</span><br> <span style="font-size: 10pt;line-height: 1.5;">Technical Specification, 2010</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[PDF/A-2]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">ISO 19005-2:2011 – Document management – Electronic document file</span><br> <span style="font-size: 10pt;line-height: 1.5;">format for long-term preservation – Part 2: Use of ISO 32000-1 (PDF/A-2)</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[PKCS#1]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">vgl. [RFC-8017]</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[PP-0082]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Common Criteria Protection Profile, Card Operating System Generation</span><br> <span style="font-size: 10pt;line-height: 1.5;">2 (PP COS G2), BSI-CC-PP-0082-V2, Version 1.9, 18th November 2014</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-2119]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">RFC 2119 (März 1997): Key words for use in RFCs to Indicate Requirement</span><br> <span style="font-size: 10pt;line-height: 1.5;">Levels, S. Bradner,</span><br> <a href="http://tools.ietf.org/html/rfc2119" target="_blank" class="descriptionLink">http://tools.ietf.org/html/rfc2119</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-2590]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">RFC 2590 (June 1999): X.509 Internet Public Key Infrastructure Online</span><br> <span style="font-size: 10pt;line-height: 1.5;">Certificate Status Protocol - OCSP</span><br> <a href="https://tools.ietf.org/html/rfc2560" target="_blank" class="descriptionLink">https://tools.ietf.org/html/rfc2560</a><br> <span style="font-size: 10pt;line-height: 1.5;">(Obsoleted by [RFC-6960])</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-2986]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">RFC 2986 (November 2000):&nbsp;PKCS #10: Certification Request Syntax Specification, Version 1.7</span><br> <a href="https://tools.ietf.org/html/rfc2986" target="_blank" class="descriptionLink">https://tools.ietf.org/html/rfc2986</a><span style="font-size: 10pt;line-height: 1.5;">&nbsp;</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-3279]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">RFC 3279 (April 2002): Algorithms and Identifiers for the Internet X.509</span><br> <span style="font-size: 10pt;line-height: 1.5;">Public Key Infrastructure Certificate and Certificate Revocation List (CRL)</span><br> <span style="font-size: 10pt;line-height: 1.5;">Profile</span><br> <a href="https://tools.ietf.org/html/rfc3279" target="_blank" class="descriptionLink">https://tools.ietf.org/html/rfc3279</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-3526]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">RFC 3526 (Mai 2003: More Modular Exponential (MODP) Diffie-Hellman</span><br> <span style="font-size: 10pt;line-height: 1.5;">groups for Internet Key Exchange (IKE)</span><br> <a href="http://tools.ietf.org/html/rfc3526" target="_blank" class="descriptionLink">http://tools.ietf.org/html/rfc3526</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-4051]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Additional XML Security Uniform Resource Identifiers (URIs), April 2005</span><br> <a href="https://tools.ietf.org/html/rfc4051" target="_blank" class="descriptionLink">https://tools.ietf.org/html/rfc4051</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-4635]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">RFC 4635 (August 2006): HMAC SHA TSIG Algorithm Identifiers</span><br> <a href="http://tools.ietf.org/html/rfc4635" target="_blank" class="descriptionLink">http://tools.ietf.org/html/rfc4635</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-5077]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Transport Layer Security (TLS) Session Resumption without Server-Side</span><br> <span style="font-size: 10pt;line-height: 1.5;">State, January 2008,</span> <a href="https://tools.ietf.org/html/rfc5077" target="_blank" class="descriptionLink">https://tools.ietf.org/html/rfc5077</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-5084]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">RFC 5084: Using AES-CCM and AES-GCM Authenticated Encryption in the</span><br> <span style="font-size: 10pt;line-height: 1.5;">Cryptographic Message Syntax (CMS), November 2007</span><br> <a href="https://tools.ietf.org/html/rfc5084" target="_blank" class="descriptionLink">https://tools.ietf.org/html/rfc5084</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">[RFC-5091]</td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">RFC 5091: Identity-Based Cryptography Standard (IBCS) #1: Supersingular Curve Implementations of the BF and BB1 Cryptosystems,&nbsp;X. Boyen, L. Martin, December 2007<br> <a href="https://tools.ietf.org/html/rfc5091" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc5091</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-5246]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">The Transport Layer Security (TLS) Protocol Version 1.2, August 2008,</span><br> <a href="https://tools.ietf.org/html/rfc5246" target="_blank" class="descriptionLink">https://tools.ietf.org/html/rfc5246</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-5280]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">RFC 5280: Internet X.509 Public Key Infrastructure Certificate and</span><br> <span style="font-size: 10pt;line-height: 1.5;">Certificate Revocation List (CRL) Profile, Mai 2008</span><br> <a href="https://tools.ietf.org/html/rfc5280" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc5280</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-5480]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">RFC 5480 (March 2009): Elliptic Curve Cryptography Subject Public</span><br> <span style="font-size: 10pt;line-height: 1.5;">Key Information,</span> <a href="https://tools.ietf.org/html/rfc5480" target="_blank" class="descriptionLink">https://tools.ietf.org/html/rfc5480</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-5639]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">RFC 5639 (March 2010): Elliptic Curve Cryptography (ECC) Brainpool</span><br> <span style="font-size: 10pt;line-height: 1.5;">Standard Curves and Curve Generation,</span> <a href="http://www.ietf.org/rfc/rfc5639.txt" target="_blank" class="descriptionLink">http://www.ietf.org/rfc/rfc5639.txt</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-5652]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">RFC 5652 (September 2009): Cryptographic Message Syntax (CMS),</span><br> <span style="font-size: 10pt;line-height: 1.5;">R. Housley,</span> <a href="http://tools.ietf.org/html/rfc5652" target="_blank" class="descriptionLink">http://tools.ietf.org/html/rfc5652</a><span style="font-size: 10pt;line-height: 1.5;">&nbsp;</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-5702]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">RFC 5702 (October 2009): Use of SHA-2 Algorithms with RSA in DNSKEY</span><br> <span style="font-size: 10pt;line-height: 1.5;">and RRSIG Resource Records for DNSSEC,</span> <a href="http://tools.ietf.org/html/rfc5702" target="_blank" class="descriptionLink">http://tools.ietf.org/html/rfc5702</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-5746]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">RFC 5746:</span> <span style="font-size: 10pt;line-height: 1.5;">Transport Layer Security (TLS) Renegotiation Indication Extension,</span><br> <span style="font-size: 10pt;line-height: 1.5;">February 2010,</span> <a href="https://tools.ietf.org/html/rfc5746" target="_blank" class="descriptionLink">https://tools.ietf.org/html/rfc5746</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-5753]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">RFC 5753:&nbsp;Use of Elliptic Curve Cryptography (ECC) Algorithms in Cryptographic Message Syntax (CMS), January 2010,&nbsp;</span> <a href="https://tools.ietf.org/html/rfc5753" target="_blank" class="descriptionLink">https://tools.ietf.org/html/rfc5753</a><span style="font-size: 10pt;line-height: 1.5;">&nbsp;</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-5869]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">HMAC-based Extract-and-Expand Key Derivation Function (HKDF), May 2010,&nbsp;</span> <a href="https://tools.ietf.org/html/rfc5869" target="_blank" class="descriptionLink">https://tools.ietf.org/html/rfc5869</a><span style="font-size: 10pt;line-height: 1.5;">&nbsp;</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-5903]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Elliptic Curve Groups modulo a Prime (ECP Groups) for IKE and IKEv2, June 2010,&nbsp;</span> <a href="https://tools.ietf.org/html/rfc5903" target="_blank" class="descriptionLink">https://tools.ietf.org/html/rfc5903</a><span style="font-size: 10pt;line-height: 1.5;">&nbsp;</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-6090]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">RFC 6090:&nbsp;Fundamental Elliptic Curve Cryptography Algorithms, February 2011,&nbsp;</span> <a href="https://tools.ietf.org/html/rfc6090" target="_blank" class="descriptionLink">https://tools.ietf.org/html/rfc6090</a><span style="font-size: 10pt;line-height: 1.5;">&nbsp;</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-6954]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Using the Elliptic Curve Cryptography (ECC) Brainpool Curves for the Internet Key Exchange Protocol Version 2 (IKEv2),July 2013,&nbsp;</span> <a href="https://tools.ietf.org/html/rfc6954" target="_blank" class="descriptionLink">https://tools.ietf.org/html/rfc6954</a><span style="font-size: 10pt;line-height: 1.5;">&nbsp;</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-6960]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">RFC 6960 (June 2013): X.509 Internet Public Key Infrastructure Online</span><br> <span style="font-size: 10pt;line-height: 1.5;">Certificate Status Protocol – OCSP,</span> <a href="https://tools.ietf.org/html/rfc6960" target="_blank" class="descriptionLink">https://tools.ietf.org/html/rfc6960</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-7027]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">RFC 7027: (October 2013) Elliptic Curve Cryptography (ECC) Brainpool</span><br> <span style="font-size: 10pt;line-height: 1.5;">Curves&nbsp;&nbsp;for Transport Layer Security (TLS),</span> <a href="https://tools.ietf.org/html/rfc7027" target="_blank" class="descriptionLink">https://tools.ietf.org/html/rfc7027</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;height: 4pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-7296]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;height: 4pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">RFC 7296 (October 2014): Internet Key Exchange Protocol Version 2</span><br> <span style="font-size: 10pt;line-height: 1.5;">(IKEv2),</span> <a href="https://tools.ietf.org/html/rfc7296" target="_blank" class="descriptionLink">https://tools.ietf.org/html/rfc7296</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;height: 4pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-7427]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;height: 4pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">RFC 7427 (January 2015): Signature Authentication in the Internet Key</span><br> <span style="font-size: 10pt;line-height: 1.5;">Exchange Version 2 (IKEv2),</span> <a href="https://tools.ietf.org/html/rfc7427" target="_blank" class="descriptionLink">https://tools.ietf.org/html/rfc7427</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-8017],</span><br> <span style="font-size: 10pt;line-height: 1.5;">[PKCS#1]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography<br> Specifications Version 2.2",&nbsp; <span style="font-size: 10pt;line-height: 1.5;">November 2016</span><br> <a href="https://tools.ietf.org/html/rfc8017" target="_blank" class="descriptionLink">https://tools.ietf.org/html/rfc8017</a>&nbsp;<br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[RFC-931]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">RFC 6931: Additional XML Security Uniform Resource Identifiers (URIs),</span><br> <span style="font-size: 10pt;line-height: 1.5;">Donald Eastlake, April 2013,</span> <a href="https://tools.ietf.org/html/rfc6931" target="_blank" class="descriptionLink">https://tools.ietf.org/html/rfc6931</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">[RFC-9155]</td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">RFC 9155:&nbsp;<span style="font-size: 10pt;line-height: 1.5;">Deprecating MD5 and SHA-1 Signature Hashes in TLS 1.2 and DTLS 1.2, December 2021,&nbsp;</span><a href="https://datatracker.ietf.org/doc/rfc9155/&nbsp;" target="_top" class="descriptionLink">https://datatracker.ietf.org/doc/rfc9155/&nbsp;</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[ROCA-2017]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">The Return of Coppersmith's Attack: Practical Factorization of Widely Used RSA Moduli,</span><br> <span style="font-size: 10pt;line-height: 1.5;">Matus Nemec, Marek Sys, Petr Svenda, Dusan Klinec, Vashek Matyas</span><br> <span style="font-size: 10pt;line-height: 1.5;">24th ACM Conference on Computer and Communications Security (CCS'2017)</span><br> <a href="https://crocs.fi.muni.cz/public/papers/rsa_ccs17" target="_blank" class="descriptionLink">https://crocs.fi.muni.cz/public/papers/rsa_ccs17</a><span style="font-size: 10pt;line-height: 1.5;">&nbsp;</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[SEC1-2009]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Standards for Efficient Cryptography,&nbsp;SEC 1: Elliptic Curve Cryptography, Certicom Research, Contact: Daniel R. L. Brown (dbrown@certicom.com), May 21, 2009, Version 2.0</span><br> <a href="https://www.secg.org/sec1-v2.pdf" target="_blank" class="descriptionLink">https://www.secg.org/sec1-v2.pdf</a><span style="font-size: 10pt;line-height: 1.5;">&nbsp;</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[SDH-2016]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Measuring the Security Harm of TLS Crypto Shortcuts, Drew Springall, Zakir Durumeic, J. Alex Halderman, November 2016,</span> <a href="https://jhalderm.com/pub/papers/forward-secrecy-imc16.pdf" target="_blank" class="descriptionLink">https://jhalderm.com/pub/papers/forward-secrecy-imc16.pdf</a><span style="font-size: 10pt;line-height: 1.5;">&nbsp;</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[SOG-IS-2020]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">SOG-IS Crypto Evaluation Scheme Agreed Cryptographic Mechanisms, Version 1.2, January 2020</span><br> <a href="https://www.sogis.eu/documents/cc/crypto/SOGIS-Agreed-Cryptographic-Mechanisms-1.2.pdf" target="_top" class="descriptionLink">https://www.sogis.eu/documents/cc/crypto/SOGIS-Agreed-Cryptographic-Mechanisms-1.2.pdf</a>&nbsp;<br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[TLS-Attacks]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Lessons Learned From Previous SSL/TLS Attacks - A Brief Chronology</span><br> <span style="font-size: 10pt;line-height: 1.5;">Of Attacks And Weaknesses, Christopher Meyer und Jörg Schwenk,</span><br> <span style="font-size: 10pt;line-height: 1.5;">31. Januar 2013,</span> <a href="http://eprint.iacr.org/2013/049" target="_blank" class="descriptionLink">http://eprint.iacr.org/2013/049</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">[TLS-CC-2021]</td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Hybrid Post-Quantum Key Encapsulation Methods (PQ KEM) for Transport Layer Security 1.2 (TLS), September 2021,&nbsp;<a href="https://datatracker.ietf.org/doc/draft-campagna-tls-bike-sike-hybrid/" target="_top" class="descriptionLink">https://datatracker.ietf.org/doc/draft-campagna-tls-bike-sike-hybrid/</a>&nbsp;</span></td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[XMLCan_V1.0]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Exclusive XML Canonicalization, Version 1.0, W3C Recommendation</span><br> <span style="font-size: 10pt;line-height: 1.5;">18 July 2002,</span> <a href="http://www.w3.org/TR/xml-exc-c14n/" target="_blank" class="descriptionLink">http://www.w3.org/TR/xml-exc-c14n/</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[XMLDSig]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"> <span style="font-size: 10pt;line-height: 1.5;">XML Signature Syntax and Processing Version 1.1, W3C</span><br> <span style="font-size: 10pt;line-height: 1.5;">Recommendation 11 April 2013</span><br> <a href="https://www.w3.org/TR/xmldsig-core1/" target="_blank" class="descriptionLink">https://www.w3.org/TR/xmldsig-core1/</a><span style="font-size: 10pt;line-height: 1.5;">&nbsp;&nbsp;</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[XMLDSig-Draft]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">XML Signature Syntax and Processing Version 2.0, W3C Editor's Draft</span><br> <span style="font-size: 10pt;line-height: 1.5;">04 February 2014,</span> <a href="http://www.w3.org/2008/xmlsec/Drafts/xmldsig-core-20/" target="_blank" class="descriptionLink">http://www.w3.org/2008/xmlsec/Drafts/xmldsig-core-20/</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[XMLDSig-RSA-</span><br> <span style="font-size: 10pt;line-height: 1.5;">PSS]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">RSA-PSS in XMLDSig, 25/26 September 2007, Konrad Lanz,</span><br> <span style="font-size: 10pt;line-height: 1.5;">Dieter Bratko, Peter Lipp,</span><br> <a href="http://www.w3.org/2007/xmlsec/ws/papers/08-lanz-iaik/" target="_blank" class="descriptionLink">http://www.w3.org/2007/xmlsec/ws/papers/08-lanz-iaik/</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[XMLEnc]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">XML Encryption Syntax and Processing, W3C Recommendation</span><br> <span style="font-size: 10pt;line-height: 1.5;">10 December 2002,</span> <a href="http://www.w3.org/TR/xmlenc-core/" target="_blank" class="descriptionLink">http://www.w3.org/TR/xmlenc-core/</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[XMLEnc-CM]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Technical Analysis of Countermeasures against Attack on XML</span><br> <span style="font-size: 10pt;line-height: 1.5;">Encryption - or - Just Another Motivation for Authenticated</span><br> <span style="font-size: 10pt;line-height: 1.5;">Encryption.</span><br> <span style="font-size: 10pt;line-height: 1.5;">Juraj Somorovsky, Jörg Schwenk. 2011</span><br> <a href="http://www.w3.org/2008/xmlsec/papers/xmlEncCountermeasuresW3C.pdf" target="_blank" class="descriptionLink">http://www.w3.org/2008/xmlsec/papers/xmlEncCountermeasuresW3C.pdf</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[XMLEnc-1.1]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">XML Encryption Syntax and Processing, W3C Recommendation</span><br> <span style="font-size: 10pt;line-height: 1.5;">11 April 2013,</span> <a href="http://www.w3.org/TR/xmlenc-core1/" target="_blank" class="descriptionLink">http://www.w3.org/TR/xmlenc-core1/</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[XSpRES]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">XML Spoofing Resistant Electronic Signature (XSpRES) --</span><br> <span style="font-size: 10pt;line-height: 1.5;">Sichere Implementierung für XML-Signaturen</span><br> <span style="font-size: 10pt;line-height: 1.5;">Bundesamt für Sicherheit in der Informationstechnik 2012</span><br> <a href="https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/SOA/XSpRESS.pfd?__blob=publicationFile" target="_blank" class="descriptionLink">https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/SOA/XSpRESS.pfd?__blob=publicationFile</a><span style="font-size: 10pt;line-height: 1.5;">&nbsp;</span><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[XSW-Attack]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">On Breaking SAML: Be Whoever You Want to Be</span><br> <span style="font-size: 10pt;line-height: 1.5;">Juraj Somorovsky, Andreas Mayer, Jörg Schwenk, Marco Kampmann,</span><br> <span style="font-size: 10pt;line-height: 1.5;">Meiko Jensen, Usenix 2012</span><br> <a href="http://www.nds.rub.de/media/nds/veroeffentlichungen/2012/08/03/BreakingSAML.pdf" target="_blank" class="descriptionLink">http://www.nds.rub.de/media/nds/veroeffentlichungen/2012/08/03/BreakingSAML.pdf</a><br> </td> 
    </tr> 
    <tr> 
     <td style="vertical-align: top;width: 121pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">[Vaudenay-2002]</span><br> </td> 
     <td style="vertical-align: top;width: 434pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;"><span style="font-size: 10pt;line-height: 1.5;">Security Flaws Induced by CBC Padding: Applications to SSL, IPsec,</span><br> <span style="font-size: 10pt;line-height: 1.5;">WTLS … , Serge Vaudenay, Eurocrypt 2002, LNCS 2332/2002, 535-545</span><br> <a href="https://www.iacr.org/cryptodb/data/paper.php?pubkey=2850" target="_blank" class="descriptionLink">https://www.iacr.org/cryptodb/data/paper.php?pubkey=2850</a><br> </td> 
    </tr> 
   </tbody> 
  </table>
  <p id="polarion_447"></p>
 </body>
</html>