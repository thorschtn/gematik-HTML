<html>
 <head>
  <link rel="stylesheet" href="attachments/styleSheetForToc.css">
 </head>
 <body>
  <p id="polarion_1"> <br> </p> 
  <p id="polarion_2"> <br> </p> 
  <p id="polarion_3"> <br> </p> 
  <p id="polarion_4"> <br> </p> 
  <p id="polarion_5"> <br> </p> 
  <p id="polarion_6"> <span style="font-weight: bold;text-decoration: underline;font-size: 12pt;font-family: Arial, Helvetica, sans-serif;line-height: 1.5;">Elektronische Gesundheitskarte und Telematikinfrastruktur</span> </p> 
  <p id="polarion_7"> <br> </p> 
  <p id="polarion_8"> <br> </p> 
  <p id="polarion_9"> <br> </p> 
  <p id="polarion_10"> <br> </p> 
  <p id="polarion_11" style="text-align: center;"> <span style="font-weight: bold;font-size: 28pt;font-family: Arial, Helvetica, sans-serif;line-height: 1.2;">Spezifikation </span> </p> 
  <p id="polarion_233" style="text-align: center;"> <span style="font-weight: bold;font-size: 28pt;font-family: Arial, Helvetica, sans-serif;line-height: 1.2;">Identity Provider-Dienst</span> </p> 
  <p id="polarion_12" style="text-align: center;"></p> 
  <p id="polarion_13"> <br> </p> 
  <p id="polarion_14"> <br> </p> 
  <p id="polarion_15"> <br> </p> 
  <div id="polarion_editor_html_block2" class="polarion-dle-wiki-block"> 
   <div id="polarion_editor_html_block_content" contenteditable="false"></div>
   <pre id="polarion_editor_html_block_source" class="polarion-dle-wiki-block-source" contenteditable="false">
    <table>
     <tr>
      <td>Version</td>
      <td>1.4.0</td>
     </tr>
     <tr>
      <td>Revision</td>
      <td>581753</td>
     </tr>
     <tr>
      <td>Stand</td>
      <td>17.12.2021</td>
     </tr>
     <tr>
      <td>Status</td>
      <td>in Bearbeitung</td>
     </tr>
     <tr>
      <td>Klassifizierung</td>
      <td>öffentlich</td>
     </tr>
     <tr>
      <td>Referenzierung</td>
      <td>gemSpec_IDP_Dienst</td>
     </tr>
    </table></pre> 
  </div> 
  <p id="polarion_16"></p> 
  <h1 id="polarion_wiki macro name=module-workitem;params=id=ML-108571">Dokumentinformationen</h1> 
  <p id="polarion_21"> <span style="font-weight: bold;">Änderungen zur Vorversion</span> </p> 
  <p id="polarion_22">Anpassungen des vorliegenden Dokumentes im Vergleich zur Vorversion können Sie der nachfolgenden Tabelle entnehmen.</p> 
  <p id="polarion_23"></p> 
  <p id="polarion_24" data-keep-next="true"> <span style="font-weight: bold;">Dokumentenhistorie</span> </p> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=25" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 60.4px;height: 38px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Version<br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 67.6px;height: 38px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Stand<br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 50px;height: 38px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Kap./ Seite<br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 276.4px;height: 38px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Grund der Änderung, besondere Hinweise<br> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 94px;height: 38px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Bearbeitung<br> </th> 
    </tr> 
    <tr> 
     <td style="width: 60.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">1.0.0</td> 
     <td style="width: 67.6px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">30.06.20</td> 
     <td style="width: 50px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td> 
     <td style="width: 276.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">initiale Erstellung des Dokuments</td> 
     <td style="width: 94px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="width: 60.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">1.1.0</td> 
     <td style="width: 67.6px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">12.10.20</td> 
     <td style="width: 50px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td> 
     <td style="width: 276.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Einarbeitung Scope-Themen aus R4.0.1</td> 
     <td style="width: 94px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="width: 60.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">1.1.1</td> 
     <td style="width: 67.6px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">13.11.20</td> 
     <td style="width: 50px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td> 
     <td style="width: 276.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Einarbeitung P22.4</td> 
     <td style="width: 94px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="width: 60.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">1.2.0</td> 
     <td style="width: 67.6px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">19.02.21</td> 
     <td style="width: 50px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td> 
     <td style="width: 276.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Einarbeitung P22.5</td> 
     <td style="width: 94px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="width: 60.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">1.3.0</td> 
     <td style="width: 67.6px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">14.06.21</td> 
     <td style="width: 50px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td> 
     <td style="width: 276.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Einarbeitung IDP 2.2.0 (inkl. entsprechender Anteile aus gemF_Tokenverschlüsselung &amp; gemF_Biometrie) und der Änderungsliste IdP_Maintenance_21.1&nbsp;</td> 
     <td style="width: 94px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
    <tr> 
     <td style="width: 60.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">1.4.0</td> 
     <td style="width: 67.6px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">17.12.21</td> 
     <td style="width: 50px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td> 
     <td style="width: 276.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Einarbeitung IDP 2.3.0 (inkl. entsprechender Anteile aus gemF_sektorale_IDP) und der Änderungsliste IdP_CR_Q4&nbsp;</td> 
     <td style="width: 94px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik</td> 
    </tr> 
   </tbody> 
  </table> 
  <h1 id="polarion_wiki macro name=module-workitem;params=id=ML-104148">Inhaltsverzeichnis</h1> 
  <div id="polarion_wiki macro name=toc"></div>
  <div id="toc_container">
   <p class="toc_title"><h1></h1></p>
   <li><a href="#polarion_wiki macro name=module-workitem;params=id=ML-108571">Dokumentinformationen</a></li>
   <li><a href="#polarion_wiki macro name=module-workitem;params=id=ML-104148">Inhaltsverzeichnis</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104149">1 Einordnung des Dokumentes</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104150">1.1 Zielsetzung</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104151">1.2 Zielgruppe</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104152">1.3 Geltungsbereich</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104153">1.4 Abgrenzungen</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104154">1.5 Methodik</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104156">2 Systemüberblick</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-111887">2.1 Allgemeiner Überblick</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-111886">2.2 Detaillierter Überblick</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104157">3 Systemkontext</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104158">3.1 Akteure und Rollen</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-111901">3.2 Begriffsdefinition</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104323">3.3 Verfahrensbeschreibung</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-110717">3.4 Abweichende Verfahrensbeschreibung für Primärsysteme</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104319">3.5 Registrierung Anwendungsfrontend und Fachdienst</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104315">3.6 Anwendungsfrontend vorbereitende Maßnahmen</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104320">3.7 Anfrage eines ACCESS_TOKEN</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104322">3.8 Aufgaben des Authorization-Endpunktes</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104317">3.8.1 Unzureichende Attribute für das Claim</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104313">3.8.2 Erstellung des AUTHORIZATION_CODE</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104310">3.9 Einreichen des AUTHORIZATION_CODE</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104307">3.10 Aufgabe des Token-Endpunktes</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104324">3.11 Einreichen des ACCESS_TOKEN beim Fachdienst</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104321">3.12 Aufgabe des Fachdienstes</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104160">4 Zerlegung des Produkttyps</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-111124">4.1.1 Allgemeine Sicherheitsanforderungen</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-111125">4.1.2 Sicherheit der Netzübergänge</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104314">4.2 Fehlermeldungen</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-109653">4.3 Schnittstellenbeschreibung des IDP-Dienstes</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-111134">4.4 Identifikation des Clientsystems</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-126089">4.5 Unterstützung der Anmeldung mittels sektoraler Identity Provider</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104162">5 Funktionsmerkmale</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-108513">5.1 Authorization Server Metadata (Discovery Document)</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-108512">5.1.1 Aufbau des Discovery Documents</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-108515">5.1.2 Erneuerung des Discovery Documents</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-108514">5.1.3 Schutz des Discovery Document</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-126111">5.1.4 Liste der registrierten Authenticator Module sektoraler Identity Provider</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104338">5.2 Authorization-Endpunkt</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104347">5.2.1 Authorization Server Eingangsdaten</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104344">5.2.2 Authorization-Endpunkt Ausgangsdaten</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104341">5.3 Token-Endpunkt</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104345">5.3.1 Token-Endpunkt Eingangsdaten</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104342">5.3.2 Token-Endpunkt Ausgangsdaten</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119229">5.4 Pairing-Endpunkt</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-120406">5.4.1 Zielsetzung</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-120287">5.4.2 Technisches Konzept</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-120286">5.4.2.1 Bewertung von Gerätetypen</a></li>
   <li> : : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-120369">5.4.2.1.1 Spezifikation</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-120288">5.4.2.2 Erweiterung des IDP-Dienstes um einen Pairing-Endpunkt</a></li>
   <li> : : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-120375">5.4.2.2.1 Spezifikation</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-120374">5.4.2.3 Daten und Kommunikationsstrukturen</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-120290">5.4.2.4 Nomenklatur Schlüsselmaterial</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-120307">5.4.2.5 Registrierung von alternativen Authentisierungsmitteln</a></li>
   <li> : : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-120310">5.4.2.5.1 Erläuterungen zum Registrierungsprozess</a></li>
   <li> : : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-120370">5.4.2.5.2 Spezifikation</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-120319">5.4.2.6 Verwendung von alternativen Authentisierungsmitteln</a></li>
   <li> : : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-120289">5.4.2.6.1 Erweiterung des Authorization-Endpunkts</a></li>
   <li> : : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-120317">5.4.2.6.2 Erläuterungen zur Verwendung von alternativen Authentisierungsmitteln</a></li>
   <li> : : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-120371">5.4.2.6.3 Spezifikation</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-120372">5.4.2.7 Inspektion und De-Registrierung der am Pairing-Endpunkt gespeicherten Daten</a></li>
   <li> : : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-120322">5.4.2.7.1 Inspektion am Pairing-Endpunkt</a></li>
   <li> : : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-120321">5.4.2.7.2 Deregistrierung von alternativen Authentisierungsmitteln</a></li>
   <li> : : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-120373">5.4.2.7.3 Spezifikation</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-126102">5.5 Third-Party Authorization Endpoint</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-126100">5.5.1.1 Third-Party Authorization-Endpunkt Eingangsdaten</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-126103">5.5.1.2 Third-Party Authorization-Endpunkt Ausgangsdaten</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104177">6 Anhang A – Verzeichnisse</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104178">6.1 Abkürzungen</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104179">6.2 Glossar</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104180">6.3 Abbildungsverzeichnis</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104181">6.4 Tabellenverzeichnis</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104182">6.5 Referenzierte Dokumente</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104183">6.5.1 Dokumente der gematik</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-104184">6.5.2 Weitere Dokumente</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119214">7 Anhang B - Beispiele der Objekte und Aufrufe</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119738">7.1 Authorization Request</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119740">7.2 Authorization Response</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119924">7.3 Authentication Request</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119928">7.3.1 Authentication Request (SSO)</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119926">7.4 Authentication Response</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119927">7.4.1 Authentication Response (SSO Flow)</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119931">7.5 Token Request</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119929">7.6 Token Response</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119930">7.7 Aufbau des Discovery Document</a></li>
   <li> : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119190">8 Anhang C - Datenformate und Kommunikationsprotokolle im Zusammenhang mit alternativen Authentisierungsverfahren</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119213">8.1 Datentypen</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119225">8.1.1 Übergeordnete Anforderungen</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119227">8.1.1.1 Kodierung</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119221">8.1.1.2 Versionierung</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119223">8.1.1.3 Namen und Claims</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119217">8.1.2 Datentyp "Device_Type"</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119219">8.1.3 Datentyp "Device_Information"</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119174">8.1.4 Datentyp "Pairing_Data"</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119172">8.1.5 Datentyp "Signed_Pairing_Data"</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119170">8.1.6 Datentyp "Registration_Data"</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119168">8.1.7 Datentyp "Encrypted_Registration_Data"</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119166">8.1.8 Datentyp "Authentication_Data"</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119183">8.1.9 Datentyp "Signed_Authentication_Data"</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119182">8.1.10 Datentyp "Encrypted_Signed_Authentication_Data"</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119181">8.1.11 Datentyp "Pairing_Entry"</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119180">8.1.12 Datentyp "Pairing_Entries"</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119179">8.2 Ausgestaltung der Kommunikation mit dem IDP-Dienst</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119194">8.2.1 Registrierung von alternativen Authentisierungsmitteln</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119192">8.2.1.1 Request des Authenticator-Moduls bei Registrierung</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119191">8.2.1.2 Response des Pairing-Endpunkts bei Registrierung</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119189">8.2.2 Verwendung von alternativen Authentisierungsmitteln</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119188">8.2.2.1 Request des Authenticator-Moduls bei Verwendung von alternativen Authentisierungsmitteln</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119187">8.2.2.2 Response des Authorization-Endpunkts bei Verwendung von alternativen Authentisierungsmitteln</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119201">8.2.3 Inspektion von Pairing-Daten am Pairing-Endpunkt</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119200">8.2.3.1 Request des Authenticator-Moduls zur Inspektion</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119199">8.2.3.2 Response des Pairing-Endpunkts bei Inspektion</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119198">8.2.4 Deregistrierung von Pairing-Daten am Pairing-Endpunkt</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119208">8.2.4.1 Request des Authenticator-Moduls zur Deregistrierung</a></li>
   <li> : : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119207">8.2.4.2 Response des Pairing-Endpunkts bei Deregistrierung</a></li>
   <li> : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119206">8.3 Vergleichsoperationen</a></li>
   <li> : : : <a href="#polarion_wiki macro name=module-workitem;params=id=ML-119205">8.3.1 Registrierung</a></li>
  </div> 
  <p id="polarion_219"></p> 
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-104149">1 Einordnung des Dokumentes</h2> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104150">1.1 Zielsetzung</h3> 
  <p id="polarion_156"> Die vorliegende Spezifikation definiert die Anforderungen zu Herstellung, Test und Betrieb des Produkttyps Identity Provider (IDP)-Dienst. Der IDP-Dienst basiert auf den Standards OpenID Connect (OIDC), Open Authorization 2.0 (OAuth 2) und JSON Web Token (JWT). Die hier beschriebenen Schnittstellen werden vom Authenticator-Modul und vom Anwendungsfrontend für eine Authentifizierung eines Nutzers anhand einer Smartcard genutzt. Diese Authentifikation ist die Voraussetzung, damit ein Anwendungsfrontend Zugang zu Fachdaten eines Fachdienstes erlangen kann.&nbsp;Der IDP-Dienst verwaltet und steuert den <span style="font-size: 10pt;line-height: 1.5;">Authentifizierungsprozess&nbsp;</span>für das E-Rezept und perspektivisch auch für weitere Anwendungen. </p> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104151">1.2 Zielgruppe</h3> 
  <p id="polarion_44">Das Dokument richtet sich an Hersteller und Anbieter von Identity Providern, welche die Funktionen des&nbsp;IDP-Dienstes der gematik realisieren wollen.</p> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104152">1.3 Geltungsbereich</h3> 
  <p id="polarion_53">Dieses Dokument enthält normative Festlegungen zur Telematikinfrastruktur (TI) des deutschen Gesundheitswesens. Der Gültigkeitszeitraum der vorliegenden Version und deren Anwendung in Zulassungs- oder Abnahmeverfahren wird durch die gematik GmbH in gesonderten Dokumenten (z.B. Dokumentenlandkarte, Produkttypsteckbrief, Leistungsbeschreibung) festgelegt und bekannt gegeben.</p> 
  <p id="polarion_54"></p> 
  <p id="polarion_120"> <span style="font-weight: bold;">Schutzrechts-/Patentrechtshinweis</span> </p> 
  <p id="polarion_55"> Die nachfolgende Spezifikation ist von der gematik allein unter technischen Gesichtspunkten erstellt worden. Im Einzelfall kann nicht ausgeschlossen werden, dass die Implementierung der Spezifikation in technische Schutzrechte Dritter eingreift. Es ist allein Sache des Anbieters oder Herstellers, durch geeignete Maßnahmen dafür Sorge zu tragen, dass von ihm aufgrund der Spezifikation angebotene Produkte und/oder Leistungen nicht gegen Schutzrechte Dritter verstoßen und sich ggf. die erforderlichen Erlaubnisse/Lizenzen von den betroffenen Schutzrechtsinhabern einzuholen. Die gematik GmbH übernimmt insofern keinerlei Gewährleistungen.<span style="font-style: italic;font-size: 10pt;font-family: Arial, Helvetica, sans-serif;line-height: 1.5;"><span id="polarion-comment:1637"></span></span> </p> 
  <p id="polarion_18"></p> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104153">1.4 Abgrenzungen</h3> 
  <p id="polarion_68"></p> 
  <p id="polarion_91"> Nicht Bestandteil des vorliegenden Dokumentes sind die Verfahrensschritte zur Erstellung des notwendigen Schlüsselmaterials. Es wird angenommen, dass Fachdienste ihre innerhalb der TI zu verwendenden Zertifikate für die Transport Layer Security (TLS)-Sicherung über zentrale Plattformdienste der TI beziehen und diese dort auch geprüft werden können. Außerhalb des TI Netzes können TLS-Zertifikate von den Mitgliedern des CA/Browser Forum als übliche Anbieter solcher Zertifikate bezogen werden. Diese sind über Standardmechanismen prüfbar und erfordern keine besondere Behandlung der PKI. Wenn notwendig werden weitere Schutzmechanismen wie Zertifikat-Pinning, Certification Authority Authorization (CAA) Records oder ein Monitoring mittels&nbsp;Certificate Transparency (CT) vorgesehen.<span id="polarion-comment:1638"></span> </p> 
  <p id="polarion_40">Als Umsetzungsleitlinie ist [OpenID Connect Core 1.0] heranzuziehen. Die TI-weit übergreifenden Festlegungen – insbesondere aus Dokumenten wie beispielsweise [gemSpec_Krypt] bezüglich Algorithmen und Schlüsselstärken sowie [gemSpec_PKI] bezüglich zu verwendender Zertifikatstypen und deren Attributausprägungen – haben Bestand, sind weiterhin bindend und werden nicht in diesem Dokument beschrieben.</p> 
  <p id="polarion_41"></p> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104154">1.5 Methodik</h3> 
  <p id="polarion_65">Anforderungen als Ausdruck normativer Festlegungen werden durch eine eindeutige ID in eckigen Klammern sowie die dem RFC 2119 [RFC2119] entsprechenden, in Großbuchstaben geschriebenen deutschen Schlüsselworte MUSS, DARF NICHT, SOLL, SOLL NICHT, KANN gekennzeichnet.</p> 
  <p id="polarion_66"></p> 
  <p id="polarion_67"> Sie werden im Dokument wie folgt dargestellt:<span style="font-weight: bold;font-family: Wingdings;"><br> </span> <span style="font-weight: bold;">&lt;AFO-ID&gt; - &lt;Titel der Afo&gt;</span><br> Text / Beschreibung<br> [&lt;=] </p> 
  <p id="polarion_69" style="margin-left: 0px;">Dabei umfasst die Anforderung sämtliche zwischen Afo-ID und der Textmarke [&lt;=] angeführten Inhalte.</p> 
  <p id="polarion_71"></p> 
  <p id="polarion_121"> <span style="font-weight: bold;">Hinweise auf offene Punkte</span> </p> 
  <table id="polarion_wiki macro name=table;params=header=no|width=100%|uid=220" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 591.6px;height: 18.8px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-style: italic;color: #3366FF;">Offene Punkten werden im Dokument in dieser Darstellung ausgewiesen.</span></td> 
    </tr> 
   </tbody> 
  </table> 
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-104156">2 Systemüberblick</h2> 
  <p id="polarion_243"></p> 
  <p id="polarion_81"> <span style="font-size: 10pt;line-height: 1.5;">Im Rahmen der kontinuierlichen Erweiterung der Vorgaben für Identity Provider innerhalb der TI werden&nbsp; die Vorgaben weiter angepasst werden. Dies beinhaltet Festlegungen zur Einführung föderierter Identity Provider, die Unterstützung weiterer Anwendungen und Nutzungsszenarien, Vorgaben für zulässige Authentisierungsverfahren, Schnittstellen für die Inter-App-Kommunikation zu einer getrennten Authenticator-Anwendung sowie die mögliche Einführung weiterer Endpunkte entsprechend [openid-connect-core].&nbsp;</span> </p> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-111887">2.1 Allgemeiner Überblick</h3> 
  <p id="polarion_167"> In der Telematikinfrastruktur werden zahlreiche Fachdienste angeboten. Anwendungsfrontends können über die Authentifizierung des Nutzers am IDP-Dienst Zugriff zu den von den Fachdiensten angebotenen Daten erhalten. Der IDP-Dienst stellt durch gesicherte JSON Web Token (JWT) attestierte Identitäten aus. Gegen Vorlage eines&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span>&nbsp;erhalten Anwendungsfrontends – entsprechend der im Token attestierten <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">professionOID</span> – Zugriff auf die Inhalte der Fachdienste. </p> 
  <p id="polarion_27" style="text-align: center;"> <span style="font-family: Arial, Helvetica;">&nbsp;<img src="attachments/IdP-einfache-Übersicht-2020-08-12.png" style="width: 650px;height: 352px;" data-lastmodified="2020-08-12T06:23:44.856+02:00"></span> </p> 
  <p id="polarion_43" style="text-align: center;"></p> 
  <p id="polarion_46" style="text-align: center;"> <span style="font-family: Arial, Helvetica;"> </span> </p> 
  <p id="polarion_58" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">1</span>: Systemüberblick (vereinfacht) </p> 
  <p id="polarion_59"></p> 
  <p id="polarion_60">Die obige Abbildung stellt den Systemüberblick dar. Der Authentifizierungsprozess, welcher mit der Ausstellung und Übergabe der Token an das Anwendungsfrontend endet, wird dabei zur besseren Übersicht vereinfacht dargestellt.</p> 
  <p id="polarion_92" class="MsoNormal"> Der IDP-Dienst übernimmt für den Fachdienst die Aufgabe der Identifikation des Nutzers. Der IDP-Dienst fasst die <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">professionOID</span> sowie weitere für den Fachdienst notwendige Attribute in signierten JSON Web Token (<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span><span style="font-family: Arial, Helvetica;">, </span><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span><span style="font-family: Arial, Helvetica;"> </span>und <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span>) zusammen. Fachdienste müssen keine Überprüfung des Nutzers selbst implementieren, sondern können sich darauf verlassen, dass der Besitzer des bei ihnen vorgetragenen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN </span>bereits identifiziert wurde. Des Weiteren stellt der IDP-Dienst sicher, dass die vom Nutzer vorgetragenen Attribute (aus dem Signaturzertifikat) gültig sind. </p> 
  <p id="polarion_94" class="MsoNormal">Der IDP-Dienst prüft, ob das vorgetragene X.509-nonQES-Signatur-Zertifikat der verwendeten Prozessor-Chipkarte (eGK, HBA oder SMC-B) für die vorgesehene Laufzeit des Tokens zeitlich gültig und ob dessen Integrität sichergestellt&nbsp;ist.</p> 
  <p id="polarion_153" class="MsoNormal"> Der IDP-Dienst stellt nur solche <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> aus, welche auf gültigen AUT-Zertifikaten (d.h. C.CH.AUT, C.HP.AUT oder C.HCI.AUT) basieren. </p> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-111886">2.2 Detaillierter Überblick</h3> 
  <p id="polarion_159"> Der IDP-Dienst führt die Identifikation des Nutzers durch und stattet diesen mit einem&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span> gemäß [<a href="https://openid.net/specs/openid-connect-core-1_0.html#IDToken" target="_top" class="descriptionLink">openid-connect-core 1.0 # IDToken</a>],<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">&nbsp;einem ACCESS_TOKEN</span> gemäß [<a href="https://tools.ietf.org/html/rfc6749#section-1.4" target="_top" class="descriptionLink">RFC6749 # section-1.4</a>] und einem&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> basierend auf [<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;"><a href="https://tools.ietf.org/html/rfc7519" target="_top" class="descriptionLink">RFC7519</a></span>]&nbsp;aus. Gewählt wird aus Sicherheitsaspekten der <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">Authorization Code Grant</span> gemäß [<a href="https://tools.ietf.org/html/rfc6749#section-4.1" target="_top" class="descriptionLink">RFC6749 # section-4.1</a>]. &nbsp;Die Verwendung von PKCE (Proof Key for Code Exchange by OAuth Public Clients) gemäß [<a href="https://tools.ietf.org/html/rfc7636" target="_top" class="descriptionLink">RFC7636</a>] wird gefordert. </p> 
  <p id="polarion_32">Der IDP-Dienst teilt sich in mehrere Teildienste auf. Einzelne Teildienste werden zentral und bei Bedarf auf unterschiedlicher Hardware verteilt betrieben. Das Authenticator-Modul wird grundsätzlich auf dezentraler Hardware zusammen mit dem Primärsystem oder auf dem mobilen Endgerät des Nutzers betrieben. Der IDP-Dienst stellt unterschiedliche Endpunkte bereit, welche&nbsp;eine statische IP-Adressierung und somit statische URI besitzen. Diese statisch adressierten Endpunkte umfassen:</p> 
  <ul id="polarion_33"> 
   <li>Discovery-Endpunkt ("OAuth 2.0 Authorization Server Metadata" [<a href="https://tools.ietf.org/html/rfc8414" target="_top" class="descriptionLink">RFC8414</a>])<br> <br> </li> 
   <li>Redirection-Endpunkt (Teil des "The OAuth 2.0 Authorization Framework" [<a href="https://tools.ietf.org/html/rfc6749#section-3.1.2" target="_top" class="descriptionLink">RFC6749 # section-3.1.2</a>&nbsp;])&nbsp;<br> </li> 
  </ul> 
  <ul id="polarion_34"> 
   <li>Authorization-Endpunkt (Teil des "The OAuth 2.0 Authorization Framework" [<a href="https://tools.ietf.org/html/rfc6749" target="_top" class="descriptionLink">RFC6749</a>])</li> 
  </ul> 
  <ul id="polarion_38"> 
   <li>Token-Endpunkt ([<a href="https://tools.ietf.org/html/rfc6749#section-3.2" target="_top" class="descriptionLink">RFC6749 # section-3.2</a>])<br> Teildienst 1 <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span>&nbsp;([<a href="https://openid.net/specs/openid-connect-core-1_0.html#IDToken" target="_top" class="descriptionLink">openid-connect-core 1.0 # IDToken</a>])<br> Teildienst 2 <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span>&nbsp;([<a href="https://tools.ietf.org/html/rfc6749#section-1.4" target="_top" class="descriptionLink">RFC6749 # section-1.4</a> &amp; <a href="https://tools.ietf.org/html/rfc6749#section-5" target="_top" class="descriptionLink">RFC6749 # section-5</a>])<br> Teildienst 3 <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">(</span>[<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;"><a href="https://tools.ietf.org/html/rfc7519" target="_top" class="descriptionLink">RFC7519</a></span>]).<br> </li> 
  </ul> 
  <p id="polarion_197">Im folgenden Schaubild sind die vom IDP-Dienst bereitgestellten Teildienste blau hinterlegt.</p> 
  <p id="polarion_199">Teildienste wie das Authenticator-Modul und das Anwendungsfrontend befinden sich in dem mit "Gerät des Nutzers" bezeichneten Bereich.</p> 
  <p id="polarion_200">Fachdienste sind nicht näher bestimmt und befinden sich im Block unterhalb des Identity Providers.</p> 
  <p id="polarion_45" style="text-align: center;"> <img src="attachments/übersichtsbild-2020-08-13.PNG" style="max-width: 750px;" data-lastmodified="2020-08-13T06:20:19.824+02:00"> </p> 
  <p id="polarion_49" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">2</span>: Übersichtsschaubild OAuth2.0 Smartcard-IDP-Dienst </p> 
  <p id="polarion_50"></p> 
  <p id="polarion_80"> Erläuterungen zur obigen Abbildung:<br> Die Teilschritte (1) und (5) werden bei&nbsp;mobilen Endgeräten (FdV) via Redirection-Endpunkt [<a href="https://tools.ietf.org/html/rfc6749#section-3.1.2" target="_top" class="descriptionLink">RFC6749 # section-3.1.2</a>] realisiert.<br> Die Teilschritte (1) und (5) können bei Primärsystemen (PVS, AVS, KVS) abweichend&nbsp;von [<a href="https://tools.ietf.org/html/rfc6749#section-9" target="_top" class="descriptionLink">RFC6749 # section-9</a>] behandelt werden.<br> Die Teilschritte (2) und (4) werden durch den Authorization-Endpunkt gemäß [<a href="https://tools.ietf.org/html/rfc6749#section-3.1" target="_top" class="descriptionLink">RFC6749 # section-3.1</a>] bedient. <br> Der Teilschritt (3) Challenge-Response wird durch den Authorization-Endpunkt bedient.<br> Die Teilschritte (6) und (7) werden durch den Token-Endpunkt [<a href="https://tools.ietf.org/html/rfc6749#section-3.2" target="_top" class="descriptionLink">RFC6749 # section-3.2</a>] bedient. </p> 
  <p id="polarion_194">Der hier gezeigte Smartcard-IDP-Dienst stellt eine Basisleistung innerhalb der TI dar und soll die sichere Identifikation der Akteure anhand der ihnen bereitgestellten Identifikationsmittel (Smartcards) ermöglichen. Der Standard lässt hierbei die Einbringung weiterer Identity Provider für unterschiedlichste Identifikationsverfahren zu, ohne dass Fachdienste hierfür eine Änderung der Zugangsmechanismen realisieren müssen.</p> 
  <p id="polarion_212"> Die Umsetzung basiert grundsätzlich auf [<a href="https://openid.net/specs/openid-connect-core-1_0.html" target="_top" class="descriptionLink">OpenID Connect Core v1.0</a>] und [<a href="https://openid.net/specs/openid-connect-discovery-1_0.html" target="_top" class="descriptionLink">OpenID Connect Discovery v1.0</a>]. </p> 
  <p id="polarion_113"> Weitere zu beachtende Standards sind die folgenden:<br> Request for Comments&nbsp;JWT (JSON Web Token) [<a href="https://tools.ietf.org/html/rfc7519" target="_top" class="descriptionLink">RFC7519</a>&nbsp;], JWS (JSON Web Signature) [<a href="https://tools.ietf.org/html/rfc7515" target="_top" class="descriptionLink">RFC7515</a>&nbsp;], JWE (JSON Web Encryption) [<a href="https://tools.ietf.org/html/rfc7516" target="_top" class="descriptionLink">RFC7516</a>&nbsp;], JWK (JSON Web Key) [<a href="https://tools.ietf.org/html/rfc7517" target="_top" class="descriptionLink">RFC7517</a>&nbsp;], JWA (JSON Web Algorithm) [<a href="https://tools.ietf.org/html/rfc7518" target="_top" class="descriptionLink">RFC7518</a>] und WebFinger [<a href="https://tools.ietf.org/html/rfc7033" target="_top" class="descriptionLink">RFC7033</a>] sowie OAuth 2.0 Bearer [<a href="https://tools.ietf.org/html/rfc6750" target="_top" class="descriptionLink">RFC6750</a>], OAuth 2.0 Assertion [<a href="https://tools.ietf.org/html/rfc7521" target="_top" class="descriptionLink">RFC7521</a>], OAuth 2.0 JWT Profile [<a href="https://tools.ietf.org/html/rfc7523" target="_top" class="descriptionLink">RFC7523</a>], OAuth 2.0 Responses [<a href="https://tools.ietf.org/html/rfc6749" target="_top" class="descriptionLink">RFC6749</a>&nbsp;]. </p> 
  <p id="polarion_214"> Die Gesamtliste der referenzierten Standards finden sich im Abschnitt <span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-104184" data-option-id="longoutline"></span>. </p> 
  <p id="polarion_216"></p> 
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-104157">3 Systemkontext</h2> 
  <p id="polarion_19" class="MsoNormal"> Die untere Abbildung beschreibt den Systemkontext aus Sicht des IDP-Dienstes. Das Authenticator-Modul liefert die Daten zur Authentifizierung des Nutzers an den IDP-Dienst. Bei positiver Validierung – gegen den OCSP/TSL-Dienst der Public Key Infrastructure (PKI) der gematik – liefert der IDP-Dienst einen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> zurück. Der IDP-Dienst liefert ebenso einen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span>, wodurch das Authenticator-Modul einen weiteren <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> ohne erneute Nutzerauthentifizierung erhalten kann. </p> 
  <p id="polarion_75"> Das Anwendungsfrontend registriert sich innerhalb eines organisatorischen Prozesses am IDP-Dienst. Das Anwendungsfrontend erlangt gegen Vorlage des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> einen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span> und einen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span>. Das Anwendungsfrontend erhält gegen Vorlage des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> Zugang zu den Fachdaten des Fachdienstes. </p> 
  <p id="polarion_139">Der Fachdienst registriert sich am IDP-Dienst in Form eines organisatorischen Prozesses.</p> 
  <p id="polarion_140" style="text-align: center;"> <img src="attachments/Systemkontext-IdP.png" style="width: 526px;height: 378px;" data-lastmodified="2020-08-03T00:15:31.688+02:00"> </p> 
  <p id="polarion_158"></p> 
  <p id="polarion_168" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">3</span>: Systemkontext aus Sicht des IDP-Dienstes </p> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104158">3.1 Akteure und Rollen</h3> 
  <p id="polarion_36"> Im Systemkontext des IDP-Dienstes interagieren verschiedene Akteure (Nutzer und aktive Komponenten) in unterschiedlichen OAuth2-Rollen gemäß [<a href="https://tools.ietf.org/html/rfc6749#section-1.1" target="_top" class="descriptionLink">RFC6749 # section-1.1</a>]. </p> 
  <p id="polarion_73" class="MsoNormal"></p> 
  <p id="polarion_141" style="margin-left: 0px;text-align: left;" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">1</span>:&nbsp;TAB_IDP_DIENST_0001 Akteure und OAuth2-Rollen </p> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=158" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 275px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">Akteur</th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 305px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">OAuth2-Rolle</th> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 275px;height: 18px;border: 1px solid #CCCCCC;padding: 5px;">Nutzer</td> 
     <td style="text-align: left;vertical-align: top;width: 305px;height: 18px;border: 1px solid #CCCCCC;padding: 5px;">Resource Owner</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 275px;height: 18px;border: 1px solid #CCCCCC;padding: 5px;">Fachdienst</td> 
     <td style="text-align: left;vertical-align: top;width: 305px;height: 18px;border: 1px solid #CCCCCC;padding: 5px;">Resource Server</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 275px;height: 18px;border: 1px solid #CCCCCC;padding: 5px;">Anwendungsfrontend</td> 
     <td style="text-align: left;vertical-align: top;width: 305px;height: 18px;border: 1px solid #CCCCCC;padding: 5px;">Teil des Clients</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 275px;height: 18px;border: 1px solid #CCCCCC;padding: 5px;">Authenticator-Modul</td> 
     <td style="text-align: left;vertical-align: top;width: 305px;height: 18px;border: 1px solid #CCCCCC;padding: 5px;">Teil des Clients</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 275px;height: 18px;border: 1px solid #CCCCCC;padding: 5px;">IDP-Dienst</td> 
     <td style="text-align: left;vertical-align: top;width: 305px;height: 18px;border: 1px solid #CCCCCC;padding: 5px;">Authorization Server</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 275px;height: 18px;border: 1px solid #CCCCCC;padding: 5px;">Fachdaten</td> 
     <td style="text-align: left;vertical-align: top;width: 305px;height: 18px;border: 1px solid #CCCCCC;padding: 5px;">Protected Resource</td> 
    </tr> 
   </tbody> 
  </table> 
  <p id="polarion_196" class="MsoNormal"></p> 
  <p id="polarion_205"> <span style="font-weight: bold;">Nutzer (Rolle: Resource Owner)</span> </p> 
  <p id="polarion_206" class="MsoNormal">Der Resource Owner ist der Nutzer, welcher auf die beim Fachdienst (Resource Server) für ihn bereitgestellten Daten (Protected Resource) zugreift.</p> 
  <p id="polarion_207">Der Resource Owner verfügt über die folgenden Komponenten:</p> 
  <p id="polarion_208" style="margin-left: 36pt;" class="MsoListParagraph"> <span style="font-family: Symbol, 'Symbol Regular';">·<span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Endgerät des Nutzers </p> 
  <p id="polarion_209" style="margin-left: 36pt;" class="MsoListParagraph"> <span style="font-family: Symbol, 'Symbol Regular';">·<span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Authenticator-Modul </p> 
  <p id="polarion_210" style="margin-left: 36pt;" class="MsoListParagraph"> <span style="font-family: Symbol, 'Symbol Regular';">·<span style="font-size: 8pt;font-family: 'Times New Roman', Times;line-height: 1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Anwendungsfrontend </p> 
  <p id="polarion_211" class="MsoNormal"></p> 
  <p id="polarion_213"> <span style="font-weight: bold;">Fachdienst (Rolle: Resource Server)</span> </p> 
  <p id="polarion_215"> Der Resource Server ist der Fachdienst, der dem Nutzer (Resource Owner) Zugriff auf seine Fachdaten (Protected Resource) gewährt. Der Fachdienst, der die geschützten Fachdaten (Protected Resources) anbietet, ist in der Lage, auf Basis von <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> Zugriff für Clients zu gewähren. Ein solches Token repräsentiert die delegierte Identifikation des Resource Owners. </p> 
  <p id="polarion_217"></p> 
  <p id="polarion_218"> <span style="font-weight: bold;">Anwendungsfrontend/Authenticator-Modul kombiniert in einer Applikation (Rolle: Client)</span> </p> 
  <p id="polarion_220" class="MsoNormal">Der Client&nbsp; greift mit dem Authenticator-Modul und dem Anwendungsfrontend (OIDC Relying Party bzw. OAuth2 Client) auf&nbsp; Fachdienste (Resource Server) und ihre geschützten Fachdaten (Protected Resource) zu. Das Anwendungsfrontend kann auf einem Server als Webanwendung (Primärsystem als Terminalserver), auf einem Desktop-PC oder einem mobilen Gerät (z.B. Smartphone) ausgeführt werden.</p> 
  <p id="polarion_222"></p> 
  <p id="polarion_223"> <span style="font-weight: bold;">IDP-Dienst (Rolle: Authorization Server)</span> </p> 
  <p id="polarion_225" class="MsoNormal"> Der Authorization Server authentifiziert den Resource Owner&nbsp;(Nutzer) und stellt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span><span style="font-family: Arial, Helvetica;">, </span><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span><span style="font-family: Arial, Helvetica;"> und </span><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span><span style="font-family: Arial, Helvetica;"><span style="font-weight: bold;">&nbsp;</span>f</span>ür den vom Resource Owner erlaubten Anwendungsbereich (SCOPE) aus, welche dieser wiederum beim Fachdienst einreicht.<br> </p> 
  <p id="polarion_30" style="text-align: left;" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">2</span>:&nbsp;TAB_IDP_DIENST_0002 Kurzbezeichnung der Schnittstellen des IDP-Dienstes </p> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=229" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 193px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">Kurzzeichen</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 538px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">Schnittstelle</th> 
    </tr> 
    <tr> 
     <td style="width: 193px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">AUTH</td> 
     <td style="width: 538px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">Authorization-Endpunkt</td> 
    </tr> 
    <tr> 
     <td style="width: 193px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">TOKEN</td> 
     <td style="width: 538px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">Token-Endpunkt</td> 
    </tr> 
    <tr> 
     <td style="width: 193px;height: 18px;border: 1px solid #CCCCCC;padding: 5px;">REDIR</td> 
     <td style="width: 538px;height: 18px;border: 1px solid #CCCCCC;padding: 5px;">Redirection-Endpunkt</td> 
    </tr> 
    <tr> 
     <td style="width: 193px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">DD</td> 
     <td style="width: 538px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">Discovery Document-Endpunkt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td> 
    </tr> 
   </tbody> 
  </table> 
  <p id="polarion_230" class="MsoListParagraph"></p> 
  <p id="polarion_231">Weitere Akteure im Kontext IDP-Dienst sind:</p> 
  <p id="polarion_232" class="MsoNormal"> <span style="font-weight: bold;">Fachdaten (Rolle: Protected Resource)</span> </p> 
  <p id="polarion_234">Die geschützten Fachdaten, welche vom Fachdienst (Resource Server) angeboten werden.</p> 
  <p id="polarion_89"></p> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-111901">3.2 Begriffsdefinition</h3> 
  <p id="polarion_96" class="MsoNormal"> Die folgende Tabelle enthält die Abkürzungen (für die privaten Schlüssel PrK und für öffentliche Schlüssel PUK) der verschiedenen Endpunkte des IDP-Dienstes und deren Verwendung.<br> </p> 
  <p id="polarion_42" style="text-align: left;" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">3</span>:&nbsp;TAB_IDP_DIENST_0003 Bezeichnungen der extern genutzten Schlüssel und Adressen des IDP-Dienstes </p> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=101" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 194px;height: 18.9091px;border: 1px solid #CCCCCC;padding: 5px;"> 
      <div style="text-align: center;">
        &nbsp; 
      </div> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 174px;height: 18.9091px;border: 1px solid #CCCCCC;padding: 5px;"> 
      <div style="text-align: center;">
        PUK 
      </div> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 164px;height: 18.9091px;border: 1px solid #CCCCCC;padding: 5px;"> 
      <div style="text-align: center;">
        private Key 
      </div> </th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 177px;height: 18.9091px;border: 1px solid #CCCCCC;padding: 5px;"> 
      <div style="text-align: center;">
        URI Dienst 
      </div> </th> 
    </tr> 
    <tr> 
     <td style="width: 194px;height: 37.8182px;border: 1px solid #CCCCCC;padding: 5px;">Authorization-Endpunkt (AUTH)<br> </td> 
     <td style="width: 174px;height: 37.8182px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PuK_IDP_SIG</span><br> <br> -&nbsp;für&nbsp;die&nbsp;Signaturprüfung&nbsp;des<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE_TOKEN</span>, des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> und des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> <br> -&nbsp; kodiert in einem FD.SIG-Zertifikat <br> <br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PuK_IDP_ENC</span><br> <br> - für die Verschlüsselung der signierten Challenge durch das Authenticator-Modul<br> </td> 
     <td style="width: 164px;height: 37.8182px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PrK_IDP_SIG</span><br> <br> -&nbsp;zum&nbsp;Signieren&nbsp;des&nbsp;<br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE_TOKEN</span>&nbsp;des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> und des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span>&nbsp; &nbsp; <br> <br> <br> <br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PrK_IDP_ENC</span> <br> <br> - zum Entschlüsseln der signierten Challenge<br> </td> 
     <td style="width: 177px;height: 37.8182px;border: 1px solid #CCCCCC;padding: 5px;"> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">URI_AUTH</span><br> (authorization_endpoint)&nbsp; &nbsp; <br> <br> <br> <br> <br> <br> <br> <br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">URI_AUTH_SSO </span>(sso_endpoint)<br> </td> 
    </tr> 
    <tr> 
     <td style="width: 194px;height: 18.9091px;border: 1px solid #CCCCCC;padding: 5px;">Discovery-Endpunkt (DISC)<br> </td> 
     <td style="width: 174px;height: 18.9091px;border: 1px solid #CCCCCC;padding: 5px;"> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PuK_DISC_SIG</span><br> <br> - für die Signaturprüfung des Discovery Document<br> -&nbsp; kodiert in einem FD.SIG-Zertifikat<br> </td> 
     <td style="width: 164px;height: 18.9091px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PrK_DISC_SIG</span><br> <br> - zum Signieren des Discovery Document<br> </td> 
     <td style="width: 177px;height: 18.9091px;border: 1px solid #CCCCCC;padding: 5px;"> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">URI_DISC</span><br> </td> 
    </tr> 
    <tr> 
     <td style="width: 194px;height: 18.9091px;border: 1px solid #CCCCCC;padding: 5px;">Token-Endpunkt (TOKEN)<br> </td> 
     <td style="width: 174px;height: 18.9091px;border: 1px solid #CCCCCC;padding: 5px;"> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PuK_IDP_SIG</span><br> <br> - für die Signaturprüfung des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span> und des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> <br> - kodiert in einem FD.SIG-Zertifikat<br> <br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PuK_IDP_ENC</span><br> <br> - für die Verschlüsselung des KEY_VERIFIER durch das Anwendungsfrontend<br> </td> 
     <td style="width: 164px;height: 18.9091px;border: 1px solid #CCCCCC;padding: 5px;"> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PrK_IDP_SIG</span><br> <br> - zum Signieren des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span> und des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> <br> <br> <br> <br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PrK_IDP_ENC</span><br> <br> - für die Entschlüsselung des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> für den Pairing-Vorgang<br> </td> 
     <td style="width: 177px;height: 18.9091px;border: 1px solid #CCCCCC;padding: 5px;"> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">URI_TOKEN</span> (token_endpoint)<br> </td> 
    </tr> 
    <tr> 
     <td style="width: 194px;height: 18.9091px;border: 1px solid #CCCCCC;padding: 5px;">Pairing-Endpunkt (PAIR)</td> 
     <td style="width: 174px;height: 18.9091px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PuK_IDP_ENC</span><br> <br> - für die Verschlüsselung des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> für den Pairing-Vorgang</td> 
     <td style="width: 164px;height: 18.9091px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PrK_IDP_ENC</span> <br> <br> - für die Entschlüsselung des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> für den Pairing-Vorgang</td> 
     <td style="width: 177px;height: 18.9091px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">URI_PAIR</span></td> 
    </tr> 
   </tbody> 
  </table> 
  <p id="polarion_104" class="MsoNormal"> &nbsp;<br> <span style="font-style: italic;">Hinweis: Werden alle Teildienste auf einem Server gemeinsam betrieben, so können diese dasselbe Schlüsselmaterial verwenden. Werden Teildienste auf unterschiedlichen physischen oder logischen Servern betrieben, so sind die Endpunkte mit eigenem Schlüsselmaterial auszustatten.</span> </p> 
  <p id="polarion_107"> <span style="font-style: italic;">Die URL des Discovery Document&nbsp;</span><span style="font-style: normal;"><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">URI_DISC</span> </span><span style="font-style: italic;">stellt somit den zentralen Anlaufpunkt dar, anhand dessen alle weiteren „statischen“ Dienste (Endpunkte des IDP-Dienstes) adressiert werden können.</span> </p> 
  <p id="polarion_115"> <span style="font-style: italic;">Hinweis: Bei allen extern genutzten Schlüsseln handelt es sich um ECC-Schlüsselpaare der Kurve brainpoolP256r1. Für IDP_ENC ist im Gegensatz zu den anderen beiden Schlüsseln keine Bestätigung als Zertifikat vorgesehen. Die maximale Einsatzdauer des Schlüsselpaares liegt analog zum IDP_SIG und DISC_SIG bei maximal 5 Jahren.</span> </p> 
  <p id="polarion_108"></p> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104323">3.3 Verfahrensbeschreibung</h3> 
  <p id="polarion_165">Vorbereitende Maßnahmen: Das Anwendungsfrontend und der Fachdienst haben sich im Zuge eines organisatorischen Prozesses beim IDP-Dienst registriert. Das Anwendungsfrontend und das Authenticator-Modul haben das Discovery Dokument eingelesen und kennen damit die Uniform Resource Identifier (URI) und die öffentlichen Schlüssel der vom IDP-Dienst angebotenen Endpunkte. Der Fachdienst hat bei der Registrierung am IDP-Dienst seinen öffentlichen Schlüssel hinterlegt.</p> 
  <p id="polarion_82" style="text-align: center;"> <img src="attachments/Sequenzdiagramm-idp-2020-08-13.png" style="max-width: 750px;" data-lastmodified="2020-08-13T06:10:07.315+02:00"> </p> 
  <p id="polarion_175" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">4</span>:&nbsp;Datenfluss-Diagramm IDP-Dienst </p> 
  <p id="polarion_184"></p> 
  <p id="polarion_188">Die Prozessschritte, welche notwendig sind, damit ein mobiles Anwendungsfrontend einen&nbsp;Token erhält sind:</p> 
  <ol id="polarion_62"> 
   <li>Das Anwendungsfrontend erzeugt sich einen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CODE_VERIFIER</span> [<a href="https://tools.ietf.org/html/rfc7636#section-4.1" target="_top" class="descriptionLink">RFC7636 # section-4.1</a>] und bildet darüber den Hash <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CODE_CHALLENGE</span> mit dem Hash-Algorithmus S256 gemäß [<a href="https://tools.ietf.org/html/rfc7636#section-4.2" target="_top" class="descriptionLink">RFC 7636 # section-4.2</a>].</li> 
   <li>Das Anwendungsfrontend überträgt die <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CODE_CHALLENGE</span> gemäß [<a href="https://tools.ietf.org/html/rfc8252#appendix-B" target="_top" class="descriptionLink">RFC8252 # Anhang B</a>] an das Authenticator-Modul.</li> 
   <li>Das Authenticator-Modul überträgt die&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CODE_CHALLENGE</span>&nbsp;mit der genutzten <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">code_challenge_method</span> S256 weiter an den&nbsp;<span style="font-size: 10pt;line-height: 1.5;">Authorization</span>-Endpunkt des IDP-Dienst.<br> </li> 
   <li>Der &nbsp;<span style="font-size: 10pt;line-height: 1.5;">Authorization</span>-Endpunkt legt eine <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SESSION_ID</span> an und speichert alle Informationen zum Vorgang in der <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE</span>.</li> 
   <li>Der&nbsp;<span style="font-size: 10pt;line-height: 1.5;">Authorization</span>-Endpunkt stellt alle Informationen zusammen und erzeugt die <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE.</span></li> 
   <li>Der&nbsp;<span style="font-size: 10pt;line-height: 1.5;">Authorization</span>-Endpunkt stellt den mit dem entsprechenden Fachdienst vereinbarten Consent&nbsp;(Zustimmung des Nutzers zur Verarbeitung der angezeigten Daten)&nbsp;zusammen.</li> 
   <li>Der&nbsp;<span style="font-size: 10pt;line-height: 1.5;">Authorization</span>-Endpunkt überträgt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE_TOKEN</span> und Consent-Abfrage <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">USER_CONSENT</span> zum Authenticator-Modul.</li> 
   <li>Das Authenticator-Modul fordert den Nutzer zu Consent-Freigabe auf mittels Smartcard und PIN-Eingabe. Falls bereits ein <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> beim Authenticator-Modul existiert, entfällt dieser Schritt.</li> 
   <li>Das Authenticator-Modul verwendet die PIN um die <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE_TOKEN</span> von der Smartcard signieren zu lassen.&nbsp;Falls bereits ein <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> beim Authenticator-Modul existiert, entfällt dieser Schritt.</li> 
   <li>Das Authenticator-Modul überträgt das signierte <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE_TOKEN </span>mit dem Smartcard-Zertifikat, verschlüsselt mittels <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PuK_IDP_ENC</span>, an den IDP-Dienst (Antwort Schritt 7). Falls ein <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> beim Authenticator-Modul existiert, wird dieser Token zusammen mit einem unveränderten <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE_TOKEN</span> zum IDP-Dienst transportiert.<br> </li> 
   <li>Der Authorization-Endpunkt entschlüsselt und validiert die signierte Challenge <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SESSION_ID</span>, <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE</span> und <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SIGNATUR</span>. Die Signatur wird anhand des im "x5c"-Header mitgelieferten Authentifizierungszertifikats der Smartcard validiert. Falls ein <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> angenommen wurde, wird dieses validiert. Entschlüsselt wird das <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> vom Authorization-Endpunkt mit seinem Schlüsselmaterial, welches er zur Verschlüsselung genutzt hat. Die Überprüfung der Signatur des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> führt der Authorization-Endpunkt anhand seines öffentlichen Schlüssels <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PuK_IDP_SIG </span>durch.</li> 
   <li>Der Authorization-Endpunkt verknüpft die <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SESSION_ID</span> mit der Identität aus der Signatur. Falls ein <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN </span>angenommen wurde, verknüpft der Authorization-Endpunkt die <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SESSION_ID</span> mit der Identität aus dem <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span>.</li> 
   <li>Der&nbsp;<span style="font-size: 10pt;line-height: 1.5;">Authorization</span>-Endpunkt erstellt den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE.</span></li> 
   <li>Der Authorization-Endpunkt überträgt den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> und den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> an das Authenticator-Modul (Antwort Schritt 3). Falls das Authenticator-Modul ein vorhandenes <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> an den Authorization-Endpunkt zur Erlangung eines <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> geschickt hat, wird kein neues <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> vom Authorization -Endpunkt erstellt und verschickt. Der <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> und das <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> werden vom Authorization-Endpunkt mit seinem privaten Schlüssel <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PrK_IDP_SIG</span> signiert. Der Authorization-Endpunkt verschlüsselt das <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> für sich und den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> für den Token-Endpunkt. Das zur Verschlüsselung verwendete Schlüsselmaterial muss die Vorgaben der [gemSpec_Krypt] beachten.<br> </li> 
   <li>Das Authenticator-Modul überträgt den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> an das Anwendungsfrontend (Antwort Schritt 2).</li> 
   <li>Das Anwendungsfrontend erzeugt sich einen AES256-"Token-Key", verknüpft ihn mit dem <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CODE_VERFIER</span> zum <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">KEY_VERIFIER</span> und sendet diesen unter Nutzung des öffentlichen Schlüssels <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PUK_IDP_ENC</span> verschlüsselt zusammen mit dem <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> zum Token-Endpunkt des IDP-Dienstes.</li> 
   <li>Der Token-Endpunkt entschlüsselt den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> und validiert ihn anhand des öffentlichen Schlüssels <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PUK_IDP_SIG</span> des Authorization-Endpunktes.&nbsp;</li> 
   <li>Der Token-Endpunkt entschlüsselt und validiert den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">KEY_VERIFIER</span>, entnimmt aus diesem den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CODE_VERIFIER</span> und gleicht diesen mit der <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CODE_CHALLENGE</span> aus dem <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> ab.</li> 
   <li>Der Token-Endpunkt erzeugt die erforderlichen Token, signiert sie mit seinem privaten Schlüssel <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PrK_IDP_SIG</span> und verschlüsselt sie mit dem „Token-Key“ des Anwendungsfrontend, welchen er dem&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">KEY_VERIFIER</span> entnimmt.</li> 
   <li>Der Token-Endpunkt überträgt die Token an das Anwendungsfrontend (Antwort Schritt 16).<br> </li> 
   <li>Das Anwendungsfrontend entschlüsselt die Token mit seinem „Token-Key“ und prüft die Token-Signatur anhand des öffentlichen Schlüssels <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PUK_IDP_SIG</span> des Token-Endpunktes.</li> 
   <li>Das Anwendungsfrontend reicht das gültige <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> auf Anwendungsebene verschlüsselt beim Fachdienst ein.</li> 
   <li>Der Fachdienst entschlüsselt das <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> entsprechend dem für diese Anwendung vorgesehenen Verfahren.</li> 
   <li>Der Fachdienst validiert das <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> anhand des öffentlichen Schlüssels <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PUK_TOKEN</span> des Token-Endpunktes.</li> 
   <li>Der Fachdienst zieht die Claims (d. h. die Key/Value-Paare im Payload eines Tokens) aus dem <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> und gibt bei positiver Validierung den Zugriff auf die Fachdaten frei.</li> 
  </ol> 
  <p id="polarion_63"> <span style="font-style: italic;">Hinweis: Verwendet der Nutzer ein Primärsystem, führt der Konnektor in Schritt 9 die Funktion "externalAuthenticate" für eine Signatur mit der SMC-B durch. Setzt der Nutzer ein mobiles Endgerät ein, ruft das Authenticator-Modul die Signaturfunktion eines HBA oder einer eGK für eine nonQES-Signatur der Smartcard auf. Die erforderlichen Token in Schritt 19 sind</span>&nbsp;<span style="font-style: italic;font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span> <span style="font-style: italic;"><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">und ACCESS_TOKEN</span>. Das Authenticator-Modul kann mit dem&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> einen neuen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> beim IDP-Dienst ohne erneute Nutzer-Authentifizierung anfordern und damit ein neues <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> vom IDP-Dienst erhalten. Im <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> hinterlegt der IDP-Dienst die für ihn selbst bestimmten Informationen zum gesamten Vorgang, sodass er keine schützenswerten Informationen zentral speichern muss. Das <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> beinhaltet alle Daten, die beim IDP-Dienst benötigt werden, um auf die Vorgangshistorie zurückzugreifen und ggf. neue <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> herauszugeben. Die Informationen im <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> sind mit dem öffentlichen Schlüssel des Authorization-Servers für diesen selbst verschlüsselt und können ausschließlich mit dem privaten Schlüssel des Authorization Servers wieder entschlüsselt werden.</span> </p> 
  <p id="polarion_29"> <span style="font-style: italic;">Im Schaubild&nbsp;Datenflussdiagramm IDP-Dienst oben ist der Datenfluss zwischen Anwendungsfrontend, Authenticator-Modul, IDP-Dienst und Fachdienst dargestellt. Der Datenfluss weicht im Falle von Primärsystemen hiervon ab, wenngleich Primärsysteme ebenfalls Nutzer-Endgeräte sind. Die Abweichung des Datenflusses wird im nächsten Kapitel erläutert.</span> </p> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-110717">3.4 Abweichende Verfahrensbeschreibung für Primärsysteme</h3> 
  <p id="polarion_35">Da bei Primärsystemen der Zugriff auf das Authenticator-Modul nicht in allen Fällen in Form eines Links innerhalb des Systems erfolgen kann, muss von der Vorgehensweise für mobile Endgeräte des Nutzers abgewichen werden. Das Primärsystem hat nicht die Möglichkeit, die Anfrage zum freizugebenden Consent anzuzeigen und nicht zur Eingabe der PIN aufzufordern. Zum Betrieb des Primärsystems ist es notwendig, dass sich die SMC-B im freigeschalteten Modus befindet.&nbsp;Damit muss die Freischaltung der SMC-B genutzt werden, um die Consent-Freigabe dauerhaft zu bestätigen und&nbsp;die vom IDP-Dienst in Schritt 6 geforderte Challenge ohne PIN-Eingabe zu realisieren.</p> 
  <p id="polarion_148">Für die Signatur der Challenge wird die Funktion "externalAuthenticate" des Konnektors verwendet, welcher diesen Funktionsaufruf nur von den Primärsystemen entgegennimmt, an welchen ein Mitarbeiter der Praxis aktiv eingeloggt ist.</p> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104319">3.5 Registrierung Anwendungsfrontend und Fachdienst</h3> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-112000|external=true|anchor=91e259f4-c0a8e834-598480ea-3fad69b9">
   ML-112000
   <p><b>A_20737</b></p>
   <p>Der Anbieter des IdP-Dienstes MUSS eine organisatorische Registrierung von Anwendungsfrontends und Fachdiensten ermöglichen. <b>&lt;=</b></p>
  </div> 
  <p id="polarion_26" class="MsoNormal">Um ein Anwendungsfrontend nutzen zu können, muss dieses gemeinsam mit einem Authenticator-Modul&nbsp;in einer Applikation kombiniert und am IDP-Dienst registriert sein.&nbsp;Die Registrierung des Anwendungsfrontends ist im Dokument [gemSpec_IDP_Frontend] beschrieben.</p> 
  <p id="polarion_70">Anbieter von Fachdiensten müssen Ihre Fachdienste über einen organisatorischen Prozess am IDP-Dienst durchführen.</p> 
  <p id="polarion_37" class="MsoNormal"> Ergänzung: <span style="font-size: 10pt;line-height: 1.5;">Diese Registrierung erfolgt einmalig für die Anwendung bzw. den Dienst und muss nicht bei Updates wiederholt werden. Die Registrierung des Fachdienstes beinhaltet dabei auch die Abstimmung der Claims und die Gültigkeitsdauer der erstellten Token (siehe [gemSpec_IDP_FD#Kapitel 4]), wobei der Fachdienst seinen Bedarf an den gewünschten Attributen erklärt. Anpassungen an den Claims bedürfen einer erneuten Abstimmung und Registrierung.</span> </p> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104315">3.6 Anwendungsfrontend vorbereitende Maßnahmen</h3> 
  <p id="polarion_51" class="MsoNormal"> Das Anwendungsfrontend muss ein <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CODE_VERIFIER</span> (Zufallswert) gemäß [<a href="https://tools.ietf.org/html/rfc7636#section-4.1" target="_top" class="descriptionLink">RFC7636 # section-4.1</a>] und hierüber einen Hash, die <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CODE_CHALLENGE,</span> gemäß [<a href="https://tools.ietf.org/html/rfc7636#section-4.2" target="_top" class="descriptionLink">RFC7636 # section-4.2</a>] mit dem Algorithmus S256 gemäß [<a href="https://tools.ietf.org/html/rfc7636#section-4.2" target="_top" class="descriptionLink">RFC7636 # section-4.2</a>] erzeugen. </p> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104320">3.7 Anfrage eines ACCESS_TOKEN</h3> 
  <p id="polarion_52" class="MsoNormal">Die folgende Anfrage an den Authorization-Endpunkt umfasst die Schritte 1-3 aus dem Gesamtablauf des Kapitels 3.2. Der Nutzer ruft sein Anwendungsfrontend auf. Die Adressierung des IDP-Dienstes ist im Anwendungsfrontend als Parameter in einer Konfigurationsdatei oder direkt im Quellcode hinterlegt.</p> 
  <p id="polarion_170"> Das Anwendungsfrontend liefert seine Anfrage auf ein <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> über das Authenticator-Modul an den Authorization-Endpunkt. </p> 
  <p id="polarion_57" class="MsoNormal"> <span style="font-weight: normal;">Inhalt der Anfrage</span> ist: </p> 
  <ul id="polarion_587"> 
   <li>die <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">REDIRECT_URI</span> sowie Bezeichnung des aufzurufenden Fachdienstes,</li> 
   <li>die eigene Hersteller-ID, Programmkürzel und Versionsnummer,</li> 
   <li>der über das eigene <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CODE_VERIFIER</span> [<a href="https://tools.ietf.org/html/rfc7636#section-4.1" target="_top" class="descriptionLink">RFC7636 # section-4.1</a>] gebildete HASH <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">code_challenge</span> [<a href="https://tools.ietf.org/html/rfc7636#section-4.2" target="_top" class="descriptionLink">RFC7636 # section-4.2</a>] mit Angabe des Algorithmus <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">code_challenge_method</span> [<a href="https://tools.ietf.org/html/rfc7636#section-4.3" target="_top" class="descriptionLink">RFC7636 # section-4.3</a>],</li> 
   <li>der <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">STATE</span>-Parameter [<a href="https://tools.ietf.org/html/rfc8252#section-8.9" target="_top" class="descriptionLink">RFC8252 # section-8.9</a>] wird genutzt, um CSRF (Cross-Site-Request-Forgery) zu verhindern.</li> 
  </ul> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104322">3.8 Aufgaben des Authorization-Endpunktes</h3> 
  <p id="polarion_83" class="MsoNormal"> Der Authorization-Endpunkt nimmt die Anfrage an und entschlüsselt diese mit seinem privaten Schlüssel <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PRK_AUTH</span>. Nach der Signatur- und Integritätsprüfung überprüft der Authorization-Endpunkt, ob mit den Attributen in der <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span>-Anfrage die im Claim des Fachdienstes geforderten Parameter bedient werden können. </p> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-104317">3.8.1 Unzureichende Attribute für das Claim</h4> 
  <p id="polarion_90" class="MsoNormal"> Kann das Claim nicht voll bedient werden, gibt der Authorization-Endpunkt eine Fehlermeldung gemäß [<a href="https://tools.ietf.org/html/rfc6749#section-5.2" target="_top" class="descriptionLink">RFC6749 # section-5.2</a>] und fordert den Nutzer zur erneuten Authentisierung und Freigabe der erforderlichen Attribute auf. </p> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-104313">3.8.2 Erstellung des AUTHORIZATION_CODE</h4> 
  <p id="polarion_95" class="MsoNormal"> Sind alle im Claim geforderten Attribute vorhanden und die Gültigkeit&nbsp;der Attribute geprüft, erstellt der Authorization-Endpunkt einen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> und sendet diesen an das Anwendungsfrontend. Der Authorization-Endpunkt prüft die Signatur der <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE</span> und das mitgelieferte Zertifikat der Smartcard des Nutzers gegen den OCSP/TSL-Dienst der PKI der gematik. </p> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104310">3.9 Einreichen des AUTHORIZATION_CODE</h3> 
  <p id="polarion_98" class="MsoNormal"> Das Anwendungsfrontend reicht den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> zusammen mit dem <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CODE_VERIFIER</span> beim Token-Endpunkt ein. </p> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104307">3.10 Aufgabe des Token-Endpunktes</h3> 
  <p id="polarion_102" class="MsoNormal"> Der Token-Endpunkt des IDP-Dienstes&nbsp;nimmt die Daten des Anwendungsfrontends entgegen und prüft neben deren Integrität, ob der eingereichte <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CODE_VERIFIER</span> bei Nutzung des Hash-Verfahrens S256 (nach [<a href="https://tools.ietf.org/html/rfc7636#section-4.2" target="_top" class="descriptionLink">RFC7636 # section-4.2</a>]) zum bitgleichen Hash-Wert führt. Stimmt der Hash-Wert aus dem initialen Aufruf des Authenticator-Moduls - die <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CODE_CHALLENGE</span> -&nbsp;mit dem gebildeten Hash-Wert überein, ist sichergestellt, dass Aufrufer und Initiator identisch sind. Der Token-Endpunkt gibt daraufhin das <span style="font-weight: normal;font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span> und das <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> an das Anwendungsfrontend heraus. </p> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104324">3.11 Einreichen des ACCESS_TOKEN beim Fachdienst</h3> 
  <p id="polarion_103" class="MsoNormal"> Um schlussendlich Zugriff auf den Fachdienst zu bekommen, reicht das Anwendungsfrontend das&nbsp;<span style="font-weight: normal;"><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> </span>beim Fachdienst ein. </p> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104321">3.12 Aufgabe des Fachdienstes</h3> 
  <p id="polarion_105" class="MsoNormal"> <span style="font-weight: normal;">Der Fachdienst nimmt das zwischen Frontend und Fachdienst anwendungsspezifisch verschlüsselte <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN </span>entgegen.&nbsp;Der Fachdienst muss das <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> mit seinem privaten Schlüssel <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PrK_FD</span> entschlüsseln. Danach überprüft er die Integrität und die Übereinstimmung mit dem eigenen Claim. Enthält das <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> mehr oder weniger Attribute, als im Claim vereinbart, oder sind diese fehlerhaft oder nicht befüllt, stimmt die Integrität oder Signatur des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> nicht oder ist das <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> zeitlich nicht mehr gültig, bricht der Fachdienst die Kommunikation mit einer dem Abbruchgrund entsprechenden Fehlermeldung ab.</span> </p> 
  <p id="polarion_106" class="MsoNormal">Bei positiver Validierung gewährt der Fachdienst Zugriff auf seine Fachdaten.</p> 
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-104160">4 Zerlegung des Produkttyps</h2> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-117406|external=true|anchor=91e25a23-c0a8e834-598480ea-5541961f">
   ML-117406
   <p><b>A_20687-01</b></p>
   <p>Der Authorization Server MUSS zu allen verwendeten privaten Schlüsseln <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PrK_IDP_SIG</span>, <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PrK_IDP_ENC</span> und <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PrK_DISC_SIG</span> das öffentliche Pendant&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PuK_IDP_SIG</span>, <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PuK_IDP_ENC</span> und <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PuK_DISC_SIG</span>&nbsp;zum Download bereitstellen. Dies ermöglicht die Prüfung der von den einzelnen Schnittstellen vorgenommenen Signaturen ebenso wie die zielgerichtete Verschlüsselung des Payload für den bestimmten Empfänger. <b>&lt;=</b></p>
  </div> 
  <p id="polarion_25">Der Produkttyp besteht aus einer zentralen Komponente (IDP-Dienst). Diese wird bei der Durchführung des Authentifizierungsprozesses vom Authenticator-Modul unterstützt. Das Authenticator-Modul übernimmt die Ausführung der Nutzerauthentisierung. Bei Verwendung eines stationären Endgerätes mit installiertem Primärsystem, realisiert das Primärsystem die Funktionalität des Authenticator-Moduls. Das Anwendungsfrontend ist ebenso als Teil des Primärsystems realisiert. Bei Verwendung eines mobilen Endgeräts, ist dort sowohl das Authenticator-Modul, als auch das Anwendungsfrontend gemeinsam in einer Applikation installiert.&nbsp;</p> 
  <p id="polarion_86"> Der IDP-Dienst stellt die zentralisierte Identitätsprüfung der auf die Fachdienste zugreifenden Nutzer bereit. Als weitere Teile der Gesamtlösung sind neben dem IDP-Dienst die Clients (Anwendungsfrontend/Primärsystem) und die Fachdienste zu nennen, auf denen Fachdaten für den Zugriff durch die Nutzer (z. B. Versicherte oder Bediener eines AVS, PVS oder KVS) bereitgestellt werden. Ein IDP-Dienst bietet Fachdiensten seine Dienste an, auf welche Millionen Nutzer zeitgleich zugreifen. <span style="font-size: 10pt;line-height: 1.5;">Eine wesentliche Ergänzung des IDP-Dienstes ist&nbsp;</span>das Authenticator-Modul, welches auf den dezentralen Komponenten in den Praxen, Kliniken, Apotheken und bei den Versicherten betrieben wird. </p> 
  <p id="polarion_756"></p> 
  <p id="polarion_87"> <span style="font-style: italic;">Hinweis: Die Bereitstellung von öffentlichem Schlüsselmaterial bezieht sich auf die Schlüssel zum Signieren und ggf. Verschlüsseln der JSON Web Token. Hiermit sind nicht die öffentlichen Schlüssel der TLS-Verschlüsselung gemeint.</span> </p> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111991|external=true|anchor=91e25a62-c0a8e834-598480ea-e48f0125">
   ML-111991
   <p><b>A_20732</b></p>
   <p>Der Authorization Server MUSS zu jedem privaten Schlüssel dessen öffentlichen Teil mit einer eigenen absoluten URI in das Discovery Document aufnehmen. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111894|external=true|anchor=91e25a91-c0a8e834-598480ea-8acb3013">
   ML-111894
   <p><b>A_20686</b></p>
   <p>Der Authorization Server <span style="font-weight: normal;">MUSS d</span>ie einzelnen Schnittstellen (AUTH, DISC, TOKEN) mit getrennten Interfaces bedienen. <b>&lt;=</b></p>
  </div> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-111124">4.1.1 Allgemeine Sicherheitsanforderungen</h4> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-112876|external=true|anchor=91e25ac0-c0a8e834-598480ea-73c5482e">
   ML-112876
   <p><b>A_20582-01</b></p>
   <p>Der IdP-Dienst MUSS Maßnahmen zum Schutz sowohl vor den&nbsp;zum Zulassungszeitpunkt aktuellen OWASP-Top-10-Risiken umsetzen, als auch nach den zum Zulassungszeitpunkt aktuellen OWASP-Top-10-Risiken. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116307|external=true|anchor=91e25afe-c0a8e834-598480ea-9bf4bd1d">
   ML-116307
   <p><b>A_21302</b></p>
   <p>Der Anbieter des IdP-Dienstes MUSS für den internen Datenaustausch einen Mechanismus zur Sicherung der Datenintegrität, der Authentizität und zur Vertraulichkeit der Daten zur Verfügung stellen.&nbsp; <b>&lt;=</b></p>
  </div> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-111125">4.1.2 Sicherheit der Netzübergänge</h4> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111132|external=true|anchor=91e25b3d-c0a8e834-598480ea-32964303">
   ML-111132
   <p><b>A_20583</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der Anbieter des IdP-Dienstes MUSS dafür sorgen, dass das Transportnetz Internet durch einen Paketfilter (ACL) gesichert wird und ausschließlich die erforderlichen Protokolle weiterleitet. Der Anbieter des IdP-Dienstes MUSS dafür sorgen, dass&nbsp; der Paketfilter des IdP-Dienstes frei konfigurierbar auf der Grundlage von Informationen aus OSI-Layer 3 und 4 ist, das heißt Quell- und Zieladresse, IP-Protokoll sowie Quell- und Zielport.</span> <b>&lt;=</b></p>
  </div> 
  <p id="polarion_101"> <span style="font-size: 10pt;line-height: 1.5;">Der IDP-Dienst wird für Versicherte über das Internet erreichbar gemacht und für Leistungserbringer über das Netz der TI. Die folgenden Anforderungen beschreiben die für diese Netzübergänge erforderlichen Sicherheitsmechanismen. Für den Netzübergang aus dem Internet als Transportnetz zum IDP-Dienst ist ein Paketfilter erforderlich.</span> </p> 
  <p id="polarion_114"> <span style="font-style: italic;">Hinweis: Durch die Zurückweisung von Verbindungen wird sichergestellt, dass Clients einen Verbindungsaufbau mit einer anderen Instanz des Fachdienstes versuchen, bei dem die erforderlichen Ressourcen zur Verfügung stehen.</span> </p> 
  <p id="polarion_146"></p> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111131|external=true|anchor=91e25b6b-c0a8e834-598480ea-0011b738">
   ML-111131
   <p><b>A_20584</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der Anbieter des IdP-Dienstes DARF den Paketfilter des IdP-Dienstes zum Schutz in Richtung Transportnetz Internet&nbsp; NICHT physisch auf dem vorgeschalteten TLS-terminierenden Load Balancer implementieren.</span> <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-117514|external=true|anchor=91e25b9a-c0a8e834-598480ea-28502e68">
   ML-117514
   <p><b>A_20585-01</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der Anbieter des IdP-Dienstes MUSS beim Paketfilter die Weiterleitung von IP-Paketen an der Schnittstelle zum Internet auf das HTTPS- Protokoll beschränken.&nbsp;</span> <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-112831|external=true|anchor=91e25bd9-c0a8e834-598480ea-756f25f7">
   ML-112831
   <p><b>A_20586-01</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der Anbieter des IdP-Dienstes MUSS den Paketfilter des IdP-Dienstes so konfigurieren, dass bei Vollauslastung der Systemressourcen im IdP-Dienst keine weiteren Verbindungen angenommen werden.</span> <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111130|external=true|anchor=91e25c08-c0a8e834-598480ea-90b89079">
   ML-111130
   <p><b>A_20587</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der Anbieter des IdP-Dienstes MUSS dafür sorgen, dass der Eingangspunkt des IdP-Dienstes sich beim TLS-Verbindungsaufbau über das Transportnetz gegenüber dem Client mit einem Extended Validation TLS-Zertifikat eines Herausgebers gemäß [CAB-Forum] authentisiert. Der Anbieter MUSS dafür sorgen, dass das Zertifikat sich an die jeweilige Schnittstelle des Eingangspunkts für Primärsysteme, Authenticator-Module und Frontends der Versicherten des IdP-Dienstes bindet, damit Clientsysteme beim TLS-Verbindungsaufbau eine vereinfachte Zertifikatsprüfung mit TLS-Standardbibliotheken durchführen können.</span> <b>&lt;=</b></p>
  </div> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104314">4.2 Fehlermeldungen</h3> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111889|external=true|anchor=91e25c46-c0a8e834-598480ea-3922696e">
   ML-111889
   <p><b>A_20680</b></p>
   <p>Der IdP-Dienst <span style="font-weight: normal;">MUSS</span><span style="font-weight: bold;">&nbsp;</span>für die verschiedenen Teilfunktionen geeignete Fehlermeldungen erzeugen und diese an den jeweiligen Aufrufer übergeben. <b>&lt;=</b></p>
  </div> 
  <p id="polarion_198"></p> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111888|external=true|anchor=91e25c75-c0a8e834-598480ea-dfa99887">
   ML-111888
   <p><b>A_20681</b></p>
   <p>Der IdP-Dienst MUSS Fehler durch eine eindeutige Nummer erkennbar machen und der gematik eine Liste der Error-Codes zur Verfügung stellen, damit die Ursachenklärung vereinfacht möglich wird. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-117515|external=true|anchor=91e25cb4-c0a8e834-598480ea-f646cd9c">
   ML-117515
   <p><b>A_20682-01</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der IdP-Dienst MUSS alle ausgeworfenen Fehlermeldungen zur Weiterverarbeitung in einem einheitlichen Schema aufbereiten und bereitstellen. Zeitstempel MÜSSEN auf der UTC basieren.&nbsp;</span><p class="polarion-rte-caption-paragraph" data-keep-next="true"></p> <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111893|external=true|anchor=91e25ce2-c0a8e834-598480ea-e2ccde4f">
   ML-111893
   <p><b>A_20683</b></p>
   <p>Der IdP-Dienst MUSS Fehlermeldungen, welche dem Nutzer angezeigt werden, in der Art ausformulieren, dass es dem Nutzer möglich ist, eigenes Fehlverhalten anhand der Fehlermeldung abzustellen. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111891|external=true|anchor=91e25d21-c0a8e834-598480ea-168f9816">
   ML-111891
   <p><b>A_20684</b></p>
   <p>Der IdP-Dienst MUSS jedem Fehler eine eindeutige eigene Beschreibung zukommen lassen, sodass eine Fehlermeldung nicht für unterschiedliche Fehlerursachen zur Anwendung kommt. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111892|external=true|anchor=91e25d50-c0a8e834-598480ea-099c01d4">
   ML-111892
   <p><b>A_20685</b></p>
   <p>Der IdP-Dienst MUSS aufeinander aufbauende Fehlermeldungen in der umgekehrten Reihenfolge ihres Auftretens "Traceback (most recent call last)" ausgeben. <b>&lt;=</b></p>
  </div> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-109653">4.3 Schnittstellenbeschreibung des IDP-Dienstes</h3> 
  <p id="polarion_236" class="MsoNormal"> Der IDP-Dienst bietet zahlreiche Schnittstellen gegenüber unterschiedlichen Akteuren inner- und außerhalb der TI an, weswegen es notwendig ist, die einzelnen Schnittstellen so zu beschreiben, dass andere Akteure deren Funktionsweise leichter verstehen können.&nbsp;Nachfolgende Abbildung skizziert die Schnittstellen des IDP-Dienstes. Komponenten und Schnittstellen, welche nicht direkt vom IDP-Dienst genutzt werden, sind in der Abbildung grau hinterlegt.<br> </p> 
  <p id="polarion_237" style="text-align: center;" data-keep-next="true" class="MsoNormal"> <img src="attachments/Nachbarsysteme-IDP-2020-08-13.png" style="width: 645px;height: 394px;" data-lastmodified="2020-08-13T07:40:37.711+02:00"> </p> 
  <p id="polarion_20" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">5</span>: Schnittstellen des IDP-Dienstes </p> 
  <p id="polarion_238" class="MsoNormal"> <br> Die erste tokenbezogene Anfrage an den Authorization Server des IDP-Dienstes geht am Authorization-Endpunkt [<a href="https://tools.ietf.org/html/rfc6749#section-3.1" target="_top" class="descriptionLink">RFC6749 # section-3.1</a>] ein.&nbsp;<span style="font-weight: normal;">Das Authenticator-Modul reicht dort am Endpunkt den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">CONSENT</span></span> mit der <span style="font-weight: normal;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">CHALLENGE</span>&nbsp;<span style="font-weight: normal;">ein, mit welchem die <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">TOKEN&nbsp;</span>erstellt werden sollen, und erhält den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">AUTHORIZATION_CODE</span> zurück, falls die Prüfung der signierten <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE</span> und die Prüfung des übergebenen Smartcard-Zertifikats am OCSP/TSL-Dienst positiv ausfallen. Das Anwendungsfrontend reicht den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> am Token-Endpunkt [<a href="https://tools.ietf.org/html/rfc6749#section-3.2" target="_top" class="descriptionLink">RFC6749 # section-3.2</a>] des IDP-Dienstes ein. Der IDP-Dienst überprüft den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> und stellt bei positiver Validierung einen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span> und einen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> aus.</span> </p> 
  <p id="polarion_85"> <span style="font-weight: normal;">Bei der ersten Kontaktaufnahme erzeugt der Authorization Server die <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">SUBJECT_SESSION</span>, welche im weiteren Verlauf als Zeitpunkt der letzten Authentisierung gegen die eGK oder den HBA gewertet wird. Basierend darauf dürfen weitere <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">ACCESS_TOKEN</span></span>&nbsp;<span style="font-weight: normal;">und <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">SSO_TOKEN</span> für</span> andere Anwendungsfrontends und Fachdienste ausgegeben werden, wenn das jeweils vorliegende Claim durch die dem Authorization Server vorliegenden Informationen bedient werden kann. Ist der Zeitpunkt der letzten Authentisierung zu lange her oder wird das Authenticator-Modul zum ersten Mal gestartet, muss eine Authentisierung erfolgen. </p> 
  <p id="polarion_100"> Hinweise für die Implementierung der Authentifizierung für Primärsystemen werden in [<span style="font-size: 10pt;line-height: 1.5;">gemILF_PS_eRp] beschrieben.&nbsp;</span> </p> 
  <p id="polarion_240" class="MsoNormal">Der Vorgang der Authentifizierung gegen die eGK oder den HBA ist nicht Bestandteil dieser Spezifikation, sondern ist im gesonderten Dokument [gemSpec_IDP_Frontend] beschrieben.</p> 
  <p id="polarion_241"> <span style="font-size: 11pt;line-height: 1.5;"> </span> </p> 
  <p id="polarion_97"></p> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-111134">4.4 Identifikation des Clientsystems</h3> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116773|external=true|anchor=91e25d8e-c0a8e834-598480ea-0ca62304">
   ML-116773
   <p><b>A_20588-01</b></p>
   <p>Der IdP-Dienst MUSS das vom aufrufenden Nutzer verwendete Clientsystem (Authenticator-Modul, E-Rezept-FdV oder Primärsystem) anhand des im HTTP-Request enthaltenen Header-Feld "User-Agent" gemäß [RFC7231] erkennen und in den Einträgen zur Performance-Rohdatenerfassung gemäß [gemSpec_Perf] protokollieren. Der IdP-Dienst MUSS bei fehlendem User-Agent-Header den Request mit dem HTTP-Status-Code 403 beantworten, damit in der Betriebsüberwachung des IdP-Dienstes die Nutzung unzulässiger Clientsysteme erkannt werden kann. <b>&lt;=</b></p>
  </div> 
  <p id="polarion_93"> Der IDP-Dienst verwaltet und steuert den Authentisierungsprozess für das E-Rezept und perspektivisch auch weitere Anwendungen. Damit kommt ihm eine Relevanz in der Gesundheitsversorgung zu, die sich zum einen in einer hohen Verfügbarkeit und zum anderen in einem hohen Angriffspotential widerspiegelt. Zur Unterstützung der betrieblichen Überwachung des IDP-Dienstes wird die Nutzung der im Feld befindlichen Clientsysteme protokolliert. Dabei ist der Zugriff auf die Schnittstellen des IDP-Dienstes nur durch Primärsysteme der Leistungserbringer, sein eigenes Authenticator-Modul und zugelassene E-Rezept-FdVs zulässig. Der E-Rezept-Fachdienst erkennt die Clientsysteme anhand des User-Agent-Header eingehender HTTP-Requests und protokolliert diesen Wert.&nbsp;<br> </p> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111136|external=true|anchor=91e25dbd-c0a8e834-598480ea-21f7e654">
   ML-111136
   <p><b>A_20589</b></p>
   <p>Der IdP-Dienst MUSS die aus dem Internet vom Clientsystem mitgeteilte Versionsnummer aus dem HTTP-Header User-Agent, erkennen und festgelegte Versionsnummern über ein Blacklisting von einer Kommunikation mit dem IdP-Dienst ausschließen können. Der IdP-Dienst MUSS in diesen Fällen eine entsprechende Fehlermeldung an das Clientsystem geben. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111135|external=true|anchor=91e25dec-c0a8e834-598480ea-32b63b20">
   ML-111135
   <p><b>A_20590</b></p>
   <p>Der Anbieter des IdP-Dienstes MUSS ausschließlich auf Anweisung der gematik Clientsysteme mit bestimmten Versionsnummern von einer Kommunikation mit dem IdP-Dienst ausschließen. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-117592|external=true|anchor=91e25e2b-c0a8e834-598480ea-b7b1c4b6">
   ML-117592
   <p><b>A_20742-01</b></p>
   <p>Der Anbieter des IDP-Dienstes MUSS bei der organisatorischen Registrierung des Anwendungsfrontends diesem eine eindeutige <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">client_id</span> zur Nutzung des IDP-Dienstes zuweisen. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-117360|external=true|anchor=91e25e59-c0a8e834-598480ea-5f0d9441">
   ML-117360
   <p><b>A_21472</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der IDP-Dienst MUSS bei der organisatorischen Registrierung eines Clients anhand seiner&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">client_id</span> - beispielsweise des Anwendungsfrontends oder eines Primärsystems - festlegen, ob im Authorization Code Flow bei der Ausgabe eines <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> auch ein <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> vom IDP-Dienst ausgegeben werden muss.</span> <b>&lt;=</b></p>
  </div> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-126089">4.5 Unterstützung der Anmeldung mittels sektoraler Identity Provider</h3> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124989|external=true|anchor=91e25e98-c0a8e834-598480ea-c9ae13d8">
   ML-124989
   <p><b>A_22280</b></p>
   <p>Der Anbieter des IDP-Dienstes MUSS diesen bei allen sektoralen Identity Providern als C<span style="font-style: normal;">onfidential</span> Client (gemäß [RFC6749#section-2.1]) registrieren. Hierbei müssen die folgenden Metadaten verwendet werden: 
    <table style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;" class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%">
     <tbody>
      <tr>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 97.675px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Datenobjekt</th>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 235.887px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Wert</th>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 235.637px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Anmerkungen</th>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 97.675px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">client_id</td>
       <td style="text-align: left;vertical-align: top;width: 235.887px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">"zentraler-idp-dienst"</td>
       <td style="text-align: left;vertical-align: top;width: 235.637px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><br></td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 97.675px;height: 76.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">redirect_uri</td>
       <td style="text-align: left;vertical-align: top;width: 235.887px;height: 76.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">URIs, von denen der sektorale Idenitity Provider Authorization Requests entgegennimmt</td>
       <td style="text-align: left;vertical-align: top;width: 235.637px;height: 76.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Der sektorale Identity Provider muss hier den IDP-Dienst mit all jenen "kk_app_redirect_uri"-Adressen registrieren, die er unterstützt.</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 97.675px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">PuK_IDP_SIG_Sek</td>
       <td style="text-align: left;vertical-align: top;width: 235.887px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">öffentlicher Authentifizierungsschlüssel des zentralen IDP-Dienstes gegenüber den sektoralen Identity Providern</td>
       <td style="text-align: left;vertical-align: top;width: 235.637px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Mindestens ein Schlüssel ist zu übergeben.</td>
      </tr>
     </tbody>
    </table> <b>&lt;=</b></p>
  </div> 
  <p id="polarion_772">Im Rahmen der Zugänglichmachung des E-Rezepts für Versicherte ohne NFC-fähige eGK sollen ab dem 01.01.2022 Kassen-eigene Authentifizierungssysteme an&nbsp;das E-Rezept angebunden werden. Diese werden im Folgenden als sektorale Identity Provider bezeichnet, um sie vom zentralen IDP-Dienst abzugrenzen, welcher die Authentisierung der Nutzer direkt oder indirekt über die eGK realisiert und die bereitgestellten Attribute von dieser ableitet.&nbsp;</p> 
  <p id="polarion_773">Zur Einbindung eines sektoralen Identity Provider wird im ersten Schritt der zentrale IDP-Dienst als Mittler zwischen dem Anwendungsfrontend, den sektoralen Identity Providern und dem E-Rezept&nbsp;Fachdient eingesetzt. Die Realisierung der ersten Stufe der sektoralen Identity Provider auf dem Vertrauensniveau "substanziell"&nbsp;wird auf den 31.12.2022 befristet.</p> 
  <p id="polarion_774"> Dies wird später mit der Etablierung einer Föderation von Identity Providern abgelöst.<span id="polarion-comment:1632"></span> </p> 
  <p id="polarion_109"> <span style="font-style: italic;">Hinweis: <span style="font-size: 10pt;line-height: 1.5;">Der sektorale Identity Provider&nbsp;wird bei Zulassung vermerkt und der zentrale IDP-Dienst geht dann im Auftrag der gematik auf diesen zwecks Registrierung zu.</span></span> </p> 
  <p id="polarion_737"> Weitere Aspekte finden sich in den Kapiteln der jeweiligen Endpunkte.<span id="polarion-comment:1629"></span> </p> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124988|external=true|anchor=91e25ed2-c0a8e834-598480ea-185df8b8">
   ML-124988
   <p><b>A_22282</b></p>
   <p>Der IDP-Dienst MUSS die Discovery Documents und JWKS-Schlüsselsätze der sektoralen Identity Provider, bei denen er registriert ist, mindestens einmal stündlich aktualisieren.<br><br>Erfolgreich eingelesene&nbsp;Discovery Documents und Schlüssel dürfen im Fall einer Nicht-Erreichbarkeit des Downloadpunktes für maximal 24 Stunden verwendet werden. <b>&lt;=</b></p>
  </div> 
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-104162">5 Funktionsmerkmale</h2> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-108513">5.1 Authorization Server Metadata (Discovery Document)</h3> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110662|external=true|anchor=91e25f09-c0a8e834-598480ea-2e9437c7">
   ML-110662
   <p><b>A_20457</b></p>
   <p>Der IdP-Dienst <span style="font-weight: normal;">MUSS&nbsp;</span>alle verwendeten Adressen in Form von URL gemäß [<a href="https://tools.ietf.org/html/rfc1738" target="_top" class="descriptionLink">RFC1738</a>&nbsp;] angeben und in einem Discovery Document gemäß [<a href="https://tools.ietf.org/html/rfc8414#section-2" target="_top" class="descriptionLink">RFC8414 # section-2</a>] innerhalb der TI und im Internet veröffentlichen. <b>&lt;=</b></p>
  </div> 
  <p id="polarion_154">Der Authorization Server dient dazu bestehende Identitäten zu prüfen und das Prüfungsergebnis in einer einheitlichen Form abgestimmt und durch zusätzliche Mechanismen gesichert bereitzustellen. Basis dieser Dienstleistung ist ein vertrauenswürdiges Verzeichnis, aus welchem hervorgeht, an welchen Schnittstellen dieser Dienst oder seine Teildienste erreichbar sind, wie diese Schnittstellen abgesichert sind und woher man die zur Etablierung der gewünschten Sicherheit erforderlichen Materialien beziehen kann. Gemäß dem verwendeten Standard OpenID Connect mit OAuth 2.0 kommen JSON Web Token (JWT), JSON Web Encryption (JWE), JSON Web Signature (JWS) und JSON Web Key (JWK) zum Einsatz.</p> 
  <p id="polarion_189"> Um nutzenden Anwendungen eine einheitliche Bezugsquelle für die Adressierung von Schnittstellen zu schaffen, werden die für alle Akteure grundlegenden Schnittstellen im sogenannten Discovery Document zusammengefasst und dort <span style="font-family: Arial, Helvetica;">unter der </span><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">URI_DISC</span> gemäß [<a href="https://tools.ietf.org/html/rfc8414" target="_top" class="descriptionLink">RFC8414 "OAuth 2.0 Authorization Server Metadata"</a>] veröffentlicht. </p> 
  <p id="polarion_190">Alle Akteure, welche den IDP-Dienst nutzen wollen, sind angehalten, dieses Discovery Document zu lokalisieren, herunterzuladen, zu prüfen und den Inhalt in den geplanten Betrieb einzubeziehen.</p> 
  <p id="polarion_132"> <span style="font-style: italic;">Hinweis 1: Das Discovery Document innerhalb der TI adressiert hierbei die URI der Schnittstellen des IDP-Dienstes innerhalb der TI. Das im Internet bereitgestellte Discovery Document stellt die URI der angebotenen Fachdienste im Internet mit dort auflösbaren Adressen bereit.&nbsp;</span> </p> 
  <p id="polarion_133"> <span style="font-style: italic;">Hinweis 2<span style="font-size: 10pt;line-height: 1.5;">: Es gibt je ein internes und externes (public) "Discovery Document". Diese unterscheiden sich in den darin angebotenen URI, welche gleichlautend im Host-Anteil auf unterschiedliche Domänen bzw. Top-Level-Domain (TLD) verweisen.</span></span> </p> 
  <p id="polarion_77"></p> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111896|external=true|anchor=91e25f3e-c0a8e834-598480ea-069c28aa">
   ML-111896
   <p><b>A_20688</b></p>
   <p>Der Discovery-Endpunkt MUSS <span style="font-size: 10pt;line-height: 1.5;">die Discovery Documents für interne und externe Adressierung</span> sowohl innerhalb der TI als auch im Internet veröffentlichen. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-117511|external=true|anchor=91e25f75-c0a8e834-598480ea-6b9948d2">
   ML-117511
   <p><b>A_20689-01</b></p>
   <p>Der IdP-Dienst MUSS alle von ihm im internen Discovery Document angebotenen URL ständig auf bloße Erreichbarkeit prüfen. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-117512|external=true|anchor=91e25fab-c0a8e834-598480ea-d2f1490b">
   ML-117512
   <p><b>A_20690-01</b></p>
   <p>Der IdP-Dienst MUSS alle von ihm im externen Discovery Document angebotenen URL ständig auf bloße Erreichbarkeit prüfen. <b>&lt;=</b></p>
  </div> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-108512">5.1.1 Aufbau des Discovery Documents</h4> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110634|external=true|anchor=91e25fe3-c0a8e834-598480ea-660d4b4e">
   ML-110634
   <p><b>A_20439</b></p>
   <p>Der Discovery-Endpunkt MUSS sowohl im internen, als auch im externen Discovery Document die Akteure mit&nbsp; ihrer URI veröffentlichen. <br> <b>&lt;=</b></p>
  </div> 
  <p id="polarion_191"> Der Authorization Server muss das Discovery Document&nbsp;gemäß [<a href="https://tools.ietf.org/html/rfc8414" target="_top" class="descriptionLink">RFC8414</a>] bereitstellen. </p> 
  <p id="polarion_147"> <span style="font-style: italic;">Hinweis: Der genaue Aufbau entspricht [gemSpec_IDP_Dienst#Kapitel 7.7 <span style="font-size: 10pt;line-height: 1.5;">Aufbau des Discovery Document</span>].</span> </p> 
  <p id="polarion_777"> <span style="font-weight: bold;"> </span> </p> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116962|external=true|anchor=91e26018-c0a8e834-598480ea-fa93f2e8">
   ML-116962
   <p><b>A_20458-02</b></p>
   <p>Der Discovery-Endpunkt MUSS sowohl im internen, als auch im externen Discovery Document gemäß [<a href="https://tools.ietf.org/html/rfc8414#section-2" target="_top" class="descriptionLink">RFC8414 # section-2</a>] mindestens die folgenden Attribute als URI angeben:<br> 
    <ul>
     <li>"issuer" (hier ist der IdP-Dienst erreichbar)&nbsp;<br></li>
     <li>"jwks_uri" (für den Abruf von „PUK_IDP_ENC“ sowie des öffentlichen Schlüssels und des Zertifikats von „PUK_IDP_SIG“ entsprechend TAB_IDP_DIENST_0003&nbsp; &nbsp;[RFC7517] – identifiziert anhand der „kid“-Parameter (puk_idp_enc / puk_idp_sig)<br></li>
     <li>"uri_disc" (URI, unter welcher das Discovery Document bereitgestellt wird)<br></li>
     <li>"authorization_endpoint" (URI des Dienstes und des öffentlichen Verschlüsselungsschlüssels des Authorization-Endpunktes gemäß [RFC6749])<br></li>
     <li>"sso_endpoint“ (URI des Authorization-Endpunktes für Requests mit SSO-Token)</li>
     <li>"auth_pair_endpoint“ (URI des Authorization-Endpunktes für Requests mit Pairing-Daten)</li>
     <li>"token_endpoint" (URI des Token-Endpunktes gemäß [RFC6749 ])<br></li>
     <li>"uri_puk_idp_enc“ und „uri_puk_idp_sig“ (URI der JWK Objekte für die zwei Schlüssel und des Zertifikates).</li>
    </ul> <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124991|external=true|anchor=91e26050-c0a8e834-598480ea-9180bb06">
   ML-124991
   <p><b>A_22286</b></p>
   <p>Der IDP-Dienst MUSS im Discovery Document unter dem Schlüssel "kk_app_list_uri" die URL der Liste der registrierten Authenticator-Module der sektoralen Identity Provider publizieren. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124994|external=true|anchor=91e26089-c0a8e834-598480ea-50bbb6f1">
   ML-124994
   <p><b>A_22287</b></p>
   <p><span style="font-weight: normal;">Der IDP-Dienst MUSS die URL des angebotenen Third-Party Authorization Endpoint im Discovery Document unter dem Schlüssel "third_party_authorization_endpoint" publizieren.</span> <br> <b>&lt;=</b></p>
  </div> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-108515">5.1.2 Erneuerung des Discovery Documents</h4> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-117477|external=true|anchor=91e260bf-c0a8e834-598480ea-37d04302">
   ML-117477
   <p><b>A_20691-01</b></p>
   <p>Der Discovery-Endpunkt MUSS das Discovery Document regelmäßig alle 24 Stunden oder nach durchgeführten Änderungen umgehend neu erstellen, mit dem <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PrK_DISC_SIG</span>&nbsp;signieren&nbsp;und am mit der gematik vereinbarten Downloadpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">URI_DISC</span>&nbsp;bereitstellen. <b>&lt;=</b></p>
  </div> 
  <p id="polarion_192"> Der Authorization Server muss das Discovery Document mit den Metainformationen zu den Teildiensten mindestens einmal täglich und immer nach Änderungen mit dem <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PrK_DISC</span> signieren und am mit der gematik vereinbarten Downloadpunkt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">URI_DISC</span> bereitstellen. </p> 
  <p id="polarion_173"></p> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-108514">5.1.3 Schutz des Discovery Document</h4> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-117509|external=true|anchor=91e26106-c0a8e834-598480ea-383df3ad">
   ML-117509
   <p><b>A_19874-05</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der IdP-Dienst MUSS das interne Discovery Document mit einem Zertifikat des Typs FD.SIG und der technischen Rolle „oid_idpd“ gemäß [<span style="color: #172B4D;">gemSpec_OID # Abschnitt 3.5.4</span>] signiert, an einem spezifischen Downloadpunkt TLS-gesichert innerhalb der TI bereitstellen.<br> Die URL des Downloadpunktes lautet: "<span style="font-weight: bold;">https://idp.zentral.idp.splitdns.ti-dienste.de/.wellknown/openid-configuration</span>".&nbsp;</span> <b>&lt;=</b></p>
  </div> 
  <p id="polarion_193"> <span style="color: #000000;">Der Authorization Server schützt die Integrität des&nbsp; Discovery Document auf Dateiebene durch eine&nbsp;Signatur und während des Transportes zusätzlich mittels TLS.</span> </p> 
  <p id="polarion_124"> <span style="font-weight: bold;"> </span> </p> 
  <p id="polarion_110"></p> 
  <p id="polarion_144"> <span style="font-weight: bold;"> </span> </p> 
  <p id="polarion_166"> <span style="font-style: italic;">Hinweis: Die für die Rolle des IDP-Dienstes vorgesehene professionOID ist in [<span style="font-size: 10pt;line-height: 1.5;">gemSpec_OID</span>] beschrieben.</span> </p> 
  <p id="polarion_129"></p> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125073|external=true|anchor=91e26154-c0a8e834-598480ea-0a1c425f">
   ML-125073
   <p><b>A_19877-04</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der IdP-Dienst MUSS das externe Discovery Document mit einem Zertifikat des Typs FD.SIG und der technischen Rolle „oid_idpd“ gemäß [<span style="font-size: 11pt;color: #172B4D;line-height: 1.5;">gemSpec_OID # Abschnitt 3.5.4</span>] signiert und TLS-gesichert im Internet zum Download bereitstellen.<br> Die URL des Downloadpunktes lautet: "<span style="font-weight: bold;"><a href="https://idp.app.ti-dienste.de/.well-known/openid-configuration" target="_top" class="descriptionLink">https://idp.app.ti-dienste.de/.well-known/openid-configuration</a></span>"&nbsp;</span><br> <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116333|external=true|anchor=91e26193-c0a8e834-598480ea-57617d03">
   ML-116333
   <p><b>A_20591-01</b></p>
   <p>Der IdP-Dienst MUSS die Signatur der Discovery Documents dabei durch die Verwendung einer JSON Web Signature (JWS) [RFC7515 # section-3 - Compact Serialization] und des Schüssels PrK_DISC_SIG&nbsp;gewährleisten. Als Algorithmus ist dementsprechend "BP256R1" zu wählen.<br>Der IdP-Dienst MUSS bei der Signaturerstellung das Signaturzertifikat des PUK_DISC_SIG&nbsp;im x5c Claim einbetten. <b>&lt;=</b></p>
  </div> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-126111">5.1.4 Liste der registrierten Authenticator Module sektoraler Identity Provider</h4> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124993|external=true|anchor=91e261c9-c0a8e834-598480ea-e837120b">
   ML-124993
   <p><b>A_22283</b></p>
   <p><span style="font-weight: normal;">Der IDP-Dienst MUSS unter einer dedizierten URL eine Liste der registrierten Authenticator-Module von sektoralen Identity Providern bereitstellen, die eine Vielzahl von Einträgen des folgenden Typs enthält:<br></span> 
    <table style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;" class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%">
     <tbody>
      <tr>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 113.037px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Datum</th>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 318.1px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Erläuterung</th>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 138.062px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Anmerkung</th>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 113.037px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">kk_app_name</td>
       <td style="text-align: left;vertical-align: top;width: 318.1px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Ein für den Benutzer der Anwendungsfrontends interpretierbarer Name der Anwendung. Maximal 128 Zeichen.</td>
       <td style="text-align: left;vertical-align: top;width: 138.062px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Wird durch sektoralen Identity Provider festgelegt.<br></td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 113.037px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">kk_app_id&nbsp;</td>
       <td style="text-align: left;vertical-align: top;width: 318.1px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ID des Authenticator-Moduls des sektoralen IDP, welcher die Authentisierung für Versicherte dieser Krankenkasse durchführt. Maximal 32 VSCHAR (analog client_id nach [RFC6749]).</td>
       <td style="text-align: left;vertical-align: top;width: 138.062px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Wird durch IDP-Dienst festgelegt.</td>
      </tr>
     </tbody>
    </table> <b>&lt;=</b></p>
  </div> 
  <p id="polarion_61"></p> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124995|external=true|anchor=91e261ff-c0a8e834-598480ea-66093eb1">
   ML-124995
   <p><b>A_22288</b></p>
   <p><span style="font-weight: normal;">Neben den gemäß [A_22283] bereitgestellten Informationen MUSS der IDP-Dienst für jedes&nbsp;registrierte Authenticator-Modul eines sektoralen Identity Provider die folgenden Werte erfassen:<br></span> 
    <table style="width: 100%;margin-left: 0px;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;" class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%">
     <tbody>
      <tr>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 113.037px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Datum</th>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 318.1px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Erläuterung</th>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 138.062px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Anmerkung</th>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 113.037px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">kk_app_uri&nbsp;</td>
       <td style="text-align: left;vertical-align: top;width: 318.1px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Aufzurufende URI für die Authentisierung. Hiermit ist die entsprechende App auf dem Gerät registriert (URL).&nbsp;</td>
       <td style="text-align: left;vertical-align: top;width: 138.062px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Wird durch sektoralen Identity Provider festgelegt.<br></td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 113.037px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">idp_iss&nbsp;</td>
       <td style="text-align: left;vertical-align: top;width: 318.1px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">iss-Wert des sektoralen Identity Provider (URL).</td>
       <td style="text-align: left;vertical-align: top;width: 138.062px;height: 57.6px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Wird durch sektoralen Identity Provider festgelegt.</td>
      </tr>
     </tbody>
    </table> <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124990|external=true|anchor=91e26235-c0a8e834-598480ea-c6ca9dc1">
   ML-124990
   <p><b>A_22284</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der IDP-Dienst MUSS die Signatur der Liste der registrierten Authenticator-Module von sektoralen Identity Providern&nbsp;durch die Verwendung einer JSON Web Signature (JWS) [RFC7515 # section-3 - Compact Serialization] und des Schüssels <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PrK_DISC_SIG</span> gewährleisten. Als Algorithmus ist dementsprechend "BP256R1" zu wählen. Der IDP-Dienst MUSS bei der Signaturerstellung das Signaturzertifikat des&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PUK_DISC_SIG</span> im x5c-Claim einbetten.</span> <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124992|external=true|anchor=91e26269-c0a8e834-598480ea-cbfa03fe">
   ML-124992
   <p><b>A_22285</b></p>
   <p>Der Anbieter des IDP-Dienstes MUSS für alle registrierten Authenticator-Module der sektoralen Identity Provider eine eindeutige "kk_app_id" vergeben. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-126989|external=true|anchor=91e262a4-c0a8e834-598480ea-a72114f1">
   ML-126989
   <p><b>A_22511</b></p>
   <p>Der zentrale Identity Provider MUSS den Verbindungsversuch, der nach [A_20590] ausgeschlossenen Kommunikation in den Rohdaten protokollieren. <b>&lt;=</b></p>
  </div> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104338">5.2 Authorization-Endpunkt</h3> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110625|external=true|anchor=91e262db-c0a8e834-598480ea-b9c6fc54">
   ML-110625
   <p><b>A_20434</b></p>
   <p><span style="font-weight: normal;">Der IdP-Dienst MUSS die Schnittstelle „Authorization-Endpunkt“ gemäß [RFC6749 "The OAuth 2.0 Authorization Framework"] und [RFC8252 „OAuth 2.0 for Native Apps“] und weiteren darin festgelegten Standards implementieren.</span> <b>&lt;=</b></p>
  </div> 
  <p id="polarion_78" class="MsoNormal"> Vorbedingung ist, dass das Authenticator-Modul bereits eine <span style="font-weight: normal;"><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">SUBJECT_SESSION</span> mit dem Authorization Server etabliert, sich das Discovery Document heruntergeladen und dieses erfolgreich ausgewertet hat.</span> </p> 
  <p id="polarion_162"> <span style="font-style: italic;">Hinweis:&nbsp;Der angebotene SSO-Endpunkt bzw. die angebotene URI namens <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">sso_endpoint</span> ist nur für die konkrete Übergabe des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> nutzbar. Alle vorhergehenden Requests, inklusive des Authentication Requests, sind an den Authorization Server zu richten.</span> </p> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107603|external=true|anchor=91e26314-c0a8e834-598480ea-2f06674e">
   ML-107603
   <p><b>A_19863</b></p>
   <p>Der Anbieter IdP-Dienst <span style="font-weight: normal;">MUSS</span> dafür Sorge tragen, dass die im Apple App Store veröffentlichte Software bei Änderungen automatisiert aktualisiert wird, sodass jederzeit die dauerhafte Verwendung fehlerhafter Software ausgeschlossen werden kann. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-107601|external=true|anchor=91e2634c-c0a8e834-598480ea-885d4a7d">
   ML-107601
   <p><b>A_19865</b></p>
   <p>Der Anbieter des IdP-Dienstes <span style="font-weight: normal;">MUSS</span> dafür Sorge tragen, dass die im Google Play Store veröffentlichte Software bei Änderungen automatisiert aktualisiert wird, sodass jederzeit die dauerhafte Verwendung fehlerhafter Software ausgeschlossen werden kann. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-117524|external=true|anchor=91e2638e-c0a8e834-598480ea-421f69d7">
   ML-117524
   <p><b>A_21315-01</b></p>
   <p>Der IDP-Dienst MUSS für den Authorization-Endpunkt eine zusätzliche Adresse mit der URI-Bezeichnung "sso_endpoint" anbieten, über den im Authorization Code Flow (<a class="descriptionLink" target="_top" href="https://openid.net/specs/openid-connect-core-1_0.html#CodeFlowAuth">openid-connect-core-1_0 # CodeFlowAuth</a>) ein Client einen&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> einliefern kann, um einen&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> zu erhalten. <b>&lt;=</b></p>
  </div> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-104347">5.2.1 Authorization Server Eingangsdaten</h4> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111907|external=true|anchor=91e263c6-c0a8e834-598480ea-f9a601df">
   ML-111907
   <p><b>A_20698</b></p>
   <p>Der Authorization-Endpunkt MUSS die im Authorization Request des Authenticator-Moduls mitgelieferten&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CODE_CHALLENGE</span> und den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SCOPE</span> annehmen. <b>&lt;=</b></p>
  </div> 
  <p id="polarion_201"> <span style="font-style: italic;">Hinweis: Der Aufbau der Anfrage entspricht [gemSpec_IDP_Dienst#Kapitel 7.1 Authorization Request].</span> </p> 
  <p id="polarion_203"></p> 
  <p id="polarion_149"> <span style="font-style: italic;">Hinweis: Nach [<a href="https://openid.net/specs/openid-connect-core-1_0.html#AuthRequest" target="_top" class="descriptionLink">openid-connect-core-1_0.html # AuthRequest</a>]&nbsp;ist es zulässig, dass ein Client mehrere redirect_uri bei der Registrierung hinterlegt. Der IdP-Dienst muss laut der OIDC-Spezifikation prüfen, ob die im Request gelieferte redirect_uri mit exakt einer der hinterlegten redirect_uri übereinstimmt. Die Prüfung muss über eine Simple String Comparison nach [<a href="https://tools.ietf.org/html/rfc3986#section-6.2.1" target="_top" class="descriptionLink">RFC3986 # section-6.2.1</a>]&nbsp;erfolgen.&nbsp;</span> </p> 
  <p id="polarion_28"> <span style="font-style: italic;">Hinweis 1: Der Aufbau der Anfrage entspricht [gemSpec_IDP_Dienst#Kapitel 7.3 Authentication Request].</span> </p> 
  <p id="polarion_169"> <span style="font-style: italic;">Hinweis 2: Als Verschlüsselungsalgorithmus ist ECDH-ES (Elliptic Curve Diffie-Hellman Ephemeral Static key agreement) vorgesehen.</span> </p> 
  <p id="polarion_683"> <span style="font-style: italic;font-size: 10pt;line-height: 1.5;">Hinweis 3: Die Prüfung auf zeitliche Gültigkeit des Challenge-Token nach Entschlüsselung ist hiervon unbenommen. Die geschilderte Vorabprüfung gestattet dem IDP-Dienst, bei Empfang von zeitlich ungültigen Token auf eine Entschlüsselung zu verzichten.</span> </p> 
  <p id="polarion_757"> <span style="font-style: italic;">Hinweis: Der genaue Aufbau des vom Authenticator-Modul übertragenen, signierten <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE_TOKEN</span></span> <span style="font-style: italic;">findet sich in [gemSpec_IDP_Dienst#Kapitel 7.3 Authentication Request].</span> </p> 
  <p id="polarion_136"> <span style="font-style: italic;">Hinweis: Der Authorization-Endpunkt muss damit die im <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> gelieferten Claims überprüfen und einen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> für den angefragten Fachdienst ausstellen.</span> </p> 
  <p id="polarion_130"> <span style="font-style: italic;">Hinweis: Die Gültigkeitsdauer des <span style="font-weight: normal;font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> wird im Claim des angesprochenen Fachdienstes definiert.</span> </p> 
  <p id="polarion_99"> <span style="font-style: italic;">Hinweis: Die Gültigkeitsdauer des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS</span><span style="font-weight: normal;font-family: 'Courier New', Courier, monospace, HanWangKanTan;">_TOKEN</span> wird im Claim des angesprochenen Fachdienstes definiert.</span> </p> 
  <p id="polarion_733"></p> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110501|external=true|anchor=91e26604-c0a8e834-598480ea-4d3c5631">
   ML-110501
   <p><b>A_20376</b></p>
   <p>Der Authorization-Endpunkt MUSS den vom Anwendungsfrontend initiierten "state"-Parameter gemäß [<a class="descriptionLink" target="_top" href="https://tools.ietf.org/html/rfc6749#section-10.12">RFC6749 # section-10.12</a>] bei einer Redirection an den Client in seiner Antwort verwenden. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111990|external=true|anchor=91e26797-c0a8e834-598480ea-de76553d">
   ML-111990
   <p><b>A_20731</b></p>
   <p>Der Authorization-Endpunkt <span style="font-weight: normal;">MUSS</span> den Parameter <span style="font-weight: normal;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">auth_time</span> mit dem Zeitpunkt der letzten Authentisierung gegen das zugelassene Authentifizierungsmittel (z.B. <span style="font-size: 10pt;line-height: 1.5;">Auslösen der Signatur durch Smartcard in freigeschaltetem Zustand</span>) setzen. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-117450|external=true|anchor=91e267d3-c0a8e834-598480ea-678bafa9">
   ML-117450
   <p><b>A_20440-01</b></p>
   <p>Der IDP-Dienst MUSS die bei der organisatorischen Registrierung der App hinterlegten redirect_uri mit der redirect_uri aus dem Claim des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE_TOKEN</span> prüfen. Stimmen diese nicht überein, werden keine Token ausgestellt und die weitere Verarbeitung mit einem Fehler Response abgebrochen (vgl. https://openid.net/specs/openid-connect-core-1_0.html#AuthError). <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110664|external=true|anchor=91e2680e-c0a8e834-598480ea-439cb4f8">
   ML-110664
   <p><b>A_20459</b></p>
   <p><span style="font-weight: normal;">Der Authorization-Endpunkt DARF den Zeitpunkt der letzten Authentisierung im Attribut <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">auth_time</span> NICHT verändern.</span> <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-117841|external=true|anchor=91e26874-c0a8e834-598480ea-ed16d0ac">
   ML-117841
   <p><b>A_20699-03</b></p>
   <p>Der Authorization-Endpunkt MUSS:<br> 
    <ul>
     <li>entweder das mit dem Zertifikat der Smartcard des Nutzers signierte und durch das Authenticator-Modul mittels <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PuK_IDP_ENC</span> verschlüsselte <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE_TOKEN</span></li>
     <li>oder – im Fall der Verwendung von alternativen Authentisierungsmitteln – die mit dem privaten Schlüssel des Endgeräts signierte und durch das Authenticator-Modul mittels <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PuK_IDP_ENC</span> verschlüsselte Authentication_Data-Struktur</li>
    </ul>annehmen. Er MUSS in beiden Fällen anhand des im Header vorhandenen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">exp</span>-Claim die Token anhand der Systemzeit auf zeitliche Gültigkeit prüfen. Sind diese nicht mehr gültig, MUSS der Authentifizierungsvorgang abgebrochen werden. Im Fall der Gültigkeit MÜSSEN diese mit dem PrK.IDP.ENC entschlüsselt werden. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-114487|external=true|anchor=91e268ab-c0a8e834-598480ea-1eb1d4b1">
   ML-114487
   <p><b>A_20951-01</b></p>
   <p><span style="font-family: Arial, Helvetica;">Der Authorization-Endpunkt MUSS die Signatur des vom Authenticator-Modul übertragenen, signierten</span> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE_TOKEN</span> <span style="font-family: Arial, Helvetica;">anhand des mitgelieferten Authentifizierungs-Zertifikats überprüfen. Die Überprüfung MUSS neben der Signatur auch das Authentifizierungszertifikat anhand von OCSP umfassen.</span> <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125078|external=true|anchor=91e268e3-c0a8e834-598480ea-32167e4f">
   ML-125078
   <p><b>A_22328</b></p>
   <p>Der IDP-Dienst MUSS die Werte der Attribute "KeyUsage" und "ExtendedKeyUsage" des AUT-Zertifikats des vom Authenticator-Moduls gelieferten Response der Challenge prüfen und eine weitere Verarbeitung verweigern, wenn nicht die folgenden vorgesehenen Werte - neben möglichen weiteren Werten - enthalten sind:<br>intendedKeyUsage = digitalSignature;<br>intendedExtendedKeyUsage = id-kp-clientAuth.<br>Die Nutzung des Attributs "ExtendedKeyUsage" ist optional, weshalb der IDP-Dienst die Überprüfung des Wertes des Attributs "ExtendedKeyUsage" nur durchführen muss, wenn das Attribut auch vorhanden ist. Ein generelles Fehlen des Attributs "ExtendedKeyUsage" führt nicht zur Ablehnung. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-117453|external=true|anchor=91e2691b-c0a8e834-598480ea-c9005b42">
   ML-117453
   <p><b>A_20946-01</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der Authorization-Endpunkt MUSS einen vom Authenticator-Modul übertragenen&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> annehmen, sofern anhand der übertragenen&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">client_id</span> festgestellt wird, dass im Registrierungsprozess für diese&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">client_id</span> die Verwendung eines&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> hinterlegt wurde. Ansonsten MUSS der IdP-Dienst die Verarbeitung mit einer Fehlermeldung abbrechen.</span><br> <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-114496">
   ML-114496
   <p><b>A_20313-01</b></p>
   <p>Der IDP-Dienst MUSS <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span> und <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> für unterschiedliche Fachdienste gemäß den mit dem&nbsp;jeweiligen Fachdienst abgestimmten Claims bereitstellen. <br> <br>Sind Inhalte des Claims teilweise oder das gesamte Claim für einen registrierten Fachdienst nicht gesetzt, befüllt der IDP-Dienst die einzelnen Parameter der Gültigkeitsdauer für&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span>&nbsp;und&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span> gemäß der spezifizierten Maximalwerte <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-112824|external=true|anchor=91e263fe-c0a8e834-598480ea-8ad3f5a6">
   ML-112824
   <p><b>A_20947</b></p>
   <p>Der Authorization-Endpunkt MUSS den angenommenen&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> mit seinem eigenen Schlüsselmaterial, welches zur Verschlüsselung genutzt wurde, entschlüsseln. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-117407|external=true|anchor=91e26436-c0a8e834-598480ea-8c7f4edc">
   ML-117407
   <p><b>A_20948-01</b></p>
   <p>Der Authorization-Endpunkt MUSS den angenommenen und entschlüsselten&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> validieren. Die Validierung MUSS die Überprüfung der Signatur anhand seines öffentlichen Schlüssels <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PuK_IDP_SIG</span> und die Überprüfung der zeitlichen Gültigkeit des&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> anhand des Attributs&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">auth_time</span> umfassen. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-112827|external=true|anchor=91e2646e-c0a8e834-598480ea-ff0f0a2a">
   ML-112827
   <p><b>A_20949</b></p>
   <p>Der Authorization-Endpunkt MUSS eine neue Authentisierung vom Authenticator-Modul anfordern, wenn die Validierung des vom Authenticator-Moduls eingereichten&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> fehlschlägt. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-117451|external=true|anchor=91e264a6-c0a8e834-598480ea-85e09478">
   ML-117451
   <p><b>A_20950-01</b></p>
   <p>Der Authorization-Endpunkt MUSS bei der positiven Validierung des vom Authenticator-Moduls eingereichten <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> einen&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> für den angefragten Fachdienst ausstellen. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110797|external=true|anchor=91e264de-c0a8e834-598480ea-fb056dee">
   ML-110797
   <p><b>A_20522</b></p>
   <p>Der Authorization-Endpunkt MUSS eine neue&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SESSION_ID</span> anlegen, sobald ein Authorization Request eingeht. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110798|external=true|anchor=91e26518-c0a8e834-598480ea-9c584b7d">
   ML-110798
   <p><b>A_20523</b></p>
   <p>Der Authorization-Endpunkt MUSS die für den vorgetragenen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SCOPE</span> vom einfordernden Fachdienst erwarteten Claims zur <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">USER_CONSENT</span>-Anfrage zusammenstellen. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-114495|external=true|anchor=91e26551-c0a8e834-598480ea-b38c9187">
   ML-114495
   <p><b>A_20692-01</b></p>
   <p>Der Authorization Server DARF die zeitliche Gültigkeit eines <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span>&nbsp;NICHT länger als 86400 Sekunden (24 Stunden) einstellen.<br>Der Parameter <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">auth_time</span> beinhaltet den Zeitpunkt der letzten Authentisierung. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-117452|external=true|anchor=91e26591-c0a8e834-598480ea-f9b1963f">
   ML-117452
   <p><b>A_20314-01</b></p>
   <p>Der Authorization Server DARF die zeitliche Gültigkeit des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE_TOKEN</span> NICHT länger als 180 Sekunden (Challenge-Response) und die des&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> NICHT länger als 60 Sekunden einstellen. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-114501|external=true|anchor=91e265ca-c0a8e834-598480ea-a6e14cbd">
   ML-114501
   <p><b>A_20315-01</b></p>
   <p>Der Token-Endpunkt DARF <span style="font-size: 10pt;line-height: 1.5;">außerhalb der Gültigkeitsdauer&nbsp;</span>eingehenden <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> NICHT in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span> oder <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> eintauschen. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110667|external=true|anchor=91e2663e-c0a8e834-598480ea-e364743a">
   ML-110667
   <p><b>A_20462</b></p>
   <p>Der Token-Endpunkt DARF <span style="font-weight: normal;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">ID_TOKEN</span> mit einer Gültigkeitsdauer <span style="font-weight: normal;">von mehr</span> als 86400 <span style="font-weight: normal;">Sekunden (24 Stunden)</span> NICHT ausstellen. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110668|external=true|anchor=91e26673-c0a8e834-598480ea-41d68122">
   ML-110668
   <p><b>A_20463</b></p>
   <p>Der Token-Endpunkt DARF <span style="font-weight: normal;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">ACCESS_TOKEN</span> <span style="font-weight: normal;">mit einer Gültigkeitsdauer von mehr</span> als 300 <span style="font-weight: normal;">Sekunden (5 Minuten)</span> NICHT ausstellen. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110669|external=true|anchor=91e266b2-c0a8e834-598480ea-ec8575f5">
   ML-110669
   <p><b>A_20464</b></p>
   <p>Der Token-Endpunkt <span style="font-weight: normal;">DARF andere Informationen, als die im Claim geforderten, NICHT&nbsp;</span>herausgeben. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110428|external=true|anchor=91e266ec-c0a8e834-598480ea-83d42a4e">
   ML-110428
   <p><b>A_20318</b></p>
   <p>Der Authorization-Endpunkt DARF für nicht existente Entitäten NICHT einen&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION</span><span style="font-weight: normal;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">_CODE</span><span style="font-weight: bold;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">,</span>&nbsp;einen&nbsp;<span style="font-weight: normal;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">ID_TOKEN</span>, einen&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> oder einen&nbsp;<span style="font-weight: normal;font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> auszustellen.&nbsp; <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110670|external=true|anchor=91e26724-c0a8e834-598480ea-c000353a">
   ML-110670
   <p><b>A_20465</b></p>
   <p>Der Authorization-Endpunkt MUSS das Zertifikat des Antragstellers immer gegen den zugehörigen&nbsp;OCSP-Responder innerhalb der TI auf Gültigkeit prüfen. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125012|external=true|anchor=91e2675d-c0a8e834-598480ea-45563e79">
   ML-125012
   <p><b>A_22290</b></p>
   <p>Der Produkttyp IDP MUSS OCSP-Antworten zu Gültigkeitsanfragen für <span style="font-size: 10pt;line-height: 1.5;">Smartcard-basierte&nbsp;</span>Zertifikate zwischenspeichern und bei einer erneuten Prüfung desselben Zertifikates anstelle einer neuen OCSP-Anfrage diese zwischengespeicherte Information verwenden. <br>Die Informationen MÜSSEN jeweils für einen konfigurierbaren Zeitraum&nbsp;<span style="font-size: 10pt;line-height: 1.5;">(von maximal 60 Minuten)&nbsp;</span>gespeichert werden.<br>Voreingestellt sind 30 Minuten.<br>Der TUC_PKI_006 und der eingebaute Cache des OCSP-Responder sind hierbei zu berücksichtigen. <b>&lt;=</b></p>
  </div> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-104344">5.2.2 Authorization-Endpunkt Ausgangsdaten</h4> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-114486|external=true|anchor=91e26953-c0a8e834-598480ea-07cff61d">
   ML-114486
   <p><b>A_20521-02</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der IDP-Dienst MUSS die ihm vorliegenden Session-Informationen (z.B.&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SESSION_ID</span>, <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CODE_CHALLENGE</span>, <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SCOPE</span> und alle Informationen über Anwendungsfrontend und Authenticator-Modul) mit seinem privaten Schlüssel&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PrK_IDP_SIG</span> und der technischen Rolle "oid_idpd“ gemäß [gemSpec_OID # Abschnitt 3.5.4] signieren und als JWT ergänzt um die&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">USER_CONSENT</span>-Anfrage an das Authenticator-Modul senden. Als Algorithmus ist dementsprechend "BP256R1" zu wählen.</span> <b>&lt;=</b></p>
  </div> 
  <p id="polarion_392" class="MsoNormal"> <span style="font-weight: normal;">Konnten alle Prüfungen des eingereichten Consent erfolgreich abgeschlossen werden, erstellt der Authorization-Endpunkt ein <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">ID_TOKEN</span></span>, <span style="font-weight: normal;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">ACCESS_TOKEN</span>, <span style="font-weight: normal;">ergänzt durch ein <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span>. Die Übertragung der </span>Token<span style="font-weight: normal;"> erfolgt jedoch nicht direkt über das Authenticator-Modul, sondern in Form eines <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span>. Die Token werden am Token-Endpunkt zum Download bereitgestellt, wo das jeweilige Anwendungsfrontend diese gegen gleichzeitige Vorlage von <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">authorization_code</span> und des eigenen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">code_verifier</span>, auf we</span>lchem der bereits vorliegende Hash-Wert beruht, erhält. </p> 
  <p id="polarion_765"> <span style="font-style: italic;">Hinweis: Der genaue Aufbau der Antwort und des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE_TOKEN</span></span> <span style="font-style: italic;">entspricht [gemSpec_IDP_Dienst#Kapitel 7.2 Authorization Response].</span> </p> 
  <p id="polarion_126"> <span style="font-style: italic;">Hinweis: Der Aufbau der Header entspricht [gemSpec_IDP_Dienst#Kapitel 7.4 Authentication Response].</span> </p> 
  <p id="polarion_122"> <span style="font-style: italic;">Hinweis: Der genaue Aufbau der Antwort entspricht [gemSpec_IDP_Dienst#Kapitel 7.4 Authentication Response].</span> </p> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110502|external=true|anchor=91e269fc-c0a8e834-598480ea-ed32a250">
   ML-110502
   <p><b>A_20377</b></p>
   <p>Der Authorization-Endpunkt MUSS den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">state</span>-Parameter [<a class="descriptionLink" target="_top" href="https://tools.ietf.org/html/rfc6749#section-10.12">RFC6749 # section-10.12</a>] des Anwendungsfrontends in allen darauf basierenden Responses verwenden. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111903|external=true|anchor=91e26a34-c0a8e834-598480ea-d02e9008">
   ML-111903
   <p><b>A_20694</b></p>
   <p>Der Authorization-Endpunkt MUSS den&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> so zusammenstellen, dass alle Informationen, welche für die Ausstellung eines neuen&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> benötigt werden, im Token vorhanden sind. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-117405|external=true|anchor=91e26a6d-c0a8e834-598480ea-a2b5de1d">
   ML-117405
   <p><b>A_20695-01</b></p>
   <p>Der Authorization-Endpunkt MUSS den&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> mit seinem eigenen privaten Schlüssel&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PrK_IDP_SIG</span> signieren.&nbsp;Als Algorithmus ist dementsprechend "BP256R1" zu wählen. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111905|external=true|anchor=91e26aa6-c0a8e834-598480ea-493f8bfa">
   ML-111905
   <p><b>A_20696</b></p>
   <p>Der Authorization-Endpunkt verschlüsselt den&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> für sich selbst mit eigenem Schlüsselmaterial, welches die gemSpec_Krypt beachtet. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-111906|external=true|anchor=91e26adf-c0a8e834-598480ea-7e24d4a0">
   ML-111906
   <p><b>A_20697</b></p>
   <p>Der Authorization-Endpunkt erzeugt den&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> anhand der vom Authenticator-Modul übergebenen Daten im&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE</span>. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116334|external=true|anchor=91e26b16-c0a8e834-598480ea-cec0658d">
   ML-116334
   <p><b>A_21317</b></p>
   <p>Der Authorization-Endpunkt des IdP-Dienstes MUSS den&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> für den Token-Endpunkt mit eigenem Schlüsselmaterial verschlüsseln, welches den Anforderungen aus [gemSpec_Krypt] genügt. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-117510|external=true|anchor=91e26b4f-c0a8e834-598480ea-92c8b6c8">
   ML-117510
   <p><b>A_20319-01</b></p>
   <p>Der IDP-Dienst MUSS den&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> für die Authentisierung mit einem Zertifikat des Typs FD.SIG und der technischen Rolle „oid_idpd“ gemäß [gemSpec_OID # Abschnitt 3.5.4] signieren, damit das Authenticator-Modul sicher gewährleisten kann, dass der eingehende <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span>&nbsp;tatsächlich vom IDP-Dienst stammt [<a class="descriptionLink" target="_top" href="https://tools.ietf.org/html/rfc7519#section-7.1">RFC7519 # section-7.1</a>]. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116366|external=true|anchor=91e26b86-c0a8e834-598480ea-efc8c41d">
   ML-116366
   <p><b>A_21330</b></p>
   <p>Der Authorization-Endpunkt des IDP-Dienstes MUSS im "exp"-Claim des jeweiligen JWE Headers den Ablaufzeitpunkt des&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> bzw.&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> liefern. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-114465|external=true|anchor=91e2698b-c0a8e834-598480ea-186dcef2">
   ML-114465
   <p><b>A_20693-01</b></p>
   <p>Der IDP-Dienst MUSS den&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> und die registrierte&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">REDIRECT_URI</span> an das Authenticator-Modul&nbsp;senden. Der IDP-Dienst MUSS zusätzlich einen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> mitliefern, wenn die <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">client_id</span> im Registrierungsprozess des Anwendungsfrontends für die Nutzung eines <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> freigeschaltet wurde. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-117577|external=true|anchor=91e269c4-c0a8e834-598480ea-84ce9ec0">
   ML-117577
   <p><b>A_20320-01</b></p>
   <p>Der Authorization-Endpunkt MUSS den Transport des&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> über unsichere Netze (z.B. Internet) durch Verwendung von Transport Layer Security (TLS) gemäß den Vorgaben der [gemSpec_Krypt] sichern [<a class="descriptionLink" target="_top" href="https://tools.ietf.org/html/rfc7523#section-7">RFC7523 # section-7</a>]. <b>&lt;=</b></p>
  </div> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104341">5.3 Token-Endpunkt</h3> 
  <p id="polarion_408" class="MsoNormal"> Am Token-Endpunkt nimmt der Authorization Server den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span>, welchen er selbst am Authorization-Endpunkt ausgegeben hat, entgegen. Da beide vom Authorization Server selbst erstellt wurden, ist deren Prüfung auf Integrität keine besondere Herausforderung. Allerdings muss der Token-Endpunkt beim Einreichen eines <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> das dabei mit übertragene <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CODE_VERIFIER</span> verarbeiten, um mittels Vergleich der Hash-Werte die Übereinstimmung des den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> einreichenden mit dem ursprünglich authentisierten Client sicherzustellen. Das verwendete Hash-Verfahren ist im Authorization Request anzugeben. </p> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-104345">5.3.1 Token-Endpunkt Eingangsdaten</h4> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116335|external=true|anchor=91e26bc0-c0a8e834-598480ea-52b11846">
   ML-116335
   <p><b>A_20321-01</b></p>
   <p>Der Token-Endpunkt MUSS den vom Anwendungsfrontend übertragenen&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> und den&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">KEY_VERIFIER</span> des Anwendungsfrontend annehmen. Der&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> ist dabei mittels eines durch den IDP-Dienst für Authorization-Endpunkt und Token-Endpunkt definierten Verfahren zu entschlüsseln.&nbsp; <b>&lt;=</b></p>
  </div> 
  <p id="polarion_766"> <span style="font-style: italic;">Hinweis 1:<span style="font-style: normal;"> </span>Der Aufbau der Anfrage entspricht [gemSpec_IDP_Dienst#Kapitel 7.5 Token Request].</span> </p> 
  <p id="polarion_72"> <span style="font-style: italic;">Hinweis 2: Als Verschlüsselungsalgorithmus für den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">KEY_VERIFIER</span> ist ECDH-ES (Elliptic Curve Diffie-Hellman Ephemeral Static key agreement) vorgesehen.</span> </p> 
  <p id="polarion_17"> <span style="font-style: italic;">Hinweis: Der Aufbau des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">KEY_VERIFIER</span> entspricht [gemSpec_IDP_Dienst#Kapitel 7.5 Token Request].</span> </p> 
  <p id="polarion_767"> <span style="font-style: italic;">Hinweis: Der Aufbau des&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">KEY_VERIFIER</span> entspricht [gemSpec_IDP_Dienst#Kapitel 7.5 Token Request].</span> </p> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116336|external=true|anchor=91e26bf7-c0a8e834-598480ea-d2e4464b">
   ML-116336
   <p><b>A_21318</b></p>
   <p>Der Token-Endpunkt MUSS die Signatur des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> unter Verwendung des Schlüssels <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PuK_IDP_SIG</span> prüfen. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116337|external=true|anchor=91e26c2f-c0a8e834-598480ea-54fb5520">
   ML-116337
   <p><b>A_21319</b></p>
   <p>Der Token-Endpunkt MUSS den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CODE_VERIFIER</span> aus dem mittels <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PuK_IDP_ENC</span> verschlüsselten&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">KEY_VERIFIER</span> extrahieren und die Überprüfung gegen die <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CODE_CHALLENGE</span> mit S256 (Algorithmus nach [<a href="https://tools.ietf.org/html/rfc7636#section-4.2" target="_top" class="descriptionLink">RFC7636 # section-4.2</a>]) durchführen. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116338|external=true|anchor=91e26c68-c0a8e834-598480ea-0ce7b5ac">
   ML-116338
   <p><b>A_21320</b></p>
   <p>Der Token-Endpunkt MUSS den "Token-Key" aus dem mittels <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PuK_IDP_ENC</span> verschlüsselten&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">KEY_VERIFIER</span> extrahieren. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116314|external=true|anchor=91e26ca2-c0a8e834-598480ea-5f6765d1">
   ML-116314
   <p><b>A_21309</b></p>
   <p>Der Anbieter des IDP-Dienstes KANN gegen [<a class="descriptionLink" target="_top" href="https://tools.ietf.org/html/rfc6749#section-10.5">RFC6749 # section-10.5</a>]&nbsp;verstoßen, indem der IDP-Dienst nicht die einmalige Verwendung eines <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> überprüft. Die kurze Gültigkeit und die Verschlüsselung der ausgestellten Token wird als ausreichend sicher betrachtet. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-110434|external=true|anchor=91e26ce6-c0a8e834-598480ea-cd89334e">
   ML-110434
   <p><b>A_20323</b></p>
   <p>Der Token-Endpunkt <span style="font-weight: normal;">MUSS</span> die Herausgabe der <span style="font-weight: normal;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">TOKEN</span> im Positiv- wie auch im Negativfall protokollieren. <b>&lt;=</b></p>
  </div> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-104342">5.3.2 Token-Endpunkt Ausgangsdaten</h4> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125076|external=true|anchor=91e26d2b-c0a8e834-598480ea-fc5a8b1d">
   ML-125076
   <p><b>A_20524-04</b></p>
   <p>Der Token-Endpunkt MUSS benötigte Attribute in Claims für das auszustellende <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> und das <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span> ausschließlich aus dem ihm mit dem&nbsp;<span style="font-family: Arial, Helvetica;">signierten</span> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE_TOKEN</span> eingereichten Authentifizierungszertifikat der Smartcard (eGK, HBA oder SMC-B) beziehen. Der Claim <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">amr</span> MUSS entsprechend des ursprünglich zur Authentisierung verwendeten Authentisierungsmittels belegt werden.<br>Der Token-Endpunkt MUSS das Attribut <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">given_name</span> und <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">family_name</span> der juristischen und natürlichen Personen sowie die Attribute&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">organizationName,professionOID</span> und&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">idNummer</span>&nbsp;entsprechend dem Datenformat der Informationsquelle (Zertifikat) wie folgt befüllen:<br> <br> <p data-keep-next="true" class="polarion-rte-caption-paragraph" id="polarion___1">Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">4</span>:&nbsp;TAB_IDP_DIENST_0005 Befüllung der Attribute "given_name", "family_name", "organizationName", "professionOID" und "idNummer"&nbsp;</p>
    <table id="polarion_wiki macro name=table;params=width=100%" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;">
     <tbody>
      <tr>
       <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 131px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Attribute</th>
       <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 171px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Leistungserbringer (HBA)<br> Quell-Zertifikat: C.HP.AUT</th>
       <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 231px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Leistungserbringerinstitution (SMC-B)<br> Quell-Zertifikat: C.HCI.AUT</th>
       <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 179px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Versicherte (eGK)<br> Quell-Zertifikat: C.CH.AUT</th>
      </tr>
      <tr>
       <td style="width: 131px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">given_name<br> (</span>Zertifikatsfeld<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">)</span></td>
       <td style="width: 171px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Vorname<br> (givenName)</td>
       <td style="width: 231px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Vorname des Verantwortlichen/Inhabers<br> givenName)</td>
       <td style="width: 179px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Vorname<br> (givenName)</td>
      </tr>
      <tr>
       <td style="width: 131px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">family_name</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">(</span>Zertifikatsfeld<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">)</span></td>
       <td style="width: 171px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Nachname<br> (surname)</td>
       <td style="width: 231px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Nachname des Verantwortlichen/Inhabers<br> (surname)</td>
       <td style="width: 179px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Nachname<br> (surname)</td>
      </tr>
      <tr>
       <td style="width: 131px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">organizationName</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">(</span>Zertifikatsfeld<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">)</span></td>
       <td style="width: 171px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">leer<br> (organizationName)</td>
       <td style="width: 231px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Organisationsbezeichnung<br> (commonName)&nbsp;</td>
       <td style="width: 179px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Herausgeber<br> (organizationName)</td>
      </tr>
      <tr>
       <td style="width: 131px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">professionOID</span><br> <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">(</span>Zertifikatsfeld<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">)</span></td>
       <td style="width: 171px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">professionOID<br> (Admission/professionOID)</td>
       <td style="width: 231px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">professionOID<br> (Admission/professionOID)</td>
       <td style="width: 179px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">professionOID<br> (Admission/professionOID)</td>
      </tr>
      <tr>
       <td style="width: 131px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Identifier <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">idNummer<br> (</span><span style="font-size: 10pt;line-height: 1.5;">Zertifikatsfeld</span><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">)</span></td>
       <td style="width: 171px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Telematik-ID<br> (Admission/<br> registrationNumber)</td>
       <td style="width: 231px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Telematik-ID<br> (Admission/<br> registrationNumber)</td>
       <td style="width: 179px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">unveränderlicher Anteil der&nbsp;</span>KVNR<br> (organizationalUnitName)</td>
      </tr>
     </tbody>
    </table><br> <br> <p class="polarion-rte-caption-paragraph" id="polarion___2">Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">5</span>:&nbsp;TAB_IDP_DIENST_0006 Befüllung der Attribute "acr" und "amr"</p>
    <table id="polarion_wiki macro name=table;params=width=99.56%" class="polarion-Document-table" style="width: 99.56%;margin-left: 0px;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;">
     <tbody>
      <tr>
       <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Attribut</th>
       <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 184px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Leistungserbringer (HBA)</th>
       <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 203px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Leistungserbringerinstitution (SMC-B)</th>
       <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 207px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Versicherte (eGK)</th>
       <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 466px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Versicherte (alternative Authentisierungsmittel)</th>
      </tr>
      <tr>
       <td style="width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">amr</span></td>
       <td style="width: 184px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[„mfa“,“sc“,“pin“]</td>
       <td style="width: 203px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[„mfa“,“sc“,“pin“]</td>
       <td style="width: 207px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[„mfa“,“sc“,“pin“]</td>
       <td style="width: 466px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Gemäß des übertragenen Werts des Authenticator-Moduls in der Datenstruktur "Signed_Authentication_Data"</td>
      </tr>
      <tr>
       <td style="width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">acr</span></td>
       <td style="width: 184px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik-ehealth-loa-high<br></td>
       <td style="width: 203px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik-ehealth-loa-high<br></td>
       <td style="width: 207px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik-ehealth-loa-high<br></td>
       <td style="width: 466px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">gematik-ehealth-loa-high<br></td>
      </tr>
     </tbody>
    </table> <b>&lt;=</b></p>
  </div> 
  <p id="polarion_419" class="MsoNormal">Alle vom IDP-Dienst herausgegebenen Informationen müssen mit dem privateKey des jeweiligen Teildienstes signiert sein, da die mit TLS abgesicherte Verbindung nicht in allen Anwendungsszenarien die Integrität der übertragenen Daten gewährleistet.</p> 
  <p id="polarion_116"></p> 
  <p id="polarion_226"> <span style="font-style: italic;">Hinweis: Der Aufbau von <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN </span>und <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN </span>entspricht [gemSpec_IDP_Dienst#Kapitel 7.6 Token Response].</span> </p> 
  <p id="polarion_142"> <span style="font-style: italic;">Hinweis 1: <span style="font-size: 10pt;line-height: 1.5;">Das Vertrauensniveau "gematik-ehealth-loa-high" ist aktuell das einzige LOA das der e-Rezept Fachdienst kennt. Für die zukünftigen föderierten Identity Provider wird es weiter abgestufte Vertrauensniveaus geben.</span></span> </p> 
  <p id="polarion_145"> <span style="font-style: italic;">Hinweis 2: Der Aufbau von <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span></span> <span style="font-style: italic;">und <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN </span>entspricht [gemSpec_IDP_Dienst#Kapitel 7.6 Token Response].</span><span id="polarion-comment:1612"></span> </p> 
  <p id="polarion_119"> <span id="polarion-comment:1459"></span><span style="font-style: italic;">Hinweis:&nbsp;Für den E-Rezept-Fachdienst wird beispielsweise der folgende Wert genutzt: "<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">aud</span>" : "erp.zentral.erp.ti-dienste.de".</span> </p> 
  <p id="polarion_770"></p> 
  <p id="polarion_161"> <span style="font-style: italic;">Hinweis: Zum Aufbau des Signaturheader siehe [gemSpec_IDP_Dienst#Kapitel 7.6 Token Response].</span> </p> 
  <p id="polarion_47"></p> 
  <p id="polarion_112"> <span style="font-style: italic;">Hinweis: Zum Aufbau des Verschlüsselungs-Header siehe [gemSpec_IDP_Dienst#Kapitel 7.6 Token Response].</span> </p> 
  <p id="polarion_131"> <span style="font-style: italic;">Hinweis<span style="font-style: normal;">: </span>Der Aufbau von <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> und <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span> entspricht [gemSpec_IDP_Dienst#Kapitel 7.6 Token Response].</span> </p> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124978|external=true|anchor=91e26d73-c0a8e834-598480ea-d20520c3">
   ML-124978
   <p><b>A_22271</b></p>
   <p>Der Token-Endpunkt MUSS benötigte Attribute in Claims für das auszustellende&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span>&nbsp;und das&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span>&nbsp;ausschließlich aus den entsprechenden Claims des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span> des sektoralen Identity Provider&nbsp;beziehen.<br>Der Claim <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">amr</span> MUSS entsprechend des ursprünglich zur Authentisierung verwendeten Authentisierungsmittels belegt werden.<br> <br> <p class="polarion-rte-caption-paragraph" data-keep-next="true" id="polarion___3">Tabelle&nbsp;<span class="polarion-rte-caption" data-sequence="Tabelle">6</span>:&nbsp;TAB_IDP_DIENST_000X Befüllung der Attribute nach Bestätigung durch einen sektoralen Identity Provider</p>
    <table style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;" class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%">
     <tbody>
      <tr>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 350.462px;height: 38.175px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Attribute</th>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 380.538px;height: 38.175px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Versicherte</th>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 350.462px;height: 43.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">given_name</span><br> (Claim)</td>
       <td style="text-align: left;vertical-align: top;width: 380.538px;height: 43.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Vorname<br> (given_name)</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 350.462px;height: 43.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">family_name</span><br> (Claim)</td>
       <td style="text-align: left;vertical-align: top;width: 380.538px;height: 43.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Nachname<br> (family_name)</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 350.462px;height: 43.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">organizationName</span><br> (Claim)</td>
       <td style="text-align: left;vertical-align: top;width: 380.538px;height: 43.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Herausgeber-ID<br> (organization_number)</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 350.462px;height: 41.8125px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">professionOID</span><br></td>
       <td style="text-align: left;vertical-align: top;width: 380.538px;height: 41.8125px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">1.2.276.0.76.4.49</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 350.462px;height: 43.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Identifier&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">idNummer</span><br> (Claim)</td>
       <td style="text-align: left;vertical-align: top;width: 380.538px;height: 43.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">unveränderlicher Teil der KV-Nummer<br> (idNummer)</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 350.462px;height: 42.725px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">amr</span></td>
       <td style="text-align: left;vertical-align: top;width: 380.538px;height: 42.725px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">"mfa"</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 350.462px;height: 42.725px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">acr</span></td>
       <td style="text-align: left;vertical-align: top;width: 380.538px;height: 42.725px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">"gematik-ehealth-loa-high"</td>
      </tr>
     </tbody>
    </table> <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-113115|external=true|anchor=91e26dac-c0a8e834-598480ea-3d866934">
   ML-113115
   <p><b>A_20952</b></p>
   <p>Der IDP-Dienst MUSS den Claim&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">aud</span> im <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> entsprechend des angefragten Scopes des Authenticator-Moduls mit der URL des Fachdienstes füllen. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-125074|external=true|anchor=91e26de5-c0a8e834-598480ea-9a18c0df">
   ML-125074
   <p><b>A_22326</b></p>
   <p>Der IDP-Dienst MUSS je nach Ursprung (aus der TI oder aus dem Internet) des Aufrufs des Authentication Request den Issuer Claim <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">iss</span> in seinen ausgestellten Token analog zum Issuer Claim&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">issuer</span> des jeweiligen Discovery Document - intern (TI) oder extern (Internet) - setzen. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116339|external=true|anchor=91e26e1e-c0a8e834-598480ea-a5f45a7b">
   ML-116339
   <p><b>A_20327-02</b></p>
   <p>Der Token-Endpunkt MUSS alle erstellten&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span> und&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span>, um deren Integrität sicherzustellen und eine eineindeutige Erklärung über deren Herkunft abzugeben, mit seinem privaten Schlüssel&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PrK_IDP_SIG</span> signieren. [<a class="descriptionLink" target="_top" href="https://tools.ietf.org/html/rfc7523#section-3">RFC7523 # section-3</a>&nbsp; Spiegelpunkt 9] ist zu gewährleisten.&nbsp;Als Algorithmus ist dementsprechend "BP256R1" zu wählen. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116340|external=true|anchor=91e26e54-c0a8e834-598480ea-598ae1f0">
   ML-116340
   <p><b>A_21321</b></p>
   <p>Der Token-Endpunkt MUSS&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> und&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span> nach der Signatur mittels JWE [<a class="descriptionLink" target="_top" href="https://tools.ietf.org/html/rfc7516">RFC7516</a>]) unter Nutzung des "Token-Key" des Anwendungsfrontend verschlüsseln. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-114463|external=true|anchor=91e26ea2-c0a8e834-598480ea-e65f5785">
   ML-114463
   <p><b>A_20329-01</b></p>
   <p>Der Token-Endpunkt <span style="font-weight: normal;">MUSS</span> <span style="font-weight: normal;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #000000;">ID_TOKEN</span> und&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> beim Transport mit Transport Layer Security (TLS) gemäß [gemSpec_Krypt] schützen.&nbsp;<br> <b>&lt;=</b></p>
  </div> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-119229">5.4 Pairing-Endpunkt</h3> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-120406">5.4.1 Zielsetzung</h4> 
  <p id="polarion_760">Fachdienste der TI erfordern an Frontends der Versicherten in der Regel eine Authentisierung mithilfe der eGK. Während die Authentisierung auf Basis der eGK bei Verwendung von Mobilgeräten gegenüber dem IDP-Dienst im Dokument [gemSpec_IDP_Frontend] dargelegt ist,&nbsp;zielen die in diesem Dokument dargestellten Erweiterungen der IDP-Spezifikationen darauf ab, die Verwendung von alternativen Authentisierungsmitteln zu ermöglichen, die es Nutzern gestatten sich mithilfe eines Mobilgeräts und vom Nutzer lokal selbst gesetzten Authentisierungsmitteln (wie etwa biometrische oder wissensbasierte Faktoren) ohne weitere Verwendung der eGK gegenüber einem Fachdienst zu authentisieren.</p> 
  <p id="polarion_675">Unter alternativen Authentisierungsmitteln werden hierbei solche verstanden, die aus einem bereits etablierten Authentifizierungsmittel – wie etwa der eGK - abgeleitet werden und dieses in äquivalenter Form ersetzen. Unter einer „Ableitung“ wird hierbei eine zeitbeschränkte, unabhängig nachvollziehbare Beziehung zwischen einem vom Nutzer gesetzten Mittel und einem bereits etablierten Mittel verstanden.&nbsp;Alternative Authentisierungsmittel sind funktional dann anwendbar, wenn das ursprünglich etablierte Authentisierungsmittel anwendbar ist; ihr Lebenszyklus endet spätestens mit Ablauf des Authentisierungsmittels, das zur Ableitung verwendet wurde.&nbsp;</p> 
  <p id="polarion_679">Die zugrundeliegende Konzeption basiert auf der Verwendung von kryptographischen Verfahren in Kombination mit einem geeigneten Endgerät; eine Verwendung von anderen Authentisierungsmitteln gegenüber dem IDP, wie etwa dort hinterlegte Passwörter, ist nicht angestrebt. Grundlage für die kryptographischen Verfahren ist die Erzeugung eines asymmetrischen Schlüsselpaars auf dem Endgerät des Nutzers. Der öffentliche Schlüssel wird mit anderen Metadaten im Rahmen eines Registrierungsprozesses durch den Nutzer mithilfe seiner eGK gegenüber dem IDP-Dienst authentifiziert und am IDP-Dienst zur zukünftigen Authentifizierung des Nutzers registriert. Der zugehörige private Schlüssel wird vom Nutzer in äquivalenter Weise zu dem in [gemSpec_IDP_Dienst] und [gemSpec_IDP_Frontend] beschriebenen Challenge/Response-Verfahren zur Authentisierung angewendet. Bedingung für die Anwendung ist die erfolgreiche Authentifizierung des Nutzers durch lokal gesetzte Faktoren.&nbsp;&nbsp;</p> 
  <p id="polarion_739">Die Kombination von öffentlichem Schlüssel und Metadaten wird im Folgenden als "Pairing" bzw. "Pairing-Daten" benannt. Eine Authentisierung auf Basis des zu einem solchen öffentlichen Schlüssel gehörenden privaten Schlüssels wird "Pairing-basierte Authentisierung" genannt.&nbsp;Das Hinterlegen von Pairing-Daten am IDP-Dienst wird als "Registrierung" bezeichnet. Eine Authentifizierung auf Basis der Pairing-Daten wird als "Pairing-basierte Authentifizierung" bezeichnet. Das Gerät in Kombination mit privatem Schlüssel ist das alternative Authentisierungsmittel. Ein Pairing ist "aktiv", wenn es zur Authentifizierung verwendet werden kann. Voraussetzung für die Aktivierung ist die erfolgreiche Registrierung. Unter "Inspektion" durch den Nutzer wird die Möglichkeit zum Abruf der zu diesem Zweck auf seinem Gerät sowie der am IDP-Dienst gespeicherten Daten verstanden.&nbsp;Der Ausschluss eines alternativen Authentisierungsmittels oder Pairings zum Zweck der Authentifizierung wird "Deaktivierung" genannt. Eine Deaktivierung ist Folge einer Löschung des alternativen Authentisierungsmittels, eines vom Benutzer vollzogenen Deregistrierungsprozesses, des Endes der Gültigkeit des zur Etablierung verwendeten Authentisierungsmittels oder eine auf Basis einer Einstufung der Eignung des verwendeten Geräts getroffenen Entscheidung des IDP-Dienstes.&nbsp;Authentisierungsmethoden des Nutzers gegenüber seinem Gerät bzw. einem auf dem Gerät vorhandenen lokalen Nutzeraccount (z. B. durch biometrische Faktoren oder wissensbasierte Faktoren), werden im Folgenden "lokale Authentisierungsmittel", ihre Anwendung "lokale Authentisierung", ihre Prüfung durch das Gerät "lokale Authentifizierung" genannt.</p> 
  <p id="polarion_742"> <span style="font-size: 10pt;line-height: 1.5;">Der Begriff "isolierte Ausführungsumgebung" wird als abstrakter technik-neutraler Oberbegriff für die verschiedenen üblichen Realisierungsformen von auf Geräten verwendeten Schlüsselspeichern verwendet. Sowohl die Terminologie als auch die tatsächlichen Ausprägungen sind leider uneinheitlich. Typische herstellerspezifische Bezeichnungen oder Ausprägungen sind "Trusted Execution Environment", "Secure-Enclave", "StrongBox" oder "Secure-Element". Im Kontext der Einleitung wird hierunter ein geeignet realisierter Schlüsselspeicher verstanden, in dem Schlüssel erzeugt, gespeichert und gelöscht werden, und die Anwendung des Schlüssels (z. B. zum Zweck der Signaturbildung) auf Daten an bestimmte Bedingungen (wie etwa eine Benutzerauthentifizierung) geknüpft ist und der Zugriff auf die Schlüssel als Datenobjekte ausreichend verhindert wird.&nbsp;</span> </p> 
  <p id="polarion_743"> Die erfolgreiche Authentifizierung des Nutzers bei Verwendung von alternativen Mitteln soll an die in der folgenden Tabelle genannten Faktoren gebunden sein. Die dort genannten Anforderungen adressieren&nbsp;die Abwehr von missbräuchlicher Verwendung des alternativen Authentisierungsmittels bei Wegfall, Modifikation, vermuteter oder erkannter Kompromittierung einer dieser Faktoren durch Deaktivierung.<br> </p> 
  <p id="polarion_746" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">7</span>: Faktoren und abgeleitete Anforderungen an das System </p> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=747" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 201px;height: 18.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Motivation</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 210px;height: 18.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Faktoren</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 308px;height: 18.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Anforderungen an das System</th> 
    </tr> 
    <tr> 
     <td style="width: 201px;height: 425px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Die Verwendung von alternativen Authentisierungsmitteln ist an den Nutzer als Entität, seine Absicht diese zu nutzen und an das von ihm initial zur Registrierung verwendeten Authentisierungsmittel (hier: eGK) gebunden.</td> 
     <td style="width: 210px;height: 425px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> 
      <ul> 
       <li>der Nutzer als Entität</li> 
       <li>die Absicht des Nutzers zur Verwendung von alternativen Authentisierungsmitteln</li> 
       <li>die Bindung an das ursprüngliche Authentisierungsmittel</li> 
      </ul> <br> </td> 
     <td style="width: 308px;height: 425px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> 
      <ul> 
       <li>Die Etablierung eines alternativen Authentisierungsmittels erfolgt ausschließlich auf Initiative des Nutzers.&nbsp;</li> 
       <li>Die Etablierung eines alternativen Authentisierungsmittels ist an die eGK als bereits etabliertes Authentisierungsmittel gebunden.</li> 
       <li>Die Verwendung eines alternativen Authentisierungsmittels durch den Nutzer zur Authentifizierung gegenüber Fachdiensten ist immer optional.</li> 
       <li>Die Verwendung eines alternativen Authentisierungsmittels ist an lokale Authentisierungsmittel des Nutzers gebunden, das heißt an wissensbasierte oder biometrische Faktoren, die seinem lokalen Nutzeraccount zugeordnet sind.</li> 
       <li>Das System ermöglicht dem Nutzer den Abruf einer Übersicht aller registrierten alternativen Authentifizierungsmittel von jedem Gerät aus</li> 
       <li>Der Nutzer kann ein alternatives Authentisierungsmittel jederzeit von jedem Gerät aus deaktivieren.</li> 
       <li>Der Nutzer kann ein für ein Gerät angelegtes alternatives Authentisierungsmittel jederzeit über ein Gerät durch lokale Löschung von Schlüsseln deaktivieren.</li> 
      </ul> </td> 
    </tr> 
    <tr> 
     <td style="width: 201px;height: 363px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Die Verwendung von alternativen Authentisierungsmitteln ist an einen legitimen Besitzer des verwendeten Geräts, seine Präsenz (am Gerät) und die hierbei verwendeten Authentisierungsmittel zur lokalen Authentisierung (wie Passwörter, PINs oder biometrische Faktoren) zur Nutzung eines lokalen Nutzeraccounts gebunden. </td> 
     <td style="width: 210px;height: 363px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> 
      <ul> 
       <li>der Besitz des Geräts</li> 
       <li>die Bindung an einen definierten, lokalen Nutzeraccount</li> 
       <li>die Präsenz des Nutzers zum Zeitpunkt der Authentisierung</li> 
      </ul> <span style="font-size: 10pt;line-height: 1.5;"> <br> </span></td> 
     <td style="width: 308px;height: 363px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> 
      <ul> 
       <li>Die Erzeugung des Schlüsselpaars, die Registrierung des Schlüssels, seine Verwendung zur Authentifizierung und Deaktivierung erfolgt ausschließlich innerhalb eines Nutzeraccounts, der mit lokalen Authentisierungsmitteln geschützt ist.&nbsp;</li> 
       <li>Die Anwendung des alternativen Authentisierungsmittels erfordert die gesonderte Authentifizierung des Nutzers am Gerät durch lokale Authentisierungsmittel</li> 
       <li>Eine Deaktivierung des alternativen Authentisierungsmittels erfolgt durch lokale Löschung des privaten Schlüssels bei <br> </li> 
      </ul> 
      <ul> 
       <li>Löschung des Benutzeraccounts innerhalb dessen der Schlüssel erzeugt wurde oder Reset des Geräts,<br> </li> 
       <li>bei Entfernung von lokalen Authentisierungsmitteln oder Rückfall auf schwache Formen der Authentisierung (z. B. "wischen") oder<br> </li> 
       <li>bei Änderung von lokalen Authentisierungsmitteln (z. B. Re-Enrolment von biometrischen Faktoren).<br> </li> 
      </ul> 
      <ul> 
       <li>Bei Verlust des Geräts ist eine Deaktivierung des alternativen Authentisierungsmittels von anderen Geräten aus möglich.</li> 
      </ul> <span style="font-size: 10pt;line-height: 1.5;"> </span></td> 
    </tr> 
    <tr> 
     <td style="width: 201px;height: 186px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Die Anwendung des alternativen Authentisierungsmittels ist an Gerät, Betriebssystem und Authenticator-Modul und an die Eignung der verwendeten kryptographischen Verfahren gebunden. Hierin eingeschlossen ist die Authentifizierung des Nutzers vor Anwendung des privaten Schlüssels. <br> </td> 
     <td style="width: 210px;height: 186px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> 
      <ul> 
       <li>die Kontrolle des Nutzers über den zur Authentisierung eingesetzten privaten Schlüssel</li> 
      </ul> <br> </td> 
     <td style="width: 308px;height: 186px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> 
      <ul> 
       <li>gesonderte Authentifizierung des Nutzers vor Anwendung des alternativen Authentisierungsmittels durch lokale Mittel</li> 
       <li>Anwendung des alternativen Authentisierungsmittels ausschließlich durch am Gerät authentifizierte Nutzer in einer isolierten Ausführungsumgebung</li> 
       <li>Nicht-Exportierbarkeit des alternativen Authentisierungsmittels</li> 
       <li>Nicht-Rekonstruierbarkeit des alternativen Authentisierungsmittels aus öffentlichen Daten</li> 
       <li>Das System bietet die Möglichkeit zum Ausschluss der alternativen Authentisierungsmittels bei erkannter Kompromittierung der verwendeten kryptographischen Verfahren.</li> 
      </ul> </td> 
    </tr> 
    <tr> 
     <td style="width: 201px;height: 96px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Die Möglichkeit zur Anwendung des alternativen Authentisierungsmittels ist an das Authenticator-Modul als Anwendung (potentiell in einer bestimmten Version und ggf. Folgeversionen) zum Zweck der Authentifizierung am IDP-Dienst gebunden. </td> 
     <td style="width: 210px;height: 96px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> 
      <ul> 
       <li>das Authenticator-Modul als Anwendung zur Verwendung des alternativen Authentisierungsmittels</li> 
      </ul> <br> </td> 
     <td style="width: 308px;height: 96px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> 
      <ul> 
       <li>Die Anwendung des alternativen Authentisierungsmittels erfolgt ausschließlich bei Verwendung des Authenticator-Moduls, das die Erzeugung des Schlüsselpaares auf Kommando des Nutzers gesteuert hat.</li> 
       <li>Eine Deaktivierung des alternativen Authentisierungsmittels erfolgt durch lokale Löschung des privaten Schlüssels&nbsp;bei Deinstallation des Authenticator-Moduls oder Rückfall auf eine frühere Version.</li> 
      </ul> </td> 
    </tr> 
    <tr> 
     <td style="width: 201px;height: 105px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Der Erfolg der Authentifizierung ist an die Kombination von Betriebssystem und Hardware&nbsp;im Hinblick auf Ausstattung und sicherheitstechnischer Einstufung gebunden.</td> 
     <td style="width: 210px;height: 105px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> 
      <ul> 
       <li>die Kombination von Betriebssystem und Hardware</li> 
      </ul> <br> <br> </td> 
     <td style="width: 308px;height: 105px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> 
      <ul> 
       <li>Das System gibt dem Betreiber des IDP-Dienstes die Möglichkeit, die vom Benutzer verwendete Geräte in geeignete, bedingt geeignete und ungeeignete Geräte einzustufen.</li> 
       <li>Bei Verwendung von ungeeigneten Geräten durch den Nutzer wird die Registrierung abgelehnt.&nbsp;</li> 
       <li>Bei Verwendung eines ungeeigneten Geräts zum Zeitpunkt der Authentisierung ist die Authentifizierung nicht erfolgreich.&nbsp;</li> 
       <li>Das System setzt eine zeitliche Beschränkung der Verwendung des Pairings zum Zweck der Authentifizierung bei der Verwendung von bedingt geeigneten Geräten durch.</li> 
      </ul> </td> 
    </tr> 
    <tr> 
     <td style="width: 201px;height: 51px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Die Verwendung des alternativen Authentisierungsmittels ist an die Version des Betriebssystems gebunden, unter dessen Steuerung es erzeugt wurde.<br> </td> 
     <td style="width: 210px;height: 51px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> 
      <ul> 
       <li>das Betriebssystem des verwendeten Geräts</li> 
      </ul> <span style="font-weight: bold;font-size: 9pt;line-height: 1.5;"> </span></td> 
     <td style="width: 308px;height: 51px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> 
      <ul> 
       <li>Eine Deaktivierung des alternativen Authentisierungsmittels erfolgt durch lokale Löschung des privaten Schlüssels&nbsp;bei Deinstallation von Updates des Betriebssystems oder bei Reset des Gerätes.</li> 
      </ul> <span style="font-size: 10pt;line-height: 1.5;"> </span><br> </td> 
    </tr> 
    <tr> 
     <td style="width: 201px;height: 15px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Die Verwendung des alternativen Authentisierungsmittels soll an die verwendete Gerätehardware gebunden sein.</td> 
     <td style="width: 210px;height: 15px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> 
      <ul> 
       <li>die verwendete Gerätehardware&nbsp;</li> 
      </ul> </td> 
     <td style="width: 308px;height: 15px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"> 
      <ul> 
       <li>Der Nutzer kann ein alternatives Authentisierungsmittel jederzeit von jedem Gerät aus deaktivieren&nbsp; (z. B. bei Hardwaredefekten).</li> 
      </ul> </td> 
    </tr> 
   </tbody> 
  </table> 
  <p id="polarion_748"></p> 
  <p id="polarion_749">Eine Durchsetzung der in der Tabelle genannten und weiterer abgeleiteter Anforderungen ist nicht allein durch das Authenticator-Modul als Softwareeinheit auf dem Gerät des Nutzers und dem IDP-Dienst zu realisieren. Dem Authenticator-Modul obliegt die Prüfung auf das Vorliegen einer – gemessen an Einsatzzweck und Stand der Technik – ausreichend sicheren Einsatzumgebung auf dem mobilen Endgerät, insbesondere auf die Realisierung eines in Interaktion mit Gerät und Betriebssystem durchgesetzten, durchgängigen Schutz der kryptographischen Schlüssel im gesamten Lebenszyklus von</p> 
  <ul id="polarion_750"> 
   <li>Erzeugung des Schlüsselpaars,</li> 
   <li> Speicherung des privaten Schlüssels,</li> 
   <li>Verwendung des privaten Schlüssels zur Authentifizierung,</li> 
   <li>Löschung oder endgültige Nicht-Verwendbarkeit des privaten Schlüssels.</li> 
  </ul> 
  <p id="polarion_751" class="MsoNormal">Anforderungen an die Implementierung des Authenticator-Moduls zielen darauf ab, dem Betriebssystem und Gerät geeignete&nbsp; Parameter zu setzen,&nbsp;die eine Kompromittierung des kryptographischen Schlüsselmaterials unabhängig von einer Kompromittierung des Authenticator-Moduls oder des Betriebssystems zu verhindern.&nbsp;Komplementär wird der IDP-Dienst durch die Implementierung eines weiteren Endpunkts (dem "Pairing-Endpunkt") erweitert, der dem Nutzer die Möglichkeit zur</p> 
  <ul id="polarion_752"> 
   <li>Registrierung seines Gerätes und des alternativen Authentifizierungsmittels,</li> 
   <li>Inspektion der von ihm registrierten Daten und Geräte,</li> 
   <li>Deregistrierung eines von ihm registrierten Gerätes und des alternativen Authentifizierungsmittels</li> 
  </ul> 
  <p id="polarion_753" class="MsoNormal">gibt. Der Authorization-Endpunkt des IDP-Dienstes wird um die</p> 
  <ul id="polarion_754"> 
   <li>Authentifizierung des Nutzers auf Basis von registrierten alternativen Authentifizierungsmittels</li> 
  </ul> 
  <p id="polarion_755" class="MsoNormal">erweitert. Registrierung und Authentifizierung schließen die Bewertung der Gerätehardware auf Basis der vorliegenden Informationen durch den IDP-Dienst ein. Die eingeschlossene Bewertung ist motiviert durch die vorab beschränkten Möglichkeiten des Authenticator-Moduls zur Bewertung des Gerätes.&nbsp;Sie bietet dem Betreiber des IDP-Dienstes die Möglichkeit zur direkten Intervention bei Bekanntwerden von Sicherheitsmängeln einzelner Gerätetypen und deren gezieltem Ausschluss bei der Registrierung oder zum Zweck der Authentisierung.&nbsp;</p> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-120287">5.4.2 Technisches Konzept</h4> 
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-120286">5.4.2.1 Bewertung von Gerätetypen</h5> 
  <p id="polarion_137">Die in den folgenden Abschnitten beschriebenen Erweiterungen des IDP-Dienstes nutzen zur Bewertung eines vom Nutzer verwendeten Gerätetyps zum Zeitpunkt der Registrierung und Authentifizierung zwei Listen (in Kombination im Folgenden Block/Allow-Liste genannt):&nbsp;</p> 
  <ul id="polarion_171"> 
   <li>Die Block-Liste enthält Gerätetypen, die nicht für die Authentisierung geeignet sind; ihre Verwendung zum Zweck der Authentisierung ist ausgeschlossen.</li> 
   <li>Die Allow-Liste enthält Gerätetypen, die ohne Einschränkung zum aktuellen Zeitpunkt als zum Zweck der Authentisierung uneingeschränkt geeignet angesehen werden.&nbsp;</li> 
   <li>Gerätetypen, die sich weder auf der Block- noch auf der Allow-Liste befinden, erhalten eine Einstufung als bedingt geeignet zum Zweck der Authentisierung.&nbsp;Eine bedingte Eignung setzt eine Einschränkung an die Verwendungszeit des Pairings,&nbsp;die bei Überschreiten eine Deaktivierung des Pairings bewirkt.</li> 
  </ul> 
  <p id="polarion_172">Gerätetypen auf diesen Listen werden anhand der Kombination von&nbsp;</p> 
  <ul id="polarion_202"> 
   <li>Herstellername,</li> 
   <li>Produktname,</li> 
   <li>Modell,</li> 
   <li>Betriebssystem und</li> 
   <li>Version des Betriebssystems</li> 
  </ul> 
  <p id="polarion_221">beschrieben. Die anhand der Listen&nbsp;vorliegende Bewertung ist nicht als statisch anzunehmen, die Bewertung der Eignung erfolgt kontinuierlich auf Basis des Standes der Technik und der allgemeinen Sicherheitspolitik innerhalb der Telematikinfrastruktur. Die Pflege der Datenbasis obliegt dem Anbieter des IDP-Dienstes nach Vorgaben der gematik.&nbsp;</p> 
  <h6 id="polarion_wiki macro name=module-workitem;params=id=ML-120369">5.4.2.1.1 Spezifikation</h6> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116888|external=true|anchor=91e26ed1-c0a8e834-598480ea-0f9c8a98">
   ML-116888
   <p><b>A_21404</b></p>
   <p>Der IdP-Dienst MUSS zu vorgelegten Informationen über einen Gerätetyp innerhalb der Registrierung oder der Authentifizierung die folgende Einstufung vornehmen können: <br> Ein Gerätetyp ist zur Verwendung als Faktor innerhalb eines alternativen Authentisierungsmittels entweder<br> 
    <ul>
     <li>ohne Einschränkung geeignet oder</li>
     <li>mit Einschränkung geeignet oder</li>
     <li>nicht geeignet.</li>
    </ul>Ein Gerätetyp wird durch die folgenden Informationen beschrieben: Hersteller, Produkt, Modell, Betriebssystem, Version des Betriebssystems. Die Zuordnung wird in den folgenden Anforderungen als "Block/Allow"-Liste beschrieben. Gerätetypen, die ohne Einschränkung geeignet sind, befinden sich auf der "Allow"-Liste; Gerätetypen, die nicht geeignet sind, befinden sich auf der "Block"-Liste. <b>&lt;=</b></p>
  </div> 
  <p id="polarion_768"> <span style="font-style: italic;">Hinweis: Unter "vorgelegten Informationen" werden hierbei diejenigen verstanden, die vom Authenticator-Modul im Zuge der Registrierung oder der Authentifizierung über die Datenstruktur "Device_Information" an den IDP-Dienst übermittelt werden.</span> </p> 
  <p id="polarion_769"></p> 
  <p id="polarion_123"></p> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116889|external=true|anchor=91e26f0f-c0a8e834-598480ea-e8fa6e24">
   ML-116889
   <p><b>A_21405</b></p>
   <p>Der Anbieter des IDP-Dienstes MUSS dem CERT der gematik das Management der Datenbasis der Gerätetypen und die Zuordnung in eine der oben genannten Kategorien gestatten: <br> 
    <ul>
     <li><span style="color: #000000;">Das CERT der gematik MUSS für die Anpassung der Block/Allow-Liste des IDP-Dienstes einen Service Request im TI-ITSM-System stellen.</span><br></li>
     <li><span style="color: #000000;">Der IDP-Dienst muss für die Anpassung der Block/Allow-Liste des IDP-Dienstes einen Service im TI-ITSM bereitstellen und die Datenbasis entsprechend aktualisieren.</span><br></li>
    </ul><span style="color: #000000;">Die Daten enthalten in expliziter Form ausschließlich Gerätetypen, die</span> 
    <div style="margin-left: 40px;"></div>
    <ul>
     <li>ohne Einschränkung geeignet sind,<br></li>
     <li>nicht geeignet sind.<br></li>
    </ul>
    <div style="margin-left: 40px;"></div><span style="color: #000000;">Gerätetypen, die keine ausdrückliche Nennung erfahren, sind vom IDP-Dienst in den Protokollabläufen als bedingt geeignet einzustufen.</span> <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116890|external=true|anchor=91e26f4e-c0a8e834-598480ea-781f04e6">
   ML-116890
   <p><b>A_21406</b></p>
   <p>Innerhalb eines Service-Requests vom CERT der gematik wird der vollständige, ab Freischaltung zur Einstufung zu verwendende Datenbestand der Block/Allow-Liste übermittelt. Der IdP-Dienst MUSS genau diese Daten innerhalb eines festgelegten Zeitraums zum Zweck der Einstufung wirksam werden lassen. Die alte Datenbasis wird hierbei vollständig ersetzt. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116891|external=true|anchor=91e26f7d-c0a8e834-598480ea-ed1fc219">
   ML-116891
   <p><b>A_21407</b></p>
   <p>Der IdP-Dienst MUSS die Transaktionen der Datenbasis zur Einstufung der Gerätetypen (Block/Allow-Liste)&nbsp;der letzten 6 Monate speichern und in der Lage sein, bei Bedarf auf eine vorherige Version des Bestandes zurückfallen zu können. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116892|external=true|anchor=91e26fbb-c0a8e834-598480ea-e4b432be">
   ML-116892
   <p><b>A_21408</b></p>
   <p>Der Anbieter des IdP-Dienstes MUSS die aktuell verwendete Datenbasis zur Einstufung der Gerätetypen (Block/Allow-Liste)&nbsp;oder die innerhalb der letzten 6 Monate verwendete Version der Datenbasis der gematik zur Verfügung stellen. &nbsp;<br> <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116893|external=true|anchor=91e26ffa-c0a8e834-598480ea-4e80798a">
   ML-116893
   <p><b>A_21409</b></p>
   <p>Der Anbieter des IDP-Dienstes MUSS die erfolgten Änderungen an der Datenbasis der Block/Allow-Liste revisionssicher protokollieren. Das System MUSS jederzeit Auskunft darüber geben können:<br> 
    <ul>
     <li>Was geschehen ist (z.&nbsp;B. Import oder Export der Datenbasis).</li>
     <li>Wer den Import oder Export ausgelöst hat (Basis ist die Protokollierung von Authentifizierungsinformationen).</li>
     <li>Wann dies geschehen ist (Basis sind Zeitstempel der Protokollierung).</li>
     <li>Wie dies geschehen ist (auf welche Weise die Datenbasis übertragen wurden, Quell-IP-Adressen, Systemprotokolle, Art und Weise der Authentisierung am System).</li>
    </ul> <b>&lt;=</b></p>
  </div> 
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-120288">5.4.2.2 Erweiterung des IDP-Dienstes um einen Pairing-Endpunkt</h5> 
  <p id="polarion_542">Der IDP-Dienst wird um einen weiteren Endpunkt erweitert, der die folgenden Funktionalitäten anbietet:</p> 
  <ul id="polarion_668"> 
   <li>Registrierung von alternativen Authentisierungsmitteln,</li> 
   <li>Inspektion der registrierten alternativen Authentisierungsmittel,</li> 
   <li>Deregistrierung von alternativen Authentisierungsmitteln.</li> 
  </ul> 
  <p id="polarion_669"> Der Endpunkt wird "Pairing-Endpunkt" genannt. Der Pairing-Endpunkt wird unter einer dedizierten, im Discovery Document publizierten URI des IDP-Dienstes in gleichartiger Weise wie in [gemSpec_IDP_Dienst], Abschnitt 2.2 beschrieben bereitgestellt.&nbsp;Die Voraussetzung für die Nutzung der am Pairing-Endpunkt oben genannten angebotenen Dienste ist die Vorlage eines gültigen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> wie in [gemSpec_IDP_Dienst] beschrieben. </p> 
  <p id="polarion_670"> Im Fall der Registrierungsfunktion muss die Authentifizierung auf Basis der eGK oder eines auf Basis einer eGK-Authentifizierung ausgestellten <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> unter Verwendung eines geeigneten Gerätes erfolgen.&nbsp;Im Fall der Inspektion oder der Deregistrierung sind pauschal alle am IDP-Dienst zugelassenen Authentisierungsmethoden gestattet. Die Verwendung von bereits registrierten alternativen Authentisierungsmitteln und ggf. anderen Geräten ist hier ausdrücklich zugelassen. Alleinige Bedingung ist die Rückführbarkeit auf ein und dieselbe Identität des Nutzers.&nbsp;&nbsp; </p> 
  <p id="polarion_286"></p> 
  <h6 id="polarion_wiki macro name=module-workitem;params=id=ML-120375">5.4.2.2.1 Spezifikation</h6> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116894|external=true|anchor=91e27029-c0a8e834-598480ea-768b648e">
   ML-116894
   <p><b>A_21410</b></p>
   <p>Der Pairing-Endpunkt MUSS beim IDP-Dienst im Sinne von Abschnitt 4 aus [gemSpec_IDP_FD] registriert sein. Der registrierte Scope MUSS „openid&nbsp;pairing“ sein. Der beantragte Claim MUSS der folgende sein:<br>
    <ul>
     <li>idNummer.</li>
    </ul>Weitere Body-Claims DÜRFEN NICHT angefordert werden. Bestehende Header-Claims, die zur Prüfung der Gültigkeit von <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> verwendet werden, sind hiervon unberührt. Andere Fachdienste DÜRFEN mit dem genannten Scope NICHT registrierbar sein. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-118135|external=true|anchor=91e27067-c0a8e834-598480ea-912763de">
   ML-118135
   <p><b>A_21429-02</b></p>
   <p>Der Pairing-Endpunkt MUSS über eine dedizierte URL bereitgestellt werden. Die URL MUSS im externen Discovery Document aufgenommen und über das Attribut "uri_pair" im externen Discovery Document hinterlegt werden.<br>Im externen Discovery Document MUSS ebenfalls die Adresse des Endpunkts für die alternative Authentisierung (mit einem registrierten Pairing) über das Attribut "auth_pair_endpoint" hinterlegt werden. <b>&lt;=</b></p>
  </div> 
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-120374">5.4.2.3 Daten und Kommunikationsstrukturen</h5> 
  <p id="polarion_761">Die zur Kommunikation zwischen Authenticator-Modul und Pairing-Endpunkt bzw. Authorization-Endpunkt in den Anwendungsfällen</p> 
  <ul id="polarion_763"> 
   <li>Registrierung</li> 
   <li>Authentifizierung</li> 
   <li>Inspektion</li> 
   <li>Deregistrierung</li> 
  </ul> 
  <p id="polarion_764">verwendeten Datenobjekte basieren wie in [gemSpec_IDP_Dienst] und [gemSpec_IDP_Frontend] auf JSON-Datenstrukturen mit bzw. als&nbsp;JSON Web Signature (JWS)-Objekte und&nbsp;JSON Web Encryption (JWE)-Objekte für Datenobjekte mit kryptographischem Schutz. Das Interaktionsmuster folgt den REST-Paradigmen. Datenobjekte, die Identitätsinformationen des Nutzers beinhalten, werden auf Anwendungsebene verschlüsselt.</p> 
  <p id="polarion_183"></p> 
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-120290">5.4.2.4 Nomenklatur Schlüsselmaterial</h5> 
  <p id="polarion_674" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">8</span>: Nomenklatur Schlüsselmaterial </p> 
  <table id="polarion_wiki macro name=table;params=width=99.47%|uid=675" class="polarion-Document-table" style="width: 99.47%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th colspan="2" rowspan="1" style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 225px;height: 24px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Bezeichnung und Beschreibung</th> 
     <th colspan="5" rowspan="1" style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 505px;height: 24px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Lebenszyklus</th> 
    </tr> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 87px;height: 57px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Name</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 127px;height: 57px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Beschreibung</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 106px;height: 57px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Verwendungszweck</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 108px;height: 57px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Erzeugung</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 79px;height: 57px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Speicherung</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 82px;height: 57px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Verwendung</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 86px;height: 57px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Löschung/Ende der Verwendung</th> 
    </tr> 
    <tr> 
     <td style="width: 87px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">PrK_SE_AUT</span></td> 
     <td style="width: 127px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">privater (alternativer) Authentisierungsschlüssel</span></td> 
     <td rowspan="2" style="width: 106px;height: 47px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">Schlüsselpaar zur Authentisierung und&nbsp; Authentifizierung <br> am IDP-Dienst</span></td> 
     <td colspan="1" rowspan="2" style="width: 108px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">auf dem mobilen Endgerät</span></td> 
     <td style="width: 79px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">auf dem mobilen Endgerät</span></td> 
     <td style="width: 82px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">durch lokal&nbsp;am Gerät authentifizierten Nutzer</span></td> 
     <td style="width: 86px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">Nutzerkommando oder in Reaktion auf definierte&nbsp; Systemereignisse: Auf Initiative des Nutzers oder durch das Gerät bei Änderungen von App, vom Nutzer registrierten Credentials, Rollback von Betriebssystem-Updates und weiteren Ereignissen</span></td> 
    </tr> 
    <tr> 
     <td style="width: 87px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">PuK_SE_AUT</span></td> 
     <td style="width: 127px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">öffentlicher (alternativer) Authentifizierungsschlüssel</span></td> 
     <td style="width: 79px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">auf dem mobilen Endgerät, IDP-Dienst</span></td> 
     <td style="width: 82px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">durch den IDP-Dienst im Rahmen der Registrierung und Authentifizierung</span></td> 
     <td style="width: 86px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">Erreichen zeitlicher Bedingungen, Ablauf der zur Registrierung verwendeten eGK, Verwendung von ungeeigneten Geräten</span></td> 
    </tr> 
    <tr> 
     <td style="width: 87px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">PrK.CH.AUT</span></td> 
     <td style="width: 127px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">privater Authentisierungsschlüssel der eGK</span></td> 
     <td style="width: 106px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">Signatur der Pairing-Daten</span></td> 
     <td style="width: 108px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">eGK</span></td> 
     <td style="width: 79px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">eGK</span></td> 
     <td style="width: 82px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">durch die eGK auf Initiative des Nutzers</span></td> 
     <td style="width: 86px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">-</td> 
    </tr> 
    <tr> 
     <td style="width: 87px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">PuK.CH.AUT</span></td> 
     <td style="width: 127px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">öffentlicher Authentifizierungsschlüssel der eGK&nbsp;</span></td> 
     <td style="width: 106px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">Authentifizierung der Pairing-Daten</span></td> 
     <td style="width: 108px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">eGK</span></td> 
     <td style="width: 79px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">auf dem mobilen Endgerät, persistent am IDP-Dienst</span></td> 
     <td style="width: 82px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">durch den IDP-Dienst im Rahmen der Registrierung und&nbsp; Authentifizierung des Nutzers</span></td> 
     <td style="width: 86px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">Bei Deaktivierung des Pairings erfolgt keine weitere Verwendung des PuK.CH.AUT durch den IDP-Dienst.</span></td> 
    </tr> 
    <tr> 
     <td style="width: 87px;height: 35px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">C.CH.AUT</span></td> 
     <td style="width: 127px;height: 35px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">Authentifizierungszertifikat der eGK</span></td> 
     <td style="width: 106px;height: 35px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">Authentifizierung der Pairing-Daten</span></td> 
     <td style="width: 108px;height: 35px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">Kartenherausgeber</span></td> 
     <td style="width: 79px;height: 35px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">auf dem mobilen Endgerät, transient am IDP-Dienst</span></td> 
     <td style="width: 82px;height: 35px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">IDP-Dienst im Rahmen der Registrierung und Authentifizierung</span></td> 
     <td style="width: 86px;height: 35px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">Bei Deaktivierung des Pairings, Sperrung oder Ablauf des Zertifikats erfolgt keine weitere Verwendung des C.CH.AUT.</span></td> 
    </tr> 
    <tr> 
     <td style="width: 87px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">Key-Identifier</span></td> 
     <td style="width: 127px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">lokaler auf dem Gerät erzeugter Identifikator des Schlüsselpaars PrK_SE_AUT, PuK_SE_AUT gegenüber dem IDP-Dienst</span></td> 
     <td style="width: 106px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">Referenzierung des Schlüssels am IDP</span></td> 
     <td style="width: 108px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">Auf dem mobilen Endgerät</span></td> 
     <td style="width: 79px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">mobiles Endgerät, IDP-Dienst</span></td> 
     <td style="width: 82px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">Authenticator-Modul, IDP-Dienst zur Referenzierung und De-Referenzierung von Pairing-Daten</span></td> 
     <td style="width: 86px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">Auf Initiative des Nutzers im Rahmen der<br> Deregistrierung</span></td> 
    </tr> 
    <tr> 
     <td style="width: 87px;height: 36px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">Biometrische Referenzmerkmale oder andere durch den Nutzer gesetzte wissensbasierte Faktoren</span></td> 
     <td style="width: 127px;height: 36px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">auf dem Gerät erhobene biometrische Referenzmerkmale oder Templates, bzw. Referenzmerkmale zu anderen wissensbasierten Faktoren</span></td> 
     <td style="width: 106px;height: 36px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">lokale <br> Authentifizierung des Nutzers vor <br> Anwendung des PrK_SE_AUT</span></td> 
     <td style="width: 108px;height: 36px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">Nutzer</span></td> 
     <td style="width: 79px;height: 36px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">mobiles Endgerät</span></td> 
     <td style="width: 82px;height: 36px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">Nutzer</span></td> 
     <td style="width: 86px;height: 36px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">Auf Initiative des Nutzers durch das Gerät</span></td> 
    </tr> 
    <tr> 
     <td style="width: 87px;height: 36px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">idNummer</span></td> 
     <td style="width: 127px;height: 36px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">Telematik-ID (vgl. [gemSpec_IDP_Dienst], Tabelle 5, TAB_IDP_DIENST_0005)</span></td> 
     <td style="width: 106px;height: 36px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">Referenzierung und <br> Dereferenzierung <br> von Daten</span></td> 
     <td style="width: 108px;height: 36px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">Telematikinfrastruktur</span></td> 
     <td style="width: 79px;height: 36px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">über C.CH.AUT auf dem Endgerät, IDP-Dienst zur Referenzierung oder Dereferenzierung von Daten</span></td> 
     <td style="width: 82px;height: 36px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">Identifikation von Pairing-Daten</span></td> 
     <td style="width: 86px;height: 36px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 8pt;line-height: 1.5;">auf Initiative des Nutzers im Rahmen der<br> Deregistrierung</span></td> 
    </tr> 
   </tbody> 
  </table> 
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-120307">5.4.2.5 Registrierung von alternativen Authentisierungsmitteln</h5> 
  <p id="polarion_678">Die Registrierung von alternativen Authentisierungsmitteln basiert auf folgenden zwei Voraussetzungen:</p> 
  <ol id="polarion_680"> 
   <li>Authentifizierung des Nutzers am IDP-Dienst:&nbsp;Der Nutzer authentifiziert sich über des in [gemSpec_IDP_Dienst] und [gemSpec_IDP_Frontend] beschriebenen Challenge-Response-Verfahrens unter Nutzung von eGK oder vorliegendem, auf Basis der eGK bezogenem <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span>. Hierin eingeschlossen ist die Autorisierung des Authenticator-Moduls durch den Nutzer zur Einrichtung eines alternativen Authentifizierungsmittels. Im Erfolgsfall mündet der Prozess in einem <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> für den Pairing-Endpunkt.</li> 
   <li>Lokale Initialisierung des Geräts des Nutzers:&nbsp;Das Authenticator-Modul prüft die Systemumgebung auf das Vorliegen von Voraussetzungen&nbsp;zur Erzeugung und Verwaltung von kryptographischen Schlüsseln, die durch die vorliegende Systemumgebung&nbsp;ausreichend gegen missbräuchliche Verwendung geschützt sind. Im Erfolgsfall erzeugt das Authenticator-Modul über die Betriebssystem-APIs ein Schlüsselpaar. Der öffentliche Schlüssel und andere Metadaten werden vom Nutzer mit Hilfe der eGK durch eine Signatur authentifiziert.&nbsp;</li> 
  </ol> 
  <p id="polarion_681">Unter einem ausreichend vorhandenen Schutz wird hierbei eine Systemumgebung verstanden, die den Anforderungen der Kapitel [gemSpec_IDP_Frontend#Kapitel "Parameter für die Schlüsselerzeugung und Auswahl eines Schlüsselspeichers"] und&nbsp; [gemSpec_IDP_Frontend#Kapitel "Erzeugung des Schlüssels und weiterer Metadaten"] genügt.&nbsp;</p> 
  <p id="polarion_143"> Die hier dargestellte Reihenfolge ist nicht bindend. Bedingt durch die zweimalige Leistung einer Signatur&nbsp;durch die eGK ist es dem Anbieter des Authenticator-Moduls überlassen, den konkreten Ablauf unter ergonomischen oder Usability-Gesichtspunkten geeignet zu&nbsp;gestalten und den Benutzer im Rahmen der Benutzerführung über die Wirkung der durchgeführten Aktionen aufzuklären. Der Prozess mündet (siehe 3. in der folgenden Abbildung) in die Registrierung durch die Übertragung der Pairing-Daten und des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> an den Pairing-Endpunkt. Der Pairing-Endpunkt validiert das übertragene <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span>, die übertragenen Geräteinformationen und die übertragenen Pairing-Daten. Im Erfolgsfall werden die übertragenen Pairing-Daten am Pairing-Endpunkt gespeichert. </p> 
  <p id="polarion_682">Der Prozess wird durch das folgende Sequenzdiagramm illustriert:</p> 
  <p id="polarion_676" style="text-align: center;" class="polarion-rte-caption-paragraph"> <img src="attachments/22-screenshot-20210517-194842.png" style="max-width: 650px;"> </p> 
  <p id="polarion_741" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">6</span>: Ablauf Registrierungsprozess </p> 
  <p id="polarion_684" class="polarion-rte-caption-paragraph"></p> 
  <p id="polarion_686"> <span style="font-style: italic;">Hinweis: Die IDP-Dienst-interne Kommunikation zum Abruf der Pairing-Daten und der Bewertung der Gerätedaten ist in der Abbildung nicht dargestellt. Das Diagramm illustriert die Serviceaktivitäten, nicht die physische Verteilung.&nbsp;</span> </p> 
  <h6 id="polarion_wiki macro name=module-workitem;params=id=ML-120310">5.4.2.5.1 Erläuterungen zum Registrierungsprozess</h6> 
  <div class="heading-7" id="polarion_wiki macro name=module-workitem;params=id=ML-120308"></div> 
  <p id="polarion_689"> Der Nutzer authentifiziert sich am IDP-Dienst über das Authenticator-Modul mit Hilfe der eGK oder eines bereits vorhandenen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span>. Das hierbei ausgestellte <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> umfasst als Claim die aus dem C.CH.AUT abgeleitete idNummer des Nutzers. </p> 
  <div class="heading-7" id="polarion_wiki macro name=module-workitem;params=id=ML-120309"></div> 
  <p id="polarion_690">Dem Authenticator-Modul obliegt die Prüfung auf Vorliegen von geeigneten Voraussetzungen auf dem Endgerät. Die folgenden Aspekte sind hierbei eingeschlossen:</p> 
  <ul id="polarion_691"> 
   <li>Verfügbarkeit von geeigneten kryptographischen Algorithmen,</li> 
   <li>Vorhandensein eines geeigneten, vom Gerät und Betriebssystem realisierten Schlüsselspeichers,</li> 
   <li>Möglichkeit zur Erzeugung eines Schlüsselpaars,</li> 
   <li>Möglichkeit zur Zuordnung von lokalen Authentisierungsmitteln zur Anwendung von erzeugten Schlüsseln,</li> 
   <li>Durchsetzbarkeit von Anforderungen an die Löschung der erzeugten Schlüssel, z. B. bei Änderung von biometrischen Referenzmerkmalen oder Deinstallation des Accounts.</li> 
  </ul> 
  <p id="polarion_692">Das Authenticator-Modul erzeugt das Schlüsselpaar PrK_SE_AUT/PuK_SE_AUT und einen gegenüber dem IDP-Dienst verwendeten Key-Identifier. Der Nutzer signiert mithilfe des privaten Authentisierungsschlüssels PrK.CH.AUT der eGK&nbsp;die folgenden Daten:</p> 
  <ul id="polarion_693"> 
   <li>den öffentlichen Schlüssel PuK_SE_AUT und die zur Anwendung des Schlüssels zu verwendenden Algorithmen,&nbsp;</li> 
   <li>die folgenden Daten aus dem Authentifizierungszertifikat C.CH.AUT der eGK:</li> 
  </ul> 
  <ul id="polarion_694"> 
   <ul> 
    <li>der öffentliche Schlüssel und die zur Anwendung des Schlüssels zu verwendenden Algorithmen</li> 
    <li>die Seriennummer</li> 
    <li>das Gültigkeitsende</li> 
    <li>die Informationen zum Aussteller</li> 
   </ul> 
  </ul> 
  <ul id="polarion_695"> 
   <li>den vom Hersteller vergebenen Namen des vom Nutzer verwendeten Geräts,</li> 
   <li>ein vom Authenticator-Modul vergebener Key-Identifier des Schlüsselpaars Prk_SE_AUT/PuK_SE_AUT zur Identifikation des Schlüssels gegenüber dem IDP-Dienst.</li> 
  </ul> 
  <p id="polarion_696">Die Gesamtheit dieser Daten sind die Pairing-Daten.</p> 
  <p id="polarion_740"></p> 
  <p id="polarion_359">Zum Einleiten der Registrierung werden die folgenden Daten verschlüsselt an den Pairing-Endpunkt gesandt:</p> 
  <ul id="polarion_697"> 
   <li>das bezogene <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span>,</li> 
   <li>die produzierten Pairing-Daten,</li> 
   <li>das verwendete Authentisierungszertifikat C.CH.AUT der eGK,</li> 
   <li>einen vom Benutzer vergebenen Namen für sein Gerät,</li> 
   <li>zum Zeitpunkt der Authentisierung erhobene Geräteinformationen bestehend aus:</li> 
  </ul> 
  <ul id="polarion_698"> 
   <ul> 
    <li>Herstellername,</li> 
    <li>den vom Hersteller vergebenen Namen des vom Nutzer verwendeten Geräts,</li> 
    <li>Modell,</li> 
    <li>Betriebssystem,</li> 
    <li>Version des Betriebssystems.</li> 
   </ul> 
  </ul> 
  <p id="polarion_699">Die Verschlüsselung basiert auf Schlüsseln, die über das Discovery Document des IDP-Dienstes publiziert werden.&nbsp;Im Erfolgsfall werden der Key-Identifier, das Zertifikat C.CH.AUT und der vom Nutzer vergebene Name des Geräts lokal gespeichert.</p> 
  <p id="polarion_747"></p> 
  <p id="polarion_759">Die Aufnahme des vom Hersteller vergebenen Namen des Geräts, dem Produktnamen, in die signierten Pairing-Daten dient dem Nutzer in Kombination mit dem von ihm vergebenen Namen des Geräts der Nachvollziehbarkeit der Zuordnung&nbsp;des Pairings zu einem Gerät bei einer Geräte-übergreifenden Verwaltung seiner Pairing-Daten. Es wird hierbei angenommen, dass der Produktnamen über den gesamten Lebenszyklus des Geräts hinweg konstant bleibt (insbesondere über Betriebssystem-Updates hinaus).&nbsp;</p> 
  <div class="heading-7" id="polarion_wiki macro name=module-workitem;params=id=ML-120311"></div> 
  <p id="polarion_700">Der Pairing-Endpunkt prüft:</p> 
  <ul id="polarion_701"> 
   <li>das <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKENS</span> auf Gültigkeit,</li> 
   <li>ob anhand der Claims des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKENS</span> die Authentifizierung auf Basis der eGK nachzuvollziehen ist,</li> 
   <li>ob die&nbsp;übermittelten Geräteinformationen sich nicht auf der Block-Liste befinden,</li> 
   <li>das übermittelte Authentifizierungszertifikats auf Gültigkeit,</li> 
   <li>die Integrität der übermittelten Pairing-Daten mithilfe des öffentlichen Schlüssels aus dem Authentifizierungszertifikat C.CH.AUT,</li> 
   <li>ob die im <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> vorhandene idNummer identisch mit der des übermittelten Zertifikats C.CH.AUT ist,</li> 
   <li>ob die in den Pairing-Daten vorhandenen Angaben zu Seriennummer, Gültigkeitsende und Aussteller identisch zu denen des übermittelten Zertifikats C.CH.AUT sind und ob der in den Pairing-Daten vorhandene öffentliche Schlüssel einschließlich der Angaben zu den Algorithmen identisch zu dem in dem Zertifikat C.CH.AUT ist. </li> 
  </ul> 
  <p id="polarion_702">Bei Fehlschlag einer dieser Prüfungen wird der Registrierungsprozess abgebrochen. Bei Erfolg aller dieser Prüfungen werden die folgenden Daten am Pairing-Endpunkt für die weitere Verwendung im Zuge der Authentifizierung hinterlegt:</p> 
  <ul id="polarion_703"> 
   <li>die übertragenen Pairing-Daten einschließlich der Signaturdaten,</li> 
   <li>den Zeitpunkt der Anlage,</li> 
   <li>den vom Nutzer vergebenen Namen für sein Gerät,</li> 
   <li>die idNummer und den übertragenen Key-Identifier.</li> 
  </ul> 
  <p id="polarion_704">Die Kombination von idNummer und Key-Identifier dient zur Referenzierung bzw. Dereferenzierung der Kombination von Pairing-Daten, Zeitpunkt der Anlage und den vom Nutzer vergebenen Namen.&nbsp;Das Authentifizierungszertifikat C.CH.AUT wird hierbei nicht gespeichert. Seine Speicherung obliegt dem Authenticator-Modul für die zukünftige Verwendung des mit dem Prozess etablierten alternativen Authentisierungsmittels.</p> 
  <h6 id="polarion_wiki macro name=module-workitem;params=id=ML-120370">5.4.2.5.2 Spezifikation</h6> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116899|external=true|anchor=91e270a6-c0a8e834-598480ea-7d057104">
   ML-116899
   <p><b>A_21415</b></p>
   <p>Die Registrierungsfunktion des IdP-Dienstes MUSS die folgenden Datentypen zur Kommunikation mit dem Authenticator-Modul verwenden:&nbsp;<br> 
    <ul>
     <li>Device_Type</li>
     <li>Device_Information</li>
     <li>Pairing_Data</li>
     <li>Signed_Pairing_Data</li>
     <li>Registration_Data</li>
     <li>Encrypted_Registration_Data.</li>
    </ul> <b>&lt;=</b></p>
  </div> 
  <p id="polarion_490"> <span style="font-style: italic;">Hinweis: Festlegung zur Ausgestaltung der Datenformate und Kommunikationsprotokolle finden sich im Anhang C dieses Dokuments.<br> Der Authorization-Endpunkt und der Pairing-Endpunkt müssen das zusätzliche Attribut Security-Patchlevel ("security_patchlevel") in der Authentication_Data/Device_Information/Device_Type-Struktur (Version 1.1) annehmen können ohne es zur Bewertung&nbsp;des Gerätetyps auf Basis der Block/Allow-Liste zu nutzen. Des Weiteren müssen der Authorization-Endpunkt und der Pairing-Endpunkt auch zukünftig die vorherige Version der Authentication_Data/Device_Information/Device_Type-Struktur (Version 1.0) ohne das Attribut&nbsp;Security-Patchlevel ("security_patchlevel") annehmen.&nbsp;<span id="polarion-comment:1607"></span></span> </p> 
  <p id="polarion_736"></p> 
  <p id="polarion_163"> <span style="font-style: italic;">Hinweis: Festlegung zur Ausgestaltung der Datenformate und Kommunikationsprotokolle finden sich im Anhang C dieses Dokuments.</span> </p> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116895|external=true|anchor=91e271fd-c0a8e834-598480ea-db9e5b54">
   ML-116895
   <p><b>A_21411</b></p>
   <p>Der Pairing-Endpunkt MUSS im Zusammenhang mit der Registrierungsfunktion die folgenden Fehlermeldungen produzieren:<br> <br> <p class="polarion-rte-caption-paragraph" style="text-align: left;" id="polarion___4">Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">9</span>: Fehlermeldungen im Zusammenhang mit der Registrierungsfunktion</p>
    <table id="polarion_wiki macro name=table;params=width=100%" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;">
     <tbody>
      <tr>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 94px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">Nummer</th>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 853.2px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">Fehlermeldungstext</th>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 94px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">REG.1</td>
       <td style="text-align: left;vertical-align: top;width: 853.2px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">Der Zugriff auf den Dienst kann nicht gewährt werden.</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 94px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">REG.2</td>
       <td style="text-align: left;vertical-align: top;width: 853.2px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">Das verwendete Gerät ist nicht für die Authentisierung geeignet.</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 94px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">REG.3</td>
       <td style="text-align: left;vertical-align: top;width: 853.2px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">Der erzeugte Schlüssel konnte aufgrund eines internen Fehlers nicht registriert werden.</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 94px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">REG.4</td>
       <td style="text-align: left;vertical-align: top;width: 853.2px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">Der erzeugte Schlüssel konnte aufgrund eines bestehenden Eintrags nicht registriert werden.</td>
      </tr>
     </tbody>
    </table><br> <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116896|external=true|anchor=91e2723c-c0a8e834-598480ea-689bc0f8">
   ML-116896
   <p><b>A_21412</b></p>
   <p>Der Pairing-Endpunkt MUSS zulassen, dass mehrere Geräte pro Nutzer registriert werden. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116897|external=true|anchor=91e2726b-c0a8e834-598480ea-a127f575">
   ML-116897
   <p><b>A_21413</b></p>
   <p>Der Pairing-Endpunkt MUSS die Nutzung der Registrierjungfunktion ausschließlich auf Basis eines vom IDP-Dienst für das Authenticator-Modul erstellten <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> mit dem Scope "openid pairing" ermöglichen. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116909|external=true|anchor=91e272a9-c0a8e834-598480ea-c9935784">
   ML-116909
   <p><b>A_21425</b></p>
   <p>Der Pairing-Endpunkt MUSS die verschlüsselten Registrierungsdaten und den übermittelten <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> annehmen. Die Prüfung des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> erfolgt wie in&nbsp;[gemSpec_IDP_FD], Abschnitt 6 beschrieben. Der Pairing-Endpunkt MUSS das bezogene <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> mit dem PrK.IDP.ENC entschlüsseln. Das zur Entschlüsselung des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> zu verwendende Verfahren ist ECDH-ES<span style="font-size: 11pt;font-family: Arial, Helvetica;color: #172B4D;line-height: 1.5;">.</span> <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116903|external=true|anchor=91e272e8-c0a8e834-598480ea-c71a171e">
   ML-116903
   <p><b>A_21419</b></p>
   <p>Der Pairing-Endpunkt des IDP-Dienstes MUSS sicherstellen, dass die Registrierung ausschließlich auf Basis von <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> durchgeführt wird, die belegen, dass sich der Nutzer auf Basis der eGK authentifiziert hat. Dieser Beleg MUSS aus den Werten für die Claims&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">amr</span> und&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">acr</span> abgeleitet werden. Diese MÜSSEN wie folgt belegt sein: acr=“gematik-ehealth-loa-high“, amr=“["mfa“,“sc“,“pin“]. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116904|external=true|anchor=91e27336-c0a8e834-598480ea-06c45e9a">
   ML-116904
   <p><b>A_21420</b></p>
   <p>Der Pairing-Endpunkt MUSS die übermittelten Registrierungsdaten mit dem PrK.IDP.ENC entschlüsseln.&nbsp;<br> <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116905|external=true|anchor=91e27365-c0a8e834-598480ea-4e5dc43f">
   ML-116905
   <p><b>A_21421</b></p>
   <p>Der Pairing-Endpunkt MUSS die in den übermittelten Registrierungsdaten enthaltenen Pairing-Daten extrahieren und MUSS die Signatur des Nutzers zu den Pairing-Daten prüfen. Die Prüfung des Authentifizierungszertifikats MUSS hierbei auf Basis der aktuellen Systemzeit des Pairing-Endpunkts als Referenzzeit und gemäß [gemSpec_PKI], Abschnitt 8.3.1.1 „TUC_PKI_018“ erfolgen. <span style="font-size: 10pt;line-height: 1.5;">Der IdP-Dienst MUSS zur Validierung alle Algorithmen unterstützen, die im Zusammenhang mit den Authentisierungsmitteln verwendet werden, die zur Authentisierung am IdP-Dienst zugelassen sind (siehe [gemSpec_IDP_Frontend], Abschnitt 3). Hierbei MÜSSEN die Vorgaben aus Abschnitt 9.3.4 [gemSpec_IDP_Frontend] beachtet werden. Andere Algorithmen DÜRFEN NICHT unterstützt werden.</span> Kann die Authentizität der Pairing-Daten nicht belegt werden oder ist das übermittelte Authentifizierungszertifikat zum aktuellen Zeitpunkt ungültig oder gesperrt, MUSS der Pairing-Endpunkt die Anfrage mit der Fehlermeldung REG.1 beenden.&nbsp;<span style="font-size: 10pt;line-height: 1.5;">Unter "Authentifizierungszertifikat" wird ein Zertifikat des Typs C.CH.AUT verstanden.</span> <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116906|external=true|anchor=91e273a3-c0a8e834-598480ea-51d71da4">
   ML-116906
   <p><b>A_21422</b></p>
   <p>Der Pairing-Endpunkt MUSS überprüfen, ob sich das übermittelte <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> und sich die im Authentifizierungszertifikat eingebetteten Identitätsinformationen auf ein und dieselbe Entität zurückführen lassen: Der Pairing-Endpunkt MUSS dafür prüfen, ob der im <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> eingebettete Claim <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">idNummer</span> identisch mit der im Authentifizierungszertifikat vorhandenen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">idNummer</span> ist. Sind diese nicht identisch, MUSS der Pairing-Endpunkt die Anfrage mit der Fehlermeldung REG.1 beenden. Unter Authentifizierungszertifikat wird hierbei ein Zertifikat vom Typ C.CH.AUT verstanden.&nbsp; <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-117312|external=true|anchor=91e270e4-c0a8e834-598480ea-94f94472">
   ML-117312
   <p><b>A_21470</b></p>
   <p>Der Pairing-Endpunkt des IdP-Dienstes MUSS überprüfen, ob sich die in den Pairing-Daten befindlichen Daten „issuer“, „serialnumber“, „auth_cert_subject_public_key_info“, „not_after“ identisch zu den Zertifikatsfeldern „issuer“, „serialNumber“, „subjectPublicKeyInfo“, „notAfter“ des übermittelten Authentifizierungszertifikats sind. Schlägt einer dieser Vergleiche fehl, MUSS der Pairing-Endpunkt die Anfrage mit der Fehlermeldung REG.1 beenden. Unter "Authentifizierungszertifikat" wird ein Zertifikat des Typs C.CH.AUT verstanden. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116907|external=true|anchor=91e27113-c0a8e834-598480ea-04f7890e">
   ML-116907
   <p><b>A_21423</b></p>
   <p>Der Pairing-Endpunkt des IdP-Dienstes MUSS die vom Authenticator-Modul übertragenen Geräteinformationen gegen die Block/Allow-Liste prüfen. Bei Zuordenbarkeit der Geräteinformationen zu einem Gerätetyp auf der Block-Liste MUSS der Pairing-Endpunkt den Registrierungsvorgang mit der Fehlermeldung REG.2 beenden. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116908|external=true|anchor=91e27152-c0a8e834-598480ea-691c68b0">
   ML-116908
   <p><b>A_21424</b></p>
   <p>Der Pairing-Endpunkt MUSS die folgenden Daten und den Zeitpunkt der Speicherung in seiner Pairing-Datenbank speichern:<br> 
    <ul>
     <li>den Namen des Geräts (aus den in den Registrierungsdaten übertragenen Geräteinformationen im Datentyp "Device_Information")</li>
     <li>die signierten Pairing-Daten</li>
     <li>den aktuellen Zeitpunkt.&nbsp;&nbsp;</li>
    </ul>Die logische Kombination dieser Daten MUSS über die idNummer referenzierbar sein und sie MUSS über die Kombination aus (idNummer, keyIdentifier) eindeutig referenzierbar sein. Unter „keyIdentifier“ wird hierbei das Feld „key_Identifier“ aus den Pairing-Daten verstanden. Eventuelle Kollisionen mit bestehenden Pairing-Daten MÜSSEN mit der Fehlermeldung REG.4 begegnet werden. Der Pairing-Endpunkt DARF die übermittelten Daten in diesem Fall NICHT speichern. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116910|external=true|anchor=91e27190-c0a8e834-598480ea-743296ee">
   ML-116910
   <p><b>A_21426</b></p>
   <p>Der Pairing-Endpunkt DARF das im Zuge der Registrierung in den Registrierungsdaten übertragene Authentifizierungszertifikat NICHT persistent speichern.&nbsp;<span style="font-size: 10pt;line-height: 1.5;">Unter "Authentifizierungszertifikat" wird ein Zertifikat des Typs C.CH.AUT verstanden.</span> <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116911|external=true|anchor=91e271bf-c0a8e834-598480ea-dafc375f">
   ML-116911
   <p><b>A_21427</b></p>
   <p>Der Pairing-Endpunkt MUSS dem Authenticator-Modul eine eindeutige Rückmeldung über den Erfolg oder Misserfolg der Anlage des Pairings übermitteln. <b>&lt;=</b></p>
  </div> 
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-120319">5.4.2.6 Verwendung von alternativen Authentisierungsmitteln</h5> 
  <h6 id="polarion_wiki macro name=module-workitem;params=id=ML-120289">5.4.2.6.1 Erweiterung des Authorization-Endpunkts</h6> 
  <p id="polarion_138">Der Authorization-Endpunkt verwendet den im Zuge der Registrierung den in den Pairing-Daten hinterlegten öffentlichen Schlüssel zur Authentifizierung. Die erfolgreiche Authentifizierung ist abhängig von:</p> 
  <ul id="polarion_732"> 
   <li>der Gültigkeit des Authentisierungsmittels, das&nbsp;zur Registrierung des alternativen Authentisierungsmittels verwendet wurde</li> 
   <li>der Integrität der Pairing-Daten und deren Bezug zum Authentisierungsmittel, welches bei der Registrierung verwendet wurde</li> 
   <li>der Eignung des Geräts </li> 
   <li>weiteren zeitlichen Bedingungen an die Verwendungszeit des auf dem Gerät des Nutzers erzeugten Authentifizierungsschlüssels zum Zweck der Authentifizierung in Abhängigkeit der festgestellten Eignung des Geräts</li> 
   <li>der Prüfung der Signatur der Authentifizierungsdaten mithilfe des in den gespeicherten Pairing-Daten vorhandenen auf dem Gerät des Nutzers erzeugten Authentifizierungsschlüssels.</li> 
  </ul> 
  <p id="polarion_735">Bei Fehlschlag einer dieser Prüfungen gilt der Benutzer als nicht authentifiziert. Die Bewertung des Geräts erfolgt hierbei auf Basis von Informationen, die vom Authenticator-Modul erhoben werden.</p> 
  <p id="polarion_685"></p> 
  <p id="polarion_687">Die Verwendung von alternativen Authentisierungsmitteln gestaltet sich in zwei Schritten:</p> 
  <ol id="polarion_705"> 
   <li>Ein Anwendungsfrontend initiiert über das Authenticator-Modul einen Authorization-Request an den Authorization-Endpunkt des IDP-Dienstes. Der Authorization-Endpunkt produziert ein Challenge-Token und überträgt dieses an das Authenticator-Modul. Der Nutzer signiert über das Authenticator-Modul&nbsp;eine Datenstruktur, die die folgenden Inhalte umfasst:<br> </li> 
   <ul> 
    <li>das empfangene Challenge-Token</li> 
    <li>das lokal gespeicherte Authentifizierungszertifikat</li> 
    <li>aktuelle Geräteinformationen und</li> 
    <li>Angaben zur vom Nutzer verwendeten Methode zur Freischaltung des Authentisierungsschlüssels.<br> </li> 
   </ul> 
   <li>Der Authorization-Endpunkt prüft die empfangenen Daten und authentifiziert den Nutzer im Erfolgsfall.</li> 
  </ol> 
  <p id="polarion_706">Der Ablauf ist in dem folgenden Sequenzdiagramm dargestellt:</p> 
  <p id="polarion_708" style="text-align: center;" data-keep-next="true"> <img src="attachments/19-screenshot-20210517-171410.png" style="max-width: 650px;"> </p> 
  <p id="polarion_709" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">7</span>: Ablauf Verwendung alternativer Authentisierungsmittel </p> 
  <p id="polarion_710"></p> 
  <p id="polarion_150"> <span style="font-style: italic;">Hinweis: Die IDP-Dienst-interne Kommunikation zum Abruf der Pairing-Daten und der Bewertung der Gerätedaten ist in der Abbildung nicht dargestellt.&nbsp;Das Diagramm illustriert die Serviceaktivitäten, nicht die physische Verteilung.</span><br> </p> 
  <h6 id="polarion_wiki macro name=module-workitem;params=id=ML-120317">5.4.2.6.2 Erläuterungen zur Verwendung von alternativen Authentisierungsmitteln</h6> 
  <div class="heading-7" id="polarion_wiki macro name=module-workitem;params=id=ML-120318"></div> 
  <p id="polarion_711" class="MsoNormal">Um eine Authentifizierung mit alternativen Authentisierungsmitteln zu ermöglichen, wird das in [gemSpec_IDP_Dienst], unter Abschnitt 3.3 beschriebene Challenge-Response-Verfahren zur Nutzerauthentifizierung um die Möglichkeit zur Validierung von signierten Challenge-Token erweitert, die nicht auf Basis von Schlüsseln der eGK signiert wurden, sondern durch den PrK_SE_AUT eines Gerätes. Die Initiierung des Prozesses erfolgt wie in [gemSpec_IDP_Dienst] beschrieben über das Anwendungsfrontend und einen Authorization-Request an den Authorization-Endpunkt. Die Antwort des Authenticator-Moduls auf die Challenge des Authorization-Endpunkts gestaltet sich wie folgt:&nbsp;Das Authenticator-Modul produziert eine Datenstruktur, die die folgenden Informationen enthält:</p> 
  <ul id="polarion_712"> 
   <li>das vom IDP-Dienst bezogene Challenge-Token</li> 
   <li>das lokal gespeicherte, zur Anlage des Pairings verwendete Authentifizierungszertifikat der eGK</li> 
   <li>den lokal gespeicherten Key-Identifier des Schlüsselpaars PrK_SE_AUT/PuK_SE_AUT</li> 
   <li>aktuell vom Authenticator-Modul erhobene Geräteinformationen und</li> 
   <li>Informationen über die vom Nutzer verwendeten, lokalen Authentisierungsmittel.</li> 
  </ul> 
  <p id="polarion_713">Die Gesamtheit dieser Daten wird im Folgenden "Authentisierungsdaten" genannt. Der Nutzer signiert diese Daten mit dem PrK_SE_AUT und das Authenticator-Modul überträgt diese als Response auf die bezogene Challenge an den Authorization-Endpunkt. Die übertragenen Daten werden auf Basis von öffentlichen Schlüsseln, die über das Discovery Document des IDP-Dienstes publiziert werden, verschlüsselt. Den verschlüsselten Daten werden Angaben zur zeitlichen Gültigkeit beigefügt, die denen des bezogenen Challenge-Token entsprechen.&nbsp;</p> 
  <div class="heading-7" id="polarion_wiki macro name=module-workitem;params=id=ML-120320"></div> 
  <p id="polarion_714">Die Validierung der empfangenen Authentifizierungsdaten gestaltet sich wie folgt:</p> 
  <p id="polarion_715">Der Authorization-Endpunkt prüft die empfangenen Authentifizierungsdaten vor Entschlüsselung auf zeitliche Gültigkeit. Er vollzieht nach Entschlüsselung die folgenden Schritte:</p> 
  <ol id="polarion_716"> 
   <li>Prüfung, ob die übertragenen Geräteinformationen auf der Block-Liste hinterlegt sind. Ist dies der Fall, wird der Authentifizierungsvorgang abgebrochen.&nbsp;</li> 
   <li>Prüfung, ob das übermittelte Authentifizierungszertifikat C.CH.AUT gültig ist. Ist dieses gesperrt oder abgelaufen, wird der Authentifizierungsvorgang abgebrochen.</li> 
   <li>Der gespeicherte Pairing-Eintrag wird anhand der Kombination von idNummer aus dem Authentifizierungszertifikat C.CH.AUT und dem übertragenen Key-Identifier dereferenziert. Existiert kein solcher, wird der Authentifizierungsvorgang abgebrochen.&nbsp;</li> 
   <li>Die ursprünglich im Rahmen des Registrierungsprozesses vom Nutzer geleistete Signatur der Pairing-Daten wird vom Authorization-Endpunkt auf mathematische Integrität überprüft. Erweisen sich die hinterlegten Daten als verfälscht, wird der Authentifizierungsvorgang abgebrochen.&nbsp;</li> 
   <li>Der&nbsp;in den Pairing-Daten vorhandene öffentliche Schlüssel PuK_SE_AUT wird zur Authentifizierung der übermittelten Authentifizierungsdaten angewendet, wenn</li> 
   <ol> 
    <li>die übermittelten Gerätedaten entweder auf ein Gerät auf der Allow-Liste verweisen oder</li> 
    <li> andernfalls der Zeitpunkt der Anlage des Pairings nicht mehr als 6 Monate zurückliegt. &nbsp;</li> 
   </ol> 
   <li>Der Authorization-Endpunkt prüft die mathematische Integrität der übermittelten Authentifizierungsdaten mithilfe des öffentlichen Schlüssels PuK_CH_AUT aus den hinterlegten Pairing-Daten.&nbsp;</li> 
  </ol> 
  <p id="polarion_717"> Bei Fehlschlag einer Prüfung wird der Prozess abgebrochen. Bei erfolgreichem Durchlaufen aller Prüfungen gilt der Nutzer als authentifiziert. Alle weiteren Prozesse des Authorization-Endpunkts wie in [gemSpec_IDP_Dienst] unter Abschnitt 5.2 beschrieben werden durchlaufen und münden in der Produktion eines Authorization-Code und eines <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span>. Die vom Authenticator-Modul übertragenen Informationen über die Art der vom Nutzer verwendeten lokalen Authentisierungsmethode zur Anwendung des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PrK_SE_AUT</span> werden als Claim in <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> und <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> verankert. </p> 
  <h6 id="polarion_wiki macro name=module-workitem;params=id=ML-120371">5.4.2.6.3 Spezifikation</h6> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116933|external=true|anchor=91e273e2-c0a8e834-598480ea-b584f2f0">
   ML-116933
   <p><b>A_21449</b></p>
   <p>Der Authorization-Endpunkt des IdP-Dienstes MUSS bei der Verwendung von alternativen Authentisierungsmitteln die folgenden Datentypen zur Kommunikation mit dem Authenticator-Modul verwenden:<br> 
    <ul>
     <li><span style="font-size: 10pt;line-height: 1.5;">Authentication_Data</span></li>
     <li><span style="font-size: 10pt;line-height: 1.5;">Signed_Authentication_Data</span></li>
     <li><span style="font-size: 10pt;line-height: 1.5;">Encrypted_Signed_Authentication_Data.</span></li>
    </ul> <b>&lt;=</b></p>
  </div> 
  <p id="polarion_229"></p> 
  <p id="polarion_744"> <span style="font-style: italic;">Hinweis: Anforderungen an die initiale Verarbeitung der im Zuge der Authentifizierung empfangenen Datenstruktur "Authentication_Data" stellt die Anforderung A_20699-03.</span> </p> 
  <p id="polarion_707"> <span style="font-style: italic;">Hinweis: Die&nbsp;Prüfung auf ein ungeeignetes Gerät durch Abfrage der Block/Allow-Liste erfolgt in Anforderung A_21432.</span> </p> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116912|external=true|anchor=91e2745f-c0a8e834-598480ea-815048a6">
   ML-116912
   <p><b>A_21428</b></p>
   <p>Der Authorization-Endpunkt MUSS bei Authentifizierung von Nutzern auf Basis von alternativen Authentisierungsmitteln die folgenden Fehlermeldungen produzieren:<br> <br> <p class="polarion-rte-caption-paragraph" style="text-align: left;" id="polarion___5">Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">10</span>: Fehlermeldungen des Authorization-Endpunkts bei Authentifizierung auf Basis von alternativen Authentisierungsmitteln</p>
    <table id="polarion_wiki macro name=table;params=width=100%" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;">
     <tbody>
      <tr>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 66.8px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">Nummer</th>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 790px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">Fehlermeldungstext</th>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 66.8px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">VAL.1</td>
       <td style="text-align: left;vertical-align: top;width: 790px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">Die Authentifizierung mit einem alternativen Authentifizierungsmittel&nbsp;konnte nicht erfolgreich durchgeführt werden.</td>
      </tr>
     </tbody>
    </table> <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116916|external=true|anchor=91e2749d-c0a8e834-598480ea-17bc397a">
   ML-116916
   <p><b>A_21432</b></p>
   <p>Der Authorization-Endpunkt MUSS die in der Authentication_Data/Device_Information-Struktur dargelegten Informationen zum Gerätetyp auf Basis der Block/Allow-Liste bewerten. Sofern das Gerät als nicht geeignet im Sinne der Anforderung A_21404 eingestuft ist, MUSS der Authentifizierungsvorgang mit der Fehlermeldung „access_denied“ und der „error_description“ VAL.1 genannt abgebrochen werden. Die Zuordnung zwischen gelieferten Informationen zum Gerätetyp und der Datenbasis der Block/Allow-Liste MUSS auf Basis des Vergleichs der in den einzelnen Claims enthaltenen Strings erfolgen. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116917|external=true|anchor=91e274cc-c0a8e834-598480ea-9912c4eb">
   ML-116917
   <p><b>A_21433</b></p>
   <p>Der Authorization-Endpunkt MUSS die Gültigkeit des in der Signed_Authentication_Data-Struktur gelieferten Authentifizierungszertifikats überprüfen. Die Zertifikatsprüfung des Authentifizierungszertifikats muss hierbei auf Basis der Systemzeit des Pairing-Endpunkts als Referenzzeit erfolgen. Die Prüfung des Zertifikats MUSS gemäß [gemSpec_PKI], Abschnitt 8.3.1.1 „TUC_PKI_018“ erfolgen.&nbsp;Bei ungültigem oder gesperrtem Zertifikat MUSS der Authorization-Endpunkt die Verarbeitung abbrechen. <span style="font-size: 10pt;line-height: 1.5;">Die</span> Fehlermeldungen MUSS „access_denied“ mit „error_description“ VAL.1 sein. Unter "Authentifizierungszertifikat" wird ein Zertifikat des Typs C.CH.AUT verstanden. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116918|external=true|anchor=91e2750b-c0a8e834-598480ea-16a56418">
   ML-116918
   <p><b>A_21434</b></p>
   <p>Der Authorization-Endpunkt MUSS die idNummer aus dem übermittelten Authentifizierungszertifikat entnehmen (vergleiche A_20524 [gemSpec_IDP_Dienst] und [gemSpec_PKI], Abschnitt 4.2 zur Erläuterung). Der Authorization-Endpunkt MUSS anhand des in den Signed_Authentication_Data übermittelten Key-Identifiers und der extrahierten idNummer die Pairing-Daten aus der Pairing-Datenbank beziehen. Falls kein solcher Datensatz existiert, MUSS der Authorization-Endpunkt den Prozess mit einer Fehlermeldung abbrechen. Die Fehlermeldungen MUSS „access_denied“ mit „error_description“ VAL.1 sein.&nbsp;<span style="font-size: 10pt;line-height: 1.5;">Unter "Authentifizierungszertifikat" wird ein Zertifikat des Typs C.CH.AUT verstanden.</span> <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116919|external=true|anchor=91e27549-c0a8e834-598480ea-608763ba">
   ML-116919
   <p><b>A_21435</b></p>
   <p>Der Authorization-Endpunkt MUSS die Integrität der hinterlegten Pairing-Daten mithilfe des öffentlichen Schlüssels des Authentifizierungszertifikats überprüfen. Erweisen sich die (mathematische) Integrität der Daten nicht als gewährleistet, MUSS die Verarbeitung mit einer Fehlermeldung abgebrochen werden. Die Fehlermeldungen MUSS „access_denied“ mit „error_description“ VAL.1 sein.&nbsp;<span style="font-size: 10pt;line-height: 1.5;">Unter "Authentifizierungszertifikat" wird ein Zertifikat des Typs C.CH.AUT verstanden.</span><br> <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116921|external=true|anchor=91e27578-c0a8e834-598480ea-b1abd728">
   ML-116921
   <p><b>A_21437</b></p>
   <p>Der Authorization-Endpunkt MUSS die Eignung des in den Pairing-Daten gespeicherten öffentlichen Schlüssels PuK_SE_AUT zur Prüfung der Integrität der Signed_Authentication_Data-Struktur wie folgt bewerten: <br> 
    <ul>
     <li>Falls der Typ des Geräts des Endnutzers eine Einstufung als uneingeschränkt geeignet im Sinne von A_21404 besitzt, ist der öffentliche Schlüssel für die Validierung der Signed_Authentication_Data-Struktur zu verwenden.</li>
     <li>Falls andernfalls der Typ des Geräts des Endnutzers eine Einstufung als eingeschränkt geeignet im Sinne von A_21404 besitzt, ist der öffentliche Schlüssel für die Validierung der Signed_Authentication_Data-Struktur geeignet, wenn der Anlagezeitpunkt des Pairings nicht mehr als 6 Monate zurückliegt (d.h. sofern die aktuelle Zeit &lt; pairing_entry.creationTime+6 Monate ist). Hierbei DARF auf den vollen Tag aufgerundet werden. Ist dies nicht der Fall, so MUSS die Verarbeitung mit einer Fehlermeldung abgebrochen werden. Die Fehlermeldungen MUSS „access_denied“ mit „error_description“ VAL.1 sein.</li>
    </ul> <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116922|external=true|anchor=91e275b7-c0a8e834-598480ea-5f8f19f0">
   ML-116922
   <p><b>A_21438</b></p>
   <p>Der Authorization-Endpunkt MUSS die Integrität der übermittelten Signed_Authentication_Data mithilfe des öffentlichen Schlüssels aus dem Pairing-Datensatz überprüfen. Sofern sich die Daten als nicht (mathematisch) integer erweisen MUSS der Authorization-Endpunkt den Prozess mit einer Fehlermeldung abbrechen.&nbsp;Die Fehlermeldungen MUSS „access_denied“ mit „error_description“ VAL.1 sein.<br> <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116923|external=true|anchor=91e275f5-c0a8e834-598480ea-f889dbeb">
   ML-116923
   <p><b>A_21439</b></p>
   <p>Der Authorization-Endpunkt MUSS im Zuge der Validierung der&nbsp;mathematischen Integrität der Signed_Authentication_Data-Struktur die folgenden Algorithmen unterstützen: ECDSA mit Kurve P-256 und SHA-256.<br> <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116924|external=true|anchor=91e27420-c0a8e834-598480ea-eb642e6f">
   ML-116924
   <p><b>A_21440</b></p>
   <p>Der Authorization-Endpunkt MUSS nach erfolgreicher Prüfung der Signed_Authentication_Data einen Authorization Code und einen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> produzieren. Basis für die Claims liefert das übertragene Authentifizierungszertifikat und die Claims aus der Datenstruktur Authentication_Data. <span style="font-size: 10pt;line-height: 1.5;">Unter "Authentifizierungszertifikat" wird ein Zertifikat des Typs C.CH.AUT verstanden.&nbsp;</span>In den produzierten <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> und <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> MUSS der&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">amr</span>-Claim identisch zu dem gleichnamigen Claim in der Authentication_Data-Struktur gesetzt werden. <b>&lt;=</b></p>
  </div> 
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-120372">5.4.2.7 Inspektion und De-Registrierung der am Pairing-Endpunkt gespeicherten Daten</h5> 
  <h6 id="polarion_wiki macro name=module-workitem;params=id=ML-120322">5.4.2.7.1 Inspektion am Pairing-Endpunkt</h6> 
  <p id="polarion_688"> Die Inspektionsfunktion gestattet dem Nutzer unter Verwendung des Authenticator-Moduls die von ihm am Pairing-Endpunkt gespeicherten Daten in Augenschein zu nehmen. Bedingung für die Nutzung der Inspektionsfunktion ist die Authentisierung des Nutzers am IDP-Dienst (unter Verwendung von eGK, <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> oder Pairing) belegt durch die Vorlage eines gültigen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span>.&nbsp;Die Prüfung des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> beinhaltet keine weiteren Anforderungen, die über die in [gemSpec_IDP_FD], Abschnitt 6 hinausgehen. Die Authentifizierung kann hierbei&nbsp; auf Basis jedes vom IDP-Dienst zur Authentifizierung akzeptierten Mittels erfolgen.&nbsp;Das <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> enthält die ID-Nummer des Nutzers. Anhand der idNummer lassen sich alle am Pairing-Endpunkt hinterlegten Pairing-Einträge dereferenzieren. Diese werden dem Nutzer zur Ansicht übermittelt. Sie umfassen: </p> 
  <ul id="polarion_721"> 
   <li>die signierten Pairing-Daten,</li> 
   <li>den Zeitpunkt der Anlage des Pairings und</li> 
   <li>den vom Nutzer zugewiesenen Namen des Geräts.</li> 
  </ul> 
  <p id="polarion_722">Der Ablauf ist im folgenden Sequenzdiagramm dargestellt:</p> 
  <p id="polarion_723" style="text-align: center;" data-keep-next="true"> <img src="attachments/20-screenshot-20210517-172002.png" style="max-width: 650px;"> </p> 
  <p id="polarion_724" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">8</span>: Inspektion der Pairing-Daten </p> 
  <h6 id="polarion_wiki macro name=module-workitem;params=id=ML-120321">5.4.2.7.2 Deregistrierung von alternativen Authentisierungsmitteln</h6> 
  <p id="polarion_725"> Die Deregistrierungsfunktion gestattet dem Nutzer, von ihm gespeicherte Pairing zu deaktivieren, das heißt den öffentlichen Schlüssel dauerhaft von der Verwendung als Mittel zur Authentifizierung auszuschließen. Bedingung für die Nutzung der Deregistrierungsfunktion ist das Vorliegen eines gültigen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> und die Darstellung der Daten analog wie in Abschnitt&nbsp;<span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-120322" data-option-id="longoutline"></span>&nbsp; beschrieben. </p> 
  <p id="polarion_726"> Der Nutzer erhält die Option zur Auswahl eines zu deaktivierenden Pairing. Das Authenticator-Modul überträgt den Key-Identifier des gewählten Pairing-Datensatzes und den bereits bezogenen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> zum Pairing-Endpunkt. Der Pairing-Endpunkt referenziert den zu deaktivierenden Pairing-Eintrag anhand der idNummer im <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> und dem übermittelten Key-Identifier. Der Anbieter des IDP-Dienstes ist verpflichtet, den identifizierten Pairing-Eintrag binnen einer definierten Frist von der Verwendung zur Authentifizierung dauerhaft auszuschließen. Die Konkretisierung der Fristsetzung findet sich in den folgenden Anforderungen.&nbsp; </p> 
  <p id="polarion_727">Motivation: Die Realisierung der Funktion soll dem Nutzer eine umfassende Möglichkeit geben, alternative Authentisierungsmittel voraussetzungslos zu deaktivieren&nbsp;(z. B. in Situationen, in denen ein Verlust oder Defekt eines Gerätes eine lokale Löschung von Authentisierungsmitteln&nbsp;ausschließt).&nbsp;</p> 
  <p id="polarion_728"> Der Ablauf ist in folgendem Sequenzdiagramm dargestellt:<br> </p> 
  <p id="polarion_729" style="text-align: center;" data-keep-next="true"> <img src="attachments/21-screenshot-20210517-172002.png" style="max-width: 650px;"> </p> 
  <p id="polarion_730" style="text-align: center;" class="polarion-rte-caption-paragraph"> Abbildung <span data-sequence="Abbildung" class="polarion-rte-caption">9</span>: Deregistrierung eines Pairings </p> 
  <h6 id="polarion_wiki macro name=module-workitem;params=id=ML-120373">5.4.2.7.3 Spezifikation</h6> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116934|external=true|anchor=91e27634-c0a8e834-598480ea-be522303">
   ML-116934
   <p><b>A_21450</b></p>
   <p>Die Inspektions- und Deregistrierungsfunktion des IdP-Dienstes MUSS die folgenden Datentypen zur Kommunikation mit dem Authenticator-Modul verwenden:&nbsp;<br> 
    <ul>
     <li>Pairing_Entry</li>
     <li>Pairing_Entries.</li>
    </ul> <b>&lt;=</b></p>
  </div> 
  <p id="polarion_677"></p> 
  <p id="polarion_734"> <span style="font-style: italic;">Hinweis: Die Ausgestaltung der Datenformate und Kommunikationsprotokolle ist im Anhang C dieses Dokuments dargelegt.</span><br> </p> 
  <p id="polarion_745"> <span style="font-style: italic;">Hinweis: Die Ausgestaltung der Fehlermeldungen ist im Anhang C dieses Dokuments dargelegt.</span> </p> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116925|external=true|anchor=91e27662-c0a8e834-598480ea-4b5c80cc">
   ML-116925
   <p><b>A_21441</b></p>
   <p>Der Pairing-Endpunkt des IdP-Dienstes MUSS im Zusammenhang mit der Inspektions- und Deregistrierungsfunktion die folgenden Fehlermeldungen produzieren:<br> <br> <p class="polarion-rte-caption-paragraph" style="text-align: left;" id="polarion___6">Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">11</span>: Fehlermeldungen Inspektions- und Deregistrierungsfunktion</p>
    <table id="polarion_wiki macro name=table;params=width=100%" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;">
     <tbody>
      <tr>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 98.8px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">Nummer</th>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 762px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">Fehlermeldungstext</th>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 98.8px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">AC.1</td>
       <td style="text-align: left;vertical-align: top;width: 762px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">Der Zugriff auf den Dienst kann nicht gewährt werden.</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 98.8px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">AC.2</td>
       <td style="text-align: left;vertical-align: top;width: 762px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">Die Registrierungsdaten konnten nicht bezogen werden.</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 98.8px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">AC.3</td>
       <td style="text-align: left;vertical-align: top;width: 762px;height: 17.2px;border: 1px solid #CCCCCC;padding: 5px;">Der Auftrag zur Deaktivierung des Pairings konnte nicht angenommen werden.</td>
      </tr>
     </tbody>
    </table> <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116929|external=true|anchor=91e276a1-c0a8e834-598480ea-46c959d6">
   ML-116929
   <p><b>A_21445</b></p>
   <p>Der Pairing-Endpunkt MUSS das bezogene <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> mit dem privaten Schlüssel PrK.IDP.ENC entschlüsseln.&nbsp;Das zur Entschlüsselung des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> zu verwendende Verfahren ist ECDH-ES. Die Prüfung des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> erfolgt wie in [gemSpec_IDP_FD], Abschnitt 6 beschrieben. Sofern das <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> ungültig ist, MUSS dem Authenticator-Modul die Fehlermeldung AC.1 übermittelt werden. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116963|external=true|anchor=91e276df-c0a8e834-598480ea-2ff3c361">
   ML-116963
   <p><b>A_21452</b></p>
   <p>Der Pairing-Endpunkt MUSS die <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">idNummer</span> des Benutzers aus den Claims des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> extrahieren und die Pairing-Datenbank anhand der <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">idNummer</span> nach den bestehenden Pairings des Benutzers abfragen. Die bezogenen Pairing-Daten MÜSSEN dem Authenticator-Modul übermittelt werden.&nbsp;Die Antwort MUSS eine Liste von Pairing_Entry-Daten sein. Sofern die Daten nicht bezogen werden konnten, MUSS dem Authenticator-Modul die Fehlermeldung AC.2 übermittelt werden. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116931|external=true|anchor=91e2770e-c0a8e834-598480ea-3a26aade">
   ML-116931
   <p><b>A_21447</b></p>
   <p>Der Pairing-Endpunkt MUSS das Kommando zum Deaktivieren eines Pairing-Eintrags annehmen. Das Kommando umfasst dabei das <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> und den Key-Identifier des zu deaktivierenden Pairing-Eintrages.&nbsp;Der Pairing-Eintrag MUSS anhand von Key-Identifier und der im <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> enthaltenen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">idNummer</span> identifiziert und deaktiviert werden. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116932|external=true|anchor=91e2774d-c0a8e834-598480ea-0ed19097">
   ML-116932
   <p><b>A_21448</b></p>
   <p><span style="font-size: 10pt;line-height: 1.5;">Der Pairing-Endpunkt MUSS den zur Deaktivierung angefragten Pairing-Datensatz anhand der Kombination aus dem übermittelten Key-Identifier und der aus dem <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> bezogenen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">idNummer</span> identifizieren. Das verwendete Pairing MUSS dauerhaft deaktiviert werden. Die zur Authentifizierung verwendeten Authentifizierungsschlüssel dürfen nicht mehr verwendet werden. Sofern der Auftrag zur Deaktivierung nicht angenommen werden konnte, MUSS der Pairing-Endpunkt dem Authenticator-Modul die Fehlermeldung AC.3 übermitteln.</span> <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-116981|external=true|anchor=91e2778b-c0a8e834-598480ea-ec45b2b4">
   ML-116981
   <p><b>A_21454</b></p>
   <p>Der Anbieter des IdP-Dienstes MUSS sicherstellen, dass ein in der Pairing-Datenbank gespeichertes Pairing auf Anfrage des Nutzers innerhalb einer Stunde deaktiviert wird. Dies gilt auch für eine standortübergreifende Realisierung der einzelnen Endpunkte des IdP-Dienstes. <b>&lt;=</b></p>
  </div> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-126102">5.5 Third-Party Authorization Endpoint</h3> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124949|external=true|anchor=91e277ca-c0a8e834-598480ea-d8b409be">
   ML-124949
   <p><b>A_22262</b></p>
   <p>Der IDP-Dienst MUSS einen Third-Party Authorization Endpoint unter einer dedizierten URL bereitstellen und dort Authorization Requests und&nbsp;Authorization Codes eines sektoralen Identity Provider annehmen. <b>&lt;=</b></p>
  </div> 
  <p id="polarion_781"> Der IDP-Dienst muss einen <span style="font-size: 10pt;line-height: 1.5;">Third-Party-Authorization Endpoint bereitstellen, an welchem&nbsp;Authorization Requests eingereicht werden, bei denen die eigentliche Authentisierung anschließend unter Nutzung eines sektoralen Identity Provider durchgeführt werden soll. Nach erfolgter Authentisierung erzeugt der IDP-Dienst aus den Daten des abgerufenen ID-Token die eigenen Token für das Anwendungsfrontend und den Fachdienst.</span> </p> 
  <p id="polarion_782"> <span style="font-weight: bold;"> </span> </p> 
  <p id="polarion_671"></p> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124951|external=true|anchor=91e27808-c0a8e834-598480ea-9c1eb445">
   ML-124951
   <p><b>A_22263</b></p>
   <p>Der IDP-Dienst MUSS für Anfragen zur Authentisierung an einem sektoralen Identity Provider die folgenden Daten zur späteren Korrelation der Anfragen in einer Sitzung speichern:<br> 
    <table style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;" class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%">
     <tbody>
      <tr>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 215.45px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;">Quelle</th>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 133.288px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;">Parameter</th>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 220.462px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;">Erläuterung</th>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 215.45px;height: 205.8px;border: 1px solid #CCCCCC;padding: 5px;" rowspan="4">E-Rezept-FdV/Daten aus dem Authorization Request des E-Rezept-FdV</td>
       <td style="text-align: left;vertical-align: top;width: 133.288px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">client_id</td>
       <td style="text-align: left;vertical-align: top;width: 220.462px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">Dies ist die client-id des Anwendungsfrontend.</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 133.288px;height: 57.6px;border: 1px solid #CCCCCC;padding: 5px;">nonce_erp</td>
       <td style="text-align: left;vertical-align: top;width: 220.462px;height: 57.6px;border: 1px solid #CCCCCC;padding: 5px;">Dies ist die Nonce für das ID-Token, das zum Anwendungsfrontend gesendet werden soll.</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 133.288px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">state_erp</td>
       <td style="text-align: left;vertical-align: top;width: 220.462px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">state-Parameter des Anwendungsfrontend</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 133.288px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">code_challenge</td>
       <td style="text-align: left;vertical-align: top;width: 220.462px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">code_challenge des Anwendungsfrontend</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 215.45px;height: 244.2px;border: 1px solid #CCCCCC;padding: 5px;" rowspan="4">IDP-Dienst/Daten des Authorization Request des IDP-Dienstes an den sektoralen Identity Provider</td>
       <td style="text-align: left;vertical-align: top;width: 133.288px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">nonce_idp</td>
       <td style="text-align: left;vertical-align: top;width: 220.462px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">Nonce für das ID-Token des sektoralen Identity Provider</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 133.288px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">code_verifier</td>
       <td style="text-align: left;vertical-align: top;width: 220.462px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">Code-Verifier des IDP-Dienstes zur Abfrage des ID-Token</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 133.288px;height: 57.6px;border: 1px solid #CCCCCC;padding: 5px;">kk_app_id&nbsp;</td>
       <td style="text-align: left;vertical-align: top;width: 220.462px;height: 57.6px;border: 1px solid #CCCCCC;padding: 5px;">Identifier für das zu nutzende Authenticator-Modul des angefragten sektoralen Identity Provider</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 133.288px;height: 76.8px;border: 1px solid #CCCCCC;padding: 5px;">state_idp</td>
       <td style="text-align: left;vertical-align: top;width: 220.462px;height: 76.8px;border: 1px solid #CCCCCC;padding: 5px;">state-Parameter es IDP-Dienstes zur Abfrage des ID-Tokenf<br> Über diesen Wert wird die Sitzung anschließend referenziert.</td>
      </tr>
     </tbody>
    </table>Der IDP-Dienst MUSS diese Daten über den von ihm generierten state-Parameter referenzieren und in den späteren Anwendungsfällen dereferenzieren können. <b>&lt;=</b></p>
  </div> 
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-126100">5.5.1.1 Third-Party Authorization-Endpunkt Eingangsdaten</h5> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124953|external=true|anchor=91e27837-c0a8e834-598480ea-497ad222">
   ML-124953
   <p><b>A_22264</b></p>
   <p>Wenn der Authorization Request einen Parameter "kk_app_id" mit dem Identifikator eines sektoralen Authenticator-Moduls enthält, MUSS der IDP-Dienst selbst einen Authorization Request als Client an den zugehörigen sektoralen Identity Provider stellen. Der Request wird in Form eines HTTP-302-redirect als Antwort auf dessen Authorization-Request zurück an das Authenticator-Modul gesendet. Die "target_url" des "redirect" ist dabei&nbsp;die URL des Authenticator-Moduls des sektoralen Identity Provider, welches durch den Parameter "kk_app_id" gewählt wurde. Hierbei sind die folgenden Parameter zu verwenden:<br> 
    <table style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;" class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%">
     <tbody>
      <tr>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 138.788px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;">Parameter</th>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 205.337px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;">Wert</th>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 225.075px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;">Anmerkung</th>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 138.788px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;">client_id</td>
       <td style="text-align: left;vertical-align: top;width: 205.337px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;">"zentraler idp-dienst"</td>
       <td style="text-align: left;vertical-align: top;width: 225.075px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;"><br></td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 138.788px;height: 57.6px;border: 1px solid #CCCCCC;padding: 5px;">state</td>
       <td style="text-align: left;vertical-align: top;width: 205.337px;height: 57.6px;border: 1px solid #CCCCCC;padding: 5px;">dynamisch und zufällig zu erzeugen</td>
       <td style="text-align: left;vertical-align: top;width: 225.075px;height: 57.6px;border: 1px solid #CCCCCC;padding: 5px;">Diesen State verwendet der IDP-Dienst, um die später erhaltene Antwort zuzuordnen.</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 138.788px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">redirect_uri</td>
       <td style="text-align: left;vertical-align: top;width: 205.337px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">die Adresse des Authenticator-Moduls des IDP-Dienstes</td>
       <td style="text-align: left;vertical-align: top;width: 225.075px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">Diese wird aus der ursprünglichen Anfrage übernommen.</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 138.788px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">code_challenge</td>
       <td style="text-align: left;vertical-align: top;width: 205.337px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">mit der Methode "S256" erzeugter Hash des Code-Verifier</td>
       <td style="text-align: left;vertical-align: top;width: 225.075px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;"><br></td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 138.788px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;">code_challenge_method</td>
       <td style="text-align: left;vertical-align: top;width: 205.337px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;">"S256"&nbsp;</td>
       <td style="text-align: left;vertical-align: top;width: 225.075px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;"><br></td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 138.788px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;">response_type</td>
       <td style="text-align: left;vertical-align: top;width: 205.337px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;">code</td>
       <td style="text-align: left;vertical-align: top;width: 225.075px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;"><br></td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 138.788px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">nonce</td>
       <td style="text-align: left;vertical-align: top;width: 205.337px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">dynamisch und zufällig zu erzeugen</td>
       <td style="text-align: left;vertical-align: top;width: 225.075px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;">Nonce für das vom sektoralen IDP-Dienst zu erzeugende ID-Token</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 138.788px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;">scope</td>
       <td style="text-align: left;vertical-align: top;width: 205.337px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;">"erp_sek_auth+openid"</td>
       <td style="text-align: left;vertical-align: top;width: 225.075px;height: 19.2px;border: 1px solid #CCCCCC;padding: 5px;"><br></td>
      </tr>
     </tbody>
    </table> <b>&lt;=</b></p>
  </div> 
  <p id="polarion_784"> <span style="font-weight: bold;"> </span> </p> 
  <p id="polarion_785"> Der Request geht als Antwort in Form eines HTTP-302-redirect&nbsp;auf den Authorisierungs-Request zurück an das Authenticator-Modul&nbsp;(vergleiche Schritt 2 in<span style="font-size: 10pt;color: #FF0000;line-height: 1.5;"><span class="polarion-rte-link" data-type="polarion" id="fake" data-custom-label="gemSpec_IDP_Sek#2.2" data-url="/wiki/Spezifikation/gemSpec_IDP_Sek?selection=ML-122072"></span></span>). Die "target_url" des redirect ist dabei&nbsp;die URL des Authenticator-Moduls des sektoralen Identity Provider, welches durch den Parameter "kk_app_id" gewählt wurde. </p> 
  <p id="polarion_786"> Auf einen "claims"-Parameter wird verzichtet.<span id="polarion-comment:1622"></span> </p> 
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-126103">5.5.1.2 Third-Party Authorization-Endpunkt Ausgangsdaten</h5> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124952|external=true|anchor=91e27876-c0a8e834-598480ea-583864b1">
   ML-124952
   <p><b>A_22265</b></p>
   <p>Bei eingehenden Authorization Requests am <span style="font-size: 10pt;line-height: 1.5;">Third-Party Authorization Endpoint,&nbsp;</span>die anstelle eines <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE_TOKEN</span> den AUTHORIZATION_CODE_IDP eines sektoralen Identity Provider enthalten, MUSS der IDP-Dienst anhand des state-Parameters die in [<span style="font-size: 10pt;line-height: 1.5;">A_22263]&nbsp;</span>definierten Sitzungsdaten rekonstruieren, selbst einen Token Request an den sektoralen Identity Provider stellen und dabei als 'Confidential Client' agieren. <br> <br>Der entsprechende sektorale Identity Provider ergibt sich dabei aus der gewählten "kk_app_id" der Anfrage. Als "redirect_uri" ist die übermittelte Adresse des Authenticator-Moduls des sektoralen Identity Provider ("<span style="font-size: 10pt;line-height: 1.5;">kk_app_redirect_uri")&nbsp;</span>zu verwenden.<br> <br>Hierbei sind die folgenden Inhalte zu verwenden:<br> <br> 
    <table style="width: 100%;margin-left: 0px;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;" class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%">
     <tbody>
      <tr>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 91.3125px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Parameter<br></th>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 165.1px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Wert</th>
       <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 312.788px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Anmerkung</th>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 91.3125px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">grant_type</td>
       <td style="text-align: left;vertical-align: top;width: 165.1px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">authorization_code</td>
       <td style="text-align: left;vertical-align: top;width: 312.788px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 91.3125px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">code</td>
       <td style="text-align: left;vertical-align: top;width: 165.1px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">AUTHORIZATION_CODE_IDP</td>
       <td style="text-align: left;vertical-align: top;width: 312.788px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Authorization_Code des sektoralen Identity Provider</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 91.3125px;height: 38.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">code_verifier</td>
       <td style="text-align: left;vertical-align: top;width: 165.1px;height: 38.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">&lt;code_verifier des IDP-Dienstes&gt;</td>
       <td style="text-align: left;vertical-align: top;width: 312.788px;height: 38.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">aus den Sitzungsdaten</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 91.3125px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">client_id</td>
       <td style="text-align: left;vertical-align: top;width: 165.1px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">"zentraler-idp-dienst"</td>
       <td style="text-align: left;vertical-align: top;width: 312.788px;height: 19.2px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 91.3125px;height: 38.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">redirect_uri</td>
       <td style="text-align: left;vertical-align: top;width: 165.1px;height: 38.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">kk_app_redirect_uri</td>
       <td style="text-align: left;vertical-align: top;width: 312.788px;height: 38.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">zusammen mit dem <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> übermittelte Adresse</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 91.3125px;height: 38.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">client_assertion_type</span></td>
       <td style="text-align: left;vertical-align: top;width: 165.1px;height: 38.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">"urn:ietf:params:oauth:client-assertion-type:jwt-bearer"</td>
       <td style="text-align: left;vertical-align: top;width: 312.788px;height: 38.4px;border: 1px solid #CCCCCC;padding: 5px;" rowspan="2" colspan="1">&nbsp;<br> Authentisierung des confidential client entsprechend <a class="descriptionLink" target="_top" href="https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication">https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication</a>&nbsp;durch ein signiertes JWT</td>
      </tr>
      <tr>
       <td style="text-align: left;vertical-align: top;width: 91.3125px;height: 76.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">client_assertion&nbsp;</td>
       <td style="text-align: left;vertical-align: top;width: 165.1px;height: 76.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">private_key_jwt</td>
      </tr>
     </tbody>
    </table><br>Der Timeout, mit dem ein Request zum sektoralen Identity Provider abgebrochen werden darf, wird einheitlich für alle Abfragen (und analog zur Festlegung im Kontext der OCSP Requests) auf 1100 ms festgelegt. <b>&lt;=</b></p>
  </div> 
  <p id="polarion_787"> <span style="font-weight: bold;"> </span> </p> 
  <p id="polarion_788"> <span style="font-style: italic;">Hinweis: Aufgrund der Speicherung und Referenzierung der Sitzungsdaten durch den state-Parameter, reduziert sich die Prüfung auf Gleichheit zwischen übermittelten und gespeicherten "state" auf die Prüfung des Vorhandenseins einer unter dem übermittelten "state" gespeicherten Sitzung.<span id="polarion-comment:1619"></span></span><span style="font-size: 10pt;line-height: 1.5;"> </span> </p> 
  <p id="polarion_791"> <span style="font-weight: bold;"> </span> </p> 
  <p id="polarion_738"> Der restliche Flow gestaltet sich wie in den Dokumenten [gemSpec_IDP_Dienst], [gemSpec_IDP_Frontend] und [gemSpec_IDP_Dienst] beschrieben. Dieses schließt die Produktion eines geeigneten <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> durch den IDP-Dienst mit ein.<span id="polarion-comment:1614"></span> </p> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124954|external=true|anchor=91e278b4-c0a8e834-598480ea-e5610b77">
   ML-124954
   <p><b>A_22266</b></p>
   <p>Der IDP-Dienst MUSS sich gegenüber dem Token-Endpunkt des sektoralen Identity Provider <span style="font-size: 10pt;line-height: 1.5;">entsprechend&nbsp;<a class="descriptionLink" target="_top" href="https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication">https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication</a>&nbsp;als 'confidential client' mit einem "private_key_jwt" authentisieren.</span><br> <span style="font-size: 10pt;line-height: 1.5;">Dieses "private_key_jwt" hat eine maximale Gültigkeit von 3 Minuten und muss mit dem Schlüssel&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">PuK_IDP_SIG_Sek</span> signiert werden.</span> <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124976|external=true|anchor=91e278f3-c0a8e834-598480ea-06120bf6">
   ML-124976
   <p><b>A_22268</b></p>
   <p>Der IDP-Dienst MUSS empfangene ID-Token auf Authentizität gemäß [OpenID.Core#3.1.3.7] prüfen.<br>Insbesondere MUSS die Signatur mit einem unter "jwks_uri" referenzierter öffentlichen Schlüssel aus dem Discovery Document des sektoralen Identity Provider prüfbar sein. Dieser ist über die "kid" aus der Signatur des Token auszuwählen. <br>Des Weiteren MUSS der IDP-Dienst prüfen, ob die im ID-Token enthaltene Nonce dem Wert "nonce_idp" aus den Sitzungsdaten der Session entspricht. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124974|external=true|anchor=91e27931-c0a8e834-598480ea-21bcaf05">
   ML-124974
   <p><b>A_22269</b></p>
   <p>Nach erfolgreicher Prüfung des <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID-TOKEN</span> MUSS der IDP-Dienst auf Basis der Sitzungsdaten und der Inhalte der Claims einen Authorization Code wie in [gemSpec_IDP#5.2.2] beschrieben produzieren und diesen zusammen mit dem gespeicherten 'State' und einem <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> an das Anwendungsfrontend übermitteln. <b>&lt;=</b></p>
  </div> 
  <div id="polarion_wiki macro name=module-workitem;params=id=ML-124975|external=true|anchor=91e27970-c0a8e834-598480ea-c786d449">
   ML-124975
   <p><b>A_22270</b></p>
   <p>Der IDP-Dienst MUSS nach erfolgter Ausstellung des Authorization Code oder Abbruch des Prozesses die unter dem vom ihm erzeugten 'State' gespeicherten Sitzungsdaten zur Anfrage an einen sektoralen Identity Provider löschen.&nbsp; <b>&lt;=</b></p>
  </div> 
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-104177">6 Anhang A – Verzeichnisse</h2> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104178">6.1 Abkürzungen</h3> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=1" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 94px;height: 19.6px;border: 1px solid #CCCCCC;padding: 5px;">Kürzel<br> </th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 486.8px;height: 19.6px;border: 1px solid #CCCCCC;padding: 5px;">Erläuterung<br> </th> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">AVS</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Apothekenverwaltungssystem</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">DLL&nbsp;</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Dynamic Link Library</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">eGK</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Elektronische Gesundheitskarte</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">HBA</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Heilberufsausweis</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">IDP</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Identity Provider</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">JSON</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">JavaScript Object Notation</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">JWE</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">JSON Web Encryption</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">JWS</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">JSON Web Signature</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">JWT</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">JSON Web Token</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">NFC</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Near Field Communication (Kommunikation im Nahfeld einer Antenne)</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">OAuth 2.0</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Open Authorization 2.0</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">OCSP&nbsp;</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Online Certificate Status Protocol</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">OIDC</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">OpenID Connect </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">PIN</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Personal Identification Number</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">PKI</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Public Key Infrastructure</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">PVS</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Praxisverwaltungssystem</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">QES</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Qualifizierte Elektronische Signatur</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">SMC-B</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Security Module Card Typ B, Institutionenkarte</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">TI</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Telematikinfrastruktur</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">TLD&nbsp;</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Top Level Domain</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">TLS</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Transport Layer Security</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">TSL&nbsp;</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Trust-service Status List</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 94px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">URI</td> 
     <td style="text-align: left;vertical-align: top;width: 486.8px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Uniform Resource Identifier</td> 
    </tr> 
   </tbody> 
  </table> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104179">6.2 Glossar</h3> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=2" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 190px;height: 19.6px;border: 1px solid #CCCCCC;padding: 5px;">Begriff<br> </th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 540px;height: 19.6px;border: 1px solid #CCCCCC;padding: 5px;">Erläuterung<br> </th> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 57.2px;border: 1px solid #CCCCCC;padding: 5px;">Access Token</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 57.2px;border: 1px solid #CCCCCC;padding: 5px;">Ein Access Token (nach [<a href="https://tools.ietf.org/html/rfc6749#section-1.4" target="_top" class="descriptionLink">RFC6749 # section-1.4</a>])&nbsp;wird vom Client (Anwendungsfrontend) benötigt, um auf geschützte Daten eines Resource Servers zuzugreifen. Die Representation kann als JSON Web Token erfolgen.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 38px;border: 1px solid #CCCCCC;padding: 5px;">Alternatives Authentisierungsmittel</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 38px;border: 1px solid #CCCCCC;padding: 5px;">Mit einem bereits etablierten Authentisierungsmittel verknüpftes Mittel zur Authentisierung gegenüber Fachdiensten.&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 57.2px;border: 1px solid #CCCCCC;padding: 5px;">Authentifizierung des Nutzers am Gerät oder lokale Authentifizierung</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 57.2px;border: 1px solid #CCCCCC;padding: 5px;">Authentifizierungsmittel des Nutzers zur Nutzung eines Kontos auf einem Mobilgerät.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 43px;border: 1px solid #CCCCCC;padding: 5px;">Authentifizierungszertifikat</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 43px;border: 1px solid #CCCCCC;padding: 5px;">Unter einem Authentifizierungszertifikat werden&nbsp;Kontext der Registrierung und Verwendung von alternativen Authentisierungsmittel Zertifikate vom Typ C.CH.AUT der eGK verstanden.&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 57.2px;border: 1px solid #CCCCCC;padding: 5px;">Authorization Server</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 57.2px;border: 1px solid #CCCCCC;padding: 5px;">OAuth2 Rolle <span style="font-size: 10pt;line-height: 1.5;">(siehe [<a href="https://tools.ietf.org/html/rfc6749#section-1.1" target="_top" class="descriptionLink">RFC6749 # section-1.1</a>])</span>: Der Authorization Server ist Teil des IDP-Dienstes. Der Server authentifiziert den Resource Owner (Nutzer) und stellt Access Tokens für den vom Resource Owner erlaubten Anwendungsbereich (Scope) für einen Resource Server bzw. eine auf einem Resource Server existierende Protected Resource aus.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 38px;border: 1px solid #CCCCCC;padding: 5px;">Autorisierte Anwendung eines Schlüssels</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 38px;border: 1px solid #CCCCCC;padding: 5px;">Anwendung eines kryptographischen Schlüssels auf Daten durch einen berechtigten Nutzer.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 17px;border: 1px solid #CCCCCC;padding: 5px;">Betriebssystem (oder Plattform)</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 17px;border: 1px solid #CCCCCC;padding: 5px;">Der Name des Betriebssystems eines Geräts.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 21px;border: 1px solid #CCCCCC;padding: 5px;">Besitz (eines Geräts)</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 21px;border: 1px solid #CCCCCC;padding: 5px;">Verwendungshoheit eines Nutzers über ein Mobilgerät.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 37px;border: 1px solid #CCCCCC;padding: 5px;">Bewertung (eines Gerätetyps)</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 37px;border: 1px solid #CCCCCC;padding: 5px;">Sicherheitsbezogene Einstufung eines Gerätetyps mit Bezug auf seine Eignung als Authentisierungsmittel</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 27px;border: 1px solid #CCCCCC;padding: 5px;">Block/Allow-Liste(n)</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 27px;border: 1px solid #CCCCCC;padding: 5px;">Registrierung von Gerätetypen und Zuordnung zu einer Bewertung.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 20px;border: 1px solid #CCCCCC;padding: 5px;">Claim</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 20px;border: 1px solid #CCCCCC;padding: 5px;">Ein Key/Value-Paar im Payload eines JSON Web Token.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 57.2px;border: 1px solid #CCCCCC;padding: 5px;">Client</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 57.2px;border: 1px solid #CCCCCC;padding: 5px;">OAuth2 Rolle (siehe [<a href="https://tools.ietf.org/html/rfc6749#section-1.1" target="_top" class="descriptionLink">RFC6749 # section-1.1</a>]): Eine Anwendung (Relying Party), die auf geschützte Ressourcen des Resource Owners zugreifen möchte, die vom Resource Server bereitgestellt werden. Der Client kann auf einem Server (Webanwendung), Desktop-PC, mobilen Gerät etc. ausgeführt werden.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 57.2px;border: 1px solid #CCCCCC;padding: 5px;">Consent</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 57.2px;border: 1px solid #CCCCCC;padding: 5px;">Zustimmung des Nutzers zur Verarbeitung der angezeigten Daten. Der Consent umfasst die Attribute, welche vom IDP-Dienst bezogen auf die im Claim des jeweiligen Fachdienstes eingeforderten Attribute zusammenfasst. Es besteht Einigkeit zwischen dem was gefordert wird und welche Attribute im Token bestätigt werden.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 57.2px;border: 1px solid #CCCCCC;padding: 5px;">Discovery Document</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 57.2px;border: 1px solid #CCCCCC;padding: 5px;">Ein OpenID Connect Metadatendokument (siehe [<a href="https://openid.net/specs/openid-connect-discovery-1_0.html" target="_top" class="descriptionLink">openid-connect-discovery 1.0</a>]), das den Großteil der Informationen enthält, die für eine App zum Durchführen einer Anmeldung erforderlich sind. Hierzu gehören Informationen wie z.B. die zu verwendenden URLs und der Speicherort der öffentlichen Signaturschlüssel des Dienstes.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 57.2px;border: 1px solid #CCCCCC;padding: 5px;">Funktionsmerkmal </td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 57.2px;border: 1px solid #CCCCCC;padding: 5px;">Der Begriff beschreibt eine Funktion oder auch einzelne, eine logische Einheit bildende Teilfunktionen der TI im Rahmen der funktionalen Zerlegung des Systems. </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 23px;border: 1px solid #CCCCCC;padding: 5px;">Gerät</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 23px;border: 1px solid #CCCCCC;padding: 5px;">Alle Arten von mobilen Endgeräten.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 27px;border: 1px solid #CCCCCC;padding: 5px;">Geräteinformationen</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 27px;border: 1px solid #CCCCCC;padding: 5px;">Die Kombination der Informationen zum Typ eines Geräts und dem Namen eines Geräts.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 27px;border: 1px solid #CCCCCC;padding: 5px;">Hersteller</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 27px;border: 1px solid #CCCCCC;padding: 5px;">Der Name des Herstellers eines Geräts.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 35px;border: 1px solid #CCCCCC;padding: 5px;">Inspektion</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 35px;border: 1px solid #CCCCCC;padding: 5px;">Einsicht des Nutzers in die für die Anwendung von alternativen Authentisierungsmitteln gespeicherten Daten auf seinem Gerät oder innerhalb des IDP-Dienstes.&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">ID Token</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Ein auf JSON basiertes und nach [<a href="https://tools.ietf.org/html/rfc7519" target="_top" class="descriptionLink">RFC7519</a>] (JWT) genormtes Identitäts-Token, mit dem ein Client (Anwendungsfrontend) die Identität eines Nutzers überprüfen kann.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Key-Identifier</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Einem kryptographischen Schlüssel oder einem Schlüsselpaar zugeordnete Zeichenkette zur Identifikation des Schlüssels.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Löschung oder Invalidierung</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Unter Löschung eines Schlüssels sollen pauschal alle Operationen verstanden werden, die einen kryptographischen Schlüssel dauerhaft einer Anwendung entziehen.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Modell</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Der vom Hersteller vergebene Name des Geräts.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Name (eines Geräts)</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Ein vom Nutzer vergebener Name eines Geräts.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Open Authorization 2.0</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Ein Protokoll zur Autorisierung für Web-, Desktop und Mobile Anwendungen. Dabei wird es einem Endbenutzer (Resource Owner) ermöglicht, einer Anwendung (Client) den Zugriff auf Daten oder Dienste (Resources) zu ermöglichen, die von einem Dritten (Resource Server) bereitgestellt werden.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">OpenID Connect</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">OpenID Connect (OIDC) ist eine Authentifizierungsschicht, die auf dem Autorisierungsframework OAuth 2.0 basiert. Es ermöglicht Clients, die Identität des Nutzers anhand der Authentifizierung durch einen Autorisierungsserver zu überprüfen (siehe [<a href="https://openid.net/specs/openid-connect-core-1_0.html&nbsp;" target="_top" class="descriptionLink">openid-connect-core 1.0</a>]).</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Pairing</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Prüfbare Verbindung von kryptographischem Schlüsselmaterial zu einer innerhalb der Telematikinfrastruktur registrierten kryptographischen Identität.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Produkt-Name</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Der vom Hersteller für den Endkunden vergebene Name eines Geräts.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">JSON Web Token</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Ein auf JSON basiertes und nach [<a href="https://tools.ietf.org/html/rfc7519" target="_top" class="descriptionLink">RFC7519</a>] (JWT) genormtes Access-Token. Das JWT ermöglicht den Austausch von verifizierbaren Claims innerhalb seines Payloads.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Resource Owner</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">OAuth2-Rolle (siehe [<a href="https://tools.ietf.org/html/rfc6749#section-1.1" target="_top" class="descriptionLink">RFC6749 # section-1.1</a>]): Eine Entität (Nutzer), die einem Dritten den Zugriff auf ihre geschützten Ressourcen gewähren kann. Diese Ressourcen werden durch den Resource Server bereitgestellt. Ist der Resource Owner eine Person, wird dieser als Nutzer bezeichnet.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Resource Server</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">&nbsp;OAuth2 Rolle (siehe [<a href="https://tools.ietf.org/html/rfc6749#section-1.1" target="_top" class="descriptionLink">RFC6749 # section-1.1</a>]): Der Server (Dienst), auf dem die geschützten Ressourcen (Protected Resources) liegen. Er ist in der Lage, auf Basis von Access Tokens darauf Zugriff zu gewähren. Ein solcher Token repräsentiert die delegierte Autorisierung des Resource Owners.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">SSO Token</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Gegen Vorlage eines gültigen SSO Token ist keine erneute Nutzerauthentisierung für die Ausstellung eines Access Tokens am IDP-Dienst nötig.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Token-Endpunkt</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Ein Endpunkt des Authorization Servers, welcher für die Ausstellung von Token (<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span> und <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span>) zuständig ist.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Typ (eines Geräts)</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Eine existente Kombination von Gerät und Betriebssystem beschrieben durch&nbsp;<br> Namen des Herstellers, Namen des Produkts, Betriebssystem und Version des Betriebssystems.</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 190px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Version (eines Betriebssystems)</td> 
     <td style="text-align: left;vertical-align: top;width: 540px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">Die Bezeichnung der Version des Betriebssystems eines Geräts.</td> 
    </tr> 
   </tbody> 
  </table> 
  <p id="polarion_181">Das Glossar wird als eigenständiges Dokument (vgl. [gemGlossar]) zur Verfügung gestellt.</p> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104180">6.3 Abbildungsverzeichnis</h3> 
  <div data-sequence="Abbildung" id="polarion_wiki macro name=tof;params=uid=1"></div>
  <div id="toc_container">
   <p class="toc_title"><h1></h1></p>
   <li><a href="#polarion_58">Abbildung 1: Systemüberblick (vereinfacht)</a></li>
   <li><a href="#polarion_49">Abbildung 2: Übersichtsschaubild OAuth2.0 Smartcard-IDP-Dienst</a></li>
   <li><a href="#polarion_168">Abbildung 3: Systemkontext aus Sicht des IDP-Dienstes</a></li>
   <li><a href="#polarion_175">Abbildung 4:&nbsp;Datenfluss-Diagramm IDP-Dienst</a></li>
   <li><a href="#polarion_20">Abbildung 5: Schnittstellen des IDP-Dienstes</a></li>
   <li><a href="#polarion_741">Abbildung 6: Ablauf Registrierungsprozess</a></li>
   <li><a href="#polarion_709">Abbildung 7: Ablauf Verwendung alternativer Authentisierungsmittel</a></li>
   <li><a href="#polarion_724">Abbildung 8: Inspektion der Pairing-Daten</a></li>
   <li><a href="#polarion_730">Abbildung 9: Deregistrierung eines Pairings</a></li>
  </div> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104181">6.4 Tabellenverzeichnis</h3> 
  <div data-sequence="Tabelle" id="polarion_wiki macro name=tof;params=uid=2"></div>
  <div id="toc_container">
   <p class="toc_title"><h1></h1></p>
   <li><a href="#polarion_141">Tabelle 1:&nbsp;TAB_IDP_DIENST_0001 Akteure und OAuth2-Rollen</a></li>
   <li><a href="#polarion_30">Tabelle 2:&nbsp;TAB_IDP_DIENST_0002 Kurzbezeichnung der Schnittstellen des IDP-Dienstes</a></li>
   <li><a href="#polarion_42">Tabelle 3:&nbsp;TAB_IDP_DIENST_0003 Bezeichnungen der extern genutzten Schlüssel und Adressen des IDP-Dienstes</a></li>
   <li><a href="#polarion___1">Tabelle 4:&nbsp;TAB_IDP_DIENST_0005 Befüllung der Attribute "given_name", "family_name", "organizationName", "professionOID" und "idNummer"&nbsp;</a></li>
   <li><a href="#polarion___2">Tabelle 5:&nbsp;TAB_IDP_DIENST_0006 Befüllung der Attribute "acr" und "amr"</a></li>
   <li><a href="#polarion___3">Tabelle&nbsp;6:&nbsp;TAB_IDP_DIENST_000X Befüllung der Attribute nach Bestätigung durch einen sektoralen Identity Provider</a></li>
   <li><a href="#polarion_746">Tabelle 7: Faktoren und abgeleitete Anforderungen an das System</a></li>
   <li><a href="#polarion_674">Tabelle 8: Nomenklatur Schlüsselmaterial</a></li>
   <li><a href="#polarion___4">Tabelle 9: Fehlermeldungen im Zusammenhang mit der Registrierungsfunktion</a></li>
   <li><a href="#polarion___5">Tabelle 10: Fehlermeldungen des Authorization-Endpunkts bei Authentifizierung auf Basis von alternativen Authentisierungsmitteln</a></li>
   <li><a href="#polarion___6">Tabelle 11: Fehlermeldungen Inspektions- und Deregistrierungsfunktion</a></li>
   <li><a href="#polarion_176">Tabelle 12: Kodierung von Daten</a></li>
   <li><a href="#polarion_182">Tabelle 13: Schema Datentyp "Device_Type"</a></li>
   <li><a href="#polarion_195">Tabelle 14: Schema Datentyp "Device_Information"</a></li>
   <li><a href="#polarion_228">Tabelle 15: Schema Datentyp "Pairing_Data"</a></li>
   <li><a href="#polarion_239">Tabelle 16: Schema Datentyp "Signed_Pairing_Data"</a></li>
   <li><a href="#polarion_244">Tabelle 17: Schema Datentyp "Registration_Data"</a></li>
   <li><a href="#polarion_248">Tabelle 18: Schema Datentyp "Encrypted_Registration_Data"</a></li>
   <li><a href="#polarion_252">Tabelle 19: Schema Datentyp "Authentication_Data"</a></li>
   <li><a href="#polarion_256">Tabelle 20: Schema Datentyp "Signed_Authentication_Data"</a></li>
   <li><a href="#polarion_260">Tabelle 21:&nbsp;Schema Datentyp "Encrypted_Signed_Authentication_Data"</a></li>
   <li><a href="#polarion_264">Tabelle 22: Schema Datentyp "Pairing_Entry"</a></li>
   <li><a href="#polarion_268">Tabelle 23: Schema Datentyp "Pairing_Entries"</a></li>
   <li><a href="#polarion_270">Tabelle 24: Registrierungsprozess/Anfrage Authenticator-Modul</a></li>
   <li><a href="#polarion_272">Tabelle 25: Registrierungsprozess/Antwort Pairing-Endpunkt</a></li>
   <li><a href="#polarion_274">Tabelle 26: Authentifizierung/Anfrage Authenticator-Modul</a></li>
   <li><a href="#polarion_276">Tabelle 27: Authentifizierung/Antwort Authorization-Endpunkt</a></li>
   <li><a href="#polarion_278">Tabelle 28: Inspektion/Anfrage Authenticator-Modul</a></li>
   <li><a href="#polarion_280">Tabelle 29: Inspektion/Antwort Pairing-Endpunkt</a></li>
   <li><a href="#polarion_282">Tabelle 30: Deregistrierung/Anfrage Authenticator-Modul</a></li>
   <li><a href="#polarion_284">Tabelle 31: Deregistrierung/Antwort Pairing-Endpunkt</a></li>
   <li><a href="#polarion_287">Tabelle 32: Vergleichsoperationen im Rahmen der Registrierung</a></li>
  </div> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-104182">6.5 Referenzierte Dokumente</h3> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-104183">6.5.1 Dokumente der gematik</h4> 
  <p id="polarion_186">Die nachfolgende Tabelle enthält die Bezeichnung der in dem vorliegenden Dokument referenzierten Dokumente der gematik zur Telematikinfrastruktur.</p> 
  <p id="polarion_187"></p> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=4" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 151px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">[Quelle]<br> </th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 580px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">Herausgeber: Titel<br> </th> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 151px;height: 38px;border: 1px solid #CCCCCC;padding: 5px;">[gemGlossar] </td> 
     <td style="text-align: left;vertical-align: top;width: 580px;height: 38px;border: 1px solid #CCCCCC;padding: 5px;">gematik: Einführung der Gesundheitskarte – Glossar </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 151px;height: 38px;border: 1px solid #CCCCCC;padding: 5px;">[<span style="font-size: 10pt;line-height: 1.5;">gemILF_PS_eRp]</span></td> 
     <td style="text-align: left;vertical-align: top;width: 580px;height: 38px;border: 1px solid #CCCCCC;padding: 5px;">gematik: Spezifikation Implementierungsleitfaden Primärsysteme - E-Rezept</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 151px;height: 21px;border: 1px solid #CCCCCC;padding: 5px;">[gemSpec_IDP_Frontend]</td> 
     <td style="text-align: left;vertical-align: top;width: 580px;height: 21px;border: 1px solid #CCCCCC;padding: 5px;">gematik:&nbsp;Spezifikation Identity Provider-Frontend</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 151px;height: 21px;border: 1px solid #CCCCCC;padding: 5px;">[gemSpec_IDP_FD]</td> 
     <td style="text-align: left;vertical-align: top;width: 580px;height: 21px;border: 1px solid #CCCCCC;padding: 5px;">gematik:&nbsp;Spezifikation Identity Provider-Fachdienst</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 151px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">[gemSpec_Krypt]</td> 
     <td style="text-align: left;vertical-align: top;width: 580px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">gematik:&nbsp;Übergreifende Spezifikation: Verwendung kryptographischer Algorithmen in der Telematikinfrastruktur</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 151px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">[<span style="font-size: 10pt;line-height: 1.5;">gemSpec_OID</span>]</td> 
     <td style="text-align: left;vertical-align: top;width: 580px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">gematik: Übergreifende Spezifikation: Festlegung von OIDs</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 151px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">[gemSpec_PKI]</td> 
     <td style="text-align: left;vertical-align: top;width: 580px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">gematik:&nbsp;Übergreifende Spezifikation: PKI</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 151px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">[gemSpec_Perf]</td> 
     <td style="text-align: left;vertical-align: top;width: 580px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">gematik:&nbsp;Übergreifende Spezifikation: Performance und Mengengerüst TI-Plattform</td> 
    </tr> 
   </tbody> 
  </table> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-104184">6.5.2 Weitere Dokumente</h4> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=5" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[Quelle]<br> </th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Herausgeber (Erscheinungsdatum): Titel<br> </th> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[openid-connect-core]</td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">OpenID Connect Core 1.0 (November 2014) <br> <a href="https://openid.net/specs/openid-connect-core-1_0.html" target="_top" class="descriptionLink">https://openid.net/specs/openid-connect-core-1_0.html</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[openid-connect-discovery]</td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">OpenID Connect Discovery 1.0 (November 2014)<br> <a href="https://openid.net/specs/openid-connect-discovery-1_0.html&nbsp;" target="_top" class="descriptionLink">https://openid.net/specs/openid-connect-discovery-1_0.html&nbsp;</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[RFC6749]</td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">The OAuth 2.0 Authorization Framework (Oktober 2012) <br> <a href="https://tools.ietf.org/html/rfc6749" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc6749</a></td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[RFC6750]</td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">The OAuth 2.0 Authorization Framework: Bearer Token Usage (Oktober 2012) <br> <a href="https://tools.ietf.org/html/rfc6750" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc6750</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[RFC7033]</td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Webfinger (September 2013)<br> <a href="https://tools.ietf.org/html/rfc7033" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc7033</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[RFC7231]</td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content (Juni 2014)<br> <a href="https://tools.ietf.org/html/rfc7231" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc7231</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[RFC7515]</td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON Web Signature (Mai 2015)<br> <a href="https://tools.ietf.org/html/rfc7515" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc7515</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[RFC7516]</td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON Web Encryption (Mai 2015)<br> <a href="https://tools.ietf.org/html/rfc7516" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc7516</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[RFC7519]&nbsp;</td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON Web Token (Mai 2015) <br> <a href="https://tools.ietf.org/html/rfc7519" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc7519</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[RFC7523]</td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants (Mai 2015) <br> <a href="https://tools.ietf.org/html/rfc7523" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc7523</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[RFC7636]</td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Proof Key for Code Exchange by OAuth Public Clients (September 2015)<br> <a href="https://tools.ietf.org/html/rfc7636" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc7636</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[RFC8252]</td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">OAuth 2.0 for Native Apps (Oktober 2017)<br> <a href="https://tools.ietf.org/html/rfc8252" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc8252</a>&nbsp;</span>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[RFC4648]</td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">The Base16, Base32, and Base64 Data Encodings<br> <a href="https://tools.ietf.org/html/rfc4648" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc4648</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[RFC5480]</td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Elliptic Curve Cryptography Subject Public Key Information<br> <a href="https://tools.ietf.org/html/rfc5480" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc5480</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[RFC5280]</td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Internet X.509 Public Key Infrastructure Certificate<br> and Certificate Revocation List (CRL) Profile<br> <a href="https://tools.ietf.org/html/rfc5280" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc5280</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[RFC7516]</td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON Web Encryption (JWE)<br> <a href="https://tools.ietf.org/html/rfc7516" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc7516</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[RFC8176]</td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Authentication Method Reference Values<br> <a href="https://tools.ietf.org/html/rfc8176" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc8176</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[openid-connect-modrna]</td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">OpenID Connect MODRNA Authentication Profile 1.0<br> <a href="https://openid.net/specs/openid-connect-modrna-authentication-1_0.html" target="_top" class="descriptionLink">https://openid.net/specs/openid-connect-modrna-authentication-1_0.html</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[RFC4648]</td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">The Base16, Base32, and Base64 Data Encodings<br> <a href="https://tools.ietf.org/html/rfc4648" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc4648</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[RFC5480]</td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Elliptic Curve Cryptography Subject Public Key Information<br> <a href="https://tools.ietf.org/html/rfc5480" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc5480</a>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">[RFC5280]</td> 
     <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Internet X.509 Public Key Infrastructure Certificate<br> and Certificate Revocation List (CRL) Profile<br> <a href="https://tools.ietf.org/html/rfc5280" target="_top" class="descriptionLink">https://tools.ietf.org/html/rfc5280</a>&nbsp;</td> 
    </tr> 
   </tbody> 
  </table> 
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-119214">7 Anhang B - Beispiele der Objekte und Aufrufe</h2> 
  <p id="polarion_74"> Folgendes Kapitel verdeutlicht beispielhaft den Aufbau der einzelnen Objekte und Aufrufe, welche im Rahmen der Beantragung von <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN </span>und <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN </span>beim IDP-Dienst generiert und ausgetauscht werden. </p> 
  <p id="polarion_117"> Die einzelnen Aufrufe werden den Schritten aus Kapitel "3.3 Verfahrensbeschreibung"<span id="polarion-comment:1635"></span> zugewiesen und in entsprechenden Unterkapiteln dargestellt. </p> 
  <p id="polarion_118">Diese Beispiele ersetzen die vorher an verschiedenen Stellen des Dokumentes verteilten Darstellungen.</p> 
  <p id="polarion_128">Die gematik wird weitere Beispielsätze auf ihrer Webseite in jeweils aktueller Form bereitstellen.</p> 
  <p id="polarion_134"></p> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-119738">7.1 Authorization Request</h3> 
  <p id="polarion_152"> 2. <span id="polarion-comment:1636"></span>Das Anwendungsfrontend überträgt die <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CODE_CHALLENGE</span> gemäß [RFC8252 # Anhang B] an das Authenticator-Modul. </p> 
  <p id="polarion_155"> 3. Das Authenticator-Modul überträgt die&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CODE_CHALLENGE</span> mit der genutzten "code_challenge_method" S256 weiter an den Authorization-Endpunkt des IDP-Dienstes. </p> 
  <p id="polarion_157"> <span style="font-weight: bold;">/sign_response?</span> </p> 
  <p id="polarion_224"> <span style="font-weight: bold;">scope=openid+e-rezept</span> </p> 
  <p id="polarion_245"> Der Scope entspricht dem zwischen E-Rezept-Fachdienst und IDP festgelegten Wert. Mit diesem antwortet der E-Rezept-Fachdienst bei fehlendem <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span> und http-Statuscode 401. </p> 
  <p id="polarion_249"> <span style="font-weight: bold;">&amp;response_type=code</span> </p> 
  <p id="polarion_253">Referenziert den erwarteten Response-Type des Flows. Muss immer 'code' lauten. Damit wird angezeigt, dass es sich hierbei um einen Authorization Code Flow handelt. Für eine nähere Erläuterung siehe OpenID-Spezifikation.</p> 
  <p id="polarion_257"> <span style="font-weight: bold;">&amp;redirect_uri=http%3A%2F%2Fredirect.gematik.de%2Ferezept</span> </p> 
  <p id="polarion_259">Die URL wird vom Primärsystem beim Registrierungsprozess im IDP hinterlegt und leitet die Antwort des Servers an diese Adresse um.</p> 
  <p id="polarion_261"> <span style="font-weight: bold;">&amp;state=AcYxMQ5MZMpRh6WOBjs8</span> </p> 
  <p id="polarion_265">Dieser Parameter wird vom Client zufällig generiert, um CSRF zu verhindern. Indem der Server mit diesem Wert antwortet, werden Redirects legitimiert.</p> 
  <p id="polarion_269"> <span style="font-weight: bold;">&amp;code_challenge_method=S256</span> </p> 
  <p id="polarion_271">Das Primärsystem generiert einen Code-Verifier und erzeugt darüber einen Hash im Verfahren SHA-256, hier abgekürzt als S256. Teil von PKCE.</p> 
  <p id="polarion_273"> <span style="font-weight: bold;">&amp;nonce=nN4LkW1moAwg1tofYZtf</span> </p> 
  <p id="polarion_275"> String zur Verhinderung von CSRF-Attacken. Dieser Wert ist optional. Wenn er mitgegeben wird, muss der gleiche Wert im abschließend ausgegebenen <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ID_TOKEN</span> wiederauftauchen. </p> 
  <p id="polarion_277"> <span style="font-weight: bold;">&amp;client_id=eRezeptApp</span> </p> 
  <p id="polarion_279">Die Client-ID des Primärsystems wird beim Registrieren des Primärsystems beim IDP festgelegt.</p> 
  <p id="polarion_281"> <span style="font-weight: bold;">&amp;code_challenge=SU8xsVcUypYGUi2g-mzs7rvR2lMtQ9vyj_9Hxs0WcII</span> </p> 
  <p id="polarion_283">Der Hashwert des Code-Verifier wird zum IDP als Code-Challenge gesendet. Teil von PKCE.</p> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-119740">7.2 Authorization Response</h3> 
  <p id="polarion_288"> 7. Der Authorization-Endpunkt überträgt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE</span> und Consent-Abfrage <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">USER_CONSENT</span> zum Authenticator-Modul. </p> 
  <p id="polarion_289"></p> 
  <p id="polarion_290">200</p> 
  <p id="polarion_291">Cache-Control=no-store,</p> 
  <p id="polarion_292">Pragma=no-cache,</p> 
  <p id="polarion_293">Version=0.1-SNAPSHOT,</p> 
  <p id="polarion_294">Content-Type=application/json,</p> 
  <p id="polarion_295">Transfer-Encoding=chunked,</p> 
  <p id="polarion_296">Date=&lt;Zeitpunkt der Antwort. Beispiel Fri, 05 Feb 2021 12:46:20 GMT&gt;</p> 
  <p id="polarion_297">Keep-Alive=timeout=60,</p> 
  <p id="polarion_298">Connection=keep-alive</p> 
  <p id="polarion_299"></p> 
  <p id="polarion_300"> <span style="font-weight: bold;">Response-Body:</span> </p> 
  <p id="polarion_301">{</p> 
  <p id="polarion_302">&nbsp; &nbsp;"challenge": "eyJhbGciOiJC...",</p> 
  <p id="polarion_303">&nbsp; &nbsp;"user_consent": {</p> 
  <p id="polarion_304">&nbsp; &nbsp; &nbsp;"requested_scopes": {</p> 
  <p id="polarion_305">&nbsp; &nbsp; &nbsp; &nbsp;"e-rezept": "Zugriff auf die E-Rezept-Funktionalität.",</p> 
  <p id="polarion_306">&nbsp; &nbsp; &nbsp; &nbsp;"openid": "Zugriff auf den ID_TOKEN."</p> 
  <p id="polarion_307">&nbsp; &nbsp; &nbsp;},</p> 
  <p id="polarion_308">&nbsp; &nbsp; &nbsp;"requested_claims": {</p> 
  <p id="polarion_309">&nbsp; &nbsp; &nbsp; &nbsp;"organizationName": "Zustimmung zur Verarbeitung der Organisationszugehörigkeit",</p> 
  <p id="polarion_310">&nbsp; &nbsp; &nbsp; &nbsp;"professionOID": "Zustimmung zur Verarbeitung der Rolle",</p> 
  <p id="polarion_311">&nbsp; &nbsp; &nbsp; &nbsp;"idNummer": "Zustimmung zur Verarbeitung der ID (z.B. Krankenversichertennummer, Telematik-ID)",</p> 
  <p id="polarion_312">&nbsp; &nbsp; &nbsp; &nbsp;"given_name": "Zustimmung zur Verarbeitung des Vornamens",</p> 
  <p id="polarion_313">&nbsp; &nbsp; &nbsp; &nbsp;"family_name": "Zustimmung zur Verarbeitung des Nachnamens"</p> 
  <p id="polarion_314">&nbsp; &nbsp; &nbsp;}</p> 
  <p id="polarion_315">&nbsp; &nbsp;}</p> 
  <p id="polarion_316">}</p> 
  <p id="polarion_317"></p> 
  <p id="polarion_318"> <span style="font-weight: bold;">CHALLENGE_TOKEN:</span> </p> 
  <p id="polarion_319">{</p> 
  <p id="polarion_320">&nbsp; &nbsp;"alg": "BP256R1",</p> 
  <p id="polarion_321">&nbsp; &nbsp;"typ": "JWT",</p> 
  <p id="polarion_322">&nbsp; &nbsp;"kid": "puk_idp_sig"</p> 
  <p id="polarion_323">}</p> 
  <p id="polarion_324">{</p> 
  <p id="polarion_325">&nbsp; &nbsp;"iss": "http://url.des.idp",</p> 
  <p id="polarion_326">&nbsp; &nbsp;"response_type": "code",</p> 
  <p id="polarion_327">&nbsp; &nbsp;"snc": "[server-nonce. Wird verwendet, um noise hinzuzufügen. Beispiel: \"yvqCVQO09TFsFfaJ312RfYoi1oII0BHtIDIRpzD8Gu0\"]",</p> 
  <p id="polarion_328">&nbsp; &nbsp;"code_challenge_method": "S256",</p> 
  <p id="polarion_329">&nbsp; &nbsp;"token_type": "challenge",</p> 
  <p id="polarion_330">&nbsp; &nbsp;"nonce": "nN4LkW1moAwg1tofYZtf",</p> 
  <p id="polarion_331">&nbsp; &nbsp;"client_id": "eRezeptApp",</p> 
  <p id="polarion_332">&nbsp; &nbsp;"scope": "openid e-rezept",</p> 
  <p id="polarion_333">&nbsp; &nbsp;"state": "AcYxMQ5MZMpRh6WOBjs8",</p> 
  <p id="polarion_334">&nbsp; &nbsp;"redirect_uri": "http://redirect.gematik.de/erezept",</p> 
  <p id="polarion_335">&nbsp; &nbsp;"exp": "[Gültigkeit des Token. Beispiel: 1618244172]",</p> 
  <p id="polarion_336">&nbsp; &nbsp;"iat": "[Zeitpunkt der Ausstellung des Token. Beispiel: 1618243992]",</p> 
  <p id="polarion_337">&nbsp; &nbsp;"code_challenge": "SU8xsVcUypYGUi2g-mzs7rvR2lMtQ9vyj_9Hxs0WcII",</p> 
  <p id="polarion_338">&nbsp; &nbsp;"jti": "[A unique identifier for the token, which can be used to prevent reuse of the token. Value is a case-sensitive string. Beispiel: \"07925bdc7c5d9990\"]"</p> 
  <p id="polarion_339">}</p> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-119924">7.3 Authentication Request</h3> 
  <p id="polarion_341"> 10. Das Authenticator-Modul überträgt <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE</span> mit dem Smartcard-Zertifikat an den IDP-Dienst (Antwort Schritt 7). </p> 
  <p id="polarion_342">https://&lt;FQDN Server&gt;/&lt;AUTHORIZATION_ENDPOINT&gt;</p> 
  <p id="polarion_343">Multiparts:</p> 
  <p id="polarion_344">signed_challenge=&lt;signierter und anschließend verschlüsselter Challenge Token&gt;</p> 
  <p id="polarion_345"></p> 
  <p id="polarion_346"> <span style="font-weight: bold;">Challenge Response (Encryption Header):</span> </p> 
  <p id="polarion_347">{</p> 
  <p id="polarion_348">&nbsp; &nbsp;"alg": "ECDH-ES",</p> 
  <p id="polarion_349">&nbsp; &nbsp;"enc": "A256GCM",</p> 
  <p id="polarion_350">&nbsp; &nbsp;"exp": "[Gültigkeit des Token. Beispiel: 1618244172]",</p> 
  <p id="polarion_351">&nbsp; &nbsp;"cty": "NJWT",</p> 
  <p id="polarion_352">&nbsp; &nbsp;"epk": {</p> 
  <p id="polarion_353">&nbsp; &nbsp; &nbsp;"kty": "EC",</p> 
  <p id="polarion_354">&nbsp; &nbsp; &nbsp;"x": "LgkJSQwrz1bCoFjSLhay9O7TLaQImYW7jeOF6XmpQX4",</p> 
  <p id="polarion_355">&nbsp; &nbsp; &nbsp;"y": "dTC6ri-f1QqpJp7M4LLg0lw4FzrzNc29nrrzjPwEWWc",</p> 
  <p id="polarion_356">&nbsp; &nbsp; &nbsp;"crv": "BP-256"</p> 
  <p id="polarion_357">&nbsp; &nbsp;}</p> 
  <p id="polarion_358">}</p> 
  <p id="polarion_360">{</p> 
  <p id="polarion_361">&nbsp; &nbsp;"njwt": "[Ein verschachtelt enthaltenes JWT] - Die verschlüsselte Challenge Response."</p> 
  <p id="polarion_362">}&nbsp;</p> 
  <p id="polarion_363"></p> 
  <p id="polarion_364"> <span style="font-weight: bold;">Challenge Response (Decrypted):</span> </p> 
  <p id="polarion_365">{</p> 
  <p id="polarion_366">&nbsp; &nbsp;"typ": "JWT",</p> 
  <p id="polarion_367">&nbsp; &nbsp;"cty": "NJWT",</p> 
  <p id="polarion_368">&nbsp; &nbsp;"alg": "BP256R1",</p> 
  <p id="polarion_369">&nbsp; &nbsp;"x5c": [</p> 
  <p id="polarion_370">&nbsp; &nbsp; &nbsp;"[Enthält das verwendete Signer-Zertifikat als Base64 ASN.1 DER-Encoding. Hier kommt ausnahmsweise NICHT URL-safes Base64-Encoding zum Einsatz!]"</p> 
  <p id="polarion_371">&nbsp; &nbsp;]</p> 
  <p id="polarion_372">}</p> 
  <p id="polarion_373">{</p> 
  <p id="polarion_374">&nbsp; &nbsp;"njwt": "[Ein verschachtelt enthaltenes JWT] - Dieses Token ist die vom Server in der vorigen Nachricht übergebene Challenge. Sie muss exakt wie empfangen auch wieder übertragen werden. "</p> 
  <p id="polarion_375">}</p> 
  <p id="polarion_376"></p> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-119928">7.3.1 Authentication Request (SSO)</h4> 
  <p id="polarion_340"> 10. Falls ein <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> beim Authenticator-Modul existiert, wird dieser Token zusammen mit einem unveränderten <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CHALLENGE_TOKEN</span> zum IDP-Dienst transportiert. </p> 
  <p id="polarion_377">https://&lt;FQDN Server&gt;/&lt;SSO_ENDPOINT&gt;&nbsp;</p> 
  <p id="polarion_378">Multiparts:</p> 
  <p id="polarion_379">sso_token=&lt;SSO-Token des IDP&gt;</p> 
  <p id="polarion_380">unsigned_challenge = &lt; unveränderter Challenge_Token&gt;</p> 
  <p id="polarion_381"></p> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-119926">7.4 Authentication Response</h3> 
  <p id="polarion_382"> 14. Der Authorization-Endpunkt überträgt den&nbsp;<span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> und den <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> an das Authenticator-Modul (Antwort Schritt 3). </p> 
  <p id="polarion_383">302</p> 
  <p id="polarion_384">Cache-Control=no-store,</p> 
  <p id="polarion_385">Pragma=no-cache,</p> 
  <p id="polarion_386">Location=http://redirect.gematik.de/erezept?</p> 
  <p id="polarion_387"> code=&lt;Authorization Code in Base64-URL-Safe Encoding. Wird unten detaillierter aufgeführt&gt; Der Authorization-Code. Er berechtigt zur Abholung eines <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">ACCESS_TOKEN</span>. Er ist vom IDP für den IDP verschlüsselt und dementsprechend vom Client nicht weiter zu verarbeiten. </p> 
  <p id="polarion_388">&amp;state=AcYxMQ5MZMpRh6WOBjs8 Der state der Session. Sollte dem zufällig generierten state-Wert aus der initialen Anfrage entsprechen.</p> 
  <p id="polarion_389">&amp;ssotoken=&lt;SSO-Token in Base64-URL-Safe Encoding. Wird unten detaillierter aufgeführt&gt; Der SSO-Token. Mit diesem kann der Client sich wiederholt einloggen, ohne erneut den Besitz der Karte durch Unterschreiben einer Challenge beweisen zu müssen. Er ist vom IDP für den IDP verschlüsselt und dementsprechend vom Client nicht weiter zu verarbeiten. - Nicht im Fall der Anmeldung über ein Primärsystem.&nbsp; &nbsp;</p> 
  <p id="polarion_390">Content-Length=0,</p> 
  <p id="polarion_391">Date=&lt;Zeitpunkt der Antwort. Beispiel Fri, 05 Feb 2021 12:46:20 GMT&gt;</p> 
  <p id="polarion_393">Keep-Alive=timeout=60, Connection=keep-alive&nbsp;</p> 
  <p id="polarion_394"></p> 
  <p id="polarion_395"> <span style="font-weight: bold;">Response-Body:</span> </p> 
  <p id="polarion_396"> Die Inhalte von Authorization Code und <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span>&nbsp;sind IDP-spezifisch und nicht normativ vorgegeben. Sie dienen hier nur dem Verständnis.&nbsp; &nbsp; </p> 
  <p id="polarion_397"></p> 
  <p id="polarion_398"> <span style="font-weight: bold;">Authorization Code (Encryption Header):</span> </p> 
  <p id="polarion_399">{&nbsp; &nbsp;"alg": "dir",</p> 
  <p id="polarion_400">&nbsp; &nbsp;"enc": "A256GCM",</p> 
  <p id="polarion_401">&nbsp; &nbsp;"exp": "[Gültigkeit des Token. Beispiel: 1618244053]",</p> 
  <p id="polarion_402">&nbsp; &nbsp;"cty": "NJWT"</p> 
  <p id="polarion_403">}</p> 
  <p id="polarion_404">{</p> 
  <p id="polarion_405">&nbsp; &nbsp;"njwt": "[Ein verschachtelt enthaltenes JWT] - Der Authorization Code"</p> 
  <p id="polarion_406">}&nbsp; &nbsp;</p> 
  <p id="polarion_407"></p> 
  <p id="polarion_409"> <span style="font-weight: bold;">Authorization Code (Decrypted):</span> </p> 
  <p id="polarion_410">{</p> 
  <p id="polarion_411">&nbsp; &nbsp;"alg": "BP256R1",</p> 
  <p id="polarion_412">&nbsp; &nbsp;"typ": "JWT",</p> 
  <p id="polarion_413">&nbsp; &nbsp;"kid": "puk_idp_sig"</p> 
  <p id="polarion_414">}</p> 
  <p id="polarion_415">{</p> 
  <p id="polarion_416">&nbsp; &nbsp;"organizationName": "AOK Plus",</p> 
  <p id="polarion_417">&nbsp; &nbsp;"professionOID": "1.2.276.0.76.4.49",</p> 
  <p id="polarion_418">&nbsp; &nbsp;"idNummer": "X114428530",</p> 
  <p id="polarion_420">&nbsp; &nbsp;"iss": "http://url.des.idp",</p> 
  <p id="polarion_422">&nbsp; &nbsp;"response_type": "code",</p> 
  <p id="polarion_423">&nbsp; &nbsp;"snc": "[server-nonce. Wird verwendet, um noise hinzuzufügen. Beispiel: \"Ay6WUqtAUcV2p9WZYHPo\"]",</p> 
  <p id="polarion_424">&nbsp; &nbsp;"code_challenge_method": "S256",</p> 
  <p id="polarion_425">&nbsp; &nbsp;"given_name": "Juna",</p> 
  <p id="polarion_426">&nbsp; &nbsp;"token_type": "code",</p> 
  <p id="polarion_427">&nbsp; &nbsp;"nonce": "nN4LkW1moAwg1tofYZtf",</p> 
  <p id="polarion_428">&nbsp; &nbsp;"client_id": "eRezeptApp",</p> 
  <p id="polarion_429">&nbsp; &nbsp;"scope": "openid e-rezept",</p> 
  <p id="polarion_430">&nbsp; &nbsp;"auth_time": "[Timestamp der Authentisierung. Beispiel: 1618243993]",</p> 
  <p id="polarion_431">&nbsp; &nbsp;"redirect_uri": "http://redirect.gematik.de/erezept",</p> 
  <p id="polarion_432">&nbsp; &nbsp;"state": "AcYxMQ5MZMpRh6WOBjs8",</p> 
  <p id="polarion_433">&nbsp; &nbsp;"exp": "[Gültigkeit des Token. Beispiel: 1618244053]",</p> 
  <p id="polarion_434">&nbsp; &nbsp;"family_name": "Fuchs",</p> 
  <p id="polarion_435">&nbsp; &nbsp;"iat": "[Zeitpunkt der Ausstellung des Token. Beispiel: 1618243993]",</p> 
  <p id="polarion_436">&nbsp; &nbsp;"code_challenge": "SU8xsVcUypYGUi2g-mzs7rvR2lMtQ9vyj_9Hxs0WcII",</p> 
  <p id="polarion_437">&nbsp; &nbsp;"jti": "[A unique identifier for the token, which can be used to prevent reuse of the token. Value is a case-sensitive string. Beispiel: \"6e8a61e316472f3b\"]"</p> 
  <p id="polarion_438">}&nbsp; &nbsp; &nbsp;</p> 
  <p id="polarion_439"></p> 
  <p id="polarion_440"> <span style="font-weight: bold;">SSO Token (Encryption Header):</span> </p> 
  <p id="polarion_441">{</p> 
  <p id="polarion_442">&nbsp; &nbsp;"alg": "dir",</p> 
  <p id="polarion_443">&nbsp; &nbsp;"enc": "A256GCM",</p> 
  <p id="polarion_444">&nbsp; &nbsp;"exp": "[Gültigkeit des Token. Beispiel: 1618287193]",</p> 
  <p id="polarion_445">&nbsp; &nbsp;"cty": "NJWT"</p> 
  <p id="polarion_446">}</p> 
  <p id="polarion_447">{</p> 
  <p id="polarion_448">&nbsp; &nbsp;"njwt": "[Ein verschachtelt enthaltenes JWT] - Das SSO Token"</p> 
  <p id="polarion_449">}&nbsp; &nbsp;</p> 
  <p id="polarion_450"></p> 
  <p id="polarion_451"> <span style="font-weight: bold;">SSO Token (Decrypted):</span> </p> 
  <p id="polarion_452">{</p> 
  <p id="polarion_453">&nbsp; &nbsp;"alg": "BP256R1",</p> 
  <p id="polarion_454">&nbsp; &nbsp;"typ": "JWT",</p> 
  <p id="polarion_455">&nbsp; &nbsp;"kid": "puk_idp_sig"</p> 
  <p id="polarion_456">}</p> 
  <p id="polarion_457">{</p> 
  <p id="polarion_458">&nbsp; &nbsp;"organizationName": "AOK Plus",</p> 
  <p id="polarion_459">&nbsp; &nbsp;"professionOID": "1.2.276.0.76.4.49",</p> 
  <p id="polarion_460">&nbsp; &nbsp;"auth_time": "[Timestamp der Authentisierung. Beispiel: 1618243993]",</p> 
  <p id="polarion_461">&nbsp; &nbsp;"idNummer": "X114428530",</p> 
  <p id="polarion_462">&nbsp; &nbsp;"iss": "http://url.des.idp",</p> 
  <p id="polarion_463">&nbsp; &nbsp;"cnf": {</p> 
  <p id="polarion_464">&nbsp; &nbsp; &nbsp;"x5c": [</p> 
  <p id="polarion_465">&nbsp; &nbsp; &nbsp; &nbsp;"[Enthält das verwendete Signer-Zertifikat als Base64 ASN.1 DER-Encoding. Hier kommt ausnahmsweise NICHT URL-safes Base64-Encoding zum Einsatz!]"</p> 
  <p id="polarion_466">&nbsp; &nbsp; &nbsp;],</p> 
  <p id="polarion_467">&nbsp; &nbsp; &nbsp;"kid": "844508318621525",</p> 
  <p id="polarion_468">&nbsp; &nbsp; &nbsp;"kty": "EC",</p> 
  <p id="polarion_469">&nbsp; &nbsp; &nbsp;"crv": "BP-256",</p> 
  <p id="polarion_470">&nbsp; &nbsp; &nbsp;"x": "dTXa6yPKCjIr9MbVFxeaLEu82xSCsRrfwcIrLpFqBCs",</p> 
  <p id="polarion_471">&nbsp; &nbsp; &nbsp;"y": "AJGsJ1cCyGEpCH0ss8JvD4OAHJS8IMm1_rM59jliS-1O"&nbsp; &nbsp;},</p> 
  <p id="polarion_472">&nbsp; &nbsp;"given_name": "Juna",</p> 
  <p id="polarion_473">&nbsp; &nbsp;"exp": "[Gültigkeit des Token. Beispiel: 1618287193]",</p> 
  <p id="polarion_474">&nbsp; &nbsp;"iat": "[Zeitpunkt der Ausstellung des Token. Beispiel: 1618243993]",</p> 
  <p id="polarion_475">&nbsp; &nbsp;"family_name": "Fuchs"</p> 
  <p id="polarion_476">}</p> 
  <p id="polarion_477"></p> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-119927">7.4.1 Authentication Response (SSO Flow)</h4> 
  <p id="polarion_478"> Falls das Authenticator-Modul ein vorhandenes <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> an den Authorization-Endpunkt zur Erlangung eines <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> geschickt hat, wird kein neues <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">SSO_TOKEN</span> vom Authorization -Endpunkt erstellt und verschickt. </p> 
  <p id="polarion_479">302</p> 
  <p id="polarion_480">Cache-Control=no-store,</p> 
  <p id="polarion_481">Pragma=no-cache,</p> 
  <p id="polarion_482">Location=https://&lt;FQDN Server&gt;/&lt;TOKEN_ENDPOINT&gt;</p> 
  <p id="polarion_483">&nbsp; &nbsp; &nbsp;?code=&lt;Authorization Code des IDP&gt;</p> 
  <p id="polarion_484">&nbsp; &nbsp; &nbsp;&amp;state=&lt;OAuth 2.0 state value. Constant over complete flow. Value is a case-sensitive string. Beispiel: 'mlE7xX1ysbZQ4Of5YiZ8'&gt;,</p> 
  <p id="polarion_485">Content-Length=0,</p> 
  <p id="polarion_486">Date=&lt;Zeitpunkt der Antwort. Beispiel Fri, 05 Feb 2021 12:46:20 GMT&gt;</p> 
  <p id="polarion_487">Keep-Alive=timeout=60,</p> 
  <p id="polarion_488">Connection=keep-alive</p> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-119931">7.5 Token Request</h3> 
  <p id="polarion_491"> 16. Das Anwendungsfrontend sendet <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">CODE_VERFIER</span> und <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">AUTHORIZATION_CODE</span> zum Token-Endpunkt des IDP-Dienstes. </p> 
  <p id="polarion_492">https://&lt;FQDN Server&gt;/&lt;TOKEN_ENDPOINT&gt;</p> 
  <p id="polarion_493">Multiparts:</p> 
  <p id="polarion_494">client_id=eRezeptApp</p> 
  <p id="polarion_495">&amp;code=&lt;Authorization Code des IDP&gt;</p> 
  <p id="polarion_496">&amp;grant_type=authorization_code</p> 
  <p id="polarion_497">&amp;key_verifier=&lt;verschlüsselter KEY_VERIFIER&gt;</p> 
  <p id="polarion_498">&amp;redirect_uri=http%3A%2F%2Fredirect.gematik.de%2Ferezept</p> 
  <p id="polarion_499"></p> 
  <p id="polarion_500"> <span style="font-weight: bold;">Key_verifier (Encryption Header):</span> </p> 
  <p id="polarion_501">{</p> 
  <p id="polarion_502">&nbsp; &nbsp;"alg": "ECDH-ES",</p> 
  <p id="polarion_503">&nbsp; &nbsp;"enc": "A256GCM",</p> 
  <p id="polarion_504">&nbsp; &nbsp;"cty": "JSON",</p> 
  <p id="polarion_505">&nbsp; &nbsp;"epk": {</p> 
  <p id="polarion_506">&nbsp; &nbsp; &nbsp;"kty": "EC",</p> 
  <p id="polarion_507">&nbsp; &nbsp; &nbsp;"x": "jqrGQlZqCGQgK7OtJj0gfWPWSbStracf_PreBrA05Lc",</p> 
  <p id="polarion_508">&nbsp; &nbsp; &nbsp;"y": "V4bbOGUgr-AV6NFLnPJNYkyPLcR_1QkGlR6w4bK1wdI",</p> 
  <p id="polarion_509">&nbsp; &nbsp; &nbsp;"crv": "BP-256"&nbsp; &nbsp;} }&nbsp;</p> 
  <p id="polarion_510"></p> 
  <p id="polarion_511"> <span style="font-weight: bold;">Key_verifier (Body)</span> </p> 
  <p id="polarion_512">&nbsp; {</p> 
  <p id="polarion_513">&nbsp; &nbsp;"token_key": "T0hHOHNKOTFaREcxTmN0dVRKSURraTZxNEpheGxaUEs",</p> 
  <p id="polarion_514">&nbsp; &nbsp;"code_verifier": "W91A37hQ8oeDRVpnkYgpYthjl4LqYy95A87ISy9zpUM"</p> 
  <p id="polarion_515">}</p> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-119929">7.6 Token Response</h3> 
  <p id="polarion_517">20. Der Token-Endpunkt überträgt die Token an das Anwendungsfrontend (Antwort Schritt 16).</p> 
  <p id="polarion_518">200</p> 
  <p id="polarion_519">Cache-Control=no-store,</p> 
  <p id="polarion_520">Pragma=no-cache,</p> 
  <p id="polarion_521">Version=0.1-SNAPSHOT,</p> 
  <p id="polarion_522">Content-Type=application/json,</p> 
  <p id="polarion_523">Transfer-Encoding=chunked,</p> 
  <p id="polarion_524">Date=&lt;Zeitpunkt der Antwort. Beispiel Fri, 05 Feb 2021 12:46:20 GMT&gt;</p> 
  <p id="polarion_525">Keep-Alive=timeout=60,</p> 
  <p id="polarion_526">Connection=keep-alive</p> 
  <p id="polarion_527"></p> 
  <p id="polarion_528"> <span style="font-weight: bold;">Response-Body:</span> </p> 
  <p id="polarion_529">{</p> 
  <p id="polarion_530">&nbsp; &nbsp;"expires_in": 300,</p> 
  <p id="polarion_531">&nbsp; &nbsp;"token_type": "Bearer",</p> 
  <p id="polarion_532">&nbsp; &nbsp;"id_token": &lt;Mit dem Token_Key verschlüsseltes ID_TOKEN.&gt;</p> 
  <p id="polarion_533">&nbsp; "access_token": &lt;Mit dem Token_Key verschlüsseltes ACCESS_TOKEN.&gt;}</p> 
  <p id="polarion_534"></p> 
  <p id="polarion_535"> <span style="font-weight: bold;">Access Token (Encryption Header):</span> </p> 
  <p id="polarion_536">{&nbsp; &nbsp;"alg": "dir",</p> 
  <p id="polarion_537">&nbsp; &nbsp;"enc": "A256GCM",</p> 
  <p id="polarion_538">&nbsp; &nbsp;"exp": "[Gültigkeit des Token. Beispiel: 1618244294]",</p> 
  <p id="polarion_539">&nbsp; &nbsp;"cty": "NJWT"</p> 
  <p id="polarion_540">}</p> 
  <p id="polarion_541">{</p> 
  <p id="polarion_543">&nbsp; &nbsp;"njwt": "[Ein verschachtelt enthaltenes JWT] - Das ACCESS_TOKEN"</p> 
  <p id="polarion_544">}&nbsp;</p> 
  <p id="polarion_545"></p> 
  <p id="polarion_546"> <span style="font-weight: bold;">Access Token (Decrypted):</span> </p> 
  <p id="polarion_547">{</p> 
  <p id="polarion_548">&nbsp; &nbsp;"alg": "BP256R1",</p> 
  <p id="polarion_549">&nbsp; &nbsp;"typ": "at+JWT",</p> 
  <p id="polarion_550">&nbsp; &nbsp;"kid": "puk_idp_sig"</p> 
  <p id="polarion_551">}</p> 
  <p id="polarion_552">{</p> 
  <p id="polarion_553">&nbsp; &nbsp;"sub": "[subject. Base64(sha256(audClaim + idNummerClaim + serverSubjectSalt)). Beispiel: \"ez4D403gBzH1IhnYOXA4aUU-7spqPbWUyUELPoA79CM\"]",</p> 
  <p id="polarion_554">&nbsp; &nbsp;"professionOID": "1.2.276.0.76.4.49",</p> 
  <p id="polarion_555">&nbsp; &nbsp;"organizationName": "AOK Plus",</p> 
  <p id="polarion_556">&nbsp; &nbsp;"idNummer": "X114428530",</p> 
  <p id="polarion_557">&nbsp; &nbsp;"amr": [</p> 
  <p id="polarion_558">&nbsp; &nbsp; &nbsp;"mfa",</p> 
  <p id="polarion_559">&nbsp; &nbsp; &nbsp;"sc",</p> 
  <p id="polarion_560">&nbsp; &nbsp; &nbsp;"pin"&nbsp; &nbsp;],</p> 
  <p id="polarion_561">&nbsp; &nbsp;"iss": "http://url.des.idp",</p> 
  <p id="polarion_562">&nbsp; &nbsp;"given_name": "Juna",</p> 
  <p id="polarion_563">&nbsp; &nbsp;"client_id": "eRezeptApp",</p> 
  <p id="polarion_564">&nbsp; &nbsp;"acr": "gematik-ehealth-loa-high",</p> 
  <p id="polarion_565">&nbsp; &nbsp;"aud": "https://erp-test.zentral.erp.splitdns.ti-dienste.de/",</p> 
  <p id="polarion_566">&nbsp; &nbsp;"azp": "eRezeptApp",</p> 
  <p id="polarion_567">&nbsp; &nbsp;"scope": "openid e-rezept",</p> 
  <p id="polarion_568">&nbsp; &nbsp;"auth_time": "[Timestamp der Authentisierung. Beispiel: 1618243993]",</p> 
  <p id="polarion_569">&nbsp; &nbsp;"exp": "[Gültigkeit des Token. Beispiel: 1618244294]",</p> 
  <p id="polarion_570">&nbsp; &nbsp;"family_name": "Fuchs",</p> 
  <p id="polarion_571">&nbsp; &nbsp;"iat": "[Zeitpunkt der Ausstellung des Token. Beispiel: 1618243994]",</p> 
  <p id="polarion_572">&nbsp; &nbsp;"jti": "[A unique identifier for the token, which can be used to prevent reuse of the token. Value is a case-sensitive string. Beispiel: \"c0bf3cebe428e3c9\"]"</p> 
  <p id="polarion_573">}</p> 
  <p id="polarion_574"></p> 
  <p id="polarion_575"> <span style="font-weight: bold;">ID Token (Encryption Header):</span> </p> 
  <p id="polarion_576">{</p> 
  <p id="polarion_577">&nbsp; &nbsp;"alg": "dir",</p> 
  <p id="polarion_578">&nbsp; &nbsp;"enc": "A256GCM",</p> 
  <p id="polarion_579">&nbsp; &nbsp;"exp": "[Gültigkeit des Token. Beispiel: 1618244294]",</p> 
  <p id="polarion_580">&nbsp; &nbsp;"cty": "NJWT"</p> 
  <p id="polarion_581">}</p> 
  <p id="polarion_582">{</p> 
  <p id="polarion_583">&nbsp; &nbsp;"njwt": "[Ein verschachtelt enthaltenes JWT] - Das ID Token"</p> 
  <p id="polarion_584">}</p> 
  <p id="polarion_585"></p> 
  <p id="polarion_586"> <span style="font-weight: bold;">ID Token (Decrypted):</span> </p> 
  <p id="polarion_588">{</p> 
  <p id="polarion_589">&nbsp; &nbsp;"alg": "BP256R1",</p> 
  <p id="polarion_590">&nbsp; &nbsp;"typ": "JWT",</p> 
  <p id="polarion_591">&nbsp; &nbsp;"kid": "puk_idp_sig"</p> 
  <p id="polarion_592">}</p> 
  <p id="polarion_593">{</p> 
  <p id="polarion_594">&nbsp; &nbsp;"at_hash": "[Erste 16 Bytes des Hash des Authentication Token Base64(subarray(Sha256(authentication_token), 0, 16)). Beispiel: \"5AZmDxrYImUa6-kjMNAL3g\"]",</p> 
  <p id="polarion_595">&nbsp; &nbsp;"sub": "[subject. Base64(sha256(audClaim + idNummerClaim + serverSubjectSalt)). Beispiel: \"ez4D403gBzH1IhnYOXA4aUU-7spqPbWUyUELPoA79CM\"]",</p> 
  <p id="polarion_596">&nbsp; &nbsp;"organizationName": "AOK Plus",</p> 
  <p id="polarion_597">&nbsp; &nbsp;"professionOID": "1.2.276.0.76.4.49",</p> 
  <p id="polarion_598">&nbsp; &nbsp;"idNummer": "X114428530",</p> 
  <p id="polarion_599">&nbsp; &nbsp;"amr": [</p> 
  <p id="polarion_600">&nbsp; &nbsp; &nbsp;"mfa",</p> 
  <p id="polarion_601">&nbsp; &nbsp; &nbsp;"sc",</p> 
  <p id="polarion_602">&nbsp; &nbsp; &nbsp;"pin"&nbsp; &nbsp;],</p> 
  <p id="polarion_603">&nbsp; &nbsp;"iss": "http://url.des.idp",</p> 
  <p id="polarion_604">&nbsp; &nbsp;"given_name": "Juna",</p> 
  <p id="polarion_605">&nbsp; &nbsp;"nonce": "nN4LkW1moAwg1tofYZtf",</p> 
  <p id="polarion_606">&nbsp; &nbsp;"aud": "eRezeptApp",</p> 
  <p id="polarion_607">&nbsp; &nbsp;"acr": "gematik-ehealth-loa-high",</p> 
  <p id="polarion_608">&nbsp; &nbsp;"azp": "eRezeptApp",</p> 
  <p id="polarion_609">&nbsp; &nbsp;"auth_time": "[Timestamp der Authentisierung. Beispiel: 1618243993]",</p> 
  <p id="polarion_610">&nbsp; &nbsp;"scope": "openid e-rezept",</p> 
  <p id="polarion_611">&nbsp; &nbsp;"exp": "[Gültigkeit des Token. Beispiel: 1618244294]",</p> 
  <p id="polarion_612">&nbsp; &nbsp;"iat": "[Zeitpunkt der Ausstellung des Token. Beispiel: 1618243994]",</p> 
  <p id="polarion_613">&nbsp; &nbsp;"family_name": "Fuchs",</p> 
  <p id="polarion_614">&nbsp; &nbsp;"jti": "[A unique identifier for the token, which can be used to prevent reuse of the token. Value is a case-sensitive string. Beispiel: \"c1c760ca67fe1306\"]"</p> 
  <p id="polarion_615">}</p> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-119930">7.7 Aufbau des Discovery Document</h3> 
  <p id="polarion_617">{</p> 
  <p id="polarion_618">&nbsp; &nbsp;"alg": "BP256R1",</p> 
  <p id="polarion_619">&nbsp; &nbsp;"kid": "puk_disc_sig",</p> 
  <p id="polarion_620">&nbsp; &nbsp;"x5c": [</p> 
  <p id="polarion_621">&nbsp; &nbsp; &nbsp;"[Enthält das verwendete Signer-Zertifikat als Base64 ASN.1 DER-Encoding. Hier kommt ausnahmsweise NICHT URL-safes Base64-Encoding zum Einsatz!]"</p> 
  <p id="polarion_622">&nbsp; &nbsp;]</p> 
  <p id="polarion_623">}</p> 
  <p id="polarion_624">{</p> 
  <p id="polarion_625">&nbsp; &nbsp;"authorization_endpoint": "[URL des Authorization Endpunkts.]",</p> 
  <p id="polarion_626">&nbsp; &nbsp;"auth_pair_endpoint": "[URL des Biometrie-Authorization-Endpunkts - dieser ist nur im Internet verfügbar]",</p> 
  <p id="polarion_627">&nbsp; &nbsp;"sso_endpoint": "[URL des SSO-Authorization Endpunkts.]",</p> 
  <p id="polarion_628">&nbsp; &nbsp;"uri_pair": "[URL des Pairing-Endpunkts.]",</p> 
  <p id="polarion_629">&nbsp; &nbsp;"token_endpoint": "[URL des Authorization-Endpunkts.]",</p> 
  <p id="polarion_630">&nbsp; &nbsp;"uri_disc": "[URL des Discovery Document.]",</p> 
  <p id="polarion_631">&nbsp; &nbsp;"issuer": "http://url.des.idp",</p> 
  <p id="polarion_632">&nbsp; &nbsp;"jwks_uri": "[URL einer JWKS-Struktur mit allen vom Server verwendeten Schlüsseln]",</p> 
  <p id="polarion_633">&nbsp; &nbsp;"exp": "[Gültigkeit des Token. Beispiel: 1618330390]",</p> 
  <p id="polarion_634">&nbsp; &nbsp;"iat": "[Zeitpunkt der Ausstellung des Token. Beispiel: 1618243990]",</p> 
  <p id="polarion_635">&nbsp; &nbsp;"uri_puk_idp_enc": "http://url.des.idp/idpEnc/jwk.json",</p> 
  <p id="polarion_636">&nbsp; &nbsp;"uri_puk_idp_sig": "http://url.des.idp/idpSig/jwk.json",</p> 
  <p id="polarion_637">&nbsp; &nbsp;"subject_types_supported": [</p> 
  <p id="polarion_638">&nbsp; &nbsp; &nbsp;"pairwise"</p> 
  <p id="polarion_639">&nbsp; &nbsp;],</p> 
  <p id="polarion_640">&nbsp; &nbsp;"id_token_signing_alg_values_supported": [</p> 
  <p id="polarion_641">&nbsp; &nbsp; &nbsp;"BP256R1"</p> 
  <p id="polarion_642">&nbsp; &nbsp;],</p> 
  <p id="polarion_643">&nbsp; &nbsp;"response_types_supported": [</p> 
  <p id="polarion_644">&nbsp; &nbsp; &nbsp;"code"</p> 
  <p id="polarion_645">&nbsp; &nbsp;],</p> 
  <p id="polarion_646">&nbsp; &nbsp;"scopes_supported": [</p> 
  <p id="polarion_647">&nbsp; &nbsp; &nbsp;"openid",</p> 
  <p id="polarion_648">&nbsp; &nbsp; &nbsp;"e-rezept"</p> 
  <p id="polarion_48">&nbsp;&nbsp; &nbsp; "pairing"</p> 
  <p id="polarion_649">&nbsp; &nbsp;],</p> 
  <p id="polarion_650">&nbsp; &nbsp;"response_modes_supported": [</p> 
  <p id="polarion_651">&nbsp; &nbsp; &nbsp;"query"</p> 
  <p id="polarion_652">&nbsp; &nbsp;],&nbsp;</p> 
  <p id="polarion_653">&nbsp;"grant_types_supported": [</p> 
  <p id="polarion_654">&nbsp; &nbsp; &nbsp;"authorization_code"</p> 
  <p id="polarion_655">&nbsp; &nbsp;],</p> 
  <p id="polarion_656">&nbsp; &nbsp;"acr_values_supported": [</p> 
  <p id="polarion_657">&nbsp; &nbsp; &nbsp;"gematik-ehealth-loa-high"</p> 
  <p id="polarion_658">&nbsp; &nbsp;],</p> 
  <p id="polarion_659">&nbsp; &nbsp;"token_endpoint_auth_methods_supported": [</p> 
  <p id="polarion_660">&nbsp; &nbsp; &nbsp;"none"</p> 
  <p id="polarion_661">&nbsp; &nbsp;],</p> 
  <p id="polarion_662">&nbsp; &nbsp;"code_challenge_methods_supported": [</p> 
  <p id="polarion_663">&nbsp; &nbsp; &nbsp;"S256"</p> 
  <p id="polarion_664">&nbsp; &nbsp;]</p> 
  <p id="polarion_665">}</p> 
  <h2 id="polarion_wiki macro name=module-workitem;params=id=ML-119190">8 Anhang C - Datenformate und Kommunikationsprotokolle im Zusammenhang mit alternativen Authentisierungsverfahren</h2> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-119213">8.1 Datentypen</h3> 
  <p id="polarion_56">Die Verwendung der hier genannten Datentypen und ihre Ausgestaltung sind verpflichtend. Gleiches gilt für die dargestellte Detaillierung der Kommunikationsprotokolle.&nbsp;</p> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-119225">8.1.1 Übergeordnete Anforderungen</h4> 
  <p id="polarion_174">Die folgenden Festlegungen gelten übergeordnet für alle verwendeten Datentypen.</p> 
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-119227">8.1.1.1 Kodierung</h5> 
  <p id="polarion_176" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">12</span>: Kodierung von Daten </p> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=177" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 71.8182px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Datentyp</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 247.273px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Kodierung</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 259.091px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Repräsentation in JSON</th> 
    </tr> 
    <tr> 
     <td style="width: 71.8182px;height: 33.6364px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">String</td> 
     <td style="width: 247.273px;height: 33.6364px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">UTF-8</td> 
     <td style="width: 259.091px;height: 33.6364px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String, vergleiche&nbsp;<a href="https://tools.ietf.org/html/rfc7159#section-7" target="_top" class="descriptionLink">[RFC7519], Abschnitt 7 "Strings"</a></td> 
    </tr> 
    <tr> 
     <td style="width: 71.8182px;height: 68.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Binärdaten</td> 
     <td style="width: 247.273px;height: 68.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">base64url, ohne Padding</td> 
     <td style="width: 259.091px;height: 68.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String, vergleiche&nbsp;<br> <a href="https://tools.ietf.org/html/rfc4648#section-5" target="_top" class="descriptionLink">[RFC4648], Abschnitt 5, "Base 64 Encoding with URL and Filename Safe Alphabet"</a>,<br> <a href="https://tools.ietf.org/html/rfc7515#appendix-C" target="_top" class="descriptionLink">[RFC7515], Anhang C, "Notes on Implementing base64url Encoding without Padding"</a></td> 
    </tr> 
    <tr> 
     <td style="width: 71.8182px;height: 50.9091px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Zeitangaben</td> 
     <td style="width: 247.273px;height: 50.9091px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">NumericDate, vergleiche&nbsp;<a href="https://tools.ietf.org/html/rfc7519#section-2" target="_top" class="descriptionLink">[RFC7519], Abschnitt 2 "Terminology"</a></td> 
     <td style="width: 259.091px;height: 50.9091px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/Number, vergleiche&nbsp;<a href="https://tools.ietf.org/html/rfc7159#section-6" target="_top" class="descriptionLink">[RFC7519], Abschnitt 6 "Numbers"</a> </td> 
    </tr> 
   </tbody> 
  </table> 
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-119221">8.1.1.2 Versionierung</h5> 
  <p id="polarion_178">Die in den folgenden Abschnitten genannten Datentypen enthalten eine Name-/Wert-Kombination zur Anzeige der Version der Datenobjekte. Diese ist "&lt;Name des Datenobjektes&gt;_version". Der Wert ist konstant mit "1.0" zu belegen.</p> 
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-119223">8.1.1.3 Namen und Claims</h5> 
  <p id="polarion_179">Namen von JSON-Elementen sind ausnahmslos in sog. "Snake-Case" dargestellt. Namen von Datenobjekten in Großschreibung.</p> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-119217">8.1.2 Datentyp "Device_Type"</h4> 
  <p id="polarion_180"> Der Datentyp "Device_Type" wird zur Übertragung von Informationen über einen Gerätetyp vom Authenticator-Modul zum IDP-Dienst verwendet. Der Datensatz wird vom Authenticator-Modul produziert und vom Pairing-Endpunkt und dem Authorization-Endpunkt verwendet.&nbsp;Der Datentyp umfasst die Elemente des folgenden Schemas:<br> </p> 
  <p id="polarion_182" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">13</span>: Schema Datentyp "Device_Type" </p> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=183" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th colspan="4" rowspan="1" style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 185px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Datenformat: JSON</th> 
    </tr> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 185px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Name</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 85px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Verpflichtend</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 174px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Type</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 266px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Hinweise</th> 
    </tr> 
    <tr> 
     <td style="width: 185px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">device_type_data_version</td> 
     <td style="width: 85px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 174px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String, Konstant "1.1"&nbsp;<span id="polarion-comment:1605"></span></td> 
     <td style="width: 266px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">-</td> 
    </tr> 
    <tr> 
     <td style="width: 185px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">manufacturer</td> 
     <td style="width: 85px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 174px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String</td> 
     <td style="width: 266px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Name des Herstellers eines Geräts</td> 
    </tr> 
    <tr> 
     <td style="width: 185px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">product</td> 
     <td style="width: 85px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 174px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String</td> 
     <td style="width: 266px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Produktname des Geräts gegenüber dem Endkunden</td> 
    </tr> 
    <tr> 
     <td style="width: 185px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">model</td> 
     <td style="width: 85px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 174px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String</td> 
     <td style="width: 266px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Name des Modells&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="width: 185px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">os</td> 
     <td style="width: 85px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 174px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String</td> 
     <td style="width: 266px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Betriebssystem</td> 
    </tr> 
    <tr> 
     <td style="width: 185px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">os_version</td> 
     <td style="width: 85px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 174px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String</td> 
     <td style="width: 266px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Version des Betriebssystems</td> 
    </tr> 
    <tr> 
     <td style="width: 185px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">security_patchlevel</td> 
     <td style="width: 85px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">nein</td> 
     <td style="width: 174px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String</td> 
     <td style="width: 266px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Format "YYYY-MM-DD"&nbsp;<span id="polarion-comment:1606"></span></td> 
    </tr> 
   </tbody> 
  </table> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-119219">8.1.3 Datentyp "Device_Information"</h4> 
  <p id="polarion_185"> Der Datentyp "Device_Information" wird zur Übertragung von Informationen über ein Gerät verwendet. Der Datensatz wird vom Authenticator-Modul produziert und vom Pairing-Endpunkt verwendet. Der Datentyp umfasst die Elemente des folgenden Schemas:&nbsp;<br> </p> 
  <p id="polarion_195" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">14</span>: Schema Datentyp "Device_Information" </p> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=196" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 194px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;">Datenformat: JSON</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 85px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;"></th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 164px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;"></th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 266px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></th> 
    </tr> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 194px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;">Name</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 85px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;">Verpflichtend</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 164px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;">Type</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 266px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Hinweise</th> 
    </tr> 
    <tr> 
     <td style="width: 194px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">device_information_data_version</td> 
     <td style="width: 85px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 164px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">JSON/String, Konstant "1.0"</td> 
     <td style="width: 266px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">-</td> 
    </tr> 
    <tr> 
     <td style="width: 194px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">name</td> 
     <td style="width: 85px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 164px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">JSON/String</td> 
     <td style="width: 266px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">vom Benutzer vergebener Name für das Gerät</td> 
    </tr> 
    <tr> 
     <td style="width: 194px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">device_type</td> 
     <td style="width: 85px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 164px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">JSON/Object Device_Type</td> 
     <td style="width: 266px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">siehe <span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-119217" data-option-id="longoutline"></span>&nbsp;&nbsp;</td> 
    </tr> 
   </tbody> 
  </table> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-119174">8.1.4 Datentyp "Pairing_Data"</h4> 
  <p id="polarion_227"> Der Datentyp "Pairing_Data" wird zur Bindung des PuK_SE_AUT an Metadaten verwendet. Der Datentyp wird vom Authenticator-Modul produziert und von Pairing-Endpunkt und Authorization-Endpunkt verwendet.&nbsp;Der Datentyp umfasst die Elemente des folgenden Schemas:&nbsp;<br> </p> 
  <p id="polarion_228" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">15</span>: Schema Datentyp "Pairing_Data" </p> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=230" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 193px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Datenformat: JSON</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 83px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 129px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 304px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></th> 
    </tr> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 193px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Name</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 83px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Verpflichtend</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 129px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Type</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 304px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Hinweise</th> 
    </tr> 
    <tr> 
     <td style="width: 193px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">pairing_data_version</td> 
     <td style="width: 83px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 129px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String, Konstant "1.0"</td> 
     <td style="width: 304px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Version der Pairing-Daten-Instanz</td> 
    </tr> 
    <tr> 
     <td style="width: 193px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">se_subject_public_key_info</td> 
     <td style="width: 83px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 129px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String</td> 
     <td style="width: 304px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">base64url-codierte, DER-codierte ASN.1-Repräsentation des öffentlichen Schlüssels aus dem Secure-Elements und des verwendeten Algorithmus in Form einer „SubjectPublicKeyInfo“-Struktur, gemäß<br> <a href="https://tools.ietf.org/html/rfc5480#section-2" target="_top" class="descriptionLink">[RFC5480], Abschnitt 2 "Subject Public Key Information Fields"</a>. Der öffentliche Schlüssel muss ohne die Verwendung von Punktkompression abgebildet werden (vergleiche&nbsp;<a href="https://tools.ietf.org/html/rfc5480#section-2.2" target="_top" class="descriptionLink">[RFC5480], Abschnitt 2.2 "Subject Public Key"</a>).<br> </td> 
    </tr> 
    <tr> 
     <td style="width: 193px;height: 15px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">key_identifier</td> 
     <td style="width: 83px;height: 15px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 129px;height: 15px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String</td> 
     <td style="width: 304px;height: 15px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">32 Byte langer Key-Identifier des Schlüsselpaars PrK_SE_AUT/PuK_SE_AUT in base64url-Kodierung</td> 
    </tr> 
    <tr> 
     <td style="width: 193px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">product</td> 
     <td style="width: 83px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 129px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String</td> 
     <td style="width: 304px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Produktname des Gerätetyps gegenüber dem Endkunden</td> 
    </tr> 
    <tr> 
     <td style="width: 193px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">serialnumber</td> 
     <td style="width: 83px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 129px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String</td> 
     <td style="width: 304px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Ergebnis der Konvertierung der Seriennummer des C.CH.AUT von Oktettstring in den binären Zertifikatsdaten nach Integer (Funktion “OS2I” gemäß [gemSpec_COS], A_13587) und anschließender Repräsentation als String</td> 
    </tr> 
    <tr> 
     <td style="width: 193px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">issuer</td> 
     <td style="width: 83px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 129px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String</td> 
     <td style="width: 304px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">base64url-kodierte, DER-kodierte RDNSequence (vergleiche&nbsp;<a href="https://tools.ietf.org/html/rfc5280#section-4.1.2.4)" target="_top" class="descriptionLink">[RFC5280], Abschnitt 4.1.2.4 "Issuer"</a>)<br> des Issuer-Felds aus dem Authentifizierungszertifikat C.CH.AUT</td> 
    </tr> 
    <tr> 
     <td style="width: 193px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">not_after</td> 
     <td style="width: 83px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 129px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String</td> 
     <td style="width: 304px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Das Ende des Gültigkeitszeitraums des Authentifizierungszertifikats C.CH.AUT.<br> Repräsentiert als NumericDate (<br> vergleiche <a href="https://tools.ietf.org/html/rfc7519#section-2" target="_top" class="descriptionLink">[RFC7519], Abschnitt 2 "Terminology"</a>)<br> </td> 
    </tr> 
    <tr> 
     <td style="width: 193px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">auth_cert_subject_public_key_info</td> 
     <td style="width: 83px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 129px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String</td> 
     <td style="width: 304px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">base64url-codierte, DER-codierte ASN.1-Repräsentation des öffentlichen Schlüssels aus dem Authentifizierungszertifikat und des zu verwendenden Algorithmus in Form einer „SubjectPublicKeyInfo“-Struktur:<br> 
      <ul> 
       <li> Für elliptische Kurven <a href="https://tools.ietf.org/html/rfc5480#section-2" target="_top" class="descriptionLink">[RFC5480], Abschnitt 2 "Subject Public Key Information Fields"</a>&nbsp;<br> Der öffentliche Schlüssel muss ohne die Verwendung von Punktkompression abgebildet werden&nbsp;(vergleiche&nbsp;<a href="https://tools.ietf.org/html/rfc5480#section-2.2" target="_top" class="descriptionLink">[RFC5480], Abschnitt 2.2 "Subject Public Key"</a>).</li> 
       <li> Im Fall von RSA-Signaturen gemäß <a href="https://tools.ietf.org/html/rfc5280#section-4.1.2.7" target="_top" class="descriptionLink">[RFC5280], Abschnitt 4.1.2.7 "Subject Public Key Info"</a><a href="https://tools.ietf.org/html/rfc5280#section-4.1.2.7" target="_top">&nbsp;</a>und <a href="https://tools.ietf.org/html/rfc5280#section-4.1" target="_top" class="descriptionLink">[RFC5280], Abschnitt 4.1 "Basic Certificate Fields"</a><a href="https://tools.ietf.org/html/rfc5280#section-4.1" target="_top">.</a> </li> 
      </ul> </td> 
    </tr> 
   </tbody> 
  </table> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-119172">8.1.5 Datentyp "Signed_Pairing_Data"</h4> 
  <p id="polarion_235"> Der Datentyp "Signed_Pairing_Data" repräsentiert den vom Nutzer mithilfe der eGK signierte Instanz des Datentyps "Pairing_Data". Der Datentyp wird vom Authenticator-Modul produziert und von Pairing-Endpunkt und Authorization-Endpunkt verwendet.&nbsp;Der Datentyp umfasst die Elemente des folgenden Schemas:&nbsp;<br> </p> 
  <p id="polarion_239" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">16</span>: Schema Datentyp "Signed_Pairing_Data" </p> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=240" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th colspan="4" rowspan="1" style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 182px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Datenformat:&nbsp;JWS, kompakte Serialisierung gemäß <a href="https://tools.ietf.org/html/rfc7515" target="_top" class="descriptionLink">[RFC7515]</a>&nbsp;</th> 
    </tr> 
    <tr> 
     <th colspan="4" rowspan="1" style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 182px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Header</th> 
    </tr> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 182px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Name</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 94px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Verpflichtend</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 333px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Type</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 100px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Hinweise</th> 
    </tr> 
    <tr> 
     <td style="width: 182px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">alg</td> 
     <td style="width: 94px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 333px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String, Konstant "BP256R1"</td> 
     <td style="width: 100px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">-</td> 
    </tr> 
    <tr> 
     <td style="width: 182px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">typ</td> 
     <td style="width: 94px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 333px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String, Konstant "JWT"</td> 
     <td style="width: 100px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">-</td> 
    </tr> 
    <tr> 
     <td colspan="4" rowspan="1" style="width: 182px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Payload</span></td> 
    </tr> 
    <tr> 
     <td style="width: 182px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Pairing-Daten-Instanz</td> 
     <td style="width: 182px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 182px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/Object - Pairing-Data</td> 
     <td style="width: 182px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">siehe <span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-119174" data-option-id="longoutline"></span>&nbsp;</td> 
    </tr> 
   </tbody> 
  </table> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-119170">8.1.6 Datentyp "Registration_Data"</h4> 
  <p id="polarion_242"> Der Datentyp "Registration_Data" bündelt die zur Verifikation und Anlage eines Pairing benötigten Daten. Der Datentyp wird vom Authenticator-Modul produziert und vom Pairing-Endpunkt verwendet.&nbsp;Der Datentyp umfasst die Elemente des folgenden Schemas:&nbsp;<br> </p> 
  <p id="polarion_244" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">17</span>: Schema Datentyp "Registration_Data" </p> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=245" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th colspan="4" rowspan="1" style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 182px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Datenformat: JSON</th> 
    </tr> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 182px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Name</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 105px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Verpflichtend</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 161px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Type</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 261px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Hinweise</th> 
    </tr> 
    <tr> 
     <td style="width: 182px;height: 33.6364px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">registration_data_version</td> 
     <td style="width: 105px;height: 33.6364px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">&nbsp;ja</td> 
     <td style="width: 161px;height: 33.6364px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String, Konstant "1.0"</td> 
     <td style="width: 261px;height: 33.6364px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">-</td> 
    </tr> 
    <tr> 
     <td style="width: 182px;height: 50.9091px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">signed_pairing_data</td> 
     <td style="width: 105px;height: 50.9091px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 161px;height: 50.9091px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String</td> 
     <td style="width: 261px;height: 50.9091px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">Repräsentation der Signed_Pairing_Data-Instanz in kompakter Serialisierung, vergleiche&nbsp;<a href="https://tools.ietf.org/html/rfc7515" target="_top" class="descriptionLink">[RFC7515]</a>.</span></td> 
    </tr> 
    <tr> 
     <td style="width: 182px;height: 50.9091px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">auth_cert</td> 
     <td style="width: 105px;height: 50.9091px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 161px;height: 50.9091px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String</td> 
     <td style="width: 261px;height: 50.9091px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 9pt;line-height: 1.5;">DER-Kodierung des X.509 Authentifizierungszertifikat der eGK in base64url-Kodierung.</span></td> 
    </tr> 
    <tr> 
     <td style="width: 182px;height: 50.9091px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">device_information</td> 
     <td style="width: 105px;height: 50.9091px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 161px;height: 50.9091px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/Object "Device_Information"</td> 
     <td style="width: 261px;height: 50.9091px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">siehe&nbsp;<span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-119219" data-option-id="longoutline"></span>&nbsp;</td> 
    </tr> 
   </tbody> 
  </table> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-119168">8.1.7 Datentyp "Encrypted_Registration_Data"</h4> 
  <p id="polarion_246">Der Datentyp "Encrypted_Registration_Data" repräsentiert die verschlüsselte Form einer "Registration_Data"-Instanz. Der Datentyp wird vom Authenticator-Modul produziert und vom Pairing-Endpunkt verwendet.&nbsp;Der Datentyp umfasst die Elemente des folgenden Schemas:&nbsp;</p> 
  <p id="polarion_247"></p> 
  <p id="polarion_248" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">18</span>: Schema Datentyp "Encrypted_Registration_Data" </p> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=249" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th colspan="4" rowspan="1" style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 176px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Datenformat:&nbsp;JWE, Compact Serialization gemäß&nbsp;<a href="https://tools.ietf.org/html/rfc7516" target="_top" class="descriptionLink">[RFC7516]</a>&nbsp;</th> 
    </tr> 
    <tr> 
     <th colspan="4" rowspan="1" style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 176px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Header</th> 
    </tr> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 176px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Name</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 113px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Verpflichtend</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 242px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Typ</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 178px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Hinweise</th> 
    </tr> 
    <tr> 
     <td style="width: 176px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">alg</td> 
     <td style="width: 113px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 242px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String, Konstant "ECDH-ES"</td> 
     <td colspan="1" rowspan="5" style="width: 178px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">vergleiche&nbsp;<a href="https://tools.ietf.org/html/rfc7516&nbsp;" target="_top" class="descriptionLink">[RFC7516], "JSON Web Encryption (JWE)"</a>.</td> 
    </tr> 
    <tr> 
     <td style="width: 176px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">enc</td> 
     <td style="width: 113px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 242px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String, Konstant "A256GCM"</td> 
    </tr> 
    <tr> 
     <td style="width: 176px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">typ</td> 
     <td style="width: 113px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 242px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String, Konstant "JWT"</td> 
    </tr> 
    <tr> 
     <td style="width: 176px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">cty</td> 
     <td style="width: 113px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 242px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String, Konstant "JSON"</td> 
    </tr> 
    <tr> 
     <td style="width: 176px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">epk</td> 
     <td style="width: 113px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 242px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/Object,</td> 
    </tr> 
    <tr> 
     <td colspan="4" rowspan="1" style="width: 176px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Encrypted Key, Initialization Vector, Ciphertext und Authentication Tag</span> wie in&nbsp;<a href="https://tools.ietf.org/html/rfc7516&nbsp;" target="_top" class="descriptionLink">[RFC7516], "JSON Web Encryption (JWE)"</a></td> 
    </tr> 
   </tbody> 
  </table> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-119166">8.1.8 Datentyp "Authentication_Data"</h4> 
  <p id="polarion_250">Der Datentyp "Authentication_Data" repräsentiert die zur Authentifizierung des Nutzers verwendeten Daten. Der Datentyp wird vom Authenticator-Modul produziert und vom Authorization-Endpunkt verwendet.&nbsp;Der Datentyp umfasst die Elemente des folgenden Schemas:&nbsp;</p> 
  <p id="polarion_251"></p> 
  <p id="polarion_252" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">19</span>: Schema Datentyp "Authentication_Data" </p> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=253" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th colspan="4" rowspan="1" style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 742px;height: 0px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Datenformat: JSON</th> 
    </tr> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 177px;height: 0px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Name</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 83px;height: 0px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Verpflichtend</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 200px;height: 0px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Type/Wert</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 251px;height: 0px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Hinweise</th> 
    </tr> 
    <tr> 
     <td style="width: 177px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">authentication_data_version</td> 
     <td style="width: 83px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 200px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String, Konstant "1.0"</td> 
     <td style="width: 251px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">-</td> 
    </tr> 
    <tr> 
     <td style="width: 177px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">challenge_token</td> 
     <td style="width: 83px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 200px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String</td> 
     <td style="width: 251px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Repräsentation des ChallengeToken in kompakter Serialisierung, vergleiche&nbsp;<a href="https://tools.ietf.org/html/rfc7515" target="_top" class="descriptionLink">[RFC7515]</a></td> 
    </tr> 
    <tr> 
     <td style="width: 177px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">auth_cert</td> 
     <td style="width: 83px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 200px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String</td> 
     <td style="width: 251px;height: 17px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">DER-Kodierung des X.509 Authentifizierungszertifikat der eGK in base64url-Kodierung</td> 
    </tr> 
    <tr> 
     <td style="width: 177px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">key_identifier</td> 
     <td style="width: 83px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 200px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/String</td> 
     <td style="width: 251px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">32 bytes in base64url-Codierung</td> 
    </tr> 
    <tr> 
     <td style="width: 177px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">device_information</td> 
     <td style="width: 83px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 200px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/Object "Device_Information"</td> 
     <td style="width: 251px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Siehe <span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-119219" data-option-id="longoutline"></span>&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="width: 177px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">amr</td> 
     <td style="width: 83px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 200px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">JSON/Array von JSON/Strings</td> 
     <td style="width: 251px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Angaben zu der vom Nutzer verwendeten Authentisierungsmethode zur Anwendung des Schlüssels PrK_SE_AUT als Array von JSON/String-Werten, vergleiche die Darstellungen in&nbsp;<a href="https://tools.ietf.org/html/rfc8176" target="_top" class="descriptionLink">[RFC8176]</a></td> 
    </tr> 
   </tbody> 
  </table> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-119183">8.1.9 Datentyp "Signed_Authentication_Data"</h4> 
  <p id="polarion_254">Der Datentyp "Signed_Authentication_Data" repräsentiert die vom Nutzer mithilfe des PrK_SE_AUT signierte Instanz einer "Authentication_Data"-Struktur.&nbsp;Der Datentyp wird vom Authenticator-Modul produziert und vom Authorization-Endpunkt verwendet.&nbsp; Der Datentyp umfasst die Elemente des folgenden Schemas:&nbsp;</p> 
  <p id="polarion_255"></p> 
  <p id="polarion_256" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">20</span>: Schema Datentyp "Signed_Authentication_Data" </p> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=257" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th colspan="4" rowspan="1" style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 742px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;">Datenformat: JWS, kompakte Serialisierung gemäß <a href="https://tools.ietf.org/html/rfc7515" target="_top" class="descriptionLink">[RFC7515]</a>&nbsp;</th> 
    </tr> 
    <tr> 
     <th colspan="4" rowspan="1" style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 742px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;">Header</th> 
    </tr> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 170px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;">Name</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 97px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;">Verpflichtend</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 208px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;">Typ/Wert</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 235px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;">Hinweise</th> 
    </tr> 
    <tr> 
     <td style="width: 170px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">alg</td> 
     <td style="width: 97px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 208px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">JSON/String, Konstant "ES256"</td> 
     <td style="width: 235px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">-</td> 
    </tr> 
    <tr> 
     <td style="width: 170px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">typ</td> 
     <td style="width: 97px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 208px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">JSON/String, Konstant "JWT"</td> 
     <td style="width: 235px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">-</td> 
    </tr> 
    <tr> 
     <td colspan="4" rowspan="1" style="width: 742px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Payload</span></td> 
    </tr> 
    <tr> 
     <td colspan="1" rowspan="1" style="width: 170px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">Authentication-Data-Instanz</td> 
     <td rowspan="1" style="width: 97px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td rowspan="1" style="width: 208px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">JSON/Object Authentication_Data&nbsp;</td> 
     <td rowspan="1" style="width: 235px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">siehe <span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-119219" data-option-id="longoutline"></span>&nbsp;</td> 
    </tr> 
   </tbody> 
  </table> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-119182">8.1.10 Datentyp "Encrypted_Signed_Authentication_Data"</h4> 
  <p id="polarion_258">Der Datentyp "Encrypted_Signed_Authentication_Data" repräsentiert eine verschlüsselte "Signed_Authentication_Data"-Instanz. Der Datentyp wird vom Authenticator-Modul produziert und vom Authorization-Endpunkt verwendet.&nbsp;Der Datentyp umfasst die Elemente des folgenden Schemas:&nbsp;</p> 
  <p id="polarion_164"></p> 
  <p id="polarion_260" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">21</span>:&nbsp;Schema Datentyp "Encrypted_Signed_Authentication_Data" </p> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=261" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th colspan="4" rowspan="1" style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 742px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;">Datenformat:&nbsp;JWE, Compact Serialization gemäß&nbsp;<a href="https://tools.ietf.org/html/rfc7516" target="_top" class="descriptionLink">[RFC7516]</a>&nbsp;</th> 
    </tr> 
    <tr> 
     <th colspan="4" rowspan="1" style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 742px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;">Header</th> 
    </tr> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 109px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;">Name</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 107px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;">Verpflichtend</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 201px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;">Typ/Wert</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 292px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;">Hinweise</th> 
    </tr> 
    <tr> 
     <td style="width: 109px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">alg</td> 
     <td style="width: 107px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 201px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">JSON/String, Konstant "ECDH-ES"</td> 
     <td colspan="1" rowspan="5" style="width: 292px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">siehe <a href="https://tools.ietf.org/html/rfc7516&nbsp;" target="_top" class="descriptionLink">[RFC7516]</a>&nbsp;&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="width: 109px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">enc</td> 
     <td style="width: 107px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 201px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">JSON/String, Konstant "A256GCM"</td> 
    </tr> 
    <tr> 
     <td style="width: 109px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">typ</td> 
     <td style="width: 107px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 201px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">JSON/String, Konstant "JWT"</td> 
    </tr> 
    <tr> 
     <td style="width: 109px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">cty</td> 
     <td style="width: 107px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 201px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">JSON/String, Konstant "NJWT"</td> 
    </tr> 
    <tr> 
     <td style="width: 109px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">epk</td> 
     <td style="width: 107px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 201px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">JSON/Object,</td> 
    </tr> 
    <tr> 
     <td style="width: 109px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">exp</td> 
     <td style="width: 107px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 201px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">JSON/Number</td> 
     <td style="width: 292px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">Zeitpunkt des Ablaufs der Gültigkeit der vorhandenen Claims, repräsentiert als NumericDate (vergleiche <a href="https://tools.ietf.org/html/rfc7519#section-2" target="_top" class="descriptionLink">[RFC7519], Abschnitt 2 "Terminology"</a>)</td> 
    </tr> 
    <tr> 
     <td colspan="4" rowspan="1" style="width: 742px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Encrypted Key, Initialization Vector, Ciphertext und Authentication Tag</span> wie in&nbsp;<a href="https://tools.ietf.org/html/rfc7516&nbsp;" target="_top" class="descriptionLink">[RFC7516]</a></td> 
    </tr> 
   </tbody> 
  </table> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-119181">8.1.11 Datentyp "Pairing_Entry"</h4> 
  <p id="polarion_262">Der Datentyp "Pairing_Entry" repräsentiert die am Pairing-Endpunkt gespeicherten Daten. Der Datentyp wird vom Pairing-Endpunkt produziert und vom Authenticator-Modul verwendet. Der Datentyp umfasst die Elemente des folgenden Schemas:&nbsp;</p> 
  <p id="polarion_263"></p> 
  <p id="polarion_264" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">22</span>: Schema Datentyp "Pairing_Entry" </p> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=265" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th colspan="4" rowspan="1" style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 742px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;">Datenformat: JSON</th> 
    </tr> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 180px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Name</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 113px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Verpflichtend</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 178px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;">Type/Wert</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 238px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;">Hinweise</th> 
    </tr> 
    <tr> 
     <td style="width: 180px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">pairing_entry_data_version</td> 
     <td style="width: 113px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 178px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">JSON/String, Konstant "1.0"</td> 
     <td style="width: 238px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">-</td> 
    </tr> 
    <tr> 
     <td style="width: 180px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">name</td> 
     <td style="width: 113px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 178px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">JSON/String,</td> 
     <td style="width: 238px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">vom Nutzer vergebener Name des Geräts</td> 
    </tr> 
    <tr> 
     <td style="width: 180px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">creation_time</td> 
     <td style="width: 113px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 178px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">JSON/Number</td> 
     <td style="width: 238px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">Zeitpunkt der Anlage des Pairing als Numeric-Date</td> 
    </tr> 
    <tr> 
     <td style="width: 180px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">signed_pairing_data</td> 
     <td style="width: 113px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 178px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">JSON/String</td> 
     <td style="width: 238px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">Repräsentation der Signed_Pairing_Data-Instanz in kompakter Serialisierung, vergleiche&nbsp;<a href="https://tools.ietf.org/html/rfc7515" target="_top" class="descriptionLink">[RFC7515]</a></td> 
    </tr> 
   </tbody> 
  </table> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-119180">8.1.12 Datentyp "Pairing_Entries"</h4> 
  <p id="polarion_266">Der Datentyp "Pairing_Entries" repräsentiert eine Liste von "Pairing_Entry"-Instanzen.&nbsp;Der Datentyp wird vom Pairing-Endpunkt produziert und vom Authenticator-Modul verwendet. Der Datentyp umfasst die Elemente des folgenden Schemas:</p> 
  <p id="polarion_267"></p> 
  <p id="polarion_268" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">23</span>: Schema Datentyp "Pairing_Entries" </p> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=269" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th colspan="4" rowspan="1" style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 742px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;">Datenformat: JSON</th> 
    </tr> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 122px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;">Name</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 90px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;">Verpflichtend</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 228px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;">Typ/Wert</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 269px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;">Hinweise</th> 
    </tr> 
    <tr> 
     <td style="width: 122px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">pairing_entries</td> 
     <td style="width: 90px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">ja</td> 
     <td style="width: 228px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">JSON/Array von Pairing_Entry-Instanzen</td> 
     <td style="width: 269px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">siehe&nbsp;<span class="polarion-rte-link" data-type="crossReference" id="fake" data-item-id="ML-119181" data-option-id="longoutline"></span>&nbsp;<br> Falls keine Pairing-Einträge des Nutzers existieren, ist dieser Wert mit einem leeren Array zu belegen.</td> 
    </tr> 
   </tbody> 
  </table> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-119179">8.2 Ausgestaltung der Kommunikation mit dem IDP-Dienst</h3> 
  <p id="polarion_125"></p> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-119194">8.2.1 Registrierung von alternativen Authentisierungsmitteln</h4> 
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-119192">8.2.1.1 Request des Authenticator-Moduls bei Registrierung</h5> 
  <p id="polarion_270" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">24</span>: Registrierungsprozess/Anfrage Authenticator-Modul </p> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=271" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th colspan="3" rowspan="1" style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 742px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;">Request</th> 
    </tr> 
    <tr> 
     <td style="width: 138px;height: 33.6364px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">HTTP-Method</span></td> 
     <td style="width: 296px;height: 33.6364px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">URL</span></td> 
     <td style="width: 286px;height: 33.6364px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Hinweise</span></td> 
    </tr> 
    <tr> 
     <td style="width: 138px;height: 33.6364px;border: 1px solid #CCCCCC;padding: 5px;">Post</td> 
     <td style="width: 296px;height: 33.6364px;border: 1px solid #CCCCCC;padding: 5px;">&lt;URL des Pairing-Endpunkts aus dem Discovery Document&gt; </td> 
     <td style="width: 286px;height: 33.6364px;border: 1px solid #CCCCCC;padding: 5px;">vergleiche Attribut "uri_pair" in A_21429-02.</td> 
    </tr> 
    <tr> 
     <td colspan="3" rowspan="1" style="width: 742px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Header</span></td> 
    </tr> 
    <tr> 
     <td style="width: 138px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Feld</span></td> 
     <td style="width: 296px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Wert</span></td> 
     <td style="width: 286px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Hinweise</span></td> 
    </tr> 
    <tr> 
     <td style="width: 138px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">Content-Type</td> 
     <td style="width: 296px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">application/x-www-form-urlencoded; charset=UTF-8</td> 
     <td style="width: 286px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">-</td> 
    </tr> 
    <tr> 
     <td style="width: 138px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">Authorization</td> 
     <td style="width: 296px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">"Bearer" &lt;ACCESS_TOKEN&gt;</td> 
     <td style="width: 286px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">vergleiche&nbsp;<a href="https://tools.ietf.org/html/rfc6750#section-2.1&nbsp;" target="_top" class="descriptionLink">[RFC6750], Abschnitt 2.1 "Authorization Request Header Field"</a></td> 
    </tr> 
    <tr> 
     <td style="width: 138px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">Accept</td> 
     <td style="width: 296px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">application/json; charset=UTF-8</td> 
     <td style="width: 286px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">-</td> 
    </tr> 
    <tr> 
     <td style="width: 138px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">User-Agent</td> 
     <td style="width: 296px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">&nbsp;&lt;User-Agent&gt;</td> 
     <td style="width: 286px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">siehe [gemSpec_IDP_Dienst], Abschnitt 4.4</td> 
    </tr> 
    <tr> 
     <td colspan="3" rowspan="1" style="width: 742px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Body</span></td> 
    </tr> 
    <tr> 
     <td style="width: 138px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Form-Key</span></td> 
     <td style="width: 296px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Wert</span></td> 
     <td style="width: 286px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Hinweise</span></td> 
    </tr> 
    <tr> 
     <td style="width: 138px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">encrypted_registration_data</td> 
     <td style="width: 296px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">serialisierte Encrypted_Registration_Data-Instanz <br> </td> 
     <td style="width: 286px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">vergleiche <a href="https://tools.ietf.org/html/rfc7516#section-3.1&nbsp;" target="_top" class="descriptionLink">[RFC7516], Abschnitt 3.1 "JWE Compact Serialization Overview"</a></td> 
    </tr> 
   </tbody> 
  </table> 
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-119191">8.2.1.2 Response des Pairing-Endpunkts bei Registrierung</h5> 
  <p id="polarion_272" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">25</span>: Registrierungsprozess/Antwort Pairing-Endpunkt </p> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=273" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 174px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Response</th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 102px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;"></th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 301px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;"></th> 
     <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 131px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></th> 
    </tr> 
    <tr> 
     <td style="width: 174px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">HTTP-Response Status-Code</span></td> 
     <td style="width: 102px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Body</span></td> 
     <td style="width: 301px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Bedeutung (Vgl. A_21411)</span></td> 
     <td style="width: 131px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Hinweise</span></td> 
    </tr> 
    <tr> 
     <td style="width: 174px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">200&nbsp;</td> 
     <td style="width: 102px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">-</td> 
     <td style="width: 301px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">Das Pairing wurde erfolgreich angelegt.</td> 
     <td colspan="1" rowspan="1" style="width: 131px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">-</td> 
    </tr> 
    <tr> 
     <td style="width: 174px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">403</td> 
     <td colspan="1" rowspan="4" style="width: 102px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">siehe Hinweise</td> 
     <td style="width: 301px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">REG.1: Der Zugriff auf den Dienst kann nicht gewährt werden.<br> Das ACCESS_TOKEN konnte nicht erfolgreich validiert werden.</td> 
     <td colspan="1" rowspan="4" style="width: 131px;height: 255px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Im Hinblick auf die syntaktische Ausgestaltung der Fehlermeldungen gelten die Anforderungen aus [gemSpec_IDP_Dienst], Abschnitt 4.2.</td> 
    </tr> 
    <tr> 
     <td style="width: 174px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">400</td> 
     <td style="width: 301px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">REG.2: Das verwendete Gerät ist nicht für die Authentifizierung geeignet.</td> 
    </tr> 
    <tr> 
     <td style="width: 174px;height: 55px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">500</td> 
     <td style="width: 301px;height: 55px;border: 1px solid #CCCCCC;padding: 5px;">REG.3 Der erzeugte Schlüssel konnte aufgrund eines internen Fehlers nicht registriert werden.</td> 
    </tr> 
    <tr> 
     <td style="width: 174px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">409</td> 
     <td style="width: 301px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">REG.4 Der erzeugte Schlüssel konnte aufgrund eines bestehenden Eintrags nicht registriert werden. </td> 
    </tr> 
   </tbody> 
  </table> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-119189">8.2.2 Verwendung von alternativen Authentisierungsmitteln</h4> 
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-119188">8.2.2.1 Request des Authenticator-Moduls bei Verwendung von alternativen Authentisierungsmitteln</h5> 
  <p id="polarion_274" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">26</span>: Authentifizierung/Anfrage Authenticator-Modul </p> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=275" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th colspan="3" rowspan="1" style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 742px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Request</th> 
    </tr> 
    <tr> 
     <td style="width: 221px;height: 14px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">HTTP-Method</span></td> 
     <td style="width: 291px;height: 14px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">URL</span></td> 
     <td style="width: 208px;height: 14px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Hinweise</span></td> 
    </tr> 
    <tr> 
     <td style="width: 221px;height: 56px;border: 1px solid #CCCCCC;padding: 5px;">Post</td> 
     <td style="width: 291px;height: 56px;border: 1px solid #CCCCCC;padding: 5px;">&lt;URL des Authorization-Endpunkts für alternative Authentisierung&gt;</td> 
     <td style="width: 208px;height: 56px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">vergleiche Attribut "auth_pair_endpoint" in A_21429-02.</td> 
    </tr> 
    <tr> 
     <td colspan="3" rowspan="1" style="width: 742px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Header</span></td> 
    </tr> 
    <tr> 
     <td style="width: 221px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Feld</span></td> 
     <td style="width: 291px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Wert</span></td> 
     <td style="width: 208px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Hinweise</span></td> 
    </tr> 
    <tr> 
     <td style="width: 221px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">Content-Type</td> 
     <td style="width: 291px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">application/x-www-form-urlencoded; charset=UTF-8</td> 
     <td style="width: 208px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">-</td> 
    </tr> 
    <tr> 
     <td style="width: 221px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">User-Agent</td> 
     <td style="width: 291px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">&nbsp;&lt;User-Agent&gt;</td> 
     <td style="width: 208px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">siehe gemSpec_IDP_Dienst, Abschnitt 4.4</td> 
    </tr> 
    <tr> 
     <td colspan="3" rowspan="1" style="width: 742px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Body</span></td> 
    </tr> 
    <tr> 
     <td style="width: 221px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Form-Key</span></td> 
     <td style="width: 291px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Wert</span></td> 
     <td style="width: 208px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Hinweise</span></td> 
    </tr> 
    <tr> 
     <td style="width: 221px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">encrypted_signed_authentication_data</td> 
     <td style="width: 291px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">serialisierte Encrypted_Registration_Data-Instanz <br> </td> 
     <td style="width: 208px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">vergleiche&nbsp;<a href="https://tools.ietf.org/html/rfc7516#section-3.1&nbsp;" target="_top" class="descriptionLink">[RFC7516], Abschnitt 3.1 "JWE Compact Serialization Overview"</a></td> 
    </tr> 
   </tbody> 
  </table> 
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-119187">8.2.2.2 Response des Authorization-Endpunkts bei Verwendung von alternativen Authentisierungsmitteln</h5> 
  <p id="polarion_276" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">27</span>: Authentifizierung/Antwort Authorization-Endpunkt </p> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=277" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th colspan="4" rowspan="1" style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 742px;height: 18.1818px;border: 1px solid #CCCCCC;padding: 5px;">Response</th> 
    </tr> 
    <tr> 
     <td style="width: 172px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">http-response Status-Code</span></td> 
     <td style="width: 93px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Body</span></td> 
     <td style="width: 205px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Bedeutung (Vgl. A_21411)</span></td> 
     <td style="width: 239px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Hinweise</span></td> 
    </tr> 
    <tr> 
     <td style="width: 172px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">200</td> 
     <td style="width: 93px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">-</td> 
     <td style="width: 205px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">Der Nutzer ist authentifiziert.</td> 
     <td colspan="1" rowspan="1" style="width: 239px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">-</td> 
    </tr> 
    <tr> 
     <td style="width: 172px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">400</td> 
     <td style="width: 93px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">siehe Hinweise</td> 
     <td style="width: 205px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">VAL.1: Die Authentifizierung konnte nicht erfolgreich durchgeführt werden.&nbsp;</td> 
     <td colspan="1" style="width: 239px;height: 16.3636px;border: 1px solid #CCCCCC;padding: 5px;">Im Hinblick auf die syntaktische Ausgestaltung der Fehlermeldungen gelten die Anforderungen aus [gemSpec_IDP_Dienst], Abschnitt 4.2.</td> 
    </tr> 
   </tbody> 
  </table> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-119201">8.2.3 Inspektion von Pairing-Daten am Pairing-Endpunkt</h4> 
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-119200">8.2.3.1 Request des Authenticator-Moduls zur Inspektion</h5> 
  <p id="polarion_278" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">28</span>: Inspektion/Anfrage Authenticator-Modul </p> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=279" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th colspan="3" rowspan="1" style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 470px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Request</th> 
    </tr> 
    <tr> 
     <td style="width: 118px;height: 33.6364px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">HTTP-Method</span></td> 
     <td style="width: 341px;height: 33.6364px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">URL</span></td> 
     <td style="width: 261px;height: 33.6364px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Hinweise</span></td> 
    </tr> 
    <tr> 
     <td style="width: 118px;height: 33.6364px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">GET</td> 
     <td style="width: 341px;height: 33.6364px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">&lt;URL des Pairing-Endpunkts aus dem Discovery Document&gt;&nbsp;</td> 
     <td style="width: 261px;height: 33.6364px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">vergleiche Attribut "uri_pair" in A_21429-02</td> 
    </tr> 
    <tr> 
     <td colspan="3" rowspan="1" style="width: 742px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Header</span></td> 
    </tr> 
    <tr> 
     <td style="width: 118px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Feld</span></td> 
     <td style="width: 341px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Wert</span></td> 
     <td style="width: 261px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Hinweise</span></td> 
    </tr> 
    <tr> 
     <td style="width: 118px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Accept</td> 
     <td style="width: 341px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">application/json; charset=UTF-8</td> 
     <td style="width: 261px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">-</td> 
    </tr> 
    <tr> 
     <td style="width: 118px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Authorization</td> 
     <td style="width: 341px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">"Bearer" &lt;ACCESS_TOKEN&gt;</td> 
     <td style="width: 261px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">vergleiche&nbsp;<a href="https://tools.ietf.org/html/rfc6750#section-2.1&nbsp;" target="_top" class="descriptionLink">[RFC6750], Abschnitt 2.1 "Authorization Request Header Field"</a></td> 
    </tr> 
    <tr> 
     <td style="width: 118px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">User-Agent</td> 
     <td style="width: 341px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">&lt;User Agent&gt;</td> 
     <td style="width: 261px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">siehe [gemSpec_IDP_Dienst], Abschnitt 4.4</td> 
    </tr> 
    <tr> 
     <td colspan="3" rowspan="1" style="width: 742px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Body</span></td> 
    </tr> 
    <tr> 
     <td colspan="3" rowspan="1" style="width: 742px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">-</td> 
    </tr> 
   </tbody> 
  </table> 
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-119199">8.2.3.2 Response des Pairing-Endpunkts bei Inspektion</h5> 
  <p id="polarion_280" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">29</span>: Inspektion/Antwort Pairing-Endpunkt </p> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=281" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th colspan="4" rowspan="1" style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 742px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Response</th> 
    </tr> 
    <tr> 
     <td style="width: 188px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">http-response Status-Code</span></td> 
     <td style="width: 138px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Body</span></td> 
     <td style="width: 170px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Bedeutung</span></td> 
     <td style="width: 215px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Hinweise</span></td> 
    </tr> 
    <tr> 
     <td style="width: 188px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">200</td> 
     <td style="width: 138px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Content-Type=application/JSON<br> Pairing-Entries-Instanz.</td> 
     <td style="width: 170px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Die Pairing-Daten wurden erfolgreich abgerufen.&nbsp;<br> <br> </td> 
     <td colspan="1" rowspan="1" style="width: 215px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Sofern keine Pairing-Daten vorliegen muss der Pairing-Endpunkt ein leeres Array in Form einer Pairing_Entries-Instanz zurückgeben.&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="width: 188px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">403</td> 
     <td colspan="1" rowspan="2" style="width: 138px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">siehe Hinweise</td> 
     <td style="width: 170px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Siehe AC.1 in A_21441</td> 
     <td colspan="1" rowspan="2" style="width: 215px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Im Hinblick auf die syntaktische Ausgestaltung der Fehlermeldungen gelten die Anforderungen aus [gemSpec_IDP_Dienst], Abschnitt 4.2. Die Ausgestaltung der http-response-Codes im Fall von technischen Fehlern (AC.2) muss entsprechend der Art des Fehlers ausgestaltet werden.&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="width: 188px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">4XX/5XX</td> 
     <td style="width: 170px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Siehe AC.2 in A_21441</td> 
    </tr> 
   </tbody> 
  </table> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-119198">8.2.4 Deregistrierung von Pairing-Daten am Pairing-Endpunkt</h4> 
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-119208">8.2.4.1 Request des Authenticator-Moduls zur Deregistrierung</h5> 
  <p id="polarion_282" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">30</span>: Deregistrierung/Anfrage Authenticator-Modul </p> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=283" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th colspan="3" rowspan="1" style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 469px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Request</th> 
    </tr> 
    <tr> 
     <td style="width: 137px;height: 33.6364px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">HTTP-Method</span></td> 
     <td style="width: 321px;height: 33.6364px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">URL</span></td> 
     <td style="width: 262px;height: 33.6364px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Hinweise</span></td> 
    </tr> 
    <tr> 
     <td style="width: 137px;height: 33.6364px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">DELETE</td> 
     <td style="width: 321px;height: 33.6364px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">&lt;URL des Pairing-Endpunkts aus dem Discovery Document&gt;/base64url(key_identifier)</td> 
     <td style="width: 262px;height: 33.6364px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">vergleiche Attribut "uri_pair" in A_21429-02</td> 
    </tr> 
    <tr> 
     <td colspan="3" rowspan="1" style="width: 742px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Header</span></td> 
    </tr> 
    <tr> 
     <td style="width: 137px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Feld</span></td> 
     <td style="width: 321px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Wert</span></td> 
     <td style="width: 262px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Hinweise</span></td> 
    </tr> 
    <tr> 
     <td style="width: 137px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Accept</td> 
     <td style="width: 321px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">application/json; charset=UTF-8</td> 
     <td style="width: 262px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"></td> 
    </tr> 
    <tr> 
     <td style="width: 137px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Authorization</td> 
     <td style="width: 321px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">"Bearer" &lt;ACCESS_TOKEN&gt;</td> 
     <td style="width: 262px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">vergleiche&nbsp;<a href="https://tools.ietf.org/html/rfc6750#section-2.1&nbsp;" target="_top" class="descriptionLink">[RFC6750], Abschnitt 2.1 "Authorization Request Header Field"</a></td> 
    </tr> 
    <tr> 
     <td style="width: 137px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">User-Agent</td> 
     <td style="width: 321px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">&lt;User Agent&gt;</td> 
     <td style="width: 262px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">siehe [gemSpec_IDP_Dienst], Abschnitt 4.4</td> 
    </tr> 
    <tr> 
     <td colspan="3" rowspan="1" style="width: 742px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Body</span></td> 
    </tr> 
    <tr> 
     <td colspan="3" rowspan="1" style="width: 742px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">-</td> 
    </tr> 
   </tbody> 
  </table> 
  <h5 id="polarion_wiki macro name=module-workitem;params=id=ML-119207">8.2.4.2 Response des Pairing-Endpunkts bei Deregistrierung</h5> 
  <p id="polarion_284" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">31</span>: Deregistrierung/Antwort Pairing-Endpunkt </p> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=285" class="polarion-Document-table" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;"> 
   <tbody> 
    <tr> 
     <th colspan="4" rowspan="1" style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 742px;height: 18.1818px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Response</th> 
    </tr> 
    <tr> 
     <td style="width: 182px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">http-response Status-Code</span></td> 
     <td style="width: 130px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Body</span></td> 
     <td style="width: 209px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Bedeutung </span></td> 
     <td style="width: 189px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-weight: bold;">Hinweise</span></td> 
    </tr> 
    <tr> 
     <td style="width: 182px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">204</td> 
     <td style="width: 130px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">-</td> 
     <td style="width: 209px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Das durch die Kombination von key_identifier und idNummer identifizierte Pairing wurde deaktiviert.</td> 
     <td colspan="1" rowspan="1" style="width: 189px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">-</td> 
    </tr> 
    <tr> 
     <td style="width: 182px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">403</span></td> 
     <td colspan="1" rowspan="2" style="width: 130px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">siehe Hinweise</td> 
     <td style="width: 209px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">siehe AC.1 in A_21441</span></td> 
     <td colspan="1" rowspan="2" style="width: 189px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">Im Hinblick auf die syntaktische Ausgestaltung der Fehlermeldungen gelten die Anforderungen aus [gemSpec_IDP_Dienst], Abschnitt 4.2. Die Ausgestaltung der http-response-Codes im Fall von technischen Fehlern (AC.3) muss entsprechend der Art des Fehlers ausgestaltet werden.&nbsp;</td> 
    </tr> 
    <tr> 
     <td style="width: 182px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">4XX/5XX</td> 
     <td style="width: 209px;height: 16.3636px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;"><span style="font-size: 10pt;line-height: 1.5;">siehe AC.3 in A_21441</span></td> 
    </tr> 
   </tbody> 
  </table> 
  <h3 id="polarion_wiki macro name=module-workitem;params=id=ML-119206">8.3 Vergleichsoperationen</h3> 
  <p id="polarion_127">Die folgenden Vergleichsoperationen sind innerhalb des Ablaufs notwendig:</p> 
  <h4 id="polarion_wiki macro name=module-workitem;params=id=ML-119205">8.3.1 Registrierung</h4> 
  <p id="polarion_287" data-keep-next="true" class="polarion-rte-caption-paragraph"> Tabelle <span data-sequence="Tabelle" class="polarion-rte-caption">32</span>: Vergleichsoperationen im Rahmen der Registrierung </p> 
  <table id="polarion_wiki macro name=table;params=width=100%|uid=3" class="polarion-Document-table" style="width: 100%;margin-left: 0px;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;"> 
   <tbody> 
    <tr> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 228px;height: 19.5px;border: 1px solid #CCCCCC;padding: 5px;">Datenobjekt<br> </th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 297px;height: 19.5px;border: 1px solid #CCCCCC;padding: 5px;">zu Datenobjekt</th> 
     <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 194px;height: 19.5px;border: 1px solid #CCCCCC;padding: 5px;">Vergleichsoperation</th> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 228px;height: 39px;border: 1px solid #CCCCCC;padding: 5px;">Signed_Pairing_Data/issuer</td> 
     <td style="text-align: left;vertical-align: top;width: 297px;height: 39px;border: 1px solid #CCCCCC;padding: 5px;">Registration_Data/auth_cert/issuer</td> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 39px;border: 1px solid #CCCCCC;padding: 5px;">Byte-weise</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 228px;height: 39px;border: 1px solid #CCCCCC;padding: 5px;">Signed_Pairing_Data/serialnumber</td> 
     <td style="text-align: left;vertical-align: top;width: 297px;height: 39px;border: 1px solid #CCCCCC;padding: 5px;">Registration_Data/auth_cert/serial_number</td> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 39px;border: 1px solid #CCCCCC;padding: 5px;">Gleiche Integer-Werte</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 228px;height: 39px;border: 1px solid #CCCCCC;padding: 5px;">Signed_Pairing_Data/not_after</td> 
     <td style="text-align: left;vertical-align: top;width: 297px;height: 39px;border: 1px solid #CCCCCC;padding: 5px;">Registration_Data/auth_cert/not_after</td> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 39px;border: 1px solid #CCCCCC;padding: 5px;">Gleichheit als Zahl bezogen auf die Repräsentation als Numeric-Date</td> 
    </tr> 
    <tr> 
     <td style="text-align: left;vertical-align: top;width: 228px;height: 39px;border: 1px solid #CCCCCC;padding: 5px;">Signed_Pairing_Data/auth_cert_subject_public_key_info</td> 
     <td style="text-align: left;vertical-align: top;width: 297px;height: 39px;border: 1px solid #CCCCCC;padding: 5px;">Registration_Data/auth_cert/SubjectPublicKeyInfo</td> 
     <td style="text-align: left;vertical-align: top;width: 194px;height: 39px;border: 1px solid #CCCCCC;padding: 5px;">Byte-weise</td> 
    </tr> 
   </tbody> 
  </table> 
  <p id="polarion_775"></p> 
 </body>
</html>